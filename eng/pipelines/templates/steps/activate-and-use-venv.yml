parameters:
  VirtualEnvironmentName: ""


steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.9'
      addToPath: true

  - template: create-venv.yml
    parameters:
      VirtualEnvironmentName: ${{ parameters.VirtualEnvironmentName }}

  - template: use-venv.yml
    parameters:
      VirtualEnvironmentName: ${{ parameters.VirtualEnvironmentName }}

  - pwsh: |
      Get-ChildItem $Env:
      Get-ChildItem -R (Join-Path "$(Build.SourcesDirectory)" "${{ parameters.VirtualEnvironmentName }}")
    displayName: 'Dump Environment + Files'

  - script: |
      which python
      python -m pip freeze
      python -m pip install -r eng/ci_tools.txt
    displayName: 'Install Requirements'

  - script: |
      which python
      python -m pip freeze
      sdk_build -d "$(Build.ArtifactStagingDirectory)" "azure*" --service=appconfiguration --inactive
    displayName: 'Test Usage'

