# pylint: disable=line-too-long,useless-suppression
# coding=utf-8
# --------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
# Code generated by Microsoft (R) Python Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is regenerated.
# --------------------------------------------------------------------------

from azure.identity import DefaultAzureCredential

from azure.mgmt.azurestackhci import AzureStackHCIClient

"""
# PREREQUISITES
    pip install azure-identity
    pip install azure-mgmt-azurestackhci
# USAGE
    python edge_machine_jobs_create_or_update_update_os.py

    Before run the sample, please set the values of the client ID, tenant ID and client secret
    of the AAD application as environment variables: AZURE_CLIENT_ID, AZURE_TENANT_ID,
    AZURE_CLIENT_SECRET. For more info about how to get the value, please see:
    https://docs.microsoft.com/azure/active-directory/develop/howto-create-service-principal-portal
"""


def main():
    client = AzureStackHCIClient(
        credential=DefaultAzureCredential(),
        subscription_id="SUBSCRIPTION_ID",
    )

    response = client.edge_machine_jobs.begin_create_or_update(
        resource_group_name="ArcInstance-rg",
        edge_machine_name="machine1",
        jobs_name="UpdateOs",
        resource={
            "properties": {
                "deploymentMode": "Deploy",
                "jobType": "ProvisionOs",
                "provisioningRequest": {
                    "customConfiguration": "eyJjdXN0b21Db25maWciOiAiZXhhbXBsZSBiYXNlNjQgZW5jb2RlZCBjb25maWcifQ==",
                    "deviceConfiguration": {
                        "hostName": "634b9db8-83e1-46ed-b391-c1614e2d0097",
                        "network": {
                            "networkAdapters": [
                                {
                                    "dnsAddressArray": ["8.8.8.8"],
                                    "gateway": "",
                                    "ipAddress": "",
                                    "ipAddressRange": {"endIp": "", "startIp": ""},
                                    "ipAssignmentType": "Automatic",
                                    "subnetMask": "",
                                    "vlanId": "0",
                                }
                            ]
                        },
                        "time": {"primaryTimeServer": "", "secondaryTimeServer": "", "timeZone": "UTC"},
                        "webProxy": {"bypassList": [], "connectionUri": "https://microsoft.com/a", "port": ""},
                    },
                    "onboardingConfiguration": {
                        "arcVirtualMachineId": "634b9db8-83e1-46ed-b391-c1614e2d0097",
                        "location": "eastus",
                        "resourceId": "/subscriptions/ff0aa6da-20f8-44fe-9aee-381c8e8a4aeb/resourceGroups/bhukumar-test-rg/providers/Microsoft.HybridCompute/machines/bkumar-t1",
                        "tenantId": "72f988bf-86f1-41af-91ab-2d7cd011db47",
                        "type": "HybridComputeMachine",
                    },
                    "osProfile": {
                        "gpgPubKey": "LS0tLS1CRUdJTiBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tXG5WZXJzaW9uOiBHbnVQRyB2MlxuXG5tUUVOQkZYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYXG4tLS0tLUVORCBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0t",
                        "imageHash": "sha256:b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef12345678",
                        "operationType": "Update",
                        "osImageLocation": "https://aka.ms/aep/azlinux3.1",
                        "osName": "AzureLinux",
                        "osType": "AzureLinux",
                        "osVersion": "3.1",
                        "vsrVersion": "1.1.0",
                    },
                    "target": "AzureLinux",
                    "userDetails": [
                        {
                            "secretLocation": "https://bhukumar-test-kv.vault.azure.net/secrets/edgeuser/7b2d7db11bad4e1599cb6a0f4d2b2e00",
                            "secretType": "KeyVault",
                            "sshPubKey": ["ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC7... edgeuser@example.com"],
                            "userName": "edgeuser",
                        }
                    ],
                },
            }
        },
    ).result()
    print(response)


# x-ms-original-file: 2025-12-01-preview/EdgeMachineJobs_CreateOrUpdate_UpdateOs.json
if __name__ == "__main__":
    main()
