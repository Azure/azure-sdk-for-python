# NOTE: Please refer to https://aka.ms/azsdk/engsys/ci-yaml before editing this file.
trigger:
  branches:
    include:
    - main
    - hotfix/*
    - release/*
    - restapi*
  paths:
    include:
    - sdk/cosmos/
    - sdk/core/

pr:
  branches:
    include:
    - main
    - feature/*
    - hotfix/*
    - release/*
    - restapi*
  paths:
    include:
    - sdk/cosmos/
    - sdk/core/

extends:
  template: /eng/pipelines/templates/stages/archetype-sdk-client.yml
  parameters:
    ServiceDirectory: cosmos
    BeforeTestSteps:
      - template: /eng/common/pipelines/templates/steps/cosmos-emulator.yml
        parameters:
          StartParameters: '/noexplorer /noui /enablepreview /EnableSqlComputeEndpoint /SqlComputePort=9999 /disableratelimiting /partitioncount=50 /consistency=Strong'
    TestMarkArgument: not cosmosEmulator
    MatrixConfigs:
      - name: MatrixConfigs
        type: object
        default:
          - Name: Python_cosmos_emulator
            Path: sdk/cosmos/emulator-matrix.json
            Selection: sparse
            GenerateVMJobs: true
    Artifacts:
    - name: azure-cosmos
      safeName: azurecosmos
