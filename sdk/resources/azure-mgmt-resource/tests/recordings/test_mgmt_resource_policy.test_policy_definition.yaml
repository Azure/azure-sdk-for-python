interactions:
- request:
    body: '{"properties": {"policyType": "Custom", "description": "Don''t create a
      VM anywhere", "policyRule": {"if": {"allOf": [{"source": "action", "equals":
      "Microsoft.Compute/virtualMachines/write"}, {"field": "location", "in": ["eastus",
      "eastus2", "centralus"]}]}, "then": {"effect": "deny"}}}}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '288'
      Content-Type:
      - application/json; charset=utf-8
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"properties":{"policyType":"Custom","mode":"Indexed","description":"Don''t
        create a VM anywhere","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:06.4039986Z","updatedBy":null,"updatedOn":null},"policyRule":{"if":{"allOf":[{"source":"action","equals":"Microsoft.Compute/virtualMachines/write"},{"field":"location","in":["eastus","eastus2","centralus"]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","type":"Microsoft.Authorization/policyDefinitions","name":"pypolicyea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '631'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:06 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1199'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"properties":{"policyType":"Custom","mode":"Indexed","description":"Don''t
        create a VM anywhere","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:06.4039986Z","updatedBy":null,"updatedOn":null},"policyRule":{"if":{"allOf":[{"source":"action","equals":"Microsoft.Compute/virtualMachines/write"},{"field":"location","in":["eastus","eastus2","centralus"]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","type":"Microsoft.Authorization/policyDefinitions","name":"pypolicyea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '631'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:06 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions?api-version=2019-01-01
  response:
    body:
      string: '{"value":[{"properties":{"displayName":"Audit virtual machines without
        disaster recovery configured","policyType":"BuiltIn","mode":"All","description":"Audit
        virtual machines which do not have disaster recovery configured. To learn
        more about disaster recovery, visit https://aka.ms/asr-doc.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Resources/links","existenceCondition":{"field":"name","like":"ASR-Protect-*"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56","type":"Microsoft.Authorization/policyDefinitions","name":"0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Sockets state for a Function App","policyType":"BuiltIn","mode":"All","description":"The
        Web Sockets protocol is vulnerable to different types of security threats.
        Use of Web Sockets within an Function app must be carefully reviewed.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableWebSockets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd","type":"Microsoft.Authorization/policyDefinitions","name":"001802d1-4969-4c82-a700-c29c6c6f9bbd"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs on which the remote host connection status does not match
        the specified one","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines on which the remote host connection
        status does not match the specified one. This policy should only be used along
        with its corresponding deploy policy in an initiative. For more information
        on Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsRemoteConnection"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/02a84be7-c304-421f-9bb7-5d2c26af54ad","type":"Microsoft.Authorization/policyDefinitions","name":"02a84be7-c304-421f-9bb7-5d2c26af54ad"},{"properties":{"displayName":"SQL
        managed instance TDE protector should be encrypted with your own key","policyType":"BuiltIn","mode":"Indexed","description":"Transparent
        Data Encryption (TDE) with your own key support provides increased transparency
        and control over the TDE Protector, increased security with an HSM-backed
        external service, and promotion of separation of duties.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/encryptionProtector","name":"current","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType","equals":"AzureKeyVault"},{"field":"Microsoft.Sql/managedInstances/encryptionProtector/uri","notEquals":""},{"field":"Microsoft.Sql/managedInstances/encryptionProtector/uri","exists":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260","type":"Microsoft.Authorization/policyDefinitions","name":"048248b0-55cd-46da-b1ff-39efd52db260"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77","type":"Microsoft.Authorization/policyDefinitions","name":"053d3325-282c-4e5c-b944-24faffd30d77"},{"properties":{"displayName":"Diagnostic
        logs in Azure Data Lake Store should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb","type":"Microsoft.Authorization/policyDefinitions","name":"057ef27e-665e-4328-8ea3-04b3122bd9fb"},{"properties":{"displayName":"Audit
        SQL DB Level Audit Setting","policyType":"BuiltIn","mode":"All","description":"Audit
        DB level audit setting for SQL databases","metadata":{"category":"SQL","deprecated":true},"parameters":{"setting":{"type":"String","metadata":{"displayName":"Audit
        Setting"},"allowedValues":["enabled","disabled"]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases"},{"field":"name","notEquals":"master"}]},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/auditingSettings","name":"default","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a12"},{"properties":{"displayName":"Audit
        VMs that do not use managed disks","policyType":"BuiltIn","mode":"All","description":"This
        policy audits VMs that do not use managed disks","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/virtualMachines/osDisk.uri","exists":"True"}]},{"allOf":[{"field":"type","equals":"Microsoft.Compute/VirtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers","exists":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl","exists":"True"}]}]}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d","type":"Microsoft.Authorization/policyDefinitions","name":"06a78e20-9358-41c9-923c-fb736d382a4d"},{"properties":{"displayName":"CORS
        should not allow every resource to access your Function App","policyType":"BuiltIn","mode":"All","description":"Cross
        origin Resource Sharing (CORS) should not allow all domains to access your
        Function app. Allow only required domains to interact with your Function app.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"CorsRestrictionsForFunctionApp","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5","type":"Microsoft.Authorization/policyDefinitions","name":"0820b7b9-23aa-4725-a1ce-ae4558f718e5"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed. The list of OS images will be updated over
        time as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        values: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c","type":"Microsoft.Authorization/policyDefinitions","name":"0868462e-646c-4fe3-9ced-a733534b6a2c"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Applications that are not using latest supported PHP Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported PHP version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPHP","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c","type":"Microsoft.Authorization/policyDefinitions","name":"08b17839-76c6-4015-90e0-33d9d54d219c"},{"properties":{"displayName":"Network
        Security Group Rules for Internet facing virtual machines should be hardened","policyType":"BuiltIn","mode":"Indexed","description":"Azure
        Security Center analyzes the traffic patterns of Internet facing virtual machines
        and provides Network Security Group rule recommendations that reduce the potential
        attack surface","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"adaptiveNetworkHardenings","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6","type":"Microsoft.Authorization/policyDefinitions","name":"08e6af2d-db70-460a-bfe9-d5bd474ba9d6"},{"properties":{"displayName":"There
        should be more than one owner assigned to your subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate more than one subscription owner in order to have
        administrator access redundancy.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateMoreThanOneOwner","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b","type":"Microsoft.Authorization/policyDefinitions","name":"09024ccc-0c5f-475e-9457-b7c0d9ed487b"},{"properties":{"displayName":"Disk
        encryption should be applied on virtual machines","policyType":"BuiltIn","mode":"All","description":"VMs
        without an enabled disk encryption will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d","type":"Microsoft.Authorization/policyDefinitions","name":"0961003e-5a0a-4549-abde-af6a37f2724d"},{"properties":{"displayName":"Audit
        resource location matches resource group location","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        that the resource location matches its resource group location","metadata":{"category":"General"},"policyRule":{"if":{"field":"location","notIn":["[resourcegroup().location]","global"]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a","type":"Microsoft.Authorization/policyDefinitions","name":"0a914e76-4921-4c19-b460-a2d36003525a"},{"properties":{"displayName":"SQL
        server TDE protector should be encrypted with your own key","policyType":"BuiltIn","mode":"Indexed","description":"Transparent
        Data Encryption (TDE) with your own key support provides increased transparency
        and control over the TDE Protector, increased security with an HSM-backed
        external service, and promotion of separation of duties.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/encryptionProtector","name":"current","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/servers/encryptionProtector/serverKeyType","equals":"AzureKeyVault"},{"field":"Microsoft.Sql/servers/encryptionProtector/uri","notEquals":""},{"field":"Microsoft.Sql/servers/encryptionProtector/uri","exists":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd","type":"Microsoft.Authorization/policyDefinitions","name":"0d134df8-db83-46fb-ad72-fe0c9428c8dd"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs on which Windows Defender Exploit Guard is not enabled","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines on which Windows Defender Exploit Guard
        is not enabled. This policy should only be used along with its corresponding
        deploy policy in an initiative/policy set. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsDefenderExploitGuard","existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","equals":"Compliant"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053","type":"Microsoft.Authorization/policyDefinitions","name":"0d9b45ff-9ddd-43fc-bf59-fbd1c8423053"},{"properties":{"displayName":"[Preview]:
        Authorized IP ranges should be defined on Kubernetes Services","policyType":"BuiltIn","mode":"All","description":"Restrict
        access to the Kubernetes Service Management API by granting API access only
        to IP addresses in specific ranges. It is recommended to limit access to authorized
        IP ranges to ensure that only applications from allowed networks can access
        the cluster.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"field":"Microsoft.ContainerService/managedClusters/apiServerAuthorizedIPRanges","exists":"false"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea","type":"Microsoft.Authorization/policyDefinitions","name":"0e246bcf-5f6f-4f87-bc6f-775d4712c7ea"},{"properties":{"displayName":"Remote
        debugging should be turned off for Function App","policyType":"BuiltIn","mode":"All","description":"Remote
        debugging requires inbound ports to be opened on an function app.  Remote
        debugging should be turned off.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoteDebuggingForFunctionApp","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9","type":"Microsoft.Authorization/policyDefinitions","name":"0e60b895-3786-45da-8377-9c6b4b6ac5f9"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that do not contain the specified
        certificates in Trusted Root","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows VMs that
        do not contain the specified certificates in the Trusted Root Certification
        Authorities certificate store (Cert:\\LocalMachine\\Root). It also creates
        a system-assigned managed identity and deploys the VM extension for Guest
        Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"CertificateThumbprints":{"type":"String","metadata":{"displayName":"Certificate
        thumbprints","description":"A semicolon-separated list of certificate thumbprints
        that should exist under the Trusted Root certificate store (Cert:\\LocalMachine\\Root).
        e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsCertificateInTrustedRoot","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude'',
        ''='', parameters(''CertificateThumbprints'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsCertificateInTrustedRoot"},"CertificateThumbprints":{"value":"[parameters(''CertificateThumbprints'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"CertificateThumbprints":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude","value":"[parameters(''CertificateThumbprints'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5","type":"Microsoft.Authorization/policyDefinitions","name":"106ccbe4-a791-4f33-a44a-06796944b8d5"},{"properties":{"displayName":"[Preview]:
        Audit Dependency Agent Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed. The list of OS images will be updated over time as
        support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3","12-SP4"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07","type":"Microsoft.Authorization/policyDefinitions","name":"11ac78e3-31bc-4f0c-8434-37ab963cea07"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs that do not have the specified applications
        installed","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        creates a Guest Configuration assignment to audit Windows virtual machines
        that do not have the specified applications installed. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"installedApplication":{"type":"String","metadata":{"displayName":"Application
        names (supports wildcards)","description":"A semicolon-separated list of the
        names of the applications that should be installed. e.g. ''Microsoft SQL Server
        2014 (64-bit); Microsoft Visual Studio Code'' or ''Microsoft SQL Server 2014*''
        (to match any application starting with ''Microsoft SQL Server 2014'')"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WhitelistedApplication","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[InstalledApplication]bwhitelistedapp;Name'',
        ''='', parameters(''installedApplication'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WhitelistedApplication"},"installedApplication":{"value":"[parameters(''installedApplication'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"installedApplication":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[InstalledApplication]bwhitelistedapp;Name","value":"[parameters(''installedApplication'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6","type":"Microsoft.Authorization/policyDefinitions","name":"12f7e5d0-42a7-4630-80d8-54fb7cff9bd6"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs in which the Administrators group contains
        any of the specified members","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        in which the Administrators group contains any of the specified members. It
        also creates a system-assigned managed identity and deploys the VM extension
        for Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"MembersToExclude":{"type":"String","metadata":{"displayName":"Members
        to exclude","description":"A semicolon-separated list of members that should
        be excluded in the Administrators local group. Ex: Administrator; myUser1;
        myUser2"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AdministratorsGroupMembersToExclude","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[LocalGroup]AdministratorsGroup;MembersToExclude'',
        ''='', parameters(''MembersToExclude'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AdministratorsGroupMembersToExclude"},"MembersToExclude":{"value":"[parameters(''MembersToExclude'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"MembersToExclude":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[LocalGroup]AdministratorsGroup;MembersToExclude","value":"[parameters(''MembersToExclude'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba","type":"Microsoft.Authorization/policyDefinitions","name":"144f1397-32f9-4598-8c88-118decc3ccba"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that do not have a minimum password
        age of 1 day","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that do not have a minimum password age of 1 day. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordAge","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df","type":"Microsoft.Authorization/policyDefinitions","name":"16390df4-2f73-4b42-af13-c801066763df"},{"properties":{"displayName":"Audit
        Windows VMs that do not have the specified Windows PowerShell modules installed","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not have the specified Windows
        PowerShell modules installed. This policy should only be used along with its
        corresponding deploy policy in an initiative. For more information on Guest
        Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsPowerShellModules"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6","type":"Microsoft.Authorization/policyDefinitions","name":"16f9b37c-4408-4c30-bc17-254958f2e2d6"},{"properties":{"displayName":"Transparent
        Data Encryption on SQL databases should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        transparent data encryption status for SQL databases","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases"},{"field":"name","notEquals":"master"}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"enabled"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12","type":"Microsoft.Authorization/policyDefinitions","name":"17k78e20-9358-41c9-923c-fb736d382a12"},{"properties":{"displayName":"[Preview]:
        Access to App Services should be restricted","policyType":"BuiltIn","mode":"All","description":"Azure
        security center has discovered that the networking configuration of some of
        your app services are overly permissive and allow inbound traffic from ranges
        that are too broad","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Web/sites"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"restrictAccessToAppServices","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff","type":"Microsoft.Authorization/policyDefinitions","name":"1a833ff1-d297-4a0f-9944-888428f8e0ff"},{"properties":{"displayName":"Vulnerability
        assessment should be enabled on your SQL managed instances","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        SQL managed instances which do not have recurring vulnerability assessment
        scans enabled. Vulnerability assessment can discover, track, and help you
        remediate potential database vulnerabilities.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/vulnerabilityAssessments","name":"default","existenceCondition":{"field":"Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled","equals":"True"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a","type":"Microsoft.Authorization/policyDefinitions","name":"1b7aa243-30e4-4c9e-bca8-d0d3022b634a"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Windows VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined
        and the agent is not installed. The list of OS images will be updated over
        time as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04","type":"Microsoft.Authorization/policyDefinitions","name":"1c210e94-a481-4beb-95fa-1571b434fb04"},{"properties":{"displayName":"Virtual
        machines should be migrated to new Azure Resource Manager resources","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager for your virtual machines to provide security enhancements
        such as: stronger access control (RBAC), better auditing, ARM-based deployment
        and governance, access to managed identities, access to key vault for secrets,
        Azure AD-based authentication and support for tags and resource groups for
        easier security management","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicCompute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d","type":"Microsoft.Authorization/policyDefinitions","name":"1d84d5fb-01f6-4d12-ba4f-4a26081d403d"},{"properties":{"displayName":"[Deprecated]:
        Audit API Applications that are not using latest supported .NET Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported .NET Framework version for the latest security classes.
        Using older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestDotNet","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb","type":"Microsoft.Authorization/policyDefinitions","name":"1de7b11d-1870-41a5-8181-507e7c663cfb"},{"properties":{"displayName":"Require
        tag and its value","policyType":"BuiltIn","mode":"Indexed","description":"Enforces
        a required tag and its value. Does not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"not":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","equals":"[parameters(''tagValue'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62","type":"Microsoft.Authorization/policyDefinitions","name":"1e30110a-5ceb-460c-a204-c1c3969c6d62"},{"properties":{"displayName":"An
        Azure Active Directory administrator should be provisioned for SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        provisioning of an Azure Active Directory administrator for your SQL server
        to enable Azure AD authentication. Azure AD authentication enables simplified
        permission management and centralized identity management of database users
        and other Microsoft services","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/administrators"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9","type":"Microsoft.Authorization/policyDefinitions","name":"1f314764-cb73-4fc9-b863-8eca98ac36e9"},{"properties":{"displayName":"The
        NSGs rules for web applications on IaaS should be hardened","policyType":"BuiltIn","mode":"All","description":"Azure
        security center has discovered that some of your virtual machines are running
        web applications, and the NSGs associated to these virtual machines are overly
        permissive with regards to the web application ports","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6","type":"Microsoft.Authorization/policyDefinitions","name":"201ea587-7c90-41c3-910f-c280ae01cfd6"},{"properties":{"displayName":"[Deprecated]:
        Audit API Apps that are not using custom domains","policyType":"BuiltIn","mode":"All","description":"Use
        of custom domains protects a API app from common attacks such as phishing
        and other DNS-related attacks.","metadata":{"category":"Security Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UsedCustomDomains","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac","type":"Microsoft.Authorization/policyDefinitions","name":"224da9fe-0d38-4e79-adb3-0a6e2af942ac"},{"properties":{"displayName":"Management
        ports should be closed on your virtual machines","policyType":"BuiltIn","mode":"All","description":"Open
        remote management ports are exposing your VM to a high level of risk from
        Internet-based attacks. These attacks attempt to brute force credentials to
        gain admin access to the machine.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"restrictAccessToManagementPorts","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917","type":"Microsoft.Authorization/policyDefinitions","name":"22730e10-96f6-4aac-ad84-9383d35b5917"},{"properties":{"displayName":"Only
        secure connections to your Redis Cache should be enabled","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of only connections via SSL to Redis Cache. Use of secure connections
        ensures authentication between the server and the service and protects data
        in transit from network layer attacks such as man-in-the-middle, eavesdropping,
        and session-hijacking","metadata":{"category":"Cache"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Cache/redis"},{"field":"Microsoft.Cache/Redis/enableNonSslPort","equals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb","type":"Microsoft.Authorization/policyDefinitions","name":"22bee202-a82f-4305-9a2a-6d7f44d4dedb"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that do not restrict the minimum
        password length to 14 characters","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that do not restrict the minimum password length to 14 characters. It also
        creates a system-assigned managed identity and deploys the VM extension for
        Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MinimumPasswordLength","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MinimumPasswordLength"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca","type":"Microsoft.Authorization/policyDefinitions","name":"23020aa6-1135-4be2-bae2-149982b06eca"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that do not have a maximum password age of 70 days","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not have a maximum password
        age of 70 days. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MaximumPasswordAge"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc","type":"Microsoft.Authorization/policyDefinitions","name":"24dde96d-f0b1-425e-884f-4a1421e2dcdc"},{"properties":{"displayName":"Endpoint
        protection solution should be installed on virtual machine scale sets","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        the existence and health of an endpoint protection solution on your virtual
        machines scale sets, to protect them from threats and vulnerabilities.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EndpointProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de","type":"Microsoft.Authorization/policyDefinitions","name":"26a828e1-e88f-464e-bbb3-c134a282b9de"},{"properties":{"displayName":"Metric
        alert rules should be configured on Batch accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        configuration of metric alert rules on Batch account to enable the required
        metric","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"metricName":{"type":"String","metadata":{"displayName":"Metric
        name","description":"The metric name that an alert rule must be enabled on"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/alertRules","existenceScope":"Subscription","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/alertRules/isEnabled","equals":"true"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.metricName","equals":"[parameters(''metricName'')]"},{"field":"Microsoft.Insights/alertRules/condition.dataSource.resourceUri","equals":"[concat(''/subscriptions/'',
        subscription().subscriptionId, ''/resourcegroups/'', resourceGroup().name,
        ''/providers/Microsoft.Batch/batchAccounts/'', field(''name''))]"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7","type":"Microsoft.Authorization/policyDefinitions","name":"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7"},{"properties":{"displayName":"Deploy
        default Microsoft IaaSAntimalware extension for Windows Server","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys a Microsoft IaaSAntimalware extension with a default configuration
        when a VM is not configured with the antimalware extension.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"IaaSAntimalware"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Security"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"ExclusionsPaths":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file paths or locations to exclude from scanning"}},"ExclusionsExtensions":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of file extensions to exclude from scanning"}},"ExclusionsProcesses":{"type":"string","defaultValue":"","metadata":{"description":"Semicolon
        delimited list of process names to exclude from scanning"}},"RealtimeProtectionEnabled":{"type":"string","defaultValue":"true","metadata":{"description":"Indicates
        whether or not real time protection is enabled (default is true)"}},"ScheduledScanSettingsIsEnabled":{"type":"string","defaultValue":"false","metadata":{"description":"Indicates
        whether or not custom scheduled scan settings are enabled (default is false)"}},"ScheduledScanSettingsScanType":{"type":"string","defaultValue":"Quick","metadata":{"description":"Indicates
        whether scheduled scan setting type is set to Quick or Full (default is Quick)"}},"ScheduledScanSettingsDay":{"type":"string","defaultValue":"7","metadata":{"description":"Day
        of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)"}},"ScheduledScanSettingsTime":{"type":"string","defaultValue":"120","metadata":{"description":"When
        to perform the scheduled scan, measured in minutes from midnight (0-1440).
        For example: 0 = 12AM, 60 = 1AM, 120 = 2AM."}}},"resources":[{"name":"[concat(parameters(''vmName''),''/IaaSAntimalware'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.Azure.Security","type":"IaaSAntimalware","typeHandlerVersion":"1.3","autoUpgradeMinorVersion":true,"settings":{"AntimalwareEnabled":true,"RealtimeProtectionEnabled":"[parameters(''RealtimeProtectionEnabled'')]","ScheduledScanSettings":{"isEnabled":"[parameters(''ScheduledScanSettingsIsEnabled'')]","day":"[parameters(''ScheduledScanSettingsDay'')]","time":"[parameters(''ScheduledScanSettingsTime'')]","scanType":"[parameters(''ScheduledScanSettingsScanType'')]"},"Exclusions":{"Extensions":"[parameters(''ExclusionsExtensions'')]","Paths":"[parameters(''ExclusionsPaths'')]","Processes":"[parameters(''ExclusionsProcesses'')]"}}}}]},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"RealtimeProtectionEnabled":{"value":"true"},"ScheduledScanSettingsIsEnabled":{"value":"true"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc","type":"Microsoft.Authorization/policyDefinitions","name":"2835b622-407b-4114-9198-6f7064cbe0dc"},{"properties":{"displayName":"Append
        tag and its default value","policyType":"BuiltIn","mode":"Indexed","description":"Appends
        the specified tag and value when any resource which is missing this tag is
        created or updated. Does not modify the tags of resources created before this
        policy was applied until those resources are changed. Does not apply to resource
        groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498","type":"Microsoft.Authorization/policyDefinitions","name":"2a0e14a6-b0a6-4fab-991a-187a4f81c498"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that do not store passwords using reversible encryption","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not store passwords using reversible
        encryption. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"StorePasswordsUsingReversibleEncryption"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6","type":"Microsoft.Authorization/policyDefinitions","name":"2d60d3b7-aa10-454c-88a8-de39d99d17c6"},{"properties":{"displayName":"[Preview]:
        Audit Linux VMs that allow remote connections from accounts without passwords","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Linux virtual machines that allow remote connections from accounts
        without passwords. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordPolicy_msid110"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83","type":"Microsoft.Authorization/policyDefinitions","name":"2d67222d-05fd-4526-a171-2ee132ad9e83"},{"properties":{"displayName":"Web
        Application should only be accessible over HTTPS","policyType":"BuiltIn","mode":"All","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"Security
        Center","deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"OnlyHttpsForWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0","type":"Microsoft.Authorization/policyDefinitions","name":"2fde8a98-6892-426a-83ba-050e640c0ce0"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs that are not joined to the specified domain","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that are not joined to the specified domain. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"DomainName":{"type":"String","metadata":{"displayName":"Domain
        Name (FQDN)","description":"The fully qualified domain name (FQDN) that the
        Windows VMs should be joined to"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsDomainMembership","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[DomainMembership]WindowsDomainMembership;DomainName'',
        ''='', parameters(''DomainName'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsDomainMembership"},"DomainName":{"value":"[parameters(''DomainName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"DomainName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[DomainMembership]WindowsDomainMembership;DomainName","value":"[parameters(''DomainName'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970","type":"Microsoft.Authorization/policyDefinitions","name":"315c850a-272d-4502-8935-b79010405970"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Agent Deployment - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if the VM Image (OS) is not in the list defined and the
        agent is not installed. The list of OS images will be updated over time as
        support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"anyOf":[{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50","type":"Microsoft.Authorization/policyDefinitions","name":"32133ab0-ee4b-4b44-98d6-042180979d50"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs on which the specified services are not
        installed and ''Running''","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        on which the specified services are not installed and ''Running''. It also
        creates a system-assigned managed identity and deploys the VM extension for
        Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ServiceName":{"type":"String","metadata":{"displayName":"Service
        names (supports wildcards)","description":"A semicolon-separated list of the
        names of the services that should be installed and ''Running''. e.g. ''WinRm;Wi*''"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsServiceStatus","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[WindowsServiceStatus]WindowsServiceStatus1;ServiceName'',
        ''='', parameters(''ServiceName'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsServiceStatus"},"ServiceName":{"value":"[parameters(''ServiceName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ServiceName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[WindowsServiceStatus]WindowsServiceStatus1;ServiceName","value":"[parameters(''ServiceName'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262","type":"Microsoft.Authorization/policyDefinitions","name":"32b1e4d4-6cd5-47b4-a935-169da8a5c262"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Linux VMs that have accounts without passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Linux virtual machines
        that have accounts without passwords. It also creates a system-assigned managed
        identity and deploys the VM extension for Guest Configuration. This policy
        should only be used along with its corresponding audit policy in an initiative.
        For more information on Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid232","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid232"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe","type":"Microsoft.Authorization/policyDefinitions","name":"3470477a-b35a-49db-aca5-1073d04524fe"},{"properties":{"displayName":"Audit
        unrestricted network access to storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        unrestricted network access in your storage account firewall settings. Instead,
        configure network rules so only applications from allowed networks can access
        the storage account. To allow connections from specific internet or on-premise
        clients, access can be granted to traffic from specific Azure virtual networks
        or to public internet IP address ranges","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/networkAcls.defaultAction","equals":"Allow"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c","type":"Microsoft.Authorization/policyDefinitions","name":"34c877ad-507e-4c82-993e-3452a6e0ad3c"},{"properties":{"displayName":"Diagnostic
        logs in Logic Apps should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Logic Apps"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Logic/workflows"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d","type":"Microsoft.Authorization/policyDefinitions","name":"34f95f76-5386-4de7-b824-0d8478470c9d"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that do not have a maximum password
        age of 70 days","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that do not have a maximum password age of 70 days. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MaximumPasswordAge","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MaximumPasswordAge"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934","type":"Microsoft.Authorization/policyDefinitions","name":"356a906e-05e5-4625-8729-90771e0ee934"},{"properties":{"displayName":"CORS
        should not allow every resource to access your API App","policyType":"BuiltIn","mode":"All","description":"Cross
        origin Resource Sharing (CORS) should not allow all domains to access your
        API app. Allow only required domains to interact with your API app.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"CorsRestrictionsForApiApp","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac","type":"Microsoft.Authorization/policyDefinitions","name":"358c20a6-3f9e-4f0e-97ff-c6ce485e2aac"},{"properties":{"displayName":"Gateway
        subnets should not be configured with a network security group","policyType":"BuiltIn","mode":"All","description":"This
        policy denies if a gateway subnet is configured with a network security group.
        Assigning a network security group to a gateway subnet will cause the gateway
        to stop functioning.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"field":"name","equals":"GatewaySubnet"},{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","exists":"true"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010","type":"Microsoft.Authorization/policyDefinitions","name":"35f9c03a-cc27-418e-9c0c-539ff999d010"},{"properties":{"displayName":"Deploy
        Advanced Threat Protection on Storage Accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables Advanced Threat Protection on Storage Accounts.","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["DeployIfNotExists","Disabled"],"defaultValue":"DeployIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Storage/storageAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/advancedThreatProtectionSettings","name":"current","existenceCondition":{"field":"Microsoft.Security/advancedThreatProtectionSettings/isEnabled","equals":"true"},"roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"storageAccountName":{"type":"string"}},"resources":[{"apiVersion":"2017-08-01-preview","type":"Microsoft.Storage/storageAccounts/providers/advancedThreatProtectionSettings","name":"[concat(parameters(''storageAccountName''),
        ''/Microsoft.Security/current'')]","properties":{"isEnabled":true}}]},"parameters":{"storageAccountName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c","type":"Microsoft.Authorization/policyDefinitions","name":"361c2074-3595-4e5d-8cab-4f21dffc835c"},{"properties":{"displayName":"Automation
        account variables should be encrypted","policyType":"BuiltIn","mode":"All","description":"It
        is important to enable encryption of Automation account variable assets when
        storing sensitive data","metadata":{"category":"Automation"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Automation/automationAccounts/variables"},{"field":"Microsoft.Automation/automationAccounts/variables/isEncrypted","notEquals":"true"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735","type":"Microsoft.Authorization/policyDefinitions","name":"3657f5a0-770e-44a3-b44e-9431ba1e9735"},{"properties":{"displayName":"Deploy
        Threat Detection on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Threat Detection is enabled on SQL Servers.","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"}},"variables":{},"resources":[{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}}]},"parameters":{"serverName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5","type":"Microsoft.Authorization/policyDefinitions","name":"36d49e87-48c4-4f2e-beed-ba4ed02b71f5"},{"properties":{"displayName":"Storage
        accounts should be migrated to new Azure Resource Manager resources","policyType":"BuiltIn","mode":"All","description":"Use
        new Azure Resource Manager for your storage accounts to provide security enhancements
        such as: stronger access control (RBAC), better auditing, Azure Resource Manager
        based deployment and governance, access to managed identities, access to key
        vault for secrets, Azure AD-based authentication and support for tags and
        resource groups for easier security management","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.classicStorage/storageAccounts"},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606","type":"Microsoft.Authorization/policyDefinitions","name":"37e0d2fe-28a5-43d6-a273-67d37d1f5606"},{"properties":{"displayName":"Diagnostic
        logs in IoT Hub should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Internet of Things"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Devices/IotHubs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4","type":"Microsoft.Authorization/policyDefinitions","name":"383856f8-de7f-44a2-81fc-e5135b5c2aa4"},{"properties":{"displayName":"Advanced
        data security settings for SQL managed instance should contain an email address
        to receive security alerts","policyType":"BuiltIn","mode":"Indexed","description":"Ensure
        that an email address is provided for the ''Send alerts to'' field in the
        Advanced Data Security server settings. This email address receives alert
        notifications when anomalous activities are detected on SQL managed instances.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/securityAlertPolicies","name":"default","existenceCondition":{"allOf":[{"field":"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]","notEquals":""},{"field":"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]","exists":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8","type":"Microsoft.Authorization/policyDefinitions","name":"3965c43d-b5f4-482e-b74a-d89ee0e0b3a8"},{"properties":{"displayName":"[Preview]:
        Pod Security Policies should be defined on Kubernetes Services","policyType":"BuiltIn","mode":"All","description":"Define
        Pod Security Policies to reduce the attack vector by removing unnecessary
        application privileges. It is recommended to configure Pod Security Policies
        to only allow pods to access the resources which they have permissions to
        access.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"anyOf":[{"field":"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy","exists":"false"},{"field":"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy","equals":"false"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94","type":"Microsoft.Authorization/policyDefinitions","name":"3abeb944-26af-43ee-b83d-32aaf060fb94"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Windows VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Windows VM Scale Sets if the VM Image (OS) is in the
        list defined and the agent is not installed. The list of OS images will be
        updated over time as support is updated. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"DependencyAgentWindows"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentWindows","vmExtensionTypeHandlerVersion":"9.7"},"resources":[{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9","type":"Microsoft.Authorization/policyDefinitions","name":"3be22e3b-d919-47aa-805e-8985dbeb0ad9"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Windows VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Windows VM Scale Sets if the VM Image (OS) is in the
        list defined and the agent is not installed. The list of OS images will be
        updated over time as support is updated. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293","/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"MicrosoftMonitoringAgent"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"MicrosoftMonitoringAgent","vmExtensionTypeHandlerVersion":"1.0"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachineScaleSets/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038","type":"Microsoft.Authorization/policyDefinitions","name":"3c1b3629-c8f8-4bf6-862c-037cb9094038"},{"properties":{"displayName":"Vulnerabilities
        in security configuration on your virtual machine scale sets should be remediated","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        the OS vulnerabilities on your virtual machine scale sets to protect them
        from attacks.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"OsVulnerabilities","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4","type":"Microsoft.Authorization/policyDefinitions","name":"3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4"},{"properties":{"displayName":"Deploy
        default Log Analytics Agent for Ubuntu VMs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the
        selected Log Analytics workspace","metadata":{"category":"Compute","deprecated":true},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS","16.04-LTS","16.04.0-LTS","14.04.2-LTS","12.04.5-LTS"]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"resources":[{"name":"[concat(parameters(''vmName''),''/omsPolicy'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","apiVersion":"2017-12-01","properties":{"publisher":"Microsoft.EnterpriseCloud.Monitoring","type":"OmsAgentForLinux","typeHandlerVersion":"1.4","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        monitoring for Linux VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38","type":"Microsoft.Authorization/policyDefinitions","name":"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38"},{"properties":{"displayName":"[Deprecated]:
        Audit API Applications that are not using latest supported PHP Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported PHP version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPHP","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66","type":"Microsoft.Authorization/policyDefinitions","name":"3fe37002-5d00-4b37-a301-da09e3a0ca66"},{"properties":{"displayName":"Secure
        transfer to storage accounts should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        requirment of Secure transfer in your storage account. Secure transfer is
        an option that forces your storage account to accept requests only from secure
        connections (HTTPS). Use of HTTPS ensures authentication between the server
        and the service and protects data in transit from network layer attacks such
        as man-in-the-middle, eavesdropping, and session-hijacking","metadata":{"category":"Storage"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9","type":"Microsoft.Authorization/policyDefinitions","name":"404c3081-a854-4457-ae30-26a93ef643f9"},{"properties":{"displayName":"Diagnostic
        logs in Batch accounts should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Batch"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Batch/batchAccounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d","type":"Microsoft.Authorization/policyDefinitions","name":"428256e6-1fac-4f48-a757-df34c2b3336d"},{"properties":{"displayName":"[Deprecated]:
        Monitor permissive network access in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Network
        Security Groups with too permissive rules will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center","deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"permissiveNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed","type":"Microsoft.Authorization/policyDefinitions","name":"44452482-524f-4bf4-b852-0bff7cc4a3ed"},{"properties":{"displayName":"Require
        SQL Server version 12.0","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures all SQL servers use version 12.0","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers"},{"not":{"field":"Microsoft.Sql/servers/version","equals":"12.0"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf","type":"Microsoft.Authorization/policyDefinitions","name":"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Applications that are not using latest supported Python Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Python version for the latest security classes. Using
        older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPython","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06","type":"Microsoft.Authorization/policyDefinitions","name":"46544d7b-1f0d-46f5-81da-5c1351de1b06"},{"properties":{"displayName":"Require
        automatic OS image patching on Virtual Machine Scale Sets","policyType":"BuiltIn","mode":"All","description":"This
        policy enforces enabling automatic OS image patching on Virtual Machine Scale
        Sets to always keep Virtual Machines secure by safely applying latest security
        patches every month.","metadata":{"category":"Compute"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgradePolicy.enableAutomaticOSUpgrade","notEquals":"True"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade","notEquals":"True"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"465f0161-0087-490a-9ad9-ad6217f4f43a"},{"properties":{"displayName":"Adaptive
        Application Controls should be enabled on virtual machines","policyType":"BuiltIn","mode":"All","description":"Possible
        Application Whitelist configuration will be monitored by Azure Security Center","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"applicationWhitelisting","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc","type":"Microsoft.Authorization/policyDefinitions","name":"47a6b606-51aa-4496-8bb7-64b11cf66adc"},{"properties":{"displayName":"[Deprecated]:
        Audit IP restrictions configuration for an API App","policyType":"BuiltIn","mode":"All","description":"IP
        Restrictions allow you to define a list of IP addresses that are allowed to
        access your app. Use of IP Restrictions protects an API app from common attacks.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"ConfigureIPRestrictions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53","type":"Microsoft.Authorization/policyDefinitions","name":"48893b84-a2c8-4d9a-badf-835d5d1b7d53"},{"properties":{"displayName":"Append
        tag and its default value to resource groups","policyType":"BuiltIn","mode":"All","description":"Appends
        the specified tag and value when any resource group which is missing this
        tag is created or updated. Does not modify the tags of resource groups created
        before this policy was applied until those resource groups are changed.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[parameters(''tagValue'')]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71","type":"Microsoft.Authorization/policyDefinitions","name":"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71"},{"properties":{"displayName":"Deploy
        requirements to audit Linux VMs that do not have the specified applications
        installed","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        creates a Guest Configuration assignment to audit Linux virtual machines that
        do not have the specified applications installed. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        names","description":"A semicolon-separated list of the names of the applications
        that should be installed. e.g. ''python; powershell''"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"installed_application_linux","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent'',
        ''='', concat(''packages: ['', replace(parameters(''ApplicationName''), '';'',
        '',''), '']'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"installed_application_linux"},"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ApplicationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent","value":"[concat(''packages:
        ['', replace(parameters(''ApplicationName''), '';'', '',''), '']'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721","type":"Microsoft.Authorization/policyDefinitions","name":"4d1c04de-2172-403f-901b-90608c35c721"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Linux VMs","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined
        and the agent is not installed.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3","12-SP4"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"},{"field":"Microsoft.Compute/virtualMachines/extensions/provisioningState","equals":"Succeeded"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.6"},"resources":[{"type":"Microsoft.Compute/virtualMachines/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for VM'', '': '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee","type":"Microsoft.Authorization/policyDefinitions","name":"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee"},{"properties":{"displayName":"A
        maximum of 3 owners should be designated for your subscription","policyType":"BuiltIn","mode":"All","description":"It
        is recommended to designate up to 3 subscription owners in order to reduce
        the potential for breach by a compromised owner.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DesignateLessThanXOwners","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c","type":"Microsoft.Authorization/policyDefinitions","name":"4f11b553-d42e-4e3a-89be-32ca364cad4c"},{"properties":{"displayName":"CORS
        should not allow every resource to access your Web Application","policyType":"BuiltIn","mode":"All","description":"Cross
        origin Resource Sharing (CORS) should not allow all domains to access your
        web application. Allow only required domains to interact with your web app.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"CorsRestrictionsForWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9","type":"Microsoft.Authorization/policyDefinitions","name":"5744710e-cc2f-4ee8-8809-3b11e89f4bc9"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that do not have a minimum password age of 1 day","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not have a minimum password
        age of 1 day. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MinimumPasswordAge"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7","type":"Microsoft.Authorization/policyDefinitions","name":"5aa11bbc-5c76-4302-80e5-aba46a4282e7"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that do not restrict the minimum password length to 14 characters","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not restrict the minimum password
        length to 14 characters. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MinimumPasswordLength"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec","type":"Microsoft.Authorization/policyDefinitions","name":"5aebc8d1-020d-4037-89a0-02043a7524ec"},{"properties":{"displayName":"Audit
        Linux VMs that have the specified applications installed","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Linux virtual machines that have the specified applications
        installed. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"not_installed_application_linux"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8","type":"Microsoft.Authorization/policyDefinitions","name":"5b842acb-0fe7-41b0-9f40-880ec4ad84d8"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs on which the remote host connection
        status does not match the specified one","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        on which the remote host connection status does not match the specified one.
        It also creates a system-assigned managed identity and deploys the VM extension
        for Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"host":{"type":"String","metadata":{"displayName":"Remote
        Host Name","description":"Specifies the Domain Name System (DNS) name or IP
        address of the remote host machine."}},"port":{"type":"String","metadata":{"displayName":"Port","description":"The
        TCP port number on the remote host name."}},"shouldConnect":{"type":"String","metadata":{"displayName":"Should
        connect to remote host","description":"Must be ''True'' or ''False''. ''True''
        indicates that the virtual machine should be able to establish a connection
        with the remote host specified, so the machine will be non-compliant if it
        cannot establish a connection. ''False'' indicates that the virtual machine
        should not be able to establish a connection with the remote host specified,
        so the machine will be non-compliant if it can establish a connection."},"allowedValues":["True","False"],"defaultValue":"False"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsRemoteConnection","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[WindowsRemoteConnection]WindowsRemoteConnection1;host'',
        ''='', parameters(''host''), '','', ''[WindowsRemoteConnection]WindowsRemoteConnection1;port'',
        ''='', parameters(''port''), '','', ''[WindowsRemoteConnection]WindowsRemoteConnection1;shouldConnect'',
        ''='', parameters(''shouldConnect'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsRemoteConnection"},"host":{"value":"[parameters(''host'')]"},"port":{"value":"[parameters(''port'')]"},"shouldConnect":{"value":"[parameters(''shouldConnect'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"host":{"type":"string"},"port":{"type":"string"},"shouldConnect":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[WindowsRemoteConnection]WindowsRemoteConnection1;host","value":"[parameters(''host'')]"},{"name":"[WindowsRemoteConnection]WindowsRemoteConnection1;port","value":"[parameters(''port'')]"},{"name":"[WindowsRemoteConnection]WindowsRemoteConnection1;shouldConnect","value":"[parameters(''shouldConnect'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5bb36dda-8a78-4df9-affd-4f05a8612a8a","type":"Microsoft.Authorization/policyDefinitions","name":"5bb36dda-8a78-4df9-affd-4f05a8612a8a"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Agent Deployment in VMSS - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMSS as non-compliant if the VM Image (OS) is not in the list defined and
        the agent is not installed. The list of OS images will be updated over time
        as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138","type":"Microsoft.Authorization/policyDefinitions","name":"5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138"},{"properties":{"displayName":"External
        accounts with write permissions should be removed from your subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with write privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4","type":"Microsoft.Authorization/policyDefinitions","name":"5c607a2e-c700-4744-8254-d77e7c9eb5e4"},{"properties":{"displayName":"Function
        App should only be accessible over HTTPS","policyType":"BuiltIn","mode":"All","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"Security
        Center","deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"OnlyHttpsForFunctionApp","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55","type":"Microsoft.Authorization/policyDefinitions","name":"5df82f4f-773a-4a2d-97a2-422a806f1a55"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Applications that are not using latest supported .NET Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported .NET Framework version for the latest security classes.
        Using older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestDotNet","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2","type":"Microsoft.Authorization/policyDefinitions","name":"5e3315e0-a414-4efb-a4d2-c7bd2b0443d2"},{"properties":{"displayName":"Audit
        Windows VMs that do not have the specified applications installed","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not have the specified applications
        installed. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WhitelistedApplication"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9","type":"Microsoft.Authorization/policyDefinitions","name":"5e393799-e3ca-4e43-a9a5-0ec4648a57d9"},{"properties":{"displayName":"Allow
        resource creation only in India data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: West India, South India,
        Central India","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["westindia","southindia","centralindia"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54","type":"Microsoft.Authorization/policyDefinitions","name":"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54"},{"properties":{"displayName":"[Preview]:
        Deploy Log Analytics Agent for Linux VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Log Analytics Agent for Linux VM Scale Sets if the VM Image (OS) is in the
        list defined and the agent is not installed. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"logAnalytics":{"type":"String","metadata":{"displayName":"Log
        Analytics workspace","description":"Select Log Analytics workspace from dropdown
        list. If this workspace is outside of the scope of the assignment you must
        manually grant ''Log Analytics Contributor'' permissions (or similar) to the
        policy assignment''s principal ID.","strongType":"omsWorkspace","assignPermissions":true}},"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"12*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"14.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"16.04*LTS"},{"field":"Microsoft.Compute/imageSKU","like":"18.04*LTS"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Oracle"},{"field":"Microsoft.Compute/imageOffer","equals":"Oracle-Linux"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7.*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293","/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"OmsAgentForLinux"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"logAnalytics":{"type":"string"}},"variables":{"vmExtensionName":"MMAExtension","vmExtensionPublisher":"Microsoft.EnterpriseCloud.Monitoring","vmExtensionType":"OmsAgentForLinux","vmExtensionTypeHandlerVersion":"1.7"},"resources":[{"name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","type":"Microsoft.Compute/virtualMachineScaleSets/extensions","location":"[parameters(''location'')]","apiVersion":"2018-06-01","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true,"settings":{"workspaceId":"[reference(parameters(''logAnalytics''),
        ''2015-03-20'').customerId]","stopOnMultipleConnections":"true"},"protectedSettings":{"workspaceKey":"[listKeys(parameters(''logAnalytics''),
        ''2015-03-20'').primarySharedKey]"}}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"logAnalytics":{"value":"[parameters(''logAnalytics'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069","type":"Microsoft.Authorization/policyDefinitions","name":"5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069"},{"properties":{"displayName":"External
        accounts with read permissions should be removed from your subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with read privileges should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60","type":"Microsoft.Authorization/policyDefinitions","name":"5f76cf89-fbf2-47fd-a3f4-b891fa780b60"},{"properties":{"displayName":"Audit
        Windows web servers that are not using secure communication protocols","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows web servers that are not using secure communication
        protocols (TLS 1.1 or TLS 1.2). This policy should only be used along with
        its corresponding deploy policy in an initiative. For more information on
        Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"AuditSecureProtocol"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c","type":"Microsoft.Authorization/policyDefinitions","name":"60ffe3e2-4604-4460-8f22-0f1da058266c"},{"properties":{"displayName":"Deploy
        Advanced Data Security on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables Advanced Data Security on SQL Servers. This includes turning
        on Threat Detection and Vulnerability Assessment. It will automatically create
        a storage account in the same region and resource group as the SQL server
        to store scan results, with a ''sqlva'' prefix.","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/securityAlertPolicies.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"location":{"type":"string"}},"variables":{"serverResourceGroupName":"[resourceGroup().name]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        variables(''serverResourceGroupName''), parameters(''location''))]","storageName":"[tolower(concat(''sqlva'',
        variables(''uniqueStorage'')))]"},"resources":[{"type":"Microsoft.Storage/storageAccounts","name":"[variables(''storageName'')]","apiVersion":"2016-01-01","location":"[parameters(''location'')]","sku":{"name":"Standard_LRS"},"kind":"Storage","properties":{}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/securityAlertPolicies","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","emailAccountAdmins":true}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/vulnerabilityAssessments","apiVersion":"2018-06-01-preview","properties":{"storageContainerPath":"[concat(reference(resourceId(''Microsoft.Storage/storageAccounts'',
        variables(''storageName''))).primaryEndpoints.blob, ''vulnerability-assessment'')]","storageAccountAccessKey":"[listKeys(resourceId(''Microsoft.Storage/storageAccounts'',
        variables(''storageName'')), ''2018-02-01'').keys[0].value]","recurringScans":{"isEnabled":true,"emailSubscriptionAdmins":true,"emails":[]}},"dependsOn":["[concat(''Microsoft.Storage/storageAccounts/'',
        variables(''storageName''))]","[concat(''Microsoft.Sql/servers/'', parameters(''serverName''),
        ''/securityAlertPolicies/Default'')]"]}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6","type":"Microsoft.Authorization/policyDefinitions","name":"6134c3db-786f-471e-87bc-8f479dc890f6"},{"properties":{"displayName":"Service
        Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign","policyType":"BuiltIn","mode":"Indexed","description":"Service
        Fabric provides three levels of protection (None, Sign and EncryptAndSign)
        for node-to-node communication using a primary cluster certificate. Set the
        protection level to ensure that all node-to-node messages are encrypted and
        digitally signed","metadata":{"category":"Service Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].name","notEquals":"Security"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name","notEquals":"ClusterProtectionLevel"},{"field":"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value","notEquals":"EncryptAndSign"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68","type":"Microsoft.Authorization/policyDefinitions","name":"617c02be-7f02-4efd-8836-3180d47b6c68"},{"properties":{"displayName":"[Deprecated]:
        Audit missing blob encryption for storage accounts","policyType":"BuiltIn","mode":"All","description":"This
        policy is no longer necessary because storage blob encryption is enabled by
        default and cannot be turned off.","metadata":{"category":"Security Center","deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"True"}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759","type":"Microsoft.Authorization/policyDefinitions","name":"655cb504-bcee-4362-bd4c-402e6aa38759"},{"properties":{"displayName":"[Deprecated]:
        Audit IP restrictions configuration for a Function App","policyType":"BuiltIn","mode":"All","description":"IP
        Restrictions allow you to define a list of IP addresses that are allowed to
        access your app. Use of IP Restrictions protects a Function app from common
        attacks.","metadata":{"category":"Security Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"ConfigureIPRestrictions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90","type":"Microsoft.Authorization/policyDefinitions","name":"664346d9-be92-43fb-a219-d595eeb76a90"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs on which the Log Analytics agent
        is not connected as expected","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        on which the Log Analytics agent is not connected to the specified workspaces.
        It also creates a system-assigned managed identity and deploys the VM extension
        for Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative/policy set. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"WorkspaceId":{"type":"String","metadata":{"displayName":"Connected
        workspace IDs","description":"A semicolon-separated list of the workspace
        IDs that the Log Analytics agent should be connected to"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsLogAnalyticsAgentConnection","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"allOf":[{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId'',
        ''='', parameters(''WorkspaceId'')))]"}]},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsLogAnalyticsAgentConnection"},"WorkspaceId":{"value":"[parameters(''WorkspaceId'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"WorkspaceId":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId","value":"[parameters(''WorkspaceId'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/68511db2-bd02-41c4-ae6b-1900a012968a","type":"Microsoft.Authorization/policyDefinitions","name":"68511db2-bd02-41c4-ae6b-1900a012968a"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs on which Windows Defender Exploit
        Guard is not enabled","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        on which Windows Defender Exploit Guard is not enabled. It also creates a
        system-assigned managed identity and deploys the VM extension for Guest Configuration.
        This policy should only be used along with its corresponding audit policy
        in an initiative/policy set. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"NotAvailableMachineState":{"type":"String","metadata":{"displayName":"State
        in which to show VMs on which Windows Defender Exploit Guard is not available","description":"Windows
        Defender Exploit Guard is only available starting with Windows 10/Windows
        Server with update 1709. Setting this value to ''Non-Compliant'' will make
        machines with older versions on which Windows Defender Exploit Guard is not
        available (such as Windows Server 2012 R2) non-compliant. Setting this value
        to ''Compliant'' will make these machines compliant."},"allowedValues":["Compliant","Non-Compliant"],"defaultValue":"Non-Compliant"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsDefenderExploitGuard","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState'',
        ''='', parameters(''NotAvailableMachineState'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsDefenderExploitGuard"},"NotAvailableMachineState":{"value":"[parameters(''NotAvailableMachineState'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"NotAvailableMachineState":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState","value":"[parameters(''NotAvailableMachineState'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d","type":"Microsoft.Authorization/policyDefinitions","name":"6a7a2bcf-f9be-4e35-9734-4f9657a70f1d"},{"properties":{"displayName":"[Deprecated]:
        Audit IP restrictions configuration for a Web Application","policyType":"BuiltIn","mode":"All","description":"IP
        Restrictions allow you to define a list of IP addresses that are allowed to
        access your app. Use of IP Restrictions protects a web application from common
        attacks.","metadata":{"category":"Security Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"ConfigureIPRestrictions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe","type":"Microsoft.Authorization/policyDefinitions","name":"6a8450e2-6c61-43b4-be65-62e3a197bffe"},{"properties":{"displayName":"Deprecated
        accounts should be removed from your subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts should be removed from your subscriptions.  Deprecated accounts are
        accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccounts","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474","type":"Microsoft.Authorization/policyDefinitions","name":"6b1cbf55-e8b6-442f-ba4c-7246b6381474"},{"properties":{"displayName":"Not
        allowed resource types","policyType":"BuiltIn","mode":"All","description":"This
        policy enables you to specify the resource types that your organization cannot
        deploy.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesNotAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that cannot be deployed.","displayName":"Not allowed
        resource types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypesNotAllowed'')]"},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749","type":"Microsoft.Authorization/policyDefinitions","name":"6c112d4e-5bc7-47ae-a041-ea2d9dccd749"},{"properties":{"displayName":"Function
        App should only be accessible over HTTPS","policyType":"BuiltIn","mode":"Indexed","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"field":"kind","like":"functionapp*"},{"field":"Microsoft.Web/sites/httpsOnly","equals":"false"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab","type":"Microsoft.Authorization/policyDefinitions","name":"6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab"},{"properties":{"displayName":"Allow
        resource creation only in Japan data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4","type":"Microsoft.Authorization/policyDefinitions","name":"6fdb9205-3462-4cfc-87d8-16c7860b53f4"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs on which the DSC configuration is not compliant","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows VMs on which the Desired State Configuration (DSC) configuration
        is not compliant. This policy is only applicable to machines with WMF 4 and
        above. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsDscConfiguration"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f","type":"Microsoft.Authorization/policyDefinitions","name":"7227ebe5-9ff7-47ab-b823-171cd02fb90f"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that allow re-use of the previous
        24 passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that allow re-use of the previous 24 passwords. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"EnforcePasswordHistory","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"EnforcePasswordHistory"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6","type":"Microsoft.Authorization/policyDefinitions","name":"726671ac-c4de-4908-8c7d-6043ae62e3b6"},{"properties":{"displayName":"Allowed
        storage account SKUs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables you to specify a set of storage account SKUs that your organization
        can deploy.","metadata":{"category":"Storage"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for storage accounts.","displayName":"Allowed
        SKUs","strongType":"StorageSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"not":{"field":"Microsoft.Storage/storageAccounts/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1","type":"Microsoft.Authorization/policyDefinitions","name":"7433c107-6db4-4ad1-b57a-a76dce0154a1"},{"properties":{"displayName":"[Deprecated]:
        Audit enabling of diagnostic logs in App Services","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of diagnostic logs on the app. This enables you to recreate activity
        trails for investigation purposes if a security incident occurs or your network
        is compromised","metadata":{"category":"App Service","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites/config"},{"field":"name","equals":"web"},{"anyOf":[{"field":"Microsoft.Web/sites/config/detailedErrorLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/httpLoggingEnabled","notEquals":"true"},{"field":"Microsoft.Web/sites/config/requestTracingEnabled","notEquals":"true"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac","type":"Microsoft.Authorization/policyDefinitions","name":"752c6934-9bcc-4749-b004-655e676ae2ac"},{"properties":{"displayName":"Vulnerabilities
        should be remediated by a Vulnerability Assessment solution","policyType":"BuiltIn","mode":"All","description":"Monitors
        vulnerabilities detected by Vulnerability Assessment solution and VMs without
        a Vulnerability Assessment solution in Azure Security Center as recommendations.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"vulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c","type":"Microsoft.Authorization/policyDefinitions","name":"760a85ff-6162-42b3-8d70-698e268f648c"},{"properties":{"displayName":"[Preview]:
        Deploy Dependency Agent for Linux VM Scale Sets (VMSS)","policyType":"BuiltIn","mode":"Indexed","description":"Deploy
        Dependency Agent for Linux VM Scale Sets if the VM Image (OS) is in the list
        defined and the agent is not installed. Note: if your scale set upgradePolicy
        is set to Manual, you need to apply the extension to the all VMs in the set
        by calling upgrade on them. In CLI this would be az vmss update-instances.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude'')]"},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3","12-SP4"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["CentOS","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"DependencyAgentLinux"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"variables":{"vmExtensionName":"DependencyAgent","vmExtensionPublisher":"Microsoft.Azure.Monitoring.DependencyAgent","vmExtensionType":"DependencyAgentLinux","vmExtensionTypeHandlerVersion":"9.7"},"resources":[{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","name":"[concat(parameters(''vmName''),
        ''/'', variables(''vmExtensionName''))]","apiVersion":"2018-06-01","location":"[parameters(''location'')]","properties":{"publisher":"[variables(''vmExtensionPublisher'')]","type":"[variables(''vmExtensionType'')]","typeHandlerVersion":"[variables(''vmExtensionTypeHandlerVersion'')]","autoUpgradeMinorVersion":true}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        extension for: '', parameters(''vmName''))]"}}},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0","type":"Microsoft.Authorization/policyDefinitions","name":"765266ab-e40e-4c61-bcb2-5a5275d0b7c0"},{"properties":{"displayName":"Deploy
        requirements to audit Windows Server VMs on which Windows Serial Console is
        not enabled","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        creates a Guest Configuration assignment to audit Windows Server virtual machines
        on which Windows Serial Console is not enabled. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"EMSPortNumber":{"type":"String","metadata":{"displayName":"EMS
        Port Number","description":"An integer indicating the COM port to be used
        for the Emergency Management Services (EMS) console redirection. For more
        information on EMS settings, please visit https://aka.ms/gcpolwsc"},"allowedValues":["1","2","3","4"],"defaultValue":"1"},"EMSBaudRate":{"type":"String","metadata":{"displayName":"EMS
        Baud Rate","description":"An integer indicating the baud rate to be used for
        the Emergency Management Services (EMS) console redirection. For more information
        on EMS settings, please visit https://aka.ms/gcpolwsc"},"allowedValues":["9600","19200","38400","57600","115200"],"defaultValue":"115200"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsSerialConsole","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber'',
        ''='', parameters(''EMSPortNumber''), '','', ''[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate'',
        ''='', parameters(''EMSBaudRate'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsSerialConsole"},"EMSPortNumber":{"value":"[parameters(''EMSPortNumber'')]"},"EMSBaudRate":{"value":"[parameters(''EMSBaudRate'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"EMSPortNumber":{"type":"string"},"EMSBaudRate":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber","value":"[parameters(''EMSPortNumber'')]"},{"name":"[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate","value":"[parameters(''EMSBaudRate'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7a031c68-d6ab-406e-a506-697a19c634b0","type":"Microsoft.Authorization/policyDefinitions","name":"7a031c68-d6ab-406e-a506-697a19c634b0"},{"properties":{"displayName":"Diagnostic
        logs in Virtual Machine Scale Sets should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"It
        is recommended to enable Logs so that activity trail can be recreated when
        investigations are required in the event of an incident or a compromise.","metadata":{"category":"Compute"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"IaaSDiagnostics"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Diagnostics"}]},{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"LinuxDiagnostic"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.OSTCExtensions"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1","type":"Microsoft.Authorization/policyDefinitions","name":"7c1b1214-f927-48bf-8882-84f0af6588b1"},{"properties":{"displayName":"[Deprecated]:
        Require blob encryption for storage accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures blob encryption for storage accounts is turned on. It only
        applies to Microsoft.Storage resource types, not other storage providers.
        This policy is deprecated because storage blob encryption is now enabled by
        default, and can no longer be disabled.","metadata":{"category":"Storage","deprecated":true},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Storage/storageAccounts"},{"field":"Microsoft.Storage/storageAccounts/enableBlobEncryption","equals":"false"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f","type":"Microsoft.Authorization/policyDefinitions","name":"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f"},{"properties":{"displayName":"Audit
        Windows VMs that have the specified applications installed","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that have the specified applications
        installed. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"NotInstalledApplication"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c","type":"Microsoft.Authorization/policyDefinitions","name":"7e56b49b-5990-4159-a734-511ea19b731c"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that have not restarted within the specified number of days","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that have not restarted within the
        specified number of days. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"MachineLastBootUpTime"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa","type":"Microsoft.Authorization/policyDefinitions","name":"7e84ba44-6d03-46fd-950e-5efa5a1112fa"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that do not have the password complexity
        setting enabled","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that do not have the password complexity setting enabled. It also creates
        a system-assigned managed identity and deploys the VM extension for Guest
        Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordMustMeetComplexityRequirements","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordMustMeetComplexityRequirements"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8","type":"Microsoft.Authorization/policyDefinitions","name":"7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8"},{"properties":{"displayName":"Audit
        diagnostic setting","policyType":"BuiltIn","mode":"All","description":"Audit
        diagnostic setting for selected resource types","metadata":{"category":"Monitoring"},"parameters":{"listOfResourceTypes":{"type":"Array","metadata":{"displayName":"Resource
        Types","strongType":"resourceTypes"}}},"policyRule":{"if":{"field":"type","in":"[parameters(''listOfResourceTypes'')]"},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"},{"field":"Microsoft.Insights/diagnosticSettings/metrics.enabled","equals":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9","type":"Microsoft.Authorization/policyDefinitions","name":"7f89b1eb-583c-429a-8828-af049802c1d9"},{"properties":{"displayName":"Audit
        SQL auditing settings at the server level for the Action-Groups and Actions","policyType":"BuiltIn","mode":"Indexed","description":"SQL
        auditing should be configured to capture certain Action-Groups and Actions.
        The AuditActionsAndGroups property should contain at least SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP
        FAILED_DATABASE_AUTHENTICATION_GROUP, BATCH_COMPLETED_GROUP to ensure a thorough
        audit logging","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"default","existenceCondition":{"allOf":[{"not":{"field":"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]","notEquals":"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP"}},{"not":{"field":"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]","notEquals":"FAILED_DATABASE_AUTHENTICATION_GROUP"}},{"not":{"field":"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]","notEquals":"BATCH_COMPLETED_GROUP"}}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5","type":"Microsoft.Authorization/policyDefinitions","name":"7ff426e2-515f-405a-91c8-4f2333442eb5"},{"properties":{"displayName":"Diagnostic
        logs in Event Hub should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a","type":"Microsoft.Authorization/policyDefinitions","name":"83a214f7-d01a-484b-91a9-ed54470c9a6a"},{"properties":{"displayName":"Network
        interfaces should not have public IPs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy denies the network interfaces which are configured with any public
        IP. Public IP addresses allow internet resources to communicate inbound to
        Azure resources, and Azure resources to communicate outbound to the internet.
        This should be reviewed by the network security team.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkInterfaces"},{"not":{"field":"Microsoft.Network/networkInterfaces/ipconfigurations[*].publicIpAddress.id","notLike":"*"}}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114","type":"Microsoft.Authorization/policyDefinitions","name":"83a86a26-fd1f-447c-b59d-e51f44264114"},{"properties":{"displayName":"Deploy
        SQL DB transparent data encryption","policyType":"BuiltIn","mode":"Indexed","description":"Enables
        transparent data encryption on SQL databases","metadata":{"category":"SQL"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Sql/servers/databases"},{"field":"name","notEquals":"master"}]},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/databases/transparentDataEncryption","name":"current","existenceCondition":{"field":"Microsoft.Sql/transparentDataEncryption.status","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullDbName":{"type":"string"}},"resources":[{"name":"[concat(parameters(''fullDbName''),
        ''/current'')]","type":"Microsoft.Sql/servers/databases/transparentDataEncryption","apiVersion":"2014-04-01","properties":{"status":"Enabled"}}]},"parameters":{"fullDbName":{"value":"[field(''fullName'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f","type":"Microsoft.Authorization/policyDefinitions","name":"86a912f6-9a06-4e26-b447-11b16ba8659f"},{"properties":{"displayName":"System
        updates should be installed on your machines","policyType":"BuiltIn","mode":"All","description":"Missing
        security system updates on your servers will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"systemUpdates","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60","type":"Microsoft.Authorization/policyDefinitions","name":"86b3d65f-7626-441e-b690-81a8b71cff60"},{"properties":{"displayName":"Require
        specified tag","policyType":"BuiltIn","mode":"Indexed","description":"Enforces
        existence of a tag. Does not apply to resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}}},"policyRule":{"if":{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/871b6d14-10aa-478d-b590-94f262ecfa99","type":"Microsoft.Authorization/policyDefinitions","name":"871b6d14-10aa-478d-b590-94f262ecfa99"},{"properties":{"displayName":"Deploy
        requirements to audit Linux VMs that have the specified applications installed","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Linux virtual machines
        that have the specified applications installed. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        names","description":"A semicolon-separated list of the names of the applications
        that should not be installed. e.g. ''python; powershell''"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"not_installed_application_linux","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent'',
        ''='', concat(''packages: ['', replace(parameters(''ApplicationName''), '';'',
        '',''), '']'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"not_installed_application_linux"},"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ApplicationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent","value":"[concat(''packages:
        ['', replace(parameters(''ApplicationName''), '';'', '',''), '']'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0","type":"Microsoft.Authorization/policyDefinitions","name":"884b209a-963b-4520-8006-d20cb3c213e0"},{"properties":{"displayName":"Network
        interfaces should disable IP forwarding","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy denies the network interfaces which enabled IP forwarding. The setting
        of IP forwarding disables Azure''s check of the source and destination for
        a network interface. This should be reviewed by the network security team.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkInterfaces"},{"field":"Microsoft.Network/networkInterfaces/enableIpForwarding","equals":"true"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900","type":"Microsoft.Authorization/policyDefinitions","name":"88c0b9da-ce96-4b03-9635-f29a937e2900"},{"properties":{"displayName":"SQL
        servers should be configured with auditing retention days greater than 90
        days.","policyType":"BuiltIn","mode":"Indexed","description":"Audit SQL servers
        configured with an auditing retention period of less than 90 days.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"default","existenceCondition":{"field":"Microsoft.Sql/servers/auditingSettings/retentionDays","greater":90}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743","type":"Microsoft.Authorization/policyDefinitions","name":"89099bee-89e0-4b26-a5f4-165451757743"},{"properties":{"displayName":"Audit
        Windows VMs with a pending reboot","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines with a pending reboot. This policy
        should only be used along with its corresponding deploy policy in an initiative.
        For more information on Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsPendingReboot"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b","type":"Microsoft.Authorization/policyDefinitions","name":"8b0de57a-f511-4d45-a277-17cb79cb163b"},{"properties":{"displayName":"Require
        tag and its value on resource groups","policyType":"BuiltIn","mode":"All","description":"Enforces
        a required tag and its value on resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}},"tagValue":{"type":"String","metadata":{"displayName":"Tag
        Value","description":"Value of the tag, such as ''production''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","notEquals":"[parameters(''tagValue'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46","type":"Microsoft.Authorization/policyDefinitions","name":"8ce3da23-7156-49e4-b145-24f95f9dcb46"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that do not store passwords using
        reversible encryption","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that do not store passwords using reversible encryption. It also creates a
        system-assigned managed identity and deploys the VM extension for Guest Configuration.
        This policy should only be used along with its corresponding audit policy
        in an initiative. For more information on Guest Configuration policies, please
        visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"StorePasswordsUsingReversibleEncryption","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"StorePasswordsUsingReversibleEncryption"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78","type":"Microsoft.Authorization/policyDefinitions","name":"8ff0b18b-262e-4512-857a-48ad0aeb9a78"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs that do not have the specified Windows PowerShell
        modules installed","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that do not have the specified Windows PowerShell modules installed. It also
        creates a system-assigned managed identity and deploys the VM extension for
        Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"Modules":{"type":"String","metadata":{"displayName":"PowerShell
        Modules","description":"A semicolon-separated list of the names of the PowerShell
        modules that should be installed. You may also specify a specific version
        of a module that should be installed by including a comma after the module
        name, followed by the desired version. e.g. PSDscResources; SqlServerDsc,
        12.0.0.0; ComputerManagementDsc, 6.1.0.0"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsPowerShellModules","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[PowerShellModules]PowerShellModules1;Modules'',
        ''='', parameters(''Modules'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsPowerShellModules"},"Modules":{"value":"[parameters(''Modules'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"Modules":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[PowerShellModules]PowerShellModules1;Modules","value":"[parameters(''Modules'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf","type":"Microsoft.Authorization/policyDefinitions","name":"90ba2ee7-4ca8-4673-84d1-c851c50d3baf"},{"properties":{"displayName":"MFA
        should be enabled accounts with write permissions on your subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        write privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForWritePermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3","type":"Microsoft.Authorization/policyDefinitions","name":"9297c21d-2ed6-4474-b48f-163f75654ce3"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that contain certificates expiring within the specified
        number of days","policyType":"BuiltIn","mode":"All","description":"This policy
        audits Windows virtual machines that contain certificates expiring within
        the specified number of days. This policy should only be used along with its
        corresponding deploy policy in an initiative. For more information on Guest
        Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"CertificateExpiration"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9328f27e-611e-44a7-a244-39109d7d35ab","type":"Microsoft.Authorization/policyDefinitions","name":"9328f27e-611e-44a7-a244-39109d7d35ab"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs in which the Administrators group does not
        contain all of the specified members","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        in which the Administrators group does not contain all of the specified members.
        It also creates a system-assigned managed identity and deploys the VM extension
        for Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"MembersToInclude":{"type":"String","metadata":{"displayName":"Members
        to include","description":"A semicolon-separated list of members that should
        be included in the Administrators local group. Ex: Administrator; myUser1;
        myUser2"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AdministratorsGroupMembersToInclude","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[LocalGroup]AdministratorsGroup;MembersToInclude'',
        ''='', parameters(''MembersToInclude'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AdministratorsGroupMembersToInclude"},"MembersToInclude":{"value":"[parameters(''MembersToInclude'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"MembersToInclude":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[LocalGroup]AdministratorsGroup;MembersToInclude","value":"[parameters(''MembersToInclude'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98","type":"Microsoft.Authorization/policyDefinitions","name":"93507a81-10a4-4af0-9ee2-34cf25a96e98"},{"properties":{"displayName":"Allow
        resource creation only in European data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: North Europe, West Europe","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["northeurope","westeurope"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b","type":"Microsoft.Authorization/policyDefinitions","name":"94c19f19-8192-48cd-a11b-e37099d3e36b"},{"properties":{"displayName":"Require
        specified tag on resource groups","policyType":"BuiltIn","mode":"All","description":"Enforces
        existence of a tag on resource groups.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025","type":"Microsoft.Authorization/policyDefinitions","name":"96670d01-0a4d-4649-9c89-2d3abc0a5025"},{"properties":{"displayName":"Ensure
        that ''Send alerts to'' is set in SQL server Advanced Data Security settings","policyType":"BuiltIn","mode":"Indexed","description":"Ensure
        that an email address is provided for the ''Send alerts to'' field in the
        Advanced Data Security server settings. This email address receives alert
        notifications when anomalous activities are detected on SQL servers.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"default","existenceCondition":{"field":"Microsoft.Sql/servers/securityAlertPolicies/emailAddresses[*]","notEquals":""}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9677b740-f641-4f3c-b9c5-466005c85278","type":"Microsoft.Authorization/policyDefinitions","name":"9677b740-f641-4f3c-b9c5-466005c85278"},{"properties":{"displayName":"Allow
        resource creation only in United States data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: Central US, East US, East
        US2, North Central US, South Central US, West US","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["centralus","eastus","eastus2","northcentralus","southcentralus","westus"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869","type":"Microsoft.Authorization/policyDefinitions","name":"983211ba-f348-4758-983b-21fa29294869"},{"properties":{"displayName":"Deploy
        Diagnostic Settings for Azure SQL Database to Event Hub","policyType":"BuiltIn","mode":"Indexed","description":"Deploys
        the diagnostic settings for Azure SQL Database to stream to a regional Event
        Hub on any Azure SQL Database which is missing this diagnostic settings is
        created or updated.","metadata":{"category":"SQL"},"parameters":{"profileName":{"type":"String","metadata":{"displayName":"Profile
        name","description":"The diagnostic settings profile name"},"defaultValue":"setbypolicy"},"eventHubRuleId":{"type":"String","metadata":{"displayName":"Event
        Hub Authorization Rule Id","description":"The Event Hub authorization rule
        Id for Azure Diagnostics. The authorization rule needs to be at Event Hub
        namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource
        group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization
        rule}","strongType":"Microsoft.EventHub/Namespaces/AuthorizationRules","assignPermissions":true}},"metricsEnabled":{"type":"String","metadata":{"displayName":"Enable
        metrics","description":"Whether to enable metrics stream to the Event Hub
        - True or False"},"allowedValues":["True","False"],"defaultValue":"False"},"logsEnabled":{"type":"String","metadata":{"displayName":"Enable
        logs","description":"Whether to enable logs stream to the Event Hub  - True
        or False"},"allowedValues":["True","False"],"defaultValue":"True"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers/databases"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","name":"[parameters(''profileName'')]","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"[parameters(''logsEnabled'')]"},{"field":"Microsoft.Insights/diagnosticSettings/metrics.enabled","equals":"[parameters(''metricsEnabled'')]"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"location":{"type":"string"},"eventHubRuleId":{"type":"string"},"metricsEnabled":{"type":"string"},"logsEnabled":{"type":"string"},"profileName":{"type":"string"}},"resources":[{"type":"Microsoft.Sql/servers/databases/providers/diagnosticSettings","apiVersion":"2017-05-01-preview","name":"[concat(parameters(''fullName''),
        ''/'', ''Microsoft.Insights/'', parameters(''profileName''))]","location":"[parameters(''location'')]","dependsOn":[],"properties":{"eventHubAuthorizationRuleId":"[parameters(''eventHubRuleId'')]","metrics":[{"category":"AllMetrics","enabled":"[parameters(''metricsEnabled'')]","retentionPolicy":{"enabled":false,"days":0}}],"logs":[{"category":"QueryStoreRuntimeStatistics","enabled":"[parameters(''logsEnabled'')]"},{"category":"QueryStoreWaitStatistics","enabled":"[parameters(''logsEnabled'')]"},{"category":"Errors","enabled":"[parameters(''logsEnabled'')]"},{"category":"DatabaseWaitStatistics","enabled":"[parameters(''logsEnabled'')]"},{"category":"Blocks","enabled":"[parameters(''logsEnabled'')]"},{"category":"SQLInsights","enabled":"[parameters(''logsEnabled'')]"},{"category":"Audit","enabled":"[parameters(''logsEnabled'')]"},{"category":"SQLSecurityAuditEvents","enabled":"[parameters(''logsEnabled'')]"},{"category":"Timeouts","enabled":"[parameters(''logsEnabled'')]"},{"category":"AutomaticTuning","enabled":"[parameters(''logsEnabled'')]"},{"category":"Deadlocks","enabled":"[parameters(''logsEnabled'')]"}]}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        diagnostic settings for '', parameters(''fullName''))]"}}},"parameters":{"location":{"value":"[field(''location'')]"},"fullName":{"value":"[field(''fullName'')]"},"eventHubRuleId":{"value":"[parameters(''eventHubRuleId'')]"},"metricsEnabled":{"value":"[parameters(''metricsEnabled'')]"},"logsEnabled":{"value":"[parameters(''logsEnabled'')]"},"profileName":{"value":"[parameters(''profileName'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9a7c7a7d-49e5-4213-bea8-6a502b6272e0","type":"Microsoft.Authorization/policyDefinitions","name":"9a7c7a7d-49e5-4213-bea8-6a502b6272e0"},{"properties":{"displayName":"[Deprecated]:
        Audit API Applications that are not using latest supported Java Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Java version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestJava","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745","type":"Microsoft.Authorization/policyDefinitions","name":"9bfe3727-0a17-471f-a2fe-eddd6b668745"},{"properties":{"displayName":"Access
        through Internet facing endpoint should be restricted","policyType":"BuiltIn","mode":"All","description":"Azure
        Security center has identified some of your Network Security Groups'' inbound
        rules to be too permissive. Inbound rules should not allow access from ''Any''
        or ''Internet'' ranges. This can potentially enable attackers to easily target
        your resources.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"unprotectedNetworkEndpoint","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6","type":"Microsoft.Authorization/policyDefinitions","name":"9daedab3-fb2d-461e-b861-71790eead4f6"},{"properties":{"displayName":"Append
        tag and its value from the resource group","policyType":"BuiltIn","mode":"Indexed","description":"Appends
        the specified tag with its value from the resource group when any resource
        which is missing this tag is created or updated. Does not modify the tags
        of resources created before this policy was applied until those resources
        are changed.","metadata":{"category":"General"},"parameters":{"tagName":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Name of the tag, such as ''environment''"}}},"policyRule":{"if":{"allOf":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"value":"[resourceGroup().tags[parameters(''tagName'')]]","exists":"true"},{"value":"[resourceGroup().tags[parameters(''tagName'')]]","notEquals":""}]},"then":{"effect":"append","details":[{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","value":"[resourceGroup().tags[parameters(''tagName'')]]"}]}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9ea02ca2-71db-412d-8b00-7c7ca9fcd32d","type":"Microsoft.Authorization/policyDefinitions","name":"9ea02ca2-71db-412d-8b00-7c7ca9fcd32d"},{"properties":{"displayName":"Audit
        Windows VMs that are not set to the specified time zone","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that are not set to the specified time
        zone. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsTimeZone"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/9f658460-46b7-43af-8565-94fc0662be38","type":"Microsoft.Authorization/policyDefinitions","name":"9f658460-46b7-43af-8565-94fc0662be38"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs on which the Log Analytics agent is not connected as expected","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines on which the Log Analytics agent is
        not connected to the specified workspaces. This policy should only be used
        along with its corresponding deploy policy in an initiative/policy set. For
        more information on Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsLogAnalyticsAgentConnection"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee","type":"Microsoft.Authorization/policyDefinitions","name":"a030a57e-4639-4e8f-ade9-a92f33afe7ee"},{"properties":{"displayName":"Allowed
        resource types","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables you to specify the resource types that your organization can
        deploy. Only resource types that support ''tags'' and ''location'' will be
        affected by this policy. To restrict all resources please duplicate this policy
        and change the ''mode'' to ''All''.","metadata":{"category":"General"},"parameters":{"listOfResourceTypesAllowed":{"type":"Array","metadata":{"description":"The
        list of resource types that can be deployed.","displayName":"Allowed resource
        types","strongType":"resourceTypes"}}},"policyRule":{"if":{"not":{"field":"type","in":"[parameters(''listOfResourceTypesAllowed'')]"}},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c","type":"Microsoft.Authorization/policyDefinitions","name":"a08ec900-254a-4555-9bf5-e42af04b5c5c"},{"properties":{"displayName":"All
        authorization rules except RootManageSharedAccessKey should be removed from
        Service Bus namespace","policyType":"BuiltIn","mode":"All","description":"Service
        Bus clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Service
        Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceBus/namespaces/authorizationRules"},{"field":"name","notEquals":"RootManageSharedAccessKey"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee","type":"Microsoft.Authorization/policyDefinitions","name":"a1817ec0-a368-432a-8057-8371e17ac6ee"},{"properties":{"displayName":"Audit
        Windows VMs that are not joined to the specified domain","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that are not joined to the specified
        domain. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsDomainMembership"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91","type":"Microsoft.Authorization/policyDefinitions","name":"a29ee95c-0395-4515-9851-cc04ffe82a91"},{"properties":{"displayName":"Audit
        usage of custom RBAC rules","policyType":"BuiltIn","mode":"All","description":"Audit
        built-in roles such as ''Owner, Contributer, Reader'' instead of custom RBAC
        roles, which are error prone. Using custom roles is treated as an exception
        and requires a rigorous review and threat modeling","metadata":{"category":"General"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Authorization/roleDefinitions"},{"field":"Microsoft.Authorization/roleDefinitions/type","equals":"CustomRole"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5","type":"Microsoft.Authorization/policyDefinitions","name":"a451c1ef-c6ca-483d-87ed-f49761e3ffb5"},{"properties":{"displayName":"Web
        Application should only be accessible over HTTPS","policyType":"BuiltIn","mode":"Indexed","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"field":"kind","like":"app*"},{"field":"Microsoft.Web/sites/httpsOnly","equals":"false"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d","type":"Microsoft.Authorization/policyDefinitions","name":"a4af4a39-4135-47fb-b175-47fbdf85311d"},{"properties":{"displayName":"Audit
        SQL server level Auditing settings","policyType":"BuiltIn","mode":"Indexed","description":"Audits
        the existence of SQL Auditing at the server level","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"setting":{"type":"String","metadata":{"displayName":"Desired
        Auditing setting"},"allowedValues":["enabled","disabled"],"defaultValue":"enabled"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"[parameters(''setting'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9","type":"Microsoft.Authorization/policyDefinitions","name":"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9"},{"properties":{"displayName":"DDoS
        Protection Standard should be enabled","policyType":"BuiltIn","mode":"All","description":"DDoS
        protection standard should be enabled for all virtual networks with a subnet
        that is part of an application gateway with a public IP.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"microsoft.network/virtualNetworks"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableDDoSProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd","type":"Microsoft.Authorization/policyDefinitions","name":"a7aca53f-2ed4-4466-a25e-0b45ade68efd"},{"properties":{"displayName":"Require
        encryption on Data Lake Store accounts","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures encryption is enabled on all Data Lake Store accounts","metadata":{"category":"Data
        Lake"},"parameters":{},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.DataLakeStore/accounts"},{"field":"Microsoft.DataLakeStore/accounts/encryptionState","equals":"Disabled"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a","type":"Microsoft.Authorization/policyDefinitions","name":"a7ff3161-0087-490a-9ad9-ad6217f4f43a"},{"properties":{"displayName":"Monitor
        unencrypted SQL databases in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Unencrypted
        SQL databases will be monitored by Azure Security Center as recommendations","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"encryption","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16","type":"Microsoft.Authorization/policyDefinitions","name":"a8bef009-a5c9-4d0f-90d7-6018734e8a16"},{"properties":{"displayName":"Deploy
        network watcher when virtual networks are created","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a network watcher resource in regions with virtual networks.
        You need to ensure existence of a resource group named networkWatcherRG, which
        will be used to deploy network watcher instances.","metadata":{"category":"Network"},"parameters":{},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/virtualNetworks"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Network/networkWatchers","resourceGroupName":"networkWatcherRG","existenceCondition":{"field":"location","equals":"[field(''location'')]"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"}},"resources":[{"apiVersion":"2016-09-01","type":"Microsoft.Network/networkWatchers","name":"[concat(''networkWatcher_'',
        parameters(''location''))]","location":"[parameters(''location'')]"}]},"parameters":{"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9","type":"Microsoft.Authorization/policyDefinitions","name":"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9"},{"properties":{"displayName":"MFA
        should be enabled on accounts with owner permissions on your subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        owner permissions to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed","type":"Microsoft.Authorization/policyDefinitions","name":"aa633080-8b72-40c4-a2d7-d00c03e80bed"},{"properties":{"displayName":"Automatic
        provisioning of security monitoring agent","policyType":"BuiltIn","mode":"All","description":"Installs
        security agent on VMs for advanced security alerts and preventions in Azure
        Security Center. Applies only for subscriptions that use Azure Security Center.","metadata":{"category":"Security
        Center","deprecated":true},"parameters":{},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"AuditIfNotExists","details":{"type":"Microsoft.Security/complianceResults","name":"securityAgent","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24","type":"Microsoft.Authorization/policyDefinitions","name":"abcc6037-1fc4-47f6-aac5-89706589be24"},{"properties":{"displayName":"Advanced
        data security should be enabled on your SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        SQL servers without Advanced Data Security","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/servers/securityAlertPolicies/state","equals":"Enabled"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9","type":"Microsoft.Authorization/policyDefinitions","name":"abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9"},{"properties":{"displayName":"Advanced
        data security should be enabled on your managed instances","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        SQL managed instances without Advanced Data Security","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/securityAlertPolicies","name":"Default","existenceCondition":{"field":"Microsoft.Sql/managedInstances/securityAlertPolicies/state","equals":"Enabled"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9","type":"Microsoft.Authorization/policyDefinitions","name":"abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9"},{"properties":{"displayName":"[Preview]:
        Role-Based Access Control (RBAC) should be used on Kubernetes Services","policyType":"BuiltIn","mode":"All","description":"To
        provide granular filtering on the actions that users can perform, use Role-Based
        Access Control (RBAC) to manage permissions in Kubernetes Service Clusters
        and configure relevant authorization policies.","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"anyOf":[{"field":"Microsoft.ContainerService/managedClusters/enableRBAC","exists":"false"},{"field":"Microsoft.ContainerService/managedClusters/enableRBAC","equals":"false"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457","type":"Microsoft.Authorization/policyDefinitions","name":"ac4a19c2-fa67-49b4-8ae5-0b2e78c49457"},{"properties":{"displayName":"Allow
        resource creation if ''environment'' tag value in allowed values","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation if the ''environment'' tag is set to one of the following
        values: production, dev, test, staging","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags.environment","in":["production","dev","test","staging"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9","type":"Microsoft.Authorization/policyDefinitions","name":"ac7e5fc0-c029-4b12-91d4-a8500ce697f9"},{"properties":{"displayName":"SQL
        managed instances should send security alerts to admins and subscription owners","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        that ''email notification to admins and subscription owners'' is enabled in
        the SQL managed instance advanced threat protection settings. This ensures
        that any detections of anomalous activities on SQL managed instance are reported
        as soon as possible to the admins.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/securityAlertPolicies","name":"default","existenceCondition":{"field":"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAccountAdmins","equals":"true"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff","type":"Microsoft.Authorization/policyDefinitions","name":"aeb23562-188d-47cb-80b8-551f16ef9fff"},{"properties":{"displayName":"Monitor
        missing Endpoint Protection in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"Servers
        without an installed Endpoint Protection agent will be monitored by Azure
        Security Center as recommendations","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"endpointProtection","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9","type":"Microsoft.Authorization/policyDefinitions","name":"af6cd1bd-1635-48cb-bde7-5b15693900b9"},{"properties":{"displayName":"Monitor
        unaudited SQL servers in Azure Security Center","policyType":"BuiltIn","mode":"All","description":"SQL
        servers which don''t have SQL auditing turned on will be monitored by Azure
        Security Center as recommendations","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.SQL/servers"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"auditing","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d","type":"Microsoft.Authorization/policyDefinitions","name":"af8051bf-258b-44e2-a2bf-165330459f9d"},{"properties":{"displayName":"Just-In-Time
        network access control should be applied on virtual machines","policyType":"BuiltIn","mode":"All","description":"Possible
        network Just In Time (JIT) access will be monitored by Azure Security Center
        as recommendations","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachines"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"jitNetworkAccess","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c","type":"Microsoft.Authorization/policyDefinitions","name":"b0f33259-77d7-4c9e-aac6-3aabcfae693c"},{"properties":{"displayName":"[Preview]:
        Audit Linux VMs that do not have the passwd file permissions set to 0644","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Linux virtual machines that do not have the passwd file permissions
        set to 0644. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordPolicy_msid121"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b","type":"Microsoft.Authorization/policyDefinitions","name":"b18175dd-c599-4c64-83ba-bb018a06d35b"},{"properties":{"displayName":"All
        authorization rules except RootManageSharedAccessKey should be removed from
        Event Hub namespace","policyType":"BuiltIn","mode":"All","description":"Event
        Hub clients should not use a namespace level access policy that provides access
        to all queues and topics in a namespace. To align with the least privilege
        security model, you shoud create access policies at the entity level for queues
        and topics to provide access to only the specific entity","metadata":{"category":"Event
        Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.EventHub/namespaces/authorizationRules"},{"field":"name","notEquals":"RootManageSharedAccessKey"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7","type":"Microsoft.Authorization/policyDefinitions","name":"b278e460-7cfc-4451-8294-cccc40a940d7"},{"properties":{"displayName":"Deploy
        requirements to audit Windows web servers that are not using secure communication
        protocols","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        creates a Guest Configuration assignment to audit Windows web servers that
        are not using secure communication protocols (TLS 1.1 or TLS 1.2). It also
        creates a system-assigned managed identity and deploys the VM extension for
        Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AuditSecureProtocol","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AuditSecureProtocol"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8","type":"Microsoft.Authorization/policyDefinitions","name":"b2fc8f91-866d-4434-9089-5ebfe38d6fd8"},{"properties":{"displayName":"Diagnostic
        logs in Search services should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Search"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Search/searchServices"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4","type":"Microsoft.Authorization/policyDefinitions","name":"b4330a05-a843-4bc8-bf9a-cacce50c67f4"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Sockets state for an API App","policyType":"BuiltIn","mode":"All","description":"The
        Web Sockets protocol is vulnerable to different types of security threats.
        Use of Web Sockets within an API app must be carefully reviewed.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableWebSockets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951","type":"Microsoft.Authorization/policyDefinitions","name":"b48334a4-911b-4084-b1ab-3e6a4e50b951"},{"properties":{"displayName":"Service
        Fabric clusters should only use Azure Active Directory for client authentication","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        usage of client authentication only via Azure Active Directory in Service
        Fabric","metadata":{"category":"Service Fabric"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ServiceFabric/clusters"},{"anyOf":[{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","exists":"false"},{"field":"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId","equals":""}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0","type":"Microsoft.Authorization/policyDefinitions","name":"b54ed75b-3e1a-44ac-a333-05ba39b99ff0"},{"properties":{"displayName":"Diagnostic
        logs in App Services should be enabled","policyType":"BuiltIn","mode":"All","description":"Audit
        enabling of diagnostic logs on the app. This enables you to recreate activity
        trails for investigation purposes if a security incident occurs or your network
        is compromised","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"field":"kind","notContains":"functionapp"}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Web/sites/config","existenceCondition":{"allOf":[{"field":"Microsoft.Web/sites/config/detailedErrorLoggingEnabled","equals":"true"},{"field":"Microsoft.Web/sites/config/httpLoggingEnabled","equals":"true"},{"field":"Microsoft.Web/sites/config/requestTracingEnabled","equals":"true"}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0","type":"Microsoft.Authorization/policyDefinitions","name":"b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0"},{"properties":{"displayName":"API
        App should only be accessible over HTTPS","policyType":"BuiltIn","mode":"Indexed","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"App Service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Web/sites"},{"field":"kind","like":"*api"},{"field":"Microsoft.Web/sites/httpsOnly","equals":"false"}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b7ddfbdc-1260-477d-91fd-98bd9be789a6","type":"Microsoft.Authorization/policyDefinitions","name":"b7ddfbdc-1260-477d-91fd-98bd9be789a6"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs in which the Administrators group does not
        contain only the specified members","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        in which the Administrators group does not contain only the specified members.
        It also creates a system-assigned managed identity and deploys the VM extension
        for Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"Members":{"type":"String","metadata":{"displayName":"Members","description":"A
        semicolon-separated list of all the expected members of the Administrators
        local group. Ex: Administrator; myUser1; myUser2"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"AdministratorsGroupMembers","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[LocalGroup]AdministratorsGroup;Members'',
        ''='', parameters(''Members'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"AdministratorsGroupMembers"},"Members":{"value":"[parameters(''Members'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"Members":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[LocalGroup]AdministratorsGroup;Members","value":"[parameters(''Members'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/b821191b-3a12-44bc-9c38-212138a29ff3","type":"Microsoft.Authorization/policyDefinitions","name":"b821191b-3a12-44bc-9c38-212138a29ff3"},{"properties":{"displayName":"[Deprecated]:
        Audit API Applications that are not using latest supported Python Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Python version for the latest security classes. Using
        older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestPython","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644","type":"Microsoft.Authorization/policyDefinitions","name":"bc0378bb-d7ab-4614-a0f6-5a6e3f02d644"},{"properties":{"displayName":"[Preview]:
        IP Forwarding on your virtual machine should be disabled","policyType":"BuiltIn","mode":"All","description":"Enabling
        IP forwarding on a virtual machine''s NIC allows the machine to receive traffic
        addressed to other destinations. IP forwarding is rarely required (e.g., when
        using the VM as a network virtual appliance), and therefore, this should be
        reviewed by the network security team.","metadata":{"category":"Security Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"disableIPForwarding","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744","type":"Microsoft.Authorization/policyDefinitions","name":"bd352bd5-2853-4985-bf0d-73806b4a5744"},{"properties":{"displayName":"Advanced
        Threat Protection types should be set to ''All'' in SQL managed instance Advanced
        Data Security settings","policyType":"BuiltIn","mode":"Indexed","description":"It
        is recommended to enable all Advanced Threat Protection types on your SQL
        servers. Enabling all types protects against SQL injection, database vulnerabilities,
        and any other anomalous activities.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/managedInstances"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/managedInstances/securityAlertPolicies","name":"default","existenceCondition":{"field":"Microsoft.Sql/managedInstances/securityAlertPolicies/disabledAlerts[*]","equals":""}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966","type":"Microsoft.Authorization/policyDefinitions","name":"bda18df3-5e41-4709-add9-2554ce68c966"},{"properties":{"displayName":"Audit
        Windows VMs in which the Administrators group contains any of the specified
        members","policyType":"BuiltIn","mode":"All","description":"This policy audits
        Windows virtual machines in which the Administrators group contains any of
        the specified members. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"AdministratorsGroupMembersToExclude"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de","type":"Microsoft.Authorization/policyDefinitions","name":"bde62c94-ccca-4821-a815-92c1d31a76de"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Applications that are not using latest supported Java Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Java version for the latest security classes. Using older
        classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestJava","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6","type":"Microsoft.Authorization/policyDefinitions","name":"be0a7681-bed4-48dc-9ff3-f0171ee170b6"},{"properties":{"displayName":"Allow
        resource creation only in Asia data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: East Asia, Southeast Asia,
        West India, South India, Central India, Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["eastasia","southeastasia","westindia","southindia","centralindia","japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94","type":"Microsoft.Authorization/policyDefinitions","name":"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs that are not set to the specified time zone","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that are not set to the specified time zone. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"TimeZone":{"type":"String","metadata":{"displayName":"Time
        zone","description":"The expected time zone"},"allowedValues":["(UTC-12:00)
        International Date Line West","(UTC-11:00) Coordinated Universal Time-11","(UTC-10:00)
        Aleutian Islands","(UTC-10:00) Hawaii","(UTC-09:30) Marquesas Islands","(UTC-09:00)
        Alaska","(UTC-09:00) Coordinated Universal Time-09","(UTC-08:00) Baja California","(UTC-08:00)
        Coordinated Universal Time-08","(UTC-08:00) Pacific Time (US & Canada)","(UTC-07:00)
        Arizona","(UTC-07:00) Chihuahua, La Paz, Mazatlan","(UTC-07:00) Mountain Time
        (US & Canada)","(UTC-06:00) Central America","(UTC-06:00) Central Time (US
        & Canada)","(UTC-06:00) Easter Island","(UTC-06:00) Guadalajara, Mexico City,
        Monterrey","(UTC-06:00) Saskatchewan","(UTC-05:00) Bogota, Lima, Quito, Rio
        Branco","(UTC-05:00) Chetumal","(UTC-05:00) Eastern Time (US & Canada)","(UTC-05:00)
        Haiti","(UTC-05:00) Havana","(UTC-05:00) Indiana (East)","(UTC-05:00) Turks
        and Caicos","(UTC-04:00) Asuncion","(UTC-04:00) Atlantic Time (Canada)","(UTC-04:00)
        Caracas","(UTC-04:00) Cuiaba","(UTC-04:00) Georgetown, La Paz, Manaus, San
        Juan","(UTC-04:00) Santiago","(UTC-03:30) Newfoundland","(UTC-03:00) Araguaina","(UTC-03:00)
        Brasilia","(UTC-03:00) Cayenne, Fortaleza","(UTC-03:00) City of Buenos Aires","(UTC-03:00)
        Greenland","(UTC-03:00) Montevideo","(UTC-03:00) Punta Arenas","(UTC-03:00)
        Saint Pierre and Miquelon","(UTC-03:00) Salvador","(UTC-02:00) Coordinated
        Universal Time-02","(UTC-02:00) Mid-Atlantic - Old","(UTC-01:00) Azores","(UTC-01:00)
        Cabo Verde Is.","(UTC) Coordinated Universal Time","(UTC+00:00) Dublin, Edinburgh,
        Lisbon, London","(UTC+00:00) Monrovia, Reykjavik","(UTC+00:00) Sao Tome","(UTC+01:00)
        Casablanca","(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna","(UTC+01:00)
        Belgrade, Bratislava, Budapest, Ljubljana, Prague","(UTC+01:00) Brussels,
        Copenhagen, Madrid, Paris","(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb","(UTC+01:00)
        West Central Africa","(UTC+02:00) Amman","(UTC+02:00) Athens, Bucharest","(UTC+02:00)
        Beirut","(UTC+02:00) Cairo","(UTC+02:00) Chisinau","(UTC+02:00) Damascus","(UTC+02:00)
        Gaza, Hebron","(UTC+02:00) Harare, Pretoria","(UTC+02:00) Helsinki, Kyiv,
        Riga, Sofia, Tallinn, Vilnius","(UTC+02:00) Jerusalem","(UTC+02:00) Kaliningrad","(UTC+02:00)
        Khartoum","(UTC+02:00) Tripoli","(UTC+02:00) Windhoek","(UTC+03:00) Baghdad","(UTC+03:00)
        Istanbul","(UTC+03:00) Kuwait, Riyadh","(UTC+03:00) Minsk","(UTC+03:00) Moscow,
        St. Petersburg","(UTC+03:00) Nairobi","(UTC+03:30) Tehran","(UTC+04:00) Abu
        Dhabi, Muscat","(UTC+04:00) Astrakhan, Ulyanovsk","(UTC+04:00) Baku","(UTC+04:00)
        Izhevsk, Samara","(UTC+04:00) Port Louis","(UTC+04:00) Saratov","(UTC+04:00)
        Tbilisi","(UTC+04:00) Volgograd","(UTC+04:00) Yerevan","(UTC+04:30) Kabul","(UTC+05:00)
        Ashgabat, Tashkent","(UTC+05:00) Ekaterinburg","(UTC+05:00) Islamabad, Karachi","(UTC+05:00)
        Qyzylorda","(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi","(UTC+05:30)
        Sri Jayawardenepura","(UTC+05:45) Kathmandu","(UTC+06:00) Astana","(UTC+06:00)
        Dhaka","(UTC+06:00) Omsk","(UTC+06:30) Yangon (Rangoon)","(UTC+07:00) Bangkok,
        Hanoi, Jakarta","(UTC+07:00) Barnaul, Gorno-Altaysk","(UTC+07:00) Hovd","(UTC+07:00)
        Krasnoyarsk","(UTC+07:00) Novosibirsk","(UTC+07:00) Tomsk","(UTC+08:00) Beijing,
        Chongqing, Hong Kong, Urumqi","(UTC+08:00) Irkutsk","(UTC+08:00) Kuala Lumpur,
        Singapore","(UTC+08:00) Perth","(UTC+08:00) Taipei","(UTC+08:00) Ulaanbaatar","(UTC+08:45)
        Eucla","(UTC+09:00) Chita","(UTC+09:00) Osaka, Sapporo, Tokyo","(UTC+09:00)
        Pyongyang","(UTC+09:00) Seoul","(UTC+09:00) Yakutsk","(UTC+09:30) Adelaide","(UTC+09:30)
        Darwin","(UTC+10:00) Brisbane","(UTC+10:00) Canberra, Melbourne, Sydney","(UTC+10:00)
        Guam, Port Moresby","(UTC+10:00) Hobart","(UTC+10:00) Vladivostok","(UTC+10:30)
        Lord Howe Island","(UTC+11:00) Bougainville Island","(UTC+11:00) Chokurdakh","(UTC+11:00)
        Magadan","(UTC+11:00) Norfolk Island","(UTC+11:00) Sakhalin","(UTC+11:00)
        Solomon Is., New Caledonia","(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky","(UTC+12:00)
        Auckland, Wellington","(UTC+12:00) Coordinated Universal Time+12","(UTC+12:00)
        Fiji","(UTC+12:00) Petropavlovsk-Kamchatsky - Old","(UTC+12:45) Chatham Islands","(UTC+13:00)
        Coordinated Universal Time+13","(UTC+13:00) Nuku''alofa","(UTC+13:00) Samoa","(UTC+14:00)
        Kiritimati Island"]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsTimeZone","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[WindowsTimeZone]WindowsTimeZone1;TimeZone'',
        ''='', parameters(''TimeZone'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsTimeZone"},"TimeZone":{"value":"[parameters(''TimeZone'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"TimeZone":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[WindowsTimeZone]WindowsTimeZone1;TimeZone","value":"[parameters(''TimeZone'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c","type":"Microsoft.Authorization/policyDefinitions","name":"c21f7060-c148-41cf-a68b-0ab3e14c764c"},{"properties":{"displayName":"Audit
        Windows VMs on which the specified services are not installed and ''Running''","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines on which the specified services are
        not installed and ''Running''. This policy should only be used along with
        its corresponding deploy policy in an initiative. For more information on
        Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsServiceStatus"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a","type":"Microsoft.Authorization/policyDefinitions","name":"c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a"},{"properties":{"displayName":"System
        updates on virtual machine scale sets should be installed","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        whether there are any missing system security updates and critical updates
        that should be installed to ensure that your Windows and Linux virtual machine
        scale sets are secure.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"SystemUpdates","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe","type":"Microsoft.Authorization/policyDefinitions","name":"c3f317a7-a95c-4547-b7e7-11017ebdf2fe"},{"properties":{"displayName":"[Preview]:
        Audit Linux VMs that have accounts without passwords","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Linux virtual machines that have accounts without passwords.
        This policy should only be used along with its corresponding deploy policy
        in an initiative. For more information on Guest Configuration policies, please
        visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordPolicy_msid232"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05","type":"Microsoft.Authorization/policyDefinitions","name":"c40c9087-1981-4e73-9f53-39743eda9d05"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that contain certificates expiring
        within the specified number of days","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that contain certificates expiring within the specified number of days. It
        also creates a system-assigned managed identity and deploys the VM extension
        for Guest Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"CertificateStorePath":{"type":"String","metadata":{"displayName":"Certificate
        store path","description":"The path to the certificate store containing the
        certificates to check the expiration dates of. Default value is ''Cert:''
        which is the root certificate store path, so all certificates on the machine
        will be checked. Other example paths: ''Cert:\\LocalMachine'', ''Cert:\\LocalMachine\\TrustedPublisher'',
        ''Cert:\\CurrentUser''"},"defaultValue":"Cert:"},"ExpirationLimitInDays":{"type":"String","metadata":{"displayName":"Expiration
        limit in days","description":"An integer indicating the number of days within
        which to check for certificates that are expiring. For example, if this value
        is 30, any certificate expiring within the next 30 days will cause this policy
        to be non-compliant."},"defaultValue":"30"},"CertificateThumbprintsToInclude":{"type":"String","metadata":{"displayName":"Certificate
        thumbprints to include","description":"A semicolon-separated list of certificate
        thumbprints to check under the specified path. If a value is not specified,
        all certificates under the certificate store path will be checked. If a value
        is specified, no certificates other than those with the thumbprints specified
        will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3"},"defaultValue":""},"CertificateThumbprintsToExclude":{"type":"String","metadata":{"displayName":"Certificate
        thumbprints to exclude","description":"A semicolon-separated list of certificate
        thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3"},"defaultValue":""},"IncludeExpiredCertificates":{"type":"String","metadata":{"displayName":"Include
        expired certificates","description":"Must be ''true'' or ''false''. True indicates
        that any found certificates that have already expired will also make this
        policy non-compliant. False indicates that certificates that have expired
        will be be ignored."},"allowedValues":["true","false"],"defaultValue":"false"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"CertificateExpiration","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[CertificateStore]CertificateStore1;CertificateStorePath'',
        ''='', parameters(''CertificateStorePath''), '','', ''[CertificateStore]CertificateStore1;ExpirationLimitInDays'',
        ''='', parameters(''ExpirationLimitInDays''), '','', ''[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude'',
        ''='', parameters(''CertificateThumbprintsToInclude''), '','', ''[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude'',
        ''='', parameters(''CertificateThumbprintsToExclude''), '','', ''[CertificateStore]CertificateStore1;IncludeExpiredCertificates'',
        ''='', parameters(''IncludeExpiredCertificates'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"CertificateExpiration"},"CertificateStorePath":{"value":"[parameters(''CertificateStorePath'')]"},"ExpirationLimitInDays":{"value":"[parameters(''ExpirationLimitInDays'')]"},"CertificateThumbprintsToInclude":{"value":"[parameters(''CertificateThumbprintsToInclude'')]"},"CertificateThumbprintsToExclude":{"value":"[parameters(''CertificateThumbprintsToExclude'')]"},"IncludeExpiredCertificates":{"value":"[parameters(''IncludeExpiredCertificates'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"CertificateStorePath":{"type":"string"},"ExpirationLimitInDays":{"type":"string"},"CertificateThumbprintsToInclude":{"type":"string"},"CertificateThumbprintsToExclude":{"type":"string"},"IncludeExpiredCertificates":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[CertificateStore]CertificateStore1;CertificateStorePath","value":"[parameters(''CertificateStorePath'')]"},{"name":"[CertificateStore]CertificateStore1;ExpirationLimitInDays","value":"[parameters(''ExpirationLimitInDays'')]"},{"name":"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude","value":"[parameters(''CertificateThumbprintsToInclude'')]"},{"name":"[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude","value":"[parameters(''CertificateThumbprintsToExclude'')]"},{"name":"[CertificateStore]CertificateStore1;IncludeExpiredCertificates","value":"[parameters(''IncludeExpiredCertificates'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8","type":"Microsoft.Authorization/policyDefinitions","name":"c5fbc59e-fb6f-494f-81e2-d99a671bdaa8"},{"properties":{"displayName":"Email
        notifications to admins and subscription owners should be enabled in SQL server
        advanced data security settings","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        that ''email notification to admins and subscription owners'' is enabled in
        the SQL server advanced threat protection settings. This ensures that any
        detections of anomalous activities on SQL server are reported as soon as possible
        to the admins.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"default","existenceCondition":{"field":"Microsoft.Sql/servers/securityAlertPolicies/emailAccountAdmins","equals":"true"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c8343d2f-fdc9-4a97-b76f-fc71d1163bfc","type":"Microsoft.Authorization/policyDefinitions","name":"c8343d2f-fdc9-4a97-b76f-fc71d1163bfc"},{"properties":{"displayName":"API
        App should only be accessible over HTTPS","policyType":"BuiltIn","mode":"All","description":"Use
        of HTTPS ensures server/service authentication and protects data in transit
        from network layer eavesdropping attacks.","metadata":{"category":"Security
        Center","deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"OnlyHttpsForApiApp","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d","type":"Microsoft.Authorization/policyDefinitions","name":"c85538c1-b527-4ce4-bdb4-1dabcb3fd90d"},{"properties":{"displayName":"Diagnostic
        logs in Data Lake Analytics should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Data Lake"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.DataLakeAnalytics/accounts"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c","type":"Microsoft.Authorization/policyDefinitions","name":"c95c74d9-38fe-4f0d-af86-0c7d626a315c"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs with a pending reboot","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        with a pending reboot. It also creates a system-assigned managed identity
        and deploys the VM extension for Guest Configuration. This policy should only
        be used along with its corresponding audit policy in an initiative. For more
        information on Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsPendingReboot","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsPendingReboot"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c","type":"Microsoft.Authorization/policyDefinitions","name":"c96f3246-4382-4264-bf6b-af0b35e23c3c"},{"properties":{"displayName":"Deploy
        Diagnostic Settings for Network Security Groups","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy automatically deploys diagnostic settings to network security groups.
        A storage account with name ''{storagePrefixParameter}{NSGLocation}'' will
        be automatically created.","metadata":{"category":"Monitoring"},"parameters":{"storagePrefix":{"type":"String","metadata":{"displayName":"Storage
        Account Prefix for Regional Storage Account","description":"This prefix will
        be combined with the network security group location to form the created storage
        account name."}},"rgName":{"type":"String","metadata":{"displayName":"Resource
        Group Name for Storage Account (must exist)","description":"The resource group
        that the storage account will be created in. This resource group must already
        exist.","strongType":"ExistingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","name":"setbypolicy","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"},"nsgName":{"type":"string"},"rgName":{"type":"string"}},"variables":{"storageDeployName":"[concat(''policyStorage_'',
        uniqueString(parameters(''location''), parameters(''nsgName'')))]"},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings","name":"[concat(parameters(''nsgName''),''/Microsoft.Insights/setbypolicy'')]","apiVersion":"2017-05-01-preview","location":"[parameters(''location'')]","dependsOn":["[variables(''storageDeployName'')]"],"properties":{"storageAccountId":"[reference(variables(''storageDeployName'')).outputs.storageAccountId.value]","logs":[{"category":"NetworkSecurityGroupEvent","enabled":true,"retentionPolicy":{"enabled":false,"days":0}},{"category":"NetworkSecurityGroupRuleCounter","enabled":true,"retentionPolicy":{"enabled":false,"days":0}}]}},{"apiVersion":"2017-05-10","name":"[variables(''storageDeployName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''rgName'')]","properties":{"mode":"incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.0","parameters":{"location":{"type":"string"},"storagePrefix":{"type":"string"}},"resources":[{"apiVersion":"2017-06-01","type":"Microsoft.Storage/storageAccounts","name":"[concat(parameters(''storageprefix''),
        parameters(''location''))]","sku":{"name":"Standard_LRS","tier":"Standard"},"kind":"Storage","location":"[parameters(''location'')]","tags":{"created-by":"policy"},"scale":null,"properties":{"networkAcls":{"bypass":"AzureServices","defaultAction":"Allow","ipRules":[],"virtualNetworkRules":[]},"supportsHttpsTrafficOnly":true}}],"outputs":{"storageAccountId":{"type":"string","value":"[resourceId(parameters(''rgName''),
        ''Microsoft.Storage/storageAccounts'',concat(parameters(''storagePrefix''),
        parameters(''location'')))]"}}}}}]},"parameters":{"location":{"value":"[field(''location'')]"},"storagePrefix":{"value":"[parameters(''storagePrefix'')]"},"rgName":{"value":"[parameters(''rgName'')]"},"nsgName":{"value":"[field(''name'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89","type":"Microsoft.Authorization/policyDefinitions","name":"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89"},{"properties":{"displayName":"Remote
        debugging should be turned off for Web Application","policyType":"BuiltIn","mode":"All","description":"Remote
        debugging requires inbound ports to be opened on a web application.  Remote
        debugging should be turned off.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoteDebuggingForWebApplication","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71","type":"Microsoft.Authorization/policyDefinitions","name":"cb510bfd-1cba-4d9f-a230-cb0976f4bb71"},{"properties":{"displayName":"Audit
        Windows VMs in which the Administrators group does not contain only the specified
        members","policyType":"BuiltIn","mode":"All","description":"This policy audits
        Windows virtual machines in which the Administrators group does not contain
        only the specified members. This policy should only be used along with its
        corresponding deploy policy in an initiative. For more information on Guest
        Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"AdministratorsGroupMembers"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cc7cda28-f867-4311-8497-a526129a8d19","type":"Microsoft.Authorization/policyDefinitions","name":"cc7cda28-f867-4311-8497-a526129a8d19"},{"properties":{"displayName":"[Preview]:
        Sensitive data in your SQL databases should be classified","policyType":"BuiltIn","mode":"Indexed","description":"Azure
        Security Center monitors the data discovery and classification scan results
        for your SQL databases and provides recommendations to classify the sensitive
        data in your databases for better monitoring and security","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Sql/servers/databases","Microsoft.Sql/managedInstances/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"sqlDataClassification","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349","type":"Microsoft.Authorization/policyDefinitions","name":"cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349"},{"properties":{"displayName":"Allowed
        virtual machine SKUs","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy enables you to specify a set of virtual machine SKUs that your organization
        can deploy.","metadata":{"category":"Compute"},"parameters":{"listOfAllowedSKUs":{"type":"Array","metadata":{"description":"The
        list of SKUs that can be specified for virtual machines.","displayName":"Allowed
        SKUs","strongType":"VMSKUs"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"not":{"field":"Microsoft.Compute/virtualMachines/sku.name","in":"[parameters(''listOfAllowedSKUs'')]"}}]},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3","type":"Microsoft.Authorization/policyDefinitions","name":"cccc23c7-8427-4f53-ad12-b6a63eb452b3"},{"properties":{"displayName":"Allow
        resource creation if ''department'' tag set","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation only if the ''department'' tag is set","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"tags","containsKey":"department"}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064","type":"Microsoft.Authorization/policyDefinitions","name":"cd8dc879-a2ae-43c3-8211-1877c5755064"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that allow re-use of the previous 24 passwords","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that allow re-use of the previous 24
        passwords. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"EnforcePasswordHistory"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293","type":"Microsoft.Authorization/policyDefinitions","name":"cdbf72d9-ac9c-4026-8a3a-491a5ac59293"},{"properties":{"displayName":"Diagnostic
        logs in Key Vault should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Key Vault"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21","type":"Microsoft.Authorization/policyDefinitions","name":"cf820ca0-f99e-4f3e-84fb-66e913812d21"},{"properties":{"displayName":"[Deprecated]:
        Audit Function Apps that are not using custom domains","policyType":"BuiltIn","mode":"All","description":"Use
        of custom domains protects a Function app from common attacks such as phishing
        and other DNS-related attacks.","metadata":{"category":"Security Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"functionapp"},{"field":"kind","equals":"functionapp,linux"},{"field":"kind","equals":"functionapp,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UsedCustomDomains","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c","type":"Microsoft.Authorization/policyDefinitions","name":"d1cb47db-b7a1-4c46-814e-aad1c0e84f3c"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs on which the DSC configuration is
        not compliant","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows VMs on which
        the Desired State Configuration (DSC) configuration is not compliant. This
        policy is only applicable to machines with WMF 4 and above. It also creates
        a system-assigned managed identity and deploys the VM extension for Guest
        Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"WindowsDscConfiguration","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"WindowsDscConfiguration"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a","type":"Microsoft.Authorization/policyDefinitions","name":"d38b4c26-9d2e-47d7-aefe-18d859a8706a"},{"properties":{"displayName":"Audit
        Windows Server VMs on which Windows Serial Console is not enabled","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows Server virtual machines on which Windows Serial Console
        is not enabled. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsSerialConsole"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc","type":"Microsoft.Authorization/policyDefinitions","name":"d7ccd0ca-8d78-42af-a43d-6b7f928accbc"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Applications that are not using custom domains","policyType":"BuiltIn","mode":"All","description":"Use
        of custom domains protects a web application from common attacks such as phishing
        and other DNS-related attacks.","metadata":{"category":"Security Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UsedCustomDomains","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a","type":"Microsoft.Authorization/policyDefinitions","name":"dd2ea520-6b06-45c3-806e-ea297c23e06a"},{"properties":{"displayName":"Allow
        resource creation only in Japan data centers","policyType":"BuiltIn","mode":"Indexed","description":"Allows
        resource creation in the following locations only: Japan East, Japan West","metadata":{"category":"General","deprecated":true},"parameters":{},"policyRule":{"if":{"not":{"field":"location","in":["japaneast","japanwest"]}},"then":{"effect":"Deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697","type":"Microsoft.Authorization/policyDefinitions","name":"e01598e8-6538-41ed-95e8-8b29746cd697"},{"properties":{"displayName":"Vulnerabilities
        in security configuration on your machines should be remediated","policyType":"BuiltIn","mode":"All","description":"Servers
        which do not satisfy the configured baseline will be monitored by Azure Security
        Center as recommendations","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"osVulnerabilities","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15","type":"Microsoft.Authorization/policyDefinitions","name":"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15"},{"properties":{"displayName":"[Preview]:
        Audit Dependency Agent Deployment in VMSS - VM Image (OS) unlisted","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMSS as non-compliant if the VM Image (OS) is not in the list defined and
        the agent is not installed. The list of OS images will be updated over time
        as support is updated.","metadata":{"category":"Monitoring"},"parameters":{"listOfImageIdToInclude_windows":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Windows OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]},"listOfImageIdToInclude_linux":{"type":"Array","metadata":{"displayName":"Optional:
        List of VM images that have supported Linux OS to add to scope","description":"Example
        value: ''/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage''"},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"not":{"anyOf":[{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_windows'')]"},{"field":"Microsoft.Compute/imageId","in":"[parameters(''listOfImageIdToInclude_linux'')]"},{"anyOf":[{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServer"},{"field":"Microsoft.Compute/imageSKU","in":["2008-R2-SP1","2008-R2-SP1-smalldisk","2012-Datacenter","2012-Datacenter-smalldisk","2012-R2-Datacenter","2012-R2-Datacenter-smalldisk","2016-Datacenter","2016-Datacenter-Server-Core","2016-Datacenter-Server-Core-smalldisk","2016-Datacenter-smalldisk","2016-Datacenter-with-Containers","2016-Datacenter-with-RDSH","2019-Datacenter","2019-Datacenter-Core","2019-Datacenter-Core-smalldisk","2019-Datacenter-Core-with-Containers","2019-Datacenter-Core-with-Containers-smalldisk","2019-Datacenter-smalldisk","2019-Datacenter-with-Containers","2019-Datacenter-with-Containers-smalldisk","2019-Datacenter-zhcn"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerSemiAnnual"},{"field":"Microsoft.Compute/imageSKU","in":["Datacenter-Core-1709-smalldisk","Datacenter-Core-1709-with-Containers-smalldisk","Datacenter-Core-1803-with-Containers-smalldisk"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServerHPCPack"},{"field":"Microsoft.Compute/imageOffer","equals":"WindowsServerHPCPack"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"anyOf":[{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2016-BYOL"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2"},{"field":"Microsoft.Compute/imageOffer","like":"*-WS2012R2-BYOL"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftRServer"},{"field":"Microsoft.Compute/imageOffer","equals":"MLServer-WS2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftVisualStudio"},{"field":"Microsoft.Compute/imageOffer","in":["VisualStudio","Windows"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftDynamicsAX"},{"field":"Microsoft.Compute/imageOffer","equals":"Dynamics"},{"field":"Microsoft.Compute/imageSKU","equals":"Pre-Req-AX7-Onebox-U8"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","equals":"windows-data-science-vm"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsDesktop"},{"field":"Microsoft.Compute/imageOffer","equals":"Windows-10"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","in":["RHEL","RHEL-SAP-HANA"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"SUSE"},{"field":"Microsoft.Compute/imageOffer","in":["SLES","SLES-HPC","SLES-HPC-Priority","SLES-SAP","SLES-SAP-BYOS","SLES-Priority","SLES-BYOS","SLES-SAPCAL","SLES-Standard"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["12-SP2","12-SP3","12-SP4"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","in":["14.04.0-LTS","14.04.1-LTS","14.04.5-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["16.04-LTS","16.04.0-LTS"]},{"field":"Microsoft.Compute/imageSKU","in":["18.04-LTS"]}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","in":["Centos","Centos-LVM","CentOS-SRIOV"]},{"anyOf":[{"field":"Microsoft.Compute/imageSKU","like":"6.*"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","like":"7*"}]}]}}]},"then":{"effect":"auditIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","existenceCondition":{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Monitoring.DependencyAgent"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10","type":"Microsoft.Authorization/policyDefinitions","name":"e2dd799a-a932-4e9d-ac17-d473bc3c6c10"},{"properties":{"displayName":"MFA
        should be enabled on accounts with read permissions on your subscription","policyType":"BuiltIn","mode":"All","description":"Multi-Factor
        Authentication (MFA) should be enabled for all subscription accounts with
        read privileges to prevent a breach of accounts or resources.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"EnableMFAForReadPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64","type":"Microsoft.Authorization/policyDefinitions","name":"e3576e28-8b17-4677-84c3-db2990658d64"},{"properties":{"displayName":"Allowed
        locations","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        enables you to restrict the locations your organization can specify when deploying
        resources. Use to enforce your geo-compliance requirements. Excludes resource
        groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that
        use the ''global'' region.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that can be specified when deploying resources.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"location","notEquals":"global"},{"field":"type","notEquals":"Microsoft.AzureActiveDirectory/b2cDirectories"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c","type":"Microsoft.Authorization/policyDefinitions","name":"e56962a6-4747-49cd-b67b-bf8b01975c4c"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Applications that are not using latest supported Node.js Framework","policyType":"BuiltIn","mode":"All","description":"Use
        the latest supported Node.js version for the latest security classes. Using
        older classes and types can make your application vulnerable.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"UseLatestNodeJS","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008","type":"Microsoft.Authorization/policyDefinitions","name":"e67687e8-08d5-4e7f-8226-5b4753bba008"},{"properties":{"displayName":"Subnets
        should be associated with a Network Security Group","policyType":"BuiltIn","mode":"All","description":"Protect
        your subnet from potential threats by restricting access to it with a Network
        Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules
        that allow or deny network traffic to your subnet.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"Disabled"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"networkSecurityGroupsOnSubnets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517","type":"Microsoft.Authorization/policyDefinitions","name":"e71308d3-144b-4262-b144-efdc3cc90517"},{"properties":{"displayName":"Advanced
        Threat Protection types should be set to ''All'' in SQL server Advanced Data
        Security settings","policyType":"BuiltIn","mode":"Indexed","description":"It
        is recommended to enable all Advanced Threat Protection types on your SQL
        servers. Enabling all types protects against SQL injection, database vulnerabilities,
        and any other anomalous activities.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/securityAlertPolicies","name":"default","existenceCondition":{"field":"Microsoft.Sql/servers/securityAlertPolicies/disabledAlerts[*]","equals":""}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad","type":"Microsoft.Authorization/policyDefinitions","name":"e756b945-1b1b-480b-8de8-9a0859d5f7ad"},{"properties":{"displayName":"Allowed
        locations for resource groups","policyType":"BuiltIn","mode":"All","description":"This
        policy enables you to restrict the locations your organization can create
        resource groups in. Use to enforce your geo-compliance requirements.","metadata":{"category":"General"},"parameters":{"listOfAllowedLocations":{"type":"Array","metadata":{"description":"The
        list of locations that resource groups can be created in.","strongType":"location","displayName":"Allowed
        locations"}}},"policyRule":{"if":{"allOf":[{"field":"location","notIn":"[parameters(''listOfAllowedLocations'')]"},{"field":"type","equals":"Microsoft.Resources/subscriptions/resourceGroups"}]},"then":{"effect":"deny"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988","type":"Microsoft.Authorization/policyDefinitions","name":"e765b5de-1225-4ba3-bd56-1ac6695af988"},{"properties":{"displayName":"[Deprecated]:
        Audit Web Sockets state for a Web Application","policyType":"BuiltIn","mode":"All","description":"The
        Web Sockets protocol is vulnerable to different types of security threats.
        Use of Web Sockets within a web application must be carefully reviewed.","metadata":{"category":"Security
        Center","preview":true,"deprecated":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"app"},{"field":"kind","equals":"WebApp"},{"field":"kind","equals":"app,linux"},{"field":"kind","equals":"app,linux,container"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"DisableWebSockets","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e","type":"Microsoft.Authorization/policyDefinitions","name":"e797f851-8be7-4c40-bb56-2e3395215b0e"},{"properties":{"displayName":"Remote
        debugging should be turned off for API App","policyType":"BuiltIn","mode":"All","description":"Remote
        debugging requires inbound ports to be opened on an API app.  Remote debugging
        should be turned off.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"microsoft.Web/sites"},{"anyOf":[{"field":"kind","equals":"api"},{"field":"kind","equals":"apiApp"}]}]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoteDebuggingForApiApp","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e","type":"Microsoft.Authorization/policyDefinitions","name":"e9c8d085-d9cc-4b17-9cdc-059f1f01f19e"},{"properties":{"displayName":"Deprecated
        accounts with owner permissions should be removed from your subscription","policyType":"BuiltIn","mode":"All","description":"Deprecated
        accounts with owner permissions should be removed from your subscription.  Deprecated
        accounts are accounts that have been blocked from signing in.","metadata":{"category":"Security
        Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveDeprecatedAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad","type":"Microsoft.Authorization/policyDefinitions","name":"ebb62a0c-3560-49e1-89ed-27e074e9f8ad"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Linux VMs that allow remote connections from
        accounts without passwords","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Linux virtual machines
        that allow remote connections from accounts without passwords. It also creates
        a system-assigned managed identity and deploys the VM extension for Guest
        Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid110","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid110"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592","type":"Microsoft.Authorization/policyDefinitions","name":"ec49586f-4939-402d-a29e-6ff502b20592"},{"properties":{"displayName":"Deploy
        Diagnostic Settings for Key Vault to Event Hub","policyType":"BuiltIn","mode":"Indexed","description":"Deploys
        the diagnostic settings for Key Vault to stream to a regional Event Hub when
        any Key Vault which is missing this diagnostic settings is created or updated.","metadata":{"category":"Key
        Vault"},"parameters":{"profileName":{"type":"String","metadata":{"displayName":"Profile
        name","description":"The diagnostic settings profile name"},"defaultValue":"setbypolicy"},"eventHubRuleId":{"type":"String","metadata":{"displayName":"Event
        Hub Authorization Rule Id","description":"The Event Hub authorization rule
        Id for Azure Diagnostics. The authorization rule needs to be at Event Hub
        namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource
        group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization
        rule}","strongType":"Microsoft.EventHub/Namespaces/AuthorizationRules","assignPermissions":true}},"metricsEnabled":{"type":"String","metadata":{"displayName":"Enable
        metrics","description":"Whether to enable metrics stream to the Event Hub
        - True or False"},"allowedValues":["True","False"],"defaultValue":"False"},"logsEnabled":{"type":"String","metadata":{"displayName":"Enable
        logs","description":"Whether to enable logs stream to the Event Hub  - True
        or False"},"allowedValues":["True","False"],"defaultValue":"True"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.KeyVault/vaults"},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Insights/diagnosticSettings","name":"[parameters(''profileName'')]","existenceCondition":{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"[parameters(''logsEnabled'')]"},{"field":"Microsoft.Insights/diagnosticSettings/metrics.enabled","equals":"[parameters(''metricsEnabled'')]"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vaultName":{"type":"string"},"location":{"type":"string"},"eventHubRuleId":{"type":"string"},"metricsEnabled":{"type":"string"},"logsEnabled":{"type":"string"},"profileName":{"type":"string"}},"resources":[{"type":"Microsoft.KeyVault/vaults/providers/diagnosticSettings","apiVersion":"2017-05-01-preview","name":"[concat(parameters(''vaultName''),
        ''/'', ''Microsoft.Insights/'', parameters(''profileName''))]","location":"[parameters(''location'')]","dependsOn":[],"properties":{"eventHubAuthorizationRuleId":"[parameters(''eventHubRuleId'')]","metrics":[{"category":"AllMetrics","enabled":"[parameters(''metricsEnabled'')]","retentionPolicy":{"enabled":false,"days":0}}],"logs":[{"category":"AuditEvent","enabled":"[parameters(''logsEnabled'')]"}]}}],"outputs":{"policy":{"type":"string","value":"[concat(''Enabled
        diagnostic settings for '', parameters(''vaultName''))]"}}},"parameters":{"location":{"value":"[field(''location'')]"},"vaultName":{"value":"[field(''name'')]"},"eventHubRuleId":{"value":"[parameters(''eventHubRuleId'')]"},"metricsEnabled":{"value":"[parameters(''metricsEnabled'')]"},"logsEnabled":{"value":"[parameters(''logsEnabled'')]"},"profileName":{"value":"[parameters(''profileName'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2","type":"Microsoft.Authorization/policyDefinitions","name":"ed7c8c13-51e7-49d1-8a43-8490431a0da2"},{"properties":{"displayName":"Vulnerability
        assessment should be enabled on your SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        Azure SQL servers which do not have recurring vulnerability assessment scans
        enabled. Vulnerability assessment can discover, track, and help you remediate
        potential database vulnerabilities.","metadata":{"category":"SQL"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Sql/servers/vulnerabilityAssessments","name":"default","existenceCondition":{"field":"Microsoft.Sql/servers/vulnerabilityAssessments/recurringScans.isEnabled","equals":"True"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9","type":"Microsoft.Authorization/policyDefinitions","name":"ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9"},{"properties":{"displayName":"Deploy
        requirements to audit Windows VMs that have the specified applications installed","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that have the specified applications installed. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"ApplicationName":{"type":"String","metadata":{"displayName":"Application
        names (supports wildcards)","description":"A semicolon-separated list of the
        names of the applications that should not be installed. e.g. ''Microsoft SQL
        Server 2014 (64-bit); Microsoft Visual Studio Code'' or ''Microsoft SQL Server
        2014*'' (to match any application starting with ''Microsoft SQL Server 2014'')"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"NotInstalledApplication","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[InstalledApplication]NotInstalledApplicationResource1;Name'',
        ''='', parameters(''ApplicationName'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"NotInstalledApplication"},"ApplicationName":{"value":"[parameters(''ApplicationName'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"ApplicationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[InstalledApplication]NotInstalledApplicationResource1;Name","value":"[parameters(''ApplicationName'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2","type":"Microsoft.Authorization/policyDefinitions","name":"f0633351-c7b2-41ff-9981-508fc08553c2"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Linux VMs that do not have the passwd file permissions
        set to 0644","policyType":"BuiltIn","mode":"Indexed","description":"This policy
        creates a Guest Configuration assignment to audit Linux virtual machines that
        do not have the passwd file permissions set to 0644. It also creates a system-assigned
        managed identity and deploys the VM extension for Guest Configuration. This
        policy should only be used along with its corresponding audit policy in an
        initiative. For more information on Guest Configuration policies, please visit
        https://aka.ms/gcpol","metadata":{"category":"Guest Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["microsoft-aks","AzureDatabricks","qubole-inc","datastax","couchbase","scalegrid","checkpoint","paloaltonetworks"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"OpenLogic"},{"field":"Microsoft.Compute/imageOffer","like":"CentOS*"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"RHEL"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"RedHat"},{"field":"Microsoft.Compute/imageOffer","equals":"osa"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"credativ"},{"field":"Microsoft.Compute/imageOffer","equals":"Debian"},{"field":"Microsoft.Compute/imageSKU","notLike":"7*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Suse"},{"field":"Microsoft.Compute/imageOffer","like":"SLES*"},{"field":"Microsoft.Compute/imageSKU","notLike":"11*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"Canonical"},{"field":"Microsoft.Compute/imageOffer","equals":"UbuntuServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"12*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","in":["linux-data-science-vm-ubuntu","azureml"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-centos-os"},{"field":"Microsoft.Compute/imageSKU","notLike":"6*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloudera"},{"field":"Microsoft.Compute/imageOffer","equals":"cloudera-altus-centos-os"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","like":"linux*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"PasswordPolicy_msid121","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"PasswordPolicy_msid121"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*"}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforLinux'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforLinux","typeHandlerVersion":"1.0","autoUpgradeMinorVersion":true},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9","type":"Microsoft.Authorization/policyDefinitions","name":"f19aa1c1-6b91-4c27-ae6a-970279f03db9"},{"properties":{"displayName":"Audit
        Windows VMs in which the Administrators group does not contain all of the
        specified members","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines in which the Administrators group does
        not contain all of the specified members. This policy should only be used
        along with its corresponding deploy policy in an initiative. For more information
        on Guest Configuration policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"AdministratorsGroupMembersToInclude"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a","type":"Microsoft.Authorization/policyDefinitions","name":"f3b44e5d-1456-475f-9c67-c66c4618e85a"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that do not contain the specified certificates in Trusted
        Root","policyType":"BuiltIn","mode":"All","description":"This policy audits
        Windows VMs that do not contain the specified certificates in the Trusted
        Root Certification Authorities certificate store (Cert:\\LocalMachine\\Root).
        This policy should only be used along with its corresponding deploy policy
        in an initiative. For more information on Guest Configuration policies, please
        visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"WindowsCertificateInTrustedRoot"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f","type":"Microsoft.Authorization/policyDefinitions","name":"f3b9ad83-000d-4dc1-bff0-6d54533dd03f"},{"properties":{"displayName":"[Preview]:
        Audit Log Analytics Workspace for VM - Report Mismatch","policyType":"BuiltIn","mode":"Indexed","description":"Reports
        VMs as non-compliant if they not logging to the LA workspace specified in
        the policy/initiative assignment.","metadata":{"category":"Monitoring"},"parameters":{"logAnalyticsWorkspaceId":{"type":"String","metadata":{"displayName":"Log
        Analytics Workspace Id that VMs should be configured for","description":"This
        is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured
        for."}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines/extensions"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.EnterpriseCloud.Monitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/settings.workspaceId","notEquals":"[parameters(''logAnalyticsWorkspaceId'')]"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917","type":"Microsoft.Authorization/policyDefinitions","name":"f47b5582-33ec-4c5c-87c0-b010a6b2e917"},{"properties":{"displayName":"Authorization
        rules on the Event Hub instance should be defined","policyType":"BuiltIn","mode":"All","description":"Audit
        existence of authorization rules on Event Hub entities to grant least-privileged
        access","metadata":{"category":"Event Hub"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.EventHub/namespaces/eventhubs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.EventHub/namespaces/eventHubs/authorizationRules"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d","type":"Microsoft.Authorization/policyDefinitions","name":"f4826e5f-6a27-407c-ae3e-9582eb39891d"},{"properties":{"displayName":"[Preview]:
        Audit Windows VMs that do not have the password complexity setting enabled","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Windows virtual machines that do not have the password complexity
        setting enabled. This policy should only be used along with its corresponding
        deploy policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"PasswordMustMeetComplexityRequirements"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb","type":"Microsoft.Authorization/policyDefinitions","name":"f48b2913-1dc5-4834-8c72-ccc1dfd819bb"},{"properties":{"displayName":"[Preview]:
        Deploy requirements to audit Windows VMs that have not restarted within the
        specified number of days","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy creates a Guest Configuration assignment to audit Windows virtual machines
        that have not restarted within the specified number of days. It also creates
        a system-assigned managed identity and deploys the VM extension for Guest
        Configuration. This policy should only be used along with its corresponding
        audit policy in an initiative. For more information on Guest Configuration
        policies, please visit https://aka.ms/gcpol","metadata":{"category":"Guest
        Configuration","requiredProviders":["Microsoft.GuestConfiguration"]},"parameters":{"NumberOfDays":{"type":"String","metadata":{"displayName":"Number
        of days","description":"The number of days without restart until the machine
        is considered non-compliant"},"defaultValue":"12"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"anyOf":[{"field":"Microsoft.Compute/imagePublisher","in":["esri","incredibuild","MicrosoftDynamicsAX","MicrosoftSharepoint","MicrosoftVisualStudio","MicrosoftWindowsDesktop","MicrosoftWindowsServerHPCPack"]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"},{"field":"Microsoft.Compute/imageSKU","notLike":"2008*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftSQLServer"},{"field":"Microsoft.Compute/imageSKU","notEquals":"SQL2008R2SP3-WS2008R2SP1"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-dsvm"},{"field":"Microsoft.Compute/imageOffer","equals":"dsvm-windows"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"microsoft-ads"},{"field":"Microsoft.Compute/imageOffer","in":["standard-data-science-vm","windows-data-science-vm"]}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"batch"},{"field":"Microsoft.Compute/imageOffer","equals":"rendering-windows2016"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"center-for-internet-security-inc"},{"field":"Microsoft.Compute/imageOffer","like":"cis-windows-server-201*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"pivotal"},{"field":"Microsoft.Compute/imageOffer","like":"bosh-windows-server*"}]},{"allOf":[{"field":"Microsoft.Compute/imagePublisher","equals":"cloud-infrastructure-services"},{"field":"Microsoft.Compute/imageOffer","like":"ad*"}]}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.GuestConfiguration/guestConfigurationAssignments","name":"MachineLastBootUpTime","roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"],"existenceCondition":{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash","equals":"[base64(concat(''[MachineUpTime]MachineLastBootUpTime;NumberOfDays'',
        ''='', parameters(''NumberOfDays'')))]"},"deployment":{"properties":{"mode":"incremental","parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"},"configurationName":{"value":"MachineLastBootUpTime"},"NumberOfDays":{"value":"[parameters(''NumberOfDays'')]"}},"template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"},"configurationName":{"type":"string"},"NumberOfDays":{"type":"string"}},"resources":[{"apiVersion":"2018-11-20","type":"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments","name":"[concat(parameters(''vmName''),
        ''/Microsoft.GuestConfiguration/'', parameters(''configurationName''))]","location":"[parameters(''location'')]","properties":{"guestConfiguration":{"name":"[parameters(''configurationName'')]","version":"1.*","configurationParameter":[{"name":"[MachineUpTime]MachineLastBootUpTime;NumberOfDays","value":"[parameters(''NumberOfDays'')]"}]}}},{"apiVersion":"2017-03-30","type":"Microsoft.Compute/virtualMachines","identity":{"type":"SystemAssigned"},"name":"[parameters(''vmName'')]","location":"[parameters(''location'')]"},{"apiVersion":"2015-05-01-preview","name":"[concat(parameters(''vmName''),
        ''/AzurePolicyforWindows'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.GuestConfiguration","type":"ConfigurationforWindows","typeHandlerVersion":"1.1","autoUpgradeMinorVersion":true,"settings":{},"protectedSettings":{}},"dependsOn":["[concat(''Microsoft.Compute/virtualMachines/'',parameters(''vmName''),''/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/'',parameters(''configurationName''))]"]}]}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194","type":"Microsoft.Authorization/policyDefinitions","name":"f4b245d4-46c9-42be-9b1a-49e2b5b94194"},{"properties":{"displayName":"Deploy
        Auditing on SQL servers","policyType":"BuiltIn","mode":"Indexed","description":"This
        policy ensures that Auditing is enabled on SQL Servers for enhanced security
        and compliance. It will automatically create a storage account in the same
        region as the SQL server to store audit records.","metadata":{"category":"SQL"},"parameters":{"retentionDays":{"type":"String","metadata":{"description":"The
        value in days of the retention period (0 indicates unlimited retention)","displayName":"Retention
        days (optional, 180 days if unspecified)"},"defaultValue":"180"},"storageAccountsResourceGroup":{"type":"String","metadata":{"displayName":"Resource
        group name for storage accounts","description":"Auditing writes database events
        to an audit log in your Azure Storage account (a storage account will be created
        in each region where a SQL Server is created that will be shared by all servers
        in that region). Important - for proper operation of Auditing do not delete
        or rename the resource group or the storage accounts.","strongType":"existingResourceGroups"}}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Sql/servers"},"then":{"effect":"DeployIfNotExists","details":{"type":"Microsoft.Sql/servers/auditingSettings","name":"Default","existenceCondition":{"field":"Microsoft.Sql/auditingSettings.state","equals":"Enabled"},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3","/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"serverName":{"type":"string"},"auditRetentionDays":{"type":"string"},"storageAccountsResourceGroup":{"type":"string"},"location":{"type":"string"}},"variables":{"retentionDays":"[int(parameters(''auditRetentionDays''))]","subscriptionId":"[subscription().subscriptionId]","uniqueStorage":"[uniqueString(variables(''subscriptionId''),
        parameters(''location''), parameters(''storageAccountsResourceGroup''))]","locationCode":"[substring(parameters(''location''),
        0, 3)]","storageName":"[tolower(concat(''sqlaudit'', variables(''locationCode''),
        variables(''uniqueStorage'')))]","createStorageAccountDeploymentName":"[concat(''sqlServerAuditingStorageAccount-'',
        uniqueString(variables(''locationCode''), parameters(''serverName'')))]"},"resources":[{"apiVersion":"2017-05-10","name":"[variables(''createStorageAccountDeploymentName'')]","type":"Microsoft.Resources/deployments","resourceGroup":"[parameters(''storageAccountsResourceGroup'')]","properties":{"mode":"Incremental","parameters":{"location":{"value":"[parameters(''location'')]"},"storageName":{"value":"[variables(''storageName'')]"}},"templateLink":{"uri":"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json","contentVersion":"1.0.0.0"}}},{"name":"[concat(parameters(''serverName''),
        ''/Default'')]","type":"Microsoft.Sql/servers/auditingSettings","apiVersion":"2017-03-01-preview","properties":{"state":"Enabled","storageEndpoint":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountEndPoint.value]","storageAccountAccessKey":"[reference(variables(''createStorageAccountDeploymentName'')).outputs.storageAccountKey.value]","retentionDays":"[variables(''retentionDays'')]","auditActionsAndGroups":null,"storageAccountSubscriptionId":"[subscription().subscriptionId]","isStorageSecondaryKeyInUse":false}}]},"parameters":{"serverName":{"value":"[field(''name'')]"},"auditRetentionDays":{"value":"[parameters(''retentionDays'')]"},"storageAccountsResourceGroup":{"value":"[parameters(''storageAccountsResourceGroup'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036","type":"Microsoft.Authorization/policyDefinitions","name":"f4c68484-132f-41f9-9b6d-3e4b1cb55036"},{"properties":{"displayName":"Virtual
        machines should be associated with a Network Security Group","policyType":"BuiltIn","mode":"All","description":"Protect
        your VM from potential threats by restricting access to it with a Network
        Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules
        that allow or deny network traffic to your VM from other instances, in or
        outside the same subnet.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Compute/virtualMachines","Microsoft.ClassicCompute/virtualMachines"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"networkSecurityGroupsOnVirtualMachines","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["Monitored","NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c","type":"Microsoft.Authorization/policyDefinitions","name":"f6de0be7-9a8a-4b8a-b349-43cf02d22f7c"},{"properties":{"displayName":"External
        accounts with owner permissions should be removed from your subscription","policyType":"BuiltIn","mode":"All","description":"External
        accounts with owner permissions should be removed from your subscription in
        order to prevent unmonitored access.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.Resources/subscriptions"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"RemoveExternalAccountsWithOwnerPermissions","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9","type":"Microsoft.Authorization/policyDefinitions","name":"f8456c1c-aa66-4dfb-861a-25d127b775c9"},{"properties":{"displayName":"Diagnostic
        logs in Service Bus should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Service Bus"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ServiceBus/namespaces"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45","type":"Microsoft.Authorization/policyDefinitions","name":"f8d36e2f-389b-4ee4-898d-21aeb69a0f45"},{"properties":{"displayName":"Diagnostic
        logs in Azure Stream Analytics should be enabled","policyType":"BuiltIn","mode":"Indexed","description":"Audit
        enabling of diagnostic logs. This enables you to recreate activity trails
        to use for investigation purposes; when a security incident occurs or when
        your network is compromised","metadata":{"category":"Stream Analytics"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"},"requiredRetentionDays":{"type":"String","metadata":{"displayName":"Required
        retention (days)","description":"The required diagnostic logs retention in
        days"},"defaultValue":"365"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.StreamAnalytics/streamingJobs"},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Insights/diagnosticSettings","existenceCondition":{"anyOf":[{"allOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"},{"anyOf":[{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"0"},{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days","equals":"[parameters(''requiredRetentionDays'')]"}]},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]},{"allOf":[{"not":{"field":"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled","equals":"true"}},{"field":"Microsoft.Insights/diagnosticSettings/logs.enabled","equals":"true"}]}]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46","type":"Microsoft.Authorization/policyDefinitions","name":"f9be5368-9bf5-4b84-9e0a-7850da98bb46"},{"properties":{"displayName":"[Preview]:
        Kubernetes Services should be upgraded to a non-vulnerable Kubernetes version","policyType":"BuiltIn","mode":"Indexed","description":"Upgrade
        your Kubernetes service cluster to a later Kubernetes version to protect against
        known vulnerabilities in your current Kubernetes version. Vulnerability CVE-2019-9946
        has been patched in Kubernetes versions 1.11.9+, 1.12.7+, 1.13.5+, and 1.14.0+","metadata":{"category":"Security
        Center","preview":true},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Disabled"],"defaultValue":"Audit"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"anyOf":[{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","in":["1.13.4","1.13.3","1.13.2","1.13.1","1.13.0"]},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","in":["1.12.6","1.12.5","1.12.4","1.12.3","1.12.2","1.12.1","1.12.0"]},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","in":["1.11.8","1.11.7","1.11.6","1.11.5","1.11.4","1.11.3","1.11.2","1.11.1","1.11.0"]},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.10.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.9.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.8.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.7.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.6.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.5.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.4.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.3.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.2.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.1.*"},{"field":"Microsoft.ContainerService/managedClusters/kubernetesVersion","like":"1.0.*"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/fb893a29-21bb-418c-a157-e99480ec364c","type":"Microsoft.Authorization/policyDefinitions","name":"fb893a29-21bb-418c-a157-e99480ec364c"},{"properties":{"displayName":"Audit
        Linux VMs that do not have the specified applications installed","policyType":"BuiltIn","mode":"All","description":"This
        policy audits Linux virtual machines that do not have the specified applications
        installed. This policy should only be used along with its corresponding deploy
        policy in an initiative. For more information on Guest Configuration policies,
        please visit https://aka.ms/gcpol","metadata":{"category":"Guest Configuration"},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.GuestConfiguration/guestConfigurationAssignments"},{"field":"name","equals":"installed_application_linux"},{"field":"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus","notEquals":"Compliant"}]},"then":{"effect":"audit"}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004","type":"Microsoft.Authorization/policyDefinitions","name":"fee5cb2b-9d9b-410e-afe3-2902d90d0004"},{"properties":{"displayName":"Vulnerabilities
        on your SQL databases should be remediated","policyType":"BuiltIn","mode":"Indexed","description":"Monitor
        Vulnerability Assessment scan results and recommendations for how to remediate
        database vulnerabilities.","metadata":{"category":"Security Center"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["AuditIfNotExists","Disabled"],"defaultValue":"AuditIfNotExists"}},"policyRule":{"if":{"field":"type","in":["Microsoft.Sql/servers/databases","Microsoft.Sql/managedinstances/databases"]},"then":{"effect":"[parameters(''effect'')]","details":{"type":"Microsoft.Security/complianceResults","name":"sqlVulnerabilityAssessment","existenceCondition":{"field":"Microsoft.Security/complianceResults/resourceStatus","in":["NotApplicable","OffByPolicy","Healthy"]}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc","type":"Microsoft.Authorization/policyDefinitions","name":"feedbf84-6b99-488c-acc2-71c829aa5ffc"},{"properties":{"displayName":"[Limited
        Preview]: Ensure containers listen only on allowed ports in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy enforces containers to listen only on allowed ports in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"allowedContainerPortsRegex":{"type":"String","metadata":{"displayName":"Allowed
        container ports regex","description":"Regex representing container ports allowed
        in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$"}},"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"ContainerAllowedPorts","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-ports/limited-preview/gatekeeperpolicy.rego","policyParameters":{"allowedContainerPortsRegex":"[parameters(''allowedContainerPortsRegex'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/0f636243-1b1c-4d50-880f-310f6199f2cb","type":"Microsoft.Authorization/policyDefinitions","name":"0f636243-1b1c-4d50-880f-310f6199f2cb"},{"properties":{"displayName":"[Limited
        Preview]: Enforce labels on pods in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy enforces the specified labels are provided for pods in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"commaSeparatedListOfLabels":{"type":"String","metadata":{"displayName":"Comma-separated
        list of labels","description":"A comma-separated list of labels to be specified
        on Pods in Kubernetes cluster. E.g. test1,test2"}},"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"PodEnforceLabels","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/pod-enforce-labels/limited-preview/gatekeeperpolicy.rego","policyParameters":{"commaSeparatedListOfLabels":"[parameters(''commaSeparatedListOfLabels'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/16c6ca72-89d2-4798-b87e-496f9de7fcb7","type":"Microsoft.Authorization/policyDefinitions","name":"16c6ca72-89d2-4798-b87e-496f9de7fcb7"},{"properties":{"displayName":"[Limited
        Preview]: Ensure services listen only on allowed ports in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy enforces services to listen only on allowed ports in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"allowedServicePortsRegex":{"type":"String","metadata":{"displayName":"Allowed
        service ports regex","description":"Regex representing service ports allowed
        in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$"}},"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"ServiceAllowedPorts","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/service-allowed-ports/limited-preview/gatekeeperpolicy.rego","policyParameters":{"allowedServicePortsRegex":"[parameters(''allowedServicePortsRegex'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/25dee3db-6ce0-4c02-ab5d-245887b24077","type":"Microsoft.Authorization/policyDefinitions","name":"25dee3db-6ce0-4c02-ab5d-245887b24077"},{"properties":{"displayName":"[Limited
        Preview]: Enforce HTTPS ingress in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy enforces HTTPS ingress in an Azure Kubernetes Service cluster. Limited
        Preview policies only work for registered subscriptions. To register, please
        go to https://aka.ms/akspolicyonboarding. For instruction on using this policy,
        please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"HttpsIngressOnly","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-https-only/limited-preview/gatekeeperpolicy.rego"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/2fbff515-eecc-4b7e-9b63-fcc7138b7dc3","type":"Microsoft.Authorization/policyDefinitions","name":"2fbff515-eecc-4b7e-9b63-fcc7138b7dc3"},{"properties":{"displayName":"[Limited
        Preview]: Ensure only allowed container images in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy ensures only allowed container images are running in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"allowedContainerImagesRegex":{"type":"String","metadata":{"displayName":"Allowed
        container images regex","description":"Regex representing container images
        allowed in Kubernetes cluster. E.g. Regex of azure container registry images
        is ^.+azurecr.io/.+$"}},"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"ContainerAllowedImages","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-images/limited-preview/gatekeeperpolicy.rego","policyParameters":{"allowedContainerImagesRegex":"[parameters(''allowedContainerImagesRegex'')]"}}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/5f86cb6e-c4da-441b-807c-44bd0cc14e66","type":"Microsoft.Authorization/policyDefinitions","name":"5f86cb6e-c4da-441b-807c-44bd0cc14e66"},{"properties":{"displayName":"[Limited
        Preview]: Do not allow privileged containers in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy does not allow privileged containers creation in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"ContainerNoPrivilege","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-no-privilege/limited-preview/gatekeeperpolicy.rego"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/7ce7ac02-a5c6-45d6-8d1b-844feb1c1531","type":"Microsoft.Authorization/policyDefinitions","name":"7ce7ac02-a5c6-45d6-8d1b-844feb1c1531"},{"properties":{"displayName":"[Limited
        Preview]: Ensure CPU and memory resource limits defined on containers in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy ensures CPU and memory resource limits are defined on containers in
        an Azure Kubernetes Service cluster. Limited Preview policies only work for
        registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding.
        For instruction on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"ContainerResourceLimits","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-resource-limits/limited-preview/gatekeeperpolicy.rego"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a2d3ed81-8d11-4079-80a5-1faadc0024f4","type":"Microsoft.Authorization/policyDefinitions","name":"a2d3ed81-8d11-4079-80a5-1faadc0024f4"},{"properties":{"displayName":"[Limited
        Preview]: Enforce internal load balancers in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy enforces load balancers do not have public IPs in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"LoadBalancersInternal","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/loadbalancer-no-publicips/limited-preview/gatekeeperpolicy.rego"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/a74d8f00-2fd9-4ce4-968e-0ee1eb821698","type":"Microsoft.Authorization/policyDefinitions","name":"a74d8f00-2fd9-4ce4-968e-0ee1eb821698"},{"properties":{"displayName":"[Limited
        Preview]: Enforce unique ingress hostnames across namespaces in AKS","policyType":"BuiltIn","mode":"Microsoft.ContainerService.Data","description":"This
        policy enforces unique ingress hostnames across namespaces in an Azure Kubernetes
        Service cluster. Limited Preview policies only work for registered subscriptions.
        To register, please go to https://aka.ms/akspolicyonboarding. For instruction
        on using this policy, please go to https://aka.ms/akspolicydoc.","metadata":{"category":"Kubernetes
        service"},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["EnforceRegoPolicy","Disabled"],"defaultValue":"EnforceRegoPolicy"}},"policyRule":{"if":{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},"then":{"effect":"[parameters(''effect'')]","details":{"policyId":"UniqueIngressHostnames","policy":"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-hostnames-conflict/limited-preview/gatekeeperpolicy.rego"}}}},"id":"/providers/Microsoft.Authorization/policyDefinitions/d011d9f7-ba32-4005-b727-b3d09371ca60","type":"Microsoft.Authorization/policyDefinitions","name":"d011d9f7-ba32-4005-b727-b3d09371ca60"},{"properties":{"policyType":"Custom","mode":"Indexed","description":"Don''t
        create a VM anywhere","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:06.4039986Z","updatedBy":null,"updatedOn":null},"policyRule":{"if":{"allOf":[{"source":"action","equals":"Microsoft.Compute/virtualMachines/write"},{"field":"location","in":["eastus","eastus2","centralus"]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","type":"Microsoft.Authorization/policyDefinitions","name":"pypolicyea4a13f0"},{"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.1484325Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.HDInsight/clusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.HDInsight/clusters/computeProfile.roles[*].virtualNetworkProfile.subnet","notIn":["null",""]}}]},{"allOf":[{"field":"type","equals":"Microsoft.HDInsight/clusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"Microsoft.HDInsight/clusters/computeProfile.roles[*].virtualNetworkProfile.subnet","exists":"false"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/11094169db59074f","type":"Microsoft.Authorization/policyDefinitions","name":"11094169db59074f"},{"properties":{"displayName":"nrms-nsg-rule-102_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:23.2021003Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/21f42d11eb755867","type":"Microsoft.Authorization/policyDefinitions","name":"21f42d11eb755867"},{"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:57.6004986Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.ContainerService/managedClusters/networkProfile.networkPlugin","notIn":["null",""]}}]},{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.ContainerService/managedClusters/networkProfile.networkPlugin","equals":"azure"}}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/26db8d27b6fa91aa","type":"Microsoft.Authorization/policyDefinitions","name":"26db8d27b6fa91aa"},{"properties":{"displayName":"nrms-nsg-rule-101_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:14.0863618Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/34612a1acdd0093","type":"Microsoft.Authorization/policyDefinitions","name":"34612a1acdd0093"},{"properties":{"displayName":"nrms-nsg-rule-105_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:18.4394851Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/40879463350508de","type":"Microsoft.Authorization/policyDefinitions","name":"40879463350508de"},{"properties":{"displayName":"nrms-nsg-rule-103_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:16.1955196Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/42c70bae0daee0b3","type":"Microsoft.Authorization/policyDefinitions","name":"42c70bae0daee0b3"},{"properties":{"displayName":"nrms-nsg-rule-101_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:18.6642999Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/5d9c8a259a63a29b","type":"Microsoft.Authorization/policyDefinitions","name":"5d9c8a259a63a29b"},{"properties":{"displayName":"geneva
        monitoring extension and azsecpack append policy for vmss_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-12T00:29:53.2880644Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osProfile.windowsConfiguration","exists":"true"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"}]},{"field":"Microsoft.Compute/VirtualMachineScaleSets/virtualMachineProfile","exists":"true"},{"field":"Microsoft.Compute/VirtualMachineScaleSets/extensionProfile.extensions[*].type","notEquals":"GenevaMonitoring"}]},"then":{"effect":"append","details":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/extensionProfile.extensions[*]","value":{"name":"Microsoft.Azure.Geneva.GenevaMonitoring","properties":{"publisher":"Microsoft.Azure.Geneva","type":"GenevaMonitoring","typeHandlerVersion":"2.0","autoUpgradeMinorVersion":true,"settings":{}}}}]}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/5e6e7d4c3e34256b","type":"Microsoft.Authorization/policyDefinitions","name":"5e6e7d4c3e34256b"},{"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:29.4182093Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"priorities":{"type":"Array","metadata":{"displayName":"Rule
        Priority","description":"List of Rule Priority Numbers reserved for Security"}},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","In":"[parameters(''priorities'')]"},{"field":"location","In":"[parameters(''allowedLocations'')]"},{"allOf":[{"not":{"field":"name","contains":"Cleanuptool"}},{"not":{"field":"name","contains":"NRMS-Rule-"}}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/6221d088cd1bcdc3","type":"Microsoft.Authorization/policyDefinitions","name":"6221d088cd1bcdc3"},{"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.788546Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Batch/batchAccounts"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.Batch/batchAccounts/poolAllocationMode","notIn":["batchservice","null",""]}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/74c98b59a6341488","type":"Microsoft.Authorization/policyDefinitions","name":"74c98b59a6341488"},{"properties":{"displayName":"nrms-nsg-rule-109_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:26.3856504Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8657a5b3e83f5307","type":"Microsoft.Authorization/policyDefinitions","name":"8657a5b3e83f5307"},{"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:24.5730438Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.ContainerService/managedClusters/networkProfile.networkPlugin","notIn":["null",""]}}]},{"allOf":[{"field":"type","equals":"Microsoft.ContainerService/managedClusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.ContainerService/managedClusters/networkProfile.networkPlugin","equals":"azure"}}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/88adc7594e846097","type":"Microsoft.Authorization/policyDefinitions","name":"88adc7594e846097"},{"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:23.3819739Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Batch/batchAccounts"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.Batch/batchAccounts/poolAllocationMode","notIn":["batchservice","null",""]}}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/891d9369d047f6ac","type":"Microsoft.Authorization/policyDefinitions","name":"891d9369d047f6ac"},{"properties":{"displayName":"nrms-nsg-rule-104_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:15.9708014Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8d69d8ee570b639","type":"Microsoft.Authorization/policyDefinitions","name":"8d69d8ee570b639"},{"properties":{"displayName":"nrms-nsg-rule-106_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:28.0710497Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8fdec1516a77bbd6","type":"Microsoft.Authorization/policyDefinitions","name":"8fdec1516a77bbd6"},{"properties":{"displayName":"nrms-nsg-subnet_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:09.005562Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"resourceGroupExclusions":{"type":"Array","metadata":{"displayName":"Resource
        Groups Excluded","description":"Any VNet in a resource group in this list
        will be ignored."},"defaultValue":[]}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"},{"value":"[resourceGroup().name]","notIn":"[parameters(''resourceGroupExclusions'')]"},{"field":"name","notContains":"GatewaySubnet"},{"field":"tags[''SkipNRMSNSG'']","exists":"false"},{"anyOf":[{"not":{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","notIn":["null",""]}},{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","exists":"false"}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Authorization/policyAssignments","name":"DoesNotExistBecauseThisIsToCauseDeployment","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json","contentVersion":"1.0.0.1","parameters":{"fullSubnetName":{"type":"String"},"allowedLocations":{"type":"Array"}},"variables":{"vnetName":"[first(split(parameters(''fullSubnetName''),''/''))]","subnetName":"[last(split(parameters(''fullSubnetName''),''/''))]","rawNsgName":"[concat(variables(''vnetName''),''-'',
        variables(''subnetName''), ''-NRMS'')]","nsgName":"[if(greater(length(variables(''rawNsgName'')),75),substring(variables(''rawNsgName''),0,75),variables(''rawNsgName''))]","nsgUpdateJson":{"networkSecurityGroup":{"id":"[resourceId(''Microsoft.Network/networkSecurityGroups'',
        variables(''nsgName''))]"}}},"resources":[{"condition":"[contains(parameters(''allowedLocations''),
        resourceGroup().location)]","type":"Microsoft.Network/networkSecurityGroups","name":"[variables(''nsgName'')]","apiVersion":"2018-03-01","location":"[resourceGroup().location]","tags":{"Creator":"Automatically
        added by NRMS Azure Policy","NRMS-Info":"http://aka.ms/nrms","NRMS-Version":"2019-03-20"},"properties":{}},{"type":"Microsoft.Resources/deployments","name":"NRMS-Update-Subnet-Without-NSG","apiVersion":"2018-05-01","properties":{"mode":"Incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","resources":[{"apiVersion":"2018-11-01","type":"Microsoft.Network/virtualNetworks/subnets","name":"[parameters(''fullSubnetName'')]","location":"[resourceGroup().location]","properties":"[union(reference(resourceId(''Microsoft.Network/virtualNetworks/subnets'',
        variables(''vnetName''), variables(''subnetName'')), ''2018-11-01''), variables(''nsgUpdateJson''))]"}]}},"dependsOn":["[variables(''nsgName'')]"]}]},"parameters":{"fullSubnetName":{"value":"[field(''fullName'')]"},"allowedLocations":{"value":"[parameters(''allowedLocations'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/9644d220df7c67a","type":"Microsoft.Authorization/policyDefinitions","name":"9644d220df7c67a"},{"properties":{"displayName":"nrms-nsg-rule-105_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:26.1317211Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/9aca16db50fb914c","type":"Microsoft.Authorization/policyDefinitions","name":"9aca16db50fb914c"},{"properties":{"displayName":"geneva
        monitoring extension and azsecpack autoupdate policy for iaas_1.0","policyType":"Custom","mode":"Indexed","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-12T00:29:57.8179024Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachines"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"anyOf":[{"field":"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration","exists":"true"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachines/extensions","name":"Microsoft.Azure.Geneva.GenevaMonitoring","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachines/extensions/type","equals":"GenevaMonitoring"},{"field":"Microsoft.Compute/virtualMachines/extensions/publisher","equals":"Microsoft.Azure.Geneva"},{"field":"Microsoft.Compute/virtualMachines/extensions/enableAutomaticUpgrade","equals":"true"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmName":{"type":"string"},"location":{"type":"string"}},"resources":[{"apiVersion":"2018-10-01","name":"[concat(parameters(''vmName''),
        ''/Microsoft.Azure.Geneva.GenevaMonitoring'')]","type":"Microsoft.Compute/virtualMachines/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.Azure.Geneva","type":"GenevaMonitoring","typeHandlerVersion":"2.0","autoUpgradeMinorVersion":true,"enableAutomaticUpgrade":true,"settings":{},"protectedSettings":{}}}]},"parameters":{"vmName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b1d9e961d02c54d5","type":"Microsoft.Authorization/policyDefinitions","name":"b1d9e961d02c54d5"},{"properties":{"displayName":"nrms-nsg-rule-106_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:22.7538641Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b4482f205fb6bbc1","type":"Microsoft.Authorization/policyDefinitions","name":"b4482f205fb6bbc1"},{"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:22.8439408Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.HDInsight/clusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"not":{"field":"Microsoft.HDInsight/clusters/computeProfile.roles[*].virtualNetworkProfile.subnet","notIn":["null",""]}}]},{"allOf":[{"field":"type","equals":"Microsoft.HDInsight/clusters"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"Microsoft.HDInsight/clusters/computeProfile.roles[*].virtualNetworkProfile.subnet","exists":"false"}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b7a0969ff954eaf7","type":"Microsoft.Authorization/policyDefinitions","name":"b7a0969ff954eaf7"},{"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.4784818Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"location","in":"[parameters(''allowedLocations'')]"},{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"not":{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","notIn":["null",""]}}]},{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","exists":"false"}]}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b8f1faa61cb41f92","type":"Microsoft.Authorization/policyDefinitions","name":"b8f1faa61cb41f92"},{"properties":{"displayName":"nrms-nsg-rule-107_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:32.278708Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/c4184f404efb2fe5","type":"Microsoft.Authorization/policyDefinitions","name":"c4184f404efb2fe5"},{"properties":{"displayName":"nrms-nsg-rule-108_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:25.3178329Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/ce4b13eba037b5cc","type":"Microsoft.Authorization/policyDefinitions","name":"ce4b13eba037b5cc"},{"properties":{"displayName":"geneva
        monitoring extension and azsecpack autoupdate policy for vmss_2.0","policyType":"Custom","mode":"Indexed","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-12T00:29:56.9604539Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Compute/virtualMachineScaleSets"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"anyOf":[{"field":"Microsoft.Compute/VirtualMachineScaleSets/osProfile.windowsConfiguration","exists":"true"},{"field":"Microsoft.Compute/imagePublisher","equals":"MicrosoftWindowsServer"}]}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Compute/virtualMachineScaleSets/extensions","name":"Microsoft.Azure.Geneva.GenevaMonitoring","existenceCondition":{"allOf":[{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/type","equals":"GenevaMonitoring"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher","equals":"Microsoft.Azure.Geneva"},{"field":"Microsoft.Compute/virtualMachineScaleSets/extensions/enableAutomaticUpgrade","equals":"true"}]},"roleDefinitionIds":["/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"],"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"vmssName":{"type":"string"},"location":{"type":"string"}},"resources":[{"apiVersion":"2018-10-01","name":"[concat(parameters(''vmssName''),
        ''/Microsoft.Azure.Geneva.GenevaMonitoring'')]","type":"Microsoft.Compute/virtualMachineScaleSets/extensions","location":"[parameters(''location'')]","properties":{"publisher":"Microsoft.Azure.Geneva","type":"GenevaMonitoring","typeHandlerVersion":"2.0","autoUpgradeMinorVersion":true,"enableAutomaticUpgrade":true,"settings":{}}}]},"parameters":{"vmssName":{"value":"[field(''name'')]"},"location":{"value":"[field(''location'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/dac4e4f8ad529fe5","type":"Microsoft.Authorization/policyDefinitions","name":"dac4e4f8ad529fe5"},{"properties":{"displayName":"nrms-nsg-rule-103_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:24.0068177Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e24b2791c9576d86","type":"Microsoft.Authorization/policyDefinitions","name":"e24b2791c9576d86"},{"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:58.9310187Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"priorities":{"type":"Array","metadata":{"displayName":"Rule
        Priority","description":"List of Rule Priority Numbers reserved for Security"}},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups/securityRules"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","In":"[parameters(''priorities'')]"},{"field":"location","In":"[parameters(''allowedLocations'')]"},{"allOf":[{"not":{"field":"name","contains":"Cleanuptool"}},{"not":{"field":"name","contains":"NRMS-Rule-"}}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e695de0794b757d","type":"Microsoft.Authorization/policyDefinitions","name":"e695de0794b757d"},{"properties":{"displayName":"nrms-nsg-rule-102_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:16.2005161Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e788a85b5ac6ce0f","type":"Microsoft.Authorization/policyDefinitions","name":"e788a85b5ac6ce0f"},{"properties":{"displayName":"nrms-nsg-rule-109_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:36.1193587Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/eb9b3ba85853f934","type":"Microsoft.Authorization/policyDefinitions","name":"eb9b3ba85853f934"},{"properties":{"displayName":"nrms-nsg-rule-104_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:24.2401173Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/eed6a81371f5e28b","type":"Microsoft.Authorization/policyDefinitions","name":"eed6a81371f5e28b"},{"properties":{"displayName":"nrms-nsg-rule-107_1.1","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:24.6068273Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"}},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"}},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","equals":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"Any"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/f0e3de3e84e21226","type":"Microsoft.Authorization/policyDefinitions","name":"f0e3de3e84e21226"},{"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:26.5935651Z","updatedBy":null,"updatedOn":null},"parameters":{"effect":{"type":"String","metadata":{"displayName":"Effect","description":"Enable
        or disable the execution of the policy"},"allowedValues":["Audit","Deny","Disabled"],"defaultValue":"Audit"},"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}}},"policyRule":{"if":{"allOf":[{"field":"location","in":"[parameters(''allowedLocations'')]"},{"anyOf":[{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"not":{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","notIn":["null",""]}}]},{"allOf":[{"field":"type","equals":"Microsoft.Network/virtualNetworks/subnets"},{"field":"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id","exists":"false"}]}]}]},"then":{"effect":"[parameters(''effect'')]"}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/f828e370e4aad7e8","type":"Microsoft.Authorization/policyDefinitions","name":"f828e370e4aad7e8"},{"properties":{"displayName":"nrms-nsg-rule-108_1.2","policyType":"Custom","mode":"All","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:32.8982907Z","updatedBy":null,"updatedOn":null},"parameters":{"allowedLocations":{"type":"Array","metadata":{"displayName":"Allowed
        locations","description":"The list of locations that can be specified when
        deploying resources.","strongType":"location"}},"ruleNo":{"type":"String","metadata":{"displayName":"Priority","description":"The
        priority slot for the new rule"},"allowedValues":["100","101","102","103","104","105","106","107","108","109"]},"info":{"type":"String","metadata":{"displayName":"Description","description":"A
        description"},"defaultValue":""},"destinationPortRanges":{"type":"Array","metadata":{"displayName":"Port
        Number","description":"Security rule port numbers must match these numbers"}},"subscriptionExclusions":{"type":"Array","metadata":{"displayName":"Subscriptions
        Excluded","description":"Subscriptions excluded from policy due to security
        exceptions"},"defaultValue":[]},"protocol":{"type":"String","metadata":{"displayName":"protocol","description":"Protocol
        for the rule"},"allowedValues":["*","Tcp","Udp"]},"sourceType":{"type":"String","metadata":{"displayName":"sourceType","description":null},"allowedValues":["IP
        Addresses","Service Tag","App Security Group"]},"sourceValue":{"type":"String","metadata":{"displayName":"sourceValue","description":null}},"actionValue":{"type":"String","metadata":{"displayName":"actionValue","description":null},"allowedValues":["Allow","Deny"]},"direction":{"type":"String","metadata":{"displayName":"direction","description":null},"allowedValues":["Inbound","Outbound"]},"tagname":{"type":"String","metadata":{"displayName":"Tag
        Name","description":"Rule is not deployed if this tag exists on the NSG"},"allowedValues":["NA","NRMSException","SkipNRMSCorp","nrmsskipcorpnetsaw","SkipNRMSSAW","SkipNRMSDatabricks","SkipNRMSRDPSSH","SkipNRMSMgmt","SkipNRMSHigh","SkipNRMSVNet","SkipNRMSLoadBal","SkipNRMSDB","SkipNRMSMedium"],"defaultValue":"NA"}},"policyRule":{"if":{"allOf":[{"field":"type","equals":"Microsoft.Network/networkSecurityGroups"},{"field":"location","in":"[parameters(''allowedLocations'')]"},{"field":"[concat(''tags['',
        parameters(''tagName''), '']'')]","exists":"false"},{"field":"tags[''SkipNRMSAll'']","exists":"false"},{"value":"[subscription().subscriptionId]","notIn":"[parameters(''subscriptionExclusions'')]"}]},"then":{"effect":"deployIfNotExists","details":{"type":"Microsoft.Network/networkSecurityGroups/securityRules","roleDefinitionIds":["/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"],"existenceCondition":{"anyOf":[{"allOf":[{"field":"fullName","equals":"[concat(field(''name''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"[parameters(''ruleno'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","equals":"[parameters(''sourceValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"[parameters(''actionValue'')]"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"[parameters(''direction'')]"}]},{"allOf":[{"field":"fullName","contains":"Cleanuptool-Deny-103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/priority","equals":"103"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix","in":["Any","*"]},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/access","equals":"Deny"},{"field":"Microsoft.Network/networkSecurityGroups/securityRules/direction","equals":"Inbound"}]}]},"deployment":{"properties":{"mode":"incremental","template":{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"fullName":{"type":"string"},"ruleNo":{"type":"String"},"destinationPortRanges":{"type":"Array"},"protocol":{"type":"String"},"sourceType":{"type":"String"},"sourceValue":{"type":"String"},"actionValue":{"type":"String"},"direction":{"type":"String"},"info":{"type":"String"}},"variables":{"SourceArr":"[split(parameters(''sourceValue''),'','')]","appSecGroups":{"copy":[{"name":"values","count":"[length(variables(''SourceArr''))]","input":{"id":"[if(equals(parameters(''sourceType''),''App
        Security Group''),if(contains(variables(''SourceArr'')[copyindex(''values'')],''subscriptions''),
        variables(''SourceArr'')[copyindex(''values'')],resourceId(''Microsoft.Network/applicationSecurityGroups'',
        variables(''SourceArr'')[copyindex(''values'')])), '''')]"}}]}},"resources":[{"type":"Microsoft.Network/networkSecurityGroups/securityRules","name":"[concat(parameters(''fullName''),''/'',''NRMS-Rule-'',
        parameters(''ruleNo''))]","apiVersion":"2017-10-01","scale":null,"properties":{"protocol":"[parameters(''protocol'')]","description":"[parameters(''info'')]","sourcePortRange":"*","sourceAddressPrefix":"[if(equals(parameters(''sourceType''),''Service
        Tag''),parameters(''sourceValue''),json(''null''))]","sourceAddressPrefixes":"[if(equals(parameters(''sourceType''),''IP
        Addresses''),variables(''SourceArr''),json(''null''))]","sourceApplicationSecurityGroups":"[if(equals(parameters(''sourceType''),''App
        Security Group''),variables(''appSecGroups'').values,json(''null''))]","destinationPortRanges":"[if
        (equals(1,length(parameters(''destinationPortRanges''))), json(''null''),
        parameters(''destinationPortRanges''))]","destinationPortRange":"[if (equals(1,length(parameters(''destinationPortRanges''))),
        parameters(''destinationPortRanges'')[0], json(''null''))]","destinationAddressPrefix":"*","destinationApplicationSecurityGroups":[],"access":"[parameters(''actionValue'')]","priority":"[parameters(''ruleNo'')]","direction":"[parameters(''direction'')]"}}]},"parameters":{"fullName":{"value":"[field(''fullName'')]"},"ruleNo":{"value":"[parameters(''ruleNo'')]"},"destinationPortRanges":{"value":"[parameters(''destinationPortRanges'')]"},"protocol":{"value":"[parameters(''protocol'')]"},"sourceType":{"value":"[parameters(''sourceType'')]"},"sourceValue":{"value":"[parameters(''sourceValue'')]"},"actionValue":{"value":"[parameters(''actionValue'')]"},"direction":{"value":"[parameters(''direction'')]"},"info":{"value":"[parameters(''info'')]"}}}}}}}},"id":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/fc84f507da5fe442","type":"Microsoft.Authorization/policyDefinitions","name":"fc84f507da5fe442"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '604711'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:07 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: 'b''b\''b\\\''b\\\\\\\''{"properties": {"policyDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0"}}\\\\\\\''\\\''\'''''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '162'
      Content-Type:
      - application/json; charset=utf-8
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:08.9173801Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '766'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1198'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:08.9173801Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '766'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments?api-version=2019-01-01
  response:
    body:
      string: '{"value":[{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"ASC
        Default (subscription: 00000000-0000-0000-0000-000000000000)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","parameters":{"diagnosticsLogsInServiceFabricMonitoringEffect":{"value":"AuditIfNotExists"},"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"AuditIfNotExists"},"identityDesignateLessThanOwnersMonitoringEffect":{"value":"AuditIfNotExists"},"identityDesignateMoreThanOneOwnerMonitoringEffect":{"value":"AuditIfNotExists"},"identityEnableMFAForOwnerPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityEnableMFAForWritePermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityEnableMFAForReadPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveDeprecatedAccountMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"secureTransferToStorageAccountMonitoringEffect":{"value":"Audit"},"aadAuthenticationInSqlServerMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInRedisCacheMonitoringEffect":{"value":"Audit"},"clusterProtectionLevelInServiceFabricMonitoringEffect":{"value":"Audit"},"aadAuthenticationInServiceFabricMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInServiceBusMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInDataLakeStoreMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInBatchAccountMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInEventHubMonitoringEffect":{"value":"AuditIfNotExists"},"metricAlertsInBatchAccountMonitoringEffect":{"value":"AuditIfNotExists"},"namespaceAuthorizationRulesInServiceBusMonitoringEffect":{"value":"Audit"},"disableUnrestrictedNetworkToStorageAccountMonitoringEffect":{"value":"Audit"},"classicComputeVMsMonitoringEffect":{"value":"Audit"},"classicStorageAccountsMonitoringEffect":{"value":"Audit"},"sqlDbVulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInKeyVaultMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInStreamAnalyticsMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInSearchServiceMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInLogicAppsMonitoringEffect":{"value":"AuditIfNotExists"}},"description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn","type":"Microsoft.Authorization/policyAssignments","name":"SecurityCenterBuiltIn"},{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:08.9173801Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/74c98b59a6341488","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Batch Accounts
        must use a Pool Allocation Mode of User subscription on the Advanced tab to
        configure a VNet in the subscriptiong.  This enables the use of NSGs to secure
        the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.9760562Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.0025385Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/6bff79d27acb9c88","type":"Microsoft.Authorization/policyAssignments","name":"6bff79d27acb9c88"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b8f1faa61cb41f92","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"All C+AI Subscriptions
        must have a NSG on all VNets in the subscription.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.682075Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:40:00.2019682Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/aca4d19ab4e30392","type":"Microsoft.Authorization/policyAssignments","name":"aca4d19ab4e30392"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e695de0794b757d","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.5549343Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.3618916Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b65cf29bbd4b57d","type":"Microsoft.Authorization/policyAssignments","name":"b65cf29bbd4b57d"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"azuresecuritypackautoupdate_3.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policySetDefinitions/12d3b8c90bd0eaa8","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"AllowedLocations1":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest"]}},"description":"Combinations
        of multiple policies to enable auto update of security pack and geneva agent","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-12T00:29:59.4918191Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-20T00:37:57.8114005Z"}},"identity":{"principalId":"b70ee0cb-d1ca-4fc0-977a-c7f98d84d623","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b74b3695477eaa8","type":"Microsoft.Authorization/policyAssignments","name":"b74b3695477eaa8","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/26db8d27b6fa91aa","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Kubernets must
        use the Advanced Networking option to configure the Kubernetes cluster to
        use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:58.085345Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:55.6577715Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/bce5fcf8b40531aa","type":"Microsoft.Authorization/policyAssignments","name":"bce5fcf8b40531aa"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/11094169db59074f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"HDInsight Clusters
        must use the Custom configuration option to configure a VNet in the subscriptiong.  This
        enables the use of NSGs to secure the network traffic for the HDInsight cluster.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.3537501Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:38:59.5098707Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/fcbba78ebf3e874f","type":"Microsoft.Authorization/policyAssignments","name":"fcbba78ebf3e874f"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/891d9369d047f6ac","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"Batch
        Accounts must use a Pool Allocation Mode of User subscription on the Advanced
        tab to configure a VNet in the subscriptiong.  This enables the use of NSGs
        to secure the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:24.2836979Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:34.2596619Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-BTCH-AUDT-VINJ-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-BTCH-AUDT-VINJ-v011"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b7a0969ff954eaf7","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"HDInsight
        Clusters must use the Custom configuration option to configure a VNet in the
        subscriptiong.  This enables the use of NSGs to secure the network traffic
        for the HDInsight cluster.  See https://aka.ms/netiso/vnetinjection for more
        details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:23.3038438Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:20.9625986Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-HDIN-AUDT-VINJ-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-HDIN-AUDT-VINJ-v011"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/88adc7594e846097","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"Kubernets
        must use the Advanced Networking option to configure the Kubernetes cluster
        to use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:24.8990144Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:21.2236207Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-KBNT-AUDT-VINJ-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-KBNT-AUDT-VINJ-v011"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-101_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/34612a1acdd0093","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"101"},"info":{"value":"Created
        by Azure Core Security managed policy to Allow Databricks IPs, rule can be
        deleted but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"13.70.105.50,13.71.184.74,13.75.218.172,13.78.19.235,23.100.0.135,23.101.152.95,40.70.58.221,40.83.178.242,40.85.223.25,40.118.174.12,51.140.203.27,51.140.204.4,52.187.0.85,52.187.145.107,52.232.19.246,52.246.160.72,104.211.89.81,104.211.101.14"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDatabricks"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:15.9530036Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:19.6332878Z"}},"identity":{"principalId":"77c75a6c-dd52-4bc9-8da9-e85128093422","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR101-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR101-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-101_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/5d9c8a259a63a29b","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"101"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"13.70.105.50,13.71.184.74,13.75.218.172,13.78.19.235,23.100.0.135,23.101.152.95,40.70.58.221,40.83.178.242,40.85.223.25,40.118.174.12,51.140.203.27,51.140.204.4,52.187.0.85,52.187.145.107,52.232.19.246,52.246.160.72,104.211.89.81,104.211.101.14"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDatabricks"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:21.6959438Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"21dda55b-ee95-4ba5-aace-58e017451c1d","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR101-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR101-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-102_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e788a85b5ac6ce0f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"102"},"info":{"value":"Created
        by Azure Core Security managed policy, to allow Corpnet IPV4 addresses, rule
        can be deleted but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"8.39.53.12/32,20.42.25.133/32,40.90.6.0/24,40.91.77.216/32,40.91.93.196/32,40.91.95.146/32,40.91.114.244/32,40.91.115.44/32,52.151.243.229/32,52.188.221.200/32,65.54.12.0/25,65.54.13.0/24,65.55.188.0/24,65.113.36.85/32,66.119.150.128/25,70.42.230.0/23,91.225.250.8/32,94.245.87.0/24,104.44.112.0/24,131.107.147.0/24,131.107.159.0/24,131.107.160.0/24,131.107.174.0/24,144.2.236.0/25,144.2.237.0/25,144.2.238.0/25,144.2.239.0/25,157.58.30.0/23,157.58.35.0/26,157.58.192.0/19,167.220.0.0/23,167.220.2.0/24,167.220.24.0/22,167.220.56.0/21,167.220.64.0/19,167.220.98.0/23,167.220.100.0/22,167.220.104.0/23,167.220.107.0/24,167.220.148.0/23,167.220.152.0/24,167.220.196.0/23,167.220.226.0/23,167.220.232.0/22,167.220.237.128/27,167.220.238.0/24,167.220.242.0/24,167.220.248.32/27,167.220.248.96/27,167.220.253.128/29,167.220.255.0/25,167.220.255.128/26,191.234.97.0/25,194.69.98.0/23,194.69.102.0/23,194.69.104.0/25,194.69.104.128/26,194.69.105.32/27,194.69.105.64/27,194.69.126.128/27,194.69.126.224/27,194.69.127.0/27,194.69.127.96/27,194.69.127.144/29,202.4.184.29/32,207.46.216.0/23,216.52.20.0/25,216.52.21.0/25,216.52.22.0/25,216.52.23.0/25,217.29.149.150/32"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:18.017056Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:24.1040996Z"}},"identity":{"principalId":"46e4eded-d3e3-47e1-adcc-aafd62d4aa2b","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR102-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR102-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-102_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/21f42d11eb755867","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"102"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"8.39.53.12/32,20.42.25.133/32,40.90.6.0/24,40.91.77.216/32,40.91.93.196/32,40.91.95.146/32,40.91.114.244/32,40.91.115.44/32,52.151.243.229/32,52.188.221.200/32,65.54.12.0/25,65.54.13.0/24,65.55.188.0/24,65.113.36.85/32,66.119.150.128/25,70.42.230.0/23,91.225.250.8/32,94.245.87.0/24,104.44.112.0/24,131.107.147.0/24,131.107.159.0/24,131.107.160.0/24,131.107.174.0/24,144.2.236.0/25,144.2.237.0/25,144.2.238.0/25,144.2.239.0/25,157.58.30.0/23,157.58.35.0/26,157.58.192.0/19,167.220.0.0/23,167.220.2.0/24,167.220.24.0/22,167.220.56.0/21,167.220.64.0/19,167.220.98.0/23,167.220.100.0/22,167.220.104.0/23,167.220.107.0/24,167.220.148.0/23,167.220.152.0/24,167.220.196.0/23,167.220.226.0/23,167.220.232.0/22,167.220.237.128/27,167.220.238.0/24,167.220.242.0/24,167.220.248.32/27,167.220.248.96/27,167.220.253.128/29,167.220.255.0/25,167.220.255.128/26,191.234.97.0/25,194.69.98.0/23,194.69.102.0/23,194.69.104.0/25,194.69.104.128/26,194.69.105.32/27,194.69.105.64/27,194.69.126.128/27,194.69.126.224/27,194.69.127.0/27,194.69.127.96/27,194.69.127.144/29,202.4.184.29/32,207.46.216.0/23,216.52.20.0/25,216.52.21.0/25,216.52.22.0/25,216.52.23.0/25,217.29.149.150/32"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:25.8530713Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"4fd162ac-c74a-4e79-9952-81fff83cbeea","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR102-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR102-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-103_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/42c70bae0daee0b3","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"103"},"info":{"value":"Created
        by Azure Core Security managed policy, to allow Corpnet IPV6 rule can be deleted
        but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"2001:4898:a800:1010::/64,2001:4898:a800:1012::/64,2001:4898:80e8::/64,2001:4898:80e8:1::/64,2405:2300:ff00::/42,2620:119:5042:900::/64,2a01:110:A008:4::/64,2001:4898:e008:1::/64,2001:4898:80e8:8::/64,2001:4898:80e8:9::/64,2001:4898:80e8:a::/64,2001:4898:80e8:b::/64,2001:4898:80e8:2::/64,2404:f801:8028:3::/64,2404:f801:8028:4::/64,2404:f801:9000:18::/64,2404:f801:9000:19::/64,2404:f801:8050:2::/64,2001:4898:80e8:3::/64,2001:4898:e810:2::/64,2a01:110:8012:1010::/64,2001:4898:e008:5::/64,2001:4898:e008:6::/64,2001:4898:e008:7::/64,2001:4898:e008:8::/64,2001:4898:e810:1::/64,2001:4898:e810:3::/64,2404:f801:8028:5::/64,2404:f801:8028:6::/64,2404:f801:8028:7::/64,2404:f801:8028:8::/64,2404:f801:8050:5::/64,2404:f801:8050:6::/64,2404:f801:8050:7::/64,2404:f801:8050:8::/64,2404:f801:9000:1c::/64,2404:f801:9000:1d::/64,2404:f801:9000:1e::/64,2404:f801:9000:1f::/64,2404:f801:e818:11::/64,2404:f801:e818:13::/64,2404:f801:e818:15::/64,2404:f801:e818:17::/64,2a01:110:8012:1014::/64,2a01:110:8012:1015::/64,2a01:110:8012:1016::/64,2a01:110:8012:1017::/64,2a01:110:9008:5::/64,2a01:110:9008:6::/64,2a01:110:9008:7::/64,2a01:110:9008:8::/64,2a01:110:A008:5::/64,2a01:110:A008:6::/64,2a01:110:A008:7::/64,2a01:110:A008:8::/64,2a01:110:A008:3::/64,2001:4898:80e8:4::/64,2001:4898:80e8:5::/64,2001:4898:80e8:6::/64,2001:4898:80e8:7::/64,2001:4898:80e8:c::/64,2001:4898:80e8:d::/64,2001:4898:80e8:e::/64,2001:4898:80e8:f::/64,2001:4898:e008:2::/64,2001:4898:e008:3::/64,2001:4898:e008:4::/64,2404:f801:8050:1::/64,2404:f801:8050:3::/64,2404:f801:8050:4::/64,2404:f801:8028:1::/64,2404:f801:8028:2::/64,2404:f801:9000:1a::/64,2404:f801:9000:1b::/64,2404:f801:e818:10::/64,2404:f801:e818:12::/64,2404:f801:e818:14::/64,2404:f801:e818:16::/64,2a01:110:A008:1::/64,2a01:110:A008:2::/64,2a01:110:9008:1::/64,2a01:110:9008:2::/64,2a01:110:9008:3::/64,2a01:110:9008:4::/64,2a01:110:8012:1011::/64,2a01:110:8012:1012::/64,2a01:110:8012:1013::/64,2001:4898:e810:0::/64,2404:f801:8020::/48,2620:119:5000::/42,2a05:f507:0:100::/64,2a05:f507:a:1002::/64,2001:4898:a800:1014::/64,2001:4898:a800:1015::/64,2001:4898:80e8:11::/64,2001:4898:80e8:12::/64,2001:4898:80e8:13::/64,2001:4898:80e8:14::/64,2001:4898:80e8:15::/64,2001:4898:80e8:16::/64,2001:4898:80e8:17::/64,2001:4898:80e8:18::/64,2001:4898:80e8:19::/64,2001:4898:80e8:1a::/64,2001:4898:80e8:1b::/64,2001:4898:80e8:1c::/64,2001:4898:80e8:1d::/64,2001:4898:80e8:1e::/64,2001:4898:80e8:1f::/64,2001:4898:80e8:20::/64"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:19.8670764Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:24.961727Z"}},"identity":{"principalId":"74bbf45f-b373-4989-bc21-d99e0a7328ec","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR103-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR103-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-103_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e24b2791c9576d86","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"103"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"2001:4898:a800:1010::/64,2001:4898:a800:1012::/64,2001:4898:80e8::/64,2001:4898:80e8:1::/64,2405:2300:ff00::/42,2620:119:5042:900::/64,2a01:110:A008:4::/64,2001:4898:e008:1::/64,2001:4898:80e8:8::/64,2001:4898:80e8:9::/64,2001:4898:80e8:a::/64,2001:4898:80e8:b::/64,2001:4898:80e8:2::/64,2404:f801:8028:3::/64,2404:f801:8028:4::/64,2404:f801:9000:18::/64,2404:f801:9000:19::/64,2404:f801:8050:2::/64,2001:4898:80e8:3::/64,2001:4898:e810:2::/64,2a01:110:8012:1010::/64,2001:4898:e008:5::/64,2001:4898:e008:6::/64,2001:4898:e008:7::/64,2001:4898:e008:8::/64,2001:4898:e810:1::/64,2001:4898:e810:3::/64,2404:f801:8028:5::/64,2404:f801:8028:6::/64,2404:f801:8028:7::/64,2404:f801:8028:8::/64,2404:f801:8050:5::/64,2404:f801:8050:6::/64,2404:f801:8050:7::/64,2404:f801:8050:8::/64,2404:f801:9000:1c::/64,2404:f801:9000:1d::/64,2404:f801:9000:1e::/64,2404:f801:9000:1f::/64,2404:f801:e818:11::/64,2404:f801:e818:13::/64,2404:f801:e818:15::/64,2404:f801:e818:17::/64,2a01:110:8012:1014::/64,2a01:110:8012:1015::/64,2a01:110:8012:1016::/64,2a01:110:8012:1017::/64,2a01:110:9008:5::/64,2a01:110:9008:6::/64,2a01:110:9008:7::/64,2a01:110:9008:8::/64,2a01:110:A008:5::/64,2a01:110:A008:6::/64,2a01:110:A008:7::/64,2a01:110:A008:8::/64,2a01:110:A008:3::/64,2001:4898:80e8:4::/64,2001:4898:80e8:5::/64,2001:4898:80e8:6::/64,2001:4898:80e8:7::/64,2001:4898:80e8:c::/64,2001:4898:80e8:d::/64,2001:4898:80e8:e::/64,2001:4898:80e8:f::/64,2001:4898:e008:2::/64,2001:4898:e008:3::/64,2001:4898:e008:4::/64,2404:f801:8050:1::/64,2404:f801:8050:3::/64,2404:f801:8050:4::/64,2404:f801:8028:1::/64,2404:f801:8028:2::/64,2404:f801:9000:1a::/64,2404:f801:9000:1b::/64,2404:f801:e818:10::/64,2404:f801:e818:12::/64,2404:f801:e818:14::/64,2404:f801:e818:16::/64,2a01:110:A008:1::/64,2a01:110:A008:2::/64,2a01:110:9008:1::/64,2a01:110:9008:2::/64,2a01:110:9008:3::/64,2a01:110:9008:4::/64,2a01:110:8012:1011::/64,2a01:110:8012:1012::/64,2a01:110:8012:1013::/64,2001:4898:e810:0::/64,2404:f801:8020::/48,2620:119:5000::/42,2a05:f507:0:100::/64,2a05:f507:a:1002::/64,2001:4898:a800:1014::/64,2001:4898:a800:1015::/64,2001:4898:80e8:11::/64,2001:4898:80e8:12::/64,2001:4898:80e8:13::/64,2001:4898:80e8:14::/64,2001:4898:80e8:15::/64,2001:4898:80e8:16::/64,2001:4898:80e8:17::/64,2001:4898:80e8:18::/64,2001:4898:80e8:19::/64,2001:4898:80e8:1a::/64,2001:4898:80e8:1b::/64,2001:4898:80e8:1c::/64,2001:4898:80e8:1d::/64,2001:4898:80e8:1e::/64,2001:4898:80e8:1f::/64,2001:4898:80e8:20::/64"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:26.5867663Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"941c0157-bdd0-499a-aba0-be1244f82ab1","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR103-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR103-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-104_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8d69d8ee570b639","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"104"},"info":{"value":"Created
        by Azure Core Security managed policy to allow SAW devices, rule can be deleted
        but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"CorpNetSaw"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSSAW"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:18.8329406Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:25.8435749Z"}},"identity":{"principalId":"a77ffbc7-b084-468d-875e-dbd122b4b7c5","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR104-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR104-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-104_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/eed6a81371f5e28b","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"104"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"CorpNetSaw"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSSAW"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:28.448243Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"7951777e-acb7-4c1c-b131-aa2e639b0481","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR104-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR104-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-105_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/40879463350508de","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"105"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["1433","1434","3306","4333","5432","6379","7000","7001","7199","9042","9160","9300","16379","26379","27017"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDB"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:19.9418567Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:27.0544535Z"}},"identity":{"principalId":"6fee5e65-e3ce-4203-bbe7-9638bef24b64","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR105-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR105-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-105_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/9aca16db50fb914c","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"105"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["1433","1434","3306","4333","5432","6379","7000","7001","7199","9042","9160","9300","16379","26379","27017"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDB"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:28.4045187Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"439882e1-d603-45dd-9e62-8592309d7aa4","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR105-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR105-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-106_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b4482f205fb6bbc1","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"106"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22","3389"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSRDPSSH"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:25.4382874Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:28.9222764Z"}},"identity":{"principalId":"24f2734a-d905-44e7-9f15-28495f477c46","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR106-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR106-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-106_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8fdec1516a77bbd6","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"106"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22","3389"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSRDPSSH"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:30.062968Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"c1181647-15a3-4d44-ac0e-34c45c204d9f","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR106-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR106-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-107_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/f0e3de3e84e21226","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"107"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["23","135","445","5985","5986"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMgmt"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:26.3022159Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:32.9414212Z"}},"identity":{"principalId":"d0f248cb-c59d-4c09-a5be-a8dd9df03180","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR107-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR107-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-107_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/c4184f404efb2fe5","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"107"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["23","135","445","5985","5986"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMgmt"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:34.5057485Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"27b2ace7-5ddd-49c3-aa81-0e87abdb9724","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR107-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR107-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-108_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/ce4b13eba037b5cc","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"108"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["13","17","19","53","69","111","123","512","514","593","873","1900","5353","11211"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSHigh"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:27.0206425Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:33.6787688Z"}},"identity":{"principalId":"b3c84eaf-931a-4990-a80f-b579d6c45746","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR108-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR108-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-108_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/fc84f507da5fe442","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"108"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["13","17","19","53","69","111","123","512","514","593","873","1900","5353","11211"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSHigh"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:35.6670025Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"3de59bcf-93d8-4eff-95db-d6d9b8751eee","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR108-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR108-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-109_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8657a5b3e83f5307","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"109"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["119","137","138","139","161","162","389","636","2049","2301","2381","3268","5800","5900"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMedium"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:27.8186125Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:36.8151414Z"}},"identity":{"principalId":"927df340-8307-4434-a7fe-79e1d06c01c5","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR109-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR109-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-109_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/eb9b3ba85853f934","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"109"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["119","137","138","139","161","162","389","636","2049","2301","2381","3268","5800","5900"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMedium"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:38.357253Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"096e33bd-3978-4b72-bb81-aa4f21faa155","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR109-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR109-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/6221d088cd1bcdc3","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:29.793219Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:24.8452611Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSGS-AUDT-RULS-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSGS-AUDT-RULS-v012"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/f828e370e4aad7e8","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:26.9922117Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:27.3096342Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-SBNT-AUDT-NSG-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-SBNT-AUDT-NSG-v012"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-subnet_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/9644d220df7c67a","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus"]},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:11.3794009Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T19:20:20.6889912Z"}},"identity":{"principalId":"13c55e93-542e-463a-8a36-73d67f89ea1f","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-SBNT-DINE-NSG-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-SBNT-DINE-NSG-v011","location":"eastus"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '213590'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:08 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments?api-version=2019-01-01
  response:
    body:
      string: '{"value":[{"sku":{"name":"A1","tier":"Standard"},"properties":{"displayName":"ASC
        Default (subscription: 00000000-0000-0000-0000-000000000000)","policyDefinitionId":"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8","scope":"/subscriptions/00000000-0000-0000-0000-000000000000","parameters":{"diagnosticsLogsInServiceFabricMonitoringEffect":{"value":"AuditIfNotExists"},"systemUpdatesMonitoringEffect":{"value":"AuditIfNotExists"},"systemConfigurationsMonitoringEffect":{"value":"AuditIfNotExists"},"endpointProtectionMonitoringEffect":{"value":"AuditIfNotExists"},"diskEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"networkSecurityGroupsMonitoringEffect":{"value":"AuditIfNotExists"},"webApplicationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"sqlAuditingMonitoringEffect":{"value":"AuditIfNotExists"},"sqlEncryptionMonitoringEffect":{"value":"AuditIfNotExists"},"nextGenerationFirewallMonitoringEffect":{"value":"AuditIfNotExists"},"vulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"storageEncryptionMonitoringEffect":{"value":"Audit"},"jitNetworkAccessMonitoringEffect":{"value":"AuditIfNotExists"},"adaptiveApplicationControlsMonitoringEffect":{"value":"AuditIfNotExists"},"identityDesignateLessThanOwnersMonitoringEffect":{"value":"AuditIfNotExists"},"identityDesignateMoreThanOneOwnerMonitoringEffect":{"value":"AuditIfNotExists"},"identityEnableMFAForOwnerPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityEnableMFAForWritePermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityEnableMFAForReadPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveDeprecatedAccountMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect":{"value":"AuditIfNotExists"},"secureTransferToStorageAccountMonitoringEffect":{"value":"Audit"},"aadAuthenticationInSqlServerMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInRedisCacheMonitoringEffect":{"value":"Audit"},"clusterProtectionLevelInServiceFabricMonitoringEffect":{"value":"Audit"},"aadAuthenticationInServiceFabricMonitoringEffect":{"value":"Audit"},"diagnosticsLogsInServiceBusMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInDataLakeStoreMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInBatchAccountMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInEventHubMonitoringEffect":{"value":"AuditIfNotExists"},"metricAlertsInBatchAccountMonitoringEffect":{"value":"AuditIfNotExists"},"namespaceAuthorizationRulesInServiceBusMonitoringEffect":{"value":"Audit"},"disableUnrestrictedNetworkToStorageAccountMonitoringEffect":{"value":"Audit"},"classicComputeVMsMonitoringEffect":{"value":"Audit"},"classicStorageAccountsMonitoringEffect":{"value":"Audit"},"sqlDbVulnerabilityAssesmentMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInKeyVaultMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInStreamAnalyticsMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInSearchServiceMonitoringEffect":{"value":"AuditIfNotExists"},"diagnosticsLogsInLogicAppsMonitoringEffect":{"value":"AuditIfNotExists"}},"description":"This
        policy assignment was automatically created by Azure Security Center","metadata":{"assignedBy":"Security
        Center"}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn","type":"Microsoft.Authorization/policyAssignments","name":"SecurityCenterBuiltIn"},{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:08.9173801Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/74c98b59a6341488","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Batch Accounts
        must use a Pool Allocation Mode of User subscription on the Advanced tab to
        configure a VNet in the subscriptiong.  This enables the use of NSGs to secure
        the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.9760562Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.0025385Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/6bff79d27acb9c88","type":"Microsoft.Authorization/policyAssignments","name":"6bff79d27acb9c88"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b8f1faa61cb41f92","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"All C+AI Subscriptions
        must have a NSG on all VNets in the subscription.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.682075Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:40:00.2019682Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/aca4d19ab4e30392","type":"Microsoft.Authorization/policyAssignments","name":"aca4d19ab4e30392"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e695de0794b757d","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:59.5549343Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:15.3618916Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b65cf29bbd4b57d","type":"Microsoft.Authorization/policyAssignments","name":"b65cf29bbd4b57d"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"azuresecuritypackautoupdate_3.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policySetDefinitions/12d3b8c90bd0eaa8","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"AllowedLocations1":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest"]}},"description":"Combinations
        of multiple policies to enable auto update of security pack and geneva agent","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-12T00:29:59.4918191Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-20T00:37:57.8114005Z"}},"identity":{"principalId":"b70ee0cb-d1ca-4fc0-977a-c7f98d84d623","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/b74b3695477eaa8","type":"Microsoft.Authorization/policyAssignments","name":"b74b3695477eaa8","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/26db8d27b6fa91aa","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"Kubernets must
        use the Advanced Networking option to configure the Kubernetes cluster to
        use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:23:58.085345Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:32:55.6577715Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/bce5fcf8b40531aa","type":"Microsoft.Authorization/policyAssignments","name":"bce5fcf8b40531aa"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/11094169db59074f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["Central
        US EUAP","East US 2 EUAP","West Central US","North Central US","West US","East
        Asia","Australia Central","Australia East","Canada Central","North Europe","Central
        India","Japan East","Korea Central","UK South","UK South 2","Central US","East
        US","West US 2","France Central","Southeast Asia","Australia Central 2","Australia
        Southeast","Canada East","West Europe","South India","Japan West","Korea South","UK
        West","UK North","East US 2","South Central US","Brazil South","West India","France
        South","Global"]},"effect":{"value":"Audit"}},"description":"HDInsight Clusters
        must use the Custom configuration option to configure a VNet in the subscriptiong.  This
        enables the use of NSGs to secure the network traffic for the HDInsight cluster.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-04-01T22:24:01.3537501Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-04-02T04:38:59.5098707Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/fcbba78ebf3e874f","type":"Microsoft.Authorization/policyAssignments","name":"fcbba78ebf3e874f"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-batch-require-user-subscription-mode_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/891d9369d047f6ac","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"Batch
        Accounts must use a Pool Allocation Mode of User subscription on the Advanced
        tab to configure a VNet in the subscriptiong.  This enables the use of NSGs
        to secure the network traffic for the Batch Account.  See https://aka.ms/netiso/vnetinjection
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:24.2836979Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:34.2596619Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-BTCH-AUDT-VINJ-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-BTCH-AUDT-VINJ-v011"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-hdinsight-require-subnet_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b7a0969ff954eaf7","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"HDInsight
        Clusters must use the Custom configuration option to configure a VNet in the
        subscriptiong.  This enables the use of NSGs to secure the network traffic
        for the HDInsight cluster.  See https://aka.ms/netiso/vnetinjection for more
        details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:23.3038438Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:20.9625986Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-HDIN-AUDT-VINJ-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-HDIN-AUDT-VINJ-v011"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-kubernet-require-azure-networkplugin_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/88adc7594e846097","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"Kubernets
        must use the Advanced Networking option to configure the Kubernetes cluster
        to use a Virtual Network that is on the subscription of the user.  This enables
        the use of NSGs to secure the network traffic for the Kubernetes container.  See
        https://aka.ms/netiso/vnetinjection for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:24.8990144Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:21.2236207Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-KBNT-AUDT-VINJ-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-KBNT-AUDT-VINJ-v011"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-101_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/34612a1acdd0093","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"101"},"info":{"value":"Created
        by Azure Core Security managed policy to Allow Databricks IPs, rule can be
        deleted but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"13.70.105.50,13.71.184.74,13.75.218.172,13.78.19.235,23.100.0.135,23.101.152.95,40.70.58.221,40.83.178.242,40.85.223.25,40.118.174.12,51.140.203.27,51.140.204.4,52.187.0.85,52.187.145.107,52.232.19.246,52.246.160.72,104.211.89.81,104.211.101.14"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDatabricks"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:15.9530036Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:19.6332878Z"}},"identity":{"principalId":"77c75a6c-dd52-4bc9-8da9-e85128093422","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR101-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR101-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-101_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/5d9c8a259a63a29b","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"101"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"13.70.105.50,13.71.184.74,13.75.218.172,13.78.19.235,23.100.0.135,23.101.152.95,40.70.58.221,40.83.178.242,40.85.223.25,40.118.174.12,51.140.203.27,51.140.204.4,52.187.0.85,52.187.145.107,52.232.19.246,52.246.160.72,104.211.89.81,104.211.101.14"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDatabricks"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:21.6959438Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"21dda55b-ee95-4ba5-aace-58e017451c1d","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR101-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR101-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-102_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e788a85b5ac6ce0f","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"102"},"info":{"value":"Created
        by Azure Core Security managed policy, to allow Corpnet IPV4 addresses, rule
        can be deleted but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"8.39.53.12/32,20.42.25.133/32,40.90.6.0/24,40.91.77.216/32,40.91.93.196/32,40.91.95.146/32,40.91.114.244/32,40.91.115.44/32,52.151.243.229/32,52.188.221.200/32,65.54.12.0/25,65.54.13.0/24,65.55.188.0/24,65.113.36.85/32,66.119.150.128/25,70.42.230.0/23,91.225.250.8/32,94.245.87.0/24,104.44.112.0/24,131.107.147.0/24,131.107.159.0/24,131.107.160.0/24,131.107.174.0/24,144.2.236.0/25,144.2.237.0/25,144.2.238.0/25,144.2.239.0/25,157.58.30.0/23,157.58.35.0/26,157.58.192.0/19,167.220.0.0/23,167.220.2.0/24,167.220.24.0/22,167.220.56.0/21,167.220.64.0/19,167.220.98.0/23,167.220.100.0/22,167.220.104.0/23,167.220.107.0/24,167.220.148.0/23,167.220.152.0/24,167.220.196.0/23,167.220.226.0/23,167.220.232.0/22,167.220.237.128/27,167.220.238.0/24,167.220.242.0/24,167.220.248.32/27,167.220.248.96/27,167.220.253.128/29,167.220.255.0/25,167.220.255.128/26,191.234.97.0/25,194.69.98.0/23,194.69.102.0/23,194.69.104.0/25,194.69.104.128/26,194.69.105.32/27,194.69.105.64/27,194.69.126.128/27,194.69.126.224/27,194.69.127.0/27,194.69.127.96/27,194.69.127.144/29,202.4.184.29/32,207.46.216.0/23,216.52.20.0/25,216.52.21.0/25,216.52.22.0/25,216.52.23.0/25,217.29.149.150/32"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:18.017056Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:24.1040996Z"}},"identity":{"principalId":"46e4eded-d3e3-47e1-adcc-aafd62d4aa2b","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR102-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR102-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-102_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/21f42d11eb755867","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"102"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"8.39.53.12/32,20.42.25.133/32,40.90.6.0/24,40.91.77.216/32,40.91.93.196/32,40.91.95.146/32,40.91.114.244/32,40.91.115.44/32,52.151.243.229/32,52.188.221.200/32,65.54.12.0/25,65.54.13.0/24,65.55.188.0/24,65.113.36.85/32,66.119.150.128/25,70.42.230.0/23,91.225.250.8/32,94.245.87.0/24,104.44.112.0/24,131.107.147.0/24,131.107.159.0/24,131.107.160.0/24,131.107.174.0/24,144.2.236.0/25,144.2.237.0/25,144.2.238.0/25,144.2.239.0/25,157.58.30.0/23,157.58.35.0/26,157.58.192.0/19,167.220.0.0/23,167.220.2.0/24,167.220.24.0/22,167.220.56.0/21,167.220.64.0/19,167.220.98.0/23,167.220.100.0/22,167.220.104.0/23,167.220.107.0/24,167.220.148.0/23,167.220.152.0/24,167.220.196.0/23,167.220.226.0/23,167.220.232.0/22,167.220.237.128/27,167.220.238.0/24,167.220.242.0/24,167.220.248.32/27,167.220.248.96/27,167.220.253.128/29,167.220.255.0/25,167.220.255.128/26,191.234.97.0/25,194.69.98.0/23,194.69.102.0/23,194.69.104.0/25,194.69.104.128/26,194.69.105.32/27,194.69.105.64/27,194.69.126.128/27,194.69.126.224/27,194.69.127.0/27,194.69.127.96/27,194.69.127.144/29,202.4.184.29/32,207.46.216.0/23,216.52.20.0/25,216.52.21.0/25,216.52.22.0/25,216.52.23.0/25,217.29.149.150/32"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:25.8530713Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"4fd162ac-c74a-4e79-9952-81fff83cbeea","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR102-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR102-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-103_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/42c70bae0daee0b3","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"103"},"info":{"value":"Created
        by Azure Core Security managed policy, to allow Corpnet IPV6 rule can be deleted
        but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"2001:4898:a800:1010::/64,2001:4898:a800:1012::/64,2001:4898:80e8::/64,2001:4898:80e8:1::/64,2405:2300:ff00::/42,2620:119:5042:900::/64,2a01:110:A008:4::/64,2001:4898:e008:1::/64,2001:4898:80e8:8::/64,2001:4898:80e8:9::/64,2001:4898:80e8:a::/64,2001:4898:80e8:b::/64,2001:4898:80e8:2::/64,2404:f801:8028:3::/64,2404:f801:8028:4::/64,2404:f801:9000:18::/64,2404:f801:9000:19::/64,2404:f801:8050:2::/64,2001:4898:80e8:3::/64,2001:4898:e810:2::/64,2a01:110:8012:1010::/64,2001:4898:e008:5::/64,2001:4898:e008:6::/64,2001:4898:e008:7::/64,2001:4898:e008:8::/64,2001:4898:e810:1::/64,2001:4898:e810:3::/64,2404:f801:8028:5::/64,2404:f801:8028:6::/64,2404:f801:8028:7::/64,2404:f801:8028:8::/64,2404:f801:8050:5::/64,2404:f801:8050:6::/64,2404:f801:8050:7::/64,2404:f801:8050:8::/64,2404:f801:9000:1c::/64,2404:f801:9000:1d::/64,2404:f801:9000:1e::/64,2404:f801:9000:1f::/64,2404:f801:e818:11::/64,2404:f801:e818:13::/64,2404:f801:e818:15::/64,2404:f801:e818:17::/64,2a01:110:8012:1014::/64,2a01:110:8012:1015::/64,2a01:110:8012:1016::/64,2a01:110:8012:1017::/64,2a01:110:9008:5::/64,2a01:110:9008:6::/64,2a01:110:9008:7::/64,2a01:110:9008:8::/64,2a01:110:A008:5::/64,2a01:110:A008:6::/64,2a01:110:A008:7::/64,2a01:110:A008:8::/64,2a01:110:A008:3::/64,2001:4898:80e8:4::/64,2001:4898:80e8:5::/64,2001:4898:80e8:6::/64,2001:4898:80e8:7::/64,2001:4898:80e8:c::/64,2001:4898:80e8:d::/64,2001:4898:80e8:e::/64,2001:4898:80e8:f::/64,2001:4898:e008:2::/64,2001:4898:e008:3::/64,2001:4898:e008:4::/64,2404:f801:8050:1::/64,2404:f801:8050:3::/64,2404:f801:8050:4::/64,2404:f801:8028:1::/64,2404:f801:8028:2::/64,2404:f801:9000:1a::/64,2404:f801:9000:1b::/64,2404:f801:e818:10::/64,2404:f801:e818:12::/64,2404:f801:e818:14::/64,2404:f801:e818:16::/64,2a01:110:A008:1::/64,2a01:110:A008:2::/64,2a01:110:9008:1::/64,2a01:110:9008:2::/64,2a01:110:9008:3::/64,2a01:110:9008:4::/64,2a01:110:8012:1011::/64,2a01:110:8012:1012::/64,2a01:110:8012:1013::/64,2001:4898:e810:0::/64,2404:f801:8020::/48,2620:119:5000::/42,2a05:f507:0:100::/64,2a05:f507:a:1002::/64,2001:4898:a800:1014::/64,2001:4898:a800:1015::/64,2001:4898:80e8:11::/64,2001:4898:80e8:12::/64,2001:4898:80e8:13::/64,2001:4898:80e8:14::/64,2001:4898:80e8:15::/64,2001:4898:80e8:16::/64,2001:4898:80e8:17::/64,2001:4898:80e8:18::/64,2001:4898:80e8:19::/64,2001:4898:80e8:1a::/64,2001:4898:80e8:1b::/64,2001:4898:80e8:1c::/64,2001:4898:80e8:1d::/64,2001:4898:80e8:1e::/64,2001:4898:80e8:1f::/64,2001:4898:80e8:20::/64"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:19.8670764Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:24.961727Z"}},"identity":{"principalId":"74bbf45f-b373-4989-bc21-d99e0a7328ec","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR103-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR103-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-103_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/e24b2791c9576d86","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"103"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"IP
        Addresses"},"sourceValue":{"value":"2001:4898:a800:1010::/64,2001:4898:a800:1012::/64,2001:4898:80e8::/64,2001:4898:80e8:1::/64,2405:2300:ff00::/42,2620:119:5042:900::/64,2a01:110:A008:4::/64,2001:4898:e008:1::/64,2001:4898:80e8:8::/64,2001:4898:80e8:9::/64,2001:4898:80e8:a::/64,2001:4898:80e8:b::/64,2001:4898:80e8:2::/64,2404:f801:8028:3::/64,2404:f801:8028:4::/64,2404:f801:9000:18::/64,2404:f801:9000:19::/64,2404:f801:8050:2::/64,2001:4898:80e8:3::/64,2001:4898:e810:2::/64,2a01:110:8012:1010::/64,2001:4898:e008:5::/64,2001:4898:e008:6::/64,2001:4898:e008:7::/64,2001:4898:e008:8::/64,2001:4898:e810:1::/64,2001:4898:e810:3::/64,2404:f801:8028:5::/64,2404:f801:8028:6::/64,2404:f801:8028:7::/64,2404:f801:8028:8::/64,2404:f801:8050:5::/64,2404:f801:8050:6::/64,2404:f801:8050:7::/64,2404:f801:8050:8::/64,2404:f801:9000:1c::/64,2404:f801:9000:1d::/64,2404:f801:9000:1e::/64,2404:f801:9000:1f::/64,2404:f801:e818:11::/64,2404:f801:e818:13::/64,2404:f801:e818:15::/64,2404:f801:e818:17::/64,2a01:110:8012:1014::/64,2a01:110:8012:1015::/64,2a01:110:8012:1016::/64,2a01:110:8012:1017::/64,2a01:110:9008:5::/64,2a01:110:9008:6::/64,2a01:110:9008:7::/64,2a01:110:9008:8::/64,2a01:110:A008:5::/64,2a01:110:A008:6::/64,2a01:110:A008:7::/64,2a01:110:A008:8::/64,2a01:110:A008:3::/64,2001:4898:80e8:4::/64,2001:4898:80e8:5::/64,2001:4898:80e8:6::/64,2001:4898:80e8:7::/64,2001:4898:80e8:c::/64,2001:4898:80e8:d::/64,2001:4898:80e8:e::/64,2001:4898:80e8:f::/64,2001:4898:e008:2::/64,2001:4898:e008:3::/64,2001:4898:e008:4::/64,2404:f801:8050:1::/64,2404:f801:8050:3::/64,2404:f801:8050:4::/64,2404:f801:8028:1::/64,2404:f801:8028:2::/64,2404:f801:9000:1a::/64,2404:f801:9000:1b::/64,2404:f801:e818:10::/64,2404:f801:e818:12::/64,2404:f801:e818:14::/64,2404:f801:e818:16::/64,2a01:110:A008:1::/64,2a01:110:A008:2::/64,2a01:110:9008:1::/64,2a01:110:9008:2::/64,2a01:110:9008:3::/64,2a01:110:9008:4::/64,2a01:110:8012:1011::/64,2a01:110:8012:1012::/64,2a01:110:8012:1013::/64,2001:4898:e810:0::/64,2404:f801:8020::/48,2620:119:5000::/42,2a05:f507:0:100::/64,2a05:f507:a:1002::/64,2001:4898:a800:1014::/64,2001:4898:a800:1015::/64,2001:4898:80e8:11::/64,2001:4898:80e8:12::/64,2001:4898:80e8:13::/64,2001:4898:80e8:14::/64,2001:4898:80e8:15::/64,2001:4898:80e8:16::/64,2001:4898:80e8:17::/64,2001:4898:80e8:18::/64,2001:4898:80e8:19::/64,2001:4898:80e8:1a::/64,2001:4898:80e8:1b::/64,2001:4898:80e8:1c::/64,2001:4898:80e8:1d::/64,2001:4898:80e8:1e::/64,2001:4898:80e8:1f::/64,2001:4898:80e8:20::/64"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSCorp"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:26.5867663Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"941c0157-bdd0-499a-aba0-be1244f82ab1","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR103-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR103-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-104_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8d69d8ee570b639","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"104"},"info":{"value":"Created
        by Azure Core Security managed policy to allow SAW devices, rule can be deleted
        but do not change source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"CorpNetSaw"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSSAW"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:18.8329406Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:25.8435749Z"}},"identity":{"principalId":"a77ffbc7-b084-468d-875e-dbd122b4b7c5","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR104-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR104-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-104_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/eed6a81371f5e28b","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"104"},"info":{"value":"Created
        by Azure Core Security managed policy, rule can be deleted but do not change
        source ips, please see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["*"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"CorpNetSaw"},"actionValue":{"value":"Allow"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSSAW"},"subscriptionExclusions":{"value":["e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:28.448243Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"7951777e-acb7-4c1c-b131-aa2e639b0481","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR104-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR104-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-105_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/40879463350508de","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"105"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["1433","1434","3306","4333","5432","6379","7000","7001","7199","9042","9160","9300","16379","26379","27017"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDB"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:19.9418567Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:27.0544535Z"}},"identity":{"principalId":"6fee5e65-e3ce-4203-bbe7-9638bef24b64","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR105-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR105-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-105_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/9aca16db50fb914c","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"105"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["1433","1434","3306","4333","5432","6379","7000","7001","7199","9042","9160","9300","16379","26379","27017"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSDB"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:28.4045187Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"439882e1-d603-45dd-9e62-8592309d7aa4","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR105-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR105-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-106_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/b4482f205fb6bbc1","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"106"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22","3389"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSRDPSSH"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:25.4382874Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:28.9222764Z"}},"identity":{"principalId":"24f2734a-d905-44e7-9f15-28495f477c46","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR106-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR106-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-106_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8fdec1516a77bbd6","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"106"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["22","3389"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSRDPSSH"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:30.062968Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"c1181647-15a3-4d44-ac0e-34c45c204d9f","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR106-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR106-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-107_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/f0e3de3e84e21226","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"107"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["23","135","445","5985","5986"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMgmt"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:26.3022159Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:32.9414212Z"}},"identity":{"principalId":"d0f248cb-c59d-4c09-a5be-a8dd9df03180","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR107-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR107-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-107_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/c4184f404efb2fe5","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"107"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["23","135","445","5985","5986"]},"protocol":{"value":"Tcp"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMgmt"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:34.5057485Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"27b2ace7-5ddd-49c3-aa81-0e87abdb9724","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR107-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR107-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-108_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/ce4b13eba037b5cc","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"108"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["13","17","19","53","69","111","123","512","514","593","873","1900","5353","11211"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSHigh"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:27.0206425Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:33.6787688Z"}},"identity":{"principalId":"b3c84eaf-931a-4990-a80f-b579d6c45746","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR108-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR108-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-108_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/fc84f507da5fe442","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"108"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["13","17","19","53","69","111","123","512","514","593","873","1900","5353","11211"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSHigh"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:35.6670025Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"3de59bcf-93d8-4eff-95db-d6d9b8751eee","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR108-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR108-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-109_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/8657a5b3e83f5307","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":[]},"ruleNo":{"value":"109"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["119","137","138","139","161","162","389","636","2049","2301","2381","3268","5800","5900"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMedium"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:27.8186125Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T18:15:36.8151414Z"}},"identity":{"principalId":"927df340-8307-4434-a7fe-79e1d06c01c5","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR109-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR109-v011","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-rule-109_1.2","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/eb9b3ba85853f934","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap"]},"ruleNo":{"value":"109"},"info":{"value":"DO
        NOT DELETE - Will result in ICM Sev 2 - Azure Core Security, see aka.ms/cainsgpolicy"},"destinationPortRanges":{"value":["119","137","138","139","161","162","389","636","2049","2301","2381","3268","5800","5900"]},"protocol":{"value":"*"},"sourceType":{"value":"Service
        Tag"},"sourceValue":{"value":"Internet"},"actionValue":{"value":"Deny"},"direction":{"value":"Inbound"},"tagname":{"value":"SkipNRMSMedium"},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-09T18:15:38.357253Z","updatedBy":null,"updatedOn":null}},"identity":{"principalId":"096e33bd-3978-4b72-bb81-aa4f21faa155","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSG-DINE-SR109-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSG-DINE-SR109-v012","location":"eastus"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-warning-non-c+ai-security-rules_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/6221d088cd1bcdc3","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"},"priorities":{"value":["100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119"]}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:29.793219Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:24.8452611Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-NSGS-AUDT-RULS-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-NSGS-AUDT-RULS-v012"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-subnet-require-nsg_1.0","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/f828e370e4aad7e8","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus","northcentralus","westus","eastasia","australiacentral","australiaeast","canadacentral","northeurope","centralindia","japaneast","koreacentral","uksouth","centralus","eastus","westus2","francecentral","southafricanorth","southeastasia","australiacentral2","australiasoutheast","canadaeast","westeurope","southindia","japanwest","koreasouth","ukwest","eastus2","southcentralus","brazilsouth","westindia","francesouth","southafricawest","global"]},"effect":{"value":"Audit"}},"description":"All
        C+AI Subscriptions must have a NSG on all VNets in the subscription.  See
        https://aka.ms/netiso/nsgs for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-06-26T21:23:26.9922117Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-06-27T03:24:27.3096342Z"}},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-SBNT-AUDT-NSG-v012","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-SBNT-AUDT-NSG-v012"},{"sku":{"name":"A0","tier":"Free"},"properties":{"displayName":"nrms-nsg-subnet_1.1","policyDefinitionId":"/providers/Microsoft.Management/managementgroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyDefinitions/9644d220df7c67a","scope":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792","parameters":{"allowedLocations":{"value":["centraluseuap","eastus2euap","westcentralus"]},"subscriptionExclusions":{"value":["61868ab8-16d4-44ec-a9ff-f35d05922847","41c39ac7-6cde-4be7-87c3-d57a168b7b92","235d341f-7fb9-435c-9bdc-034b7306c9b4","239b3f1a-daab-4125-918c-f028b0edb054","12f44720-8952-422c-bb7d-28831c2de639","c36fd9e7-e5b1-4d3e-bb85-2e538040258b","243b67d4-60ca-4dfd-a556-216ee06f77a1","24ae0a2f-2cb0-4a1a-9929-bed71bad0d59","b4582baf-35d9-47b9-b03d-1bd126876221","65f79f71-cb42-45b1-82b7-4635fd05fc26","9532a63e-f2eb-4649-bb23-5ed01077ce80","1533031f-9510-4d8d-8f83-af94df45d43c","73d25f92-e703-4c91-8aed-2fb23c8e151f","86d6f8d7-564b-4005-912c-b1a3a9a286ce","97a3d790-8d62-4f20-b579-39ee6b06cb45","179be307-0377-46c0-a8bb-17437582d266","6c516c14-f378-4780-bc52-dd1d098a9c0b","cc5e1d36-a80d-4878-add9-5204a7efda20","0bf83929-3a19-4a96-87da-b23c3aca7fd7","ad7af743-6a66-480e-98cd-e022f833d0ce","0cfe98e1-3cf6-41ca-9f54-435d1ddaf0de","ce6570fa-18fb-4503-80d9-4a225591a428","2f8446c7-7c1e-42f0-a6b7-d68df1255cc4","ff78024c-d5a1-48ae-88eb-d61f0f60f8ff","bdd789f3-d9d1-4bea-ac14-30a39ed66d33","6fe0c04c-acb9-4f74-8153-56a6cb666ca8","7fa88f8d-252c-4b22-a73e-cd77f85cca66","bafb24c9-f4bb-46a0-9891-4b3e12dab22e","aab411af-ed4d-4f02-bb87-5de8b00d880d","7e7b7a6f-0b34-4db9-958d-ece4c89b419f","964c10bb-8a6c-43bc-83d3-6b318c6c7305","7b29bb4e-8391-4d57-8045-b34a092e5108","3f706ca0-34d7-4ede-a432-3c1a37ddd5c6","7856cb6f-e1a8-48f2-b2a5-bfaa7f8c34a1","49e3ed89-bbdb-4545-844f-e3502d6ce44f","8cad7ef7-ae41-4adf-86b8-ffcb11fae200","8e9ec0f8-bfe6-43a5-acd2-b6c4666ef9f6","b8fc6ee8-6802-4605-b4a5-1d131084c62f","45493131-fef6-4cb1-80e9-f0dadaa0255a","9c8295ef-4bf7-49db-90aa-5f0837dc60b7","ed0b2672-8412-463f-a0c1-1867730d7e27","7f31cba8-b597-4129-b158-8f21a7395bd0","3b658bfc-dbb0-4f7a-9e6c-a7659ade3514","825d553e-1fdf-4961-8f6b-bab24c6b07a7","477d55b5-bef1-4c35-b8bd-42df6ef99d25","0cd887ff-5af0-405b-8d48-b2b0495af57b","4259a25b-fc62-41d0-a101-60bfaab38086","3ae1ab9b-5849-4409-b744-58ba98878274","8d8d3365-2fab-415f-862e-712d989871b2","1ef6f67e-7981-498c-8349-b67109d0fd0f","e9b95386-37fe-4820-9dc6-30a44fbeafba","f9e81224-18f1-4474-80b5-bd6b832f0b73","f0b97671-152e-45cc-a831-73fd5caa8740","d4c1893d-adf1-4111-aaa3-93d55a4059b9","2d3ea1e9-269c-4fd1-8878-21e84bf9d214","1267b3e1-8812-4435-82ff-9e57f390c194","38c49794-e385-48e6-b6ee-c42b9f2075be","2843db96-7d25-4cf5-8e67-71baed52dfb7","a531aaa4-20f4-40e6-ba1a-858a0359f602","b835f458-560c-49c2-8781-4b13d892ddd9","e4d287eb-a38c-4387-832a-e3c61ea576bd","af878dc5-7fe2-4698-b7fb-2ed4b2ffe4db","26d6d535-5164-443d-82f6-4c695caf7688","d862948f-6520-451f-af67-123309e4e4ce","ff96a11f-784d-4c26-94c7-34346d4d660e","38b241a5-8658-4b50-bfba-1800ee2d4d09","28f78ae5-97b2-487e-b097-270de10ce6b8","6c048bcd-2cc6-47fe-a558-ca54083d537e","62fc3d9a-b8ab-47e7-8df1-be09f78bb25a","48aae13c-e8a8-4057-a5d5-f77eaa56f1fd","b30d9dbd-c0f7-405f-902c-3eabd080eb00","aa858381-0720-4837-b0f8-60468c0b2763","7e6898e7-868d-490f-8f91-0cffa67c48a0","816e6e0f-a719-487e-a651-813f40cc95c5","aeaa528b-2620-42a7-bbe8-17b698d42530","9c870d54-05fd-46bb-9bb5-63a5756320a0","36e4aeae-caae-4cd6-8d6b-7015355c6229","d53f365b-64c6-45fa-9253-99fc92dfae5d","6b7b20bf-f54b-4a3d-9961-c85fbe894b67","875bd0a7-0adc-4391-8b42-85e866e87e5d","97454014-0118-4294-9648-938eb8f52327","de1883af-a411-450a-8c9f-55b07d48cd60","991af618-96d9-4bc0-879d-0e13ac6020c1","21eedfa4-4dc5-4056-bdba-dcfaf3b1a222","0e57ff86-19ec-4f88-8403-879bd0d64af8","31c8019a-6c01-4c1d-9a04-6bbd091e8ccd","52ce96d0-a12d-4e17-9644-50e0059a7730","f5f248fd-943d-477b-a9d2-de3db83d7712","c4ae973f-3a15-4409-a6cc-9cc91147f42e","ed10ec26-e9a9-40ba-85df-2d7e2dec7765","a083c30e-d4e5-4dc1-b310-02aaf36b316a","c1fd1678-d0fe-4253-a15f-a03eee323432","a013b98a-6c2a-4f92-a6a7-82266ac6f437","ef7a7954-0173-4574-86a1-486e015ab617","ded8fcaf-289f-40bd-b124-572d3d4f58ed","178b7546-3fed-4e8a-b001-9c71b1051ce9","f2b7f785-c33d-471f-bb13-57d62e83af62","a226aace-1c2d-4a53-96a3-de0ea8f3e4ad","b909342e-42c0-423e-8815-ea07509e27f9","9d124ad5-c7de-4c56-8ffe-0f3f6566d3b3","ddc736d4-2fe4-44ad-8b82-080913c64b79","ea406f31-bf7a-4139-a444-1f23847f1350","66affadd-ce7e-4ac3-a16c-d85dc2d07544","d0e65693-60a1-438c-be56-2225cf43d568","902dc4d6-9ae1-4141-ac1b-ca5b3071cd63","cac63bb3-1459-4b23-a864-f2ea6c6456e9","2fa553a5-a443-4f09-bd4c-dbc9ded93a1c","9d7c4ce2-5443-4499-a07a-695894000463","3814aaea-6bb6-4e31-b3c4-45e761c8d6d1","9d0fe465-cebe-41a0-afc4-e49fe70dee55","2edae715-e43e-471a-9b6d-a6bc52a395c0","c7d2e450-636b-443d-b737-5e2708629ea1","4bb073a1-ad47-4f14-bfa6-9ffd55ea8f81","0fbc3fc8-1bcd-433d-a6f0-b96ca76c60dc","f3d00ca5-7ce1-4562-8160-2a856dd6d1f3","1c91c686-b0d1-4f51-8784-9eee52c07b7e","c1089427-83d3-4286-9f35-5af546a6eb67","ec716296-0c8d-410a-8666-1eff05989831","c31ad117-e07c-4388-9148-387a2ba72135","c9802e4f-0860-43a1-b3ed-37d3ae8cdf92","708474aa-31a7-4dbd-a106-84de1043185d","f6470ed6-05de-421c-bae8-184d8d28be10","17cfecb9-1a5f-4b8b-a32f-119de8c44f5a","70d2f261-7253-4b1a-a52a-406e7a328c33","2fda68f7-567f-4c8f-b0b7-f4b6a5988e84","86b0b59c-8538-4aa6-90f6-ce8329258bb2","8ecadfc9-d1a3-4ea4-b844-0d9f87e4d7c8","433e1858-1953-42b2-a9dd-d7601c25d347","bb1216b4-4400-422b-8a67-8a80a9c88d5e","cf5e3b9b-595a-499d-8669-00b88b449213","e01c1ddb-8025-491a-986d-c249fa9a69a0","9d71e31b-7356-4d2d-a6e9-d588fc7692c2","c6e602bd-0d12-4265-bebc-cb208dd5030f","e929be23-7420-44f3-bd80-810a56d06e1e","46b59458-3f32-4f06-b6a2-bd27dda4305c","14cff334-91a5-4d9d-bf42-39c6d630d37c","80c8978c-c1c6-4f9e-94cd-874798b05935","f9da0435-3452-483a-a5f4-743988dc6b1d","0f1325ea-bcfe-4b02-a303-baaefb80a9f9","70407fa2-4234-4266-812c-d70754ed228c","41e806f1-99ee-4c48-9ce8-379068350924","7b6fdce7-2d25-4c7f-b8c1-004a375626cb","4a725092-b458-4dc2-9ae9-f8f0e7d415dc","178b2260-bd62-4372-ab30-7cf02b6a3108","d9964125-396a-4343-8d4e-b16c0281ae58","4df9862d-6ce3-486d-a4e1-8b246cb08f79","db205d1d-a8b1-49e1-8d5a-4f5b5ae39169","363499fe-248b-4624-ba5b-5f477bb924f4","9eefe291-18db-46f1-b308-4d7851fa270d","e4e0b3b0-1587-400f-95f9-1bb605a252c2","139c34d4-91bf-42c9-8dc5-b6c37f9ac517","8ab2ca47-1f5f-4936-8f37-c5780ff265d0","511013e8-8a72-4ddf-a9b4-1a9bb3a5fa6a","0a5044a6-a614-40e1-97e0-20af784237ea","a3fcf642-fa77-4d3c-886e-527258f00e72","4f6cdb57-2658-40b9-8adc-1b2ddf7dd7a2","df39322a-6ecd-418b-828d-09fd796dc10a","e1cb07f7-a3ac-4110-9d24-218d93bfa6f9","91280670-dbb5-4fcd-8dc3-dc9d53d94805","90b505b3-1abf-455b-af4d-f08d1135cf33","850d8476-e5fc-4059-9aed-9aeee349c384","ae2dd76f-0dd4-4484-b957-6700179f183f","9fb58da5-7347-4dbf-a892-7c933e5d7776","fc4ea3c9-1d30-4f18-b33b-7404e7da0123","693ffe34-785e-44cd-8fb7-81da25f4d3bd","3e272a96-8781-45f2-8378-6ffaa1596bcc","f2124ee6-885b-4aa6-885d-793c8626b87c","47ff8d6e-e419-464f-8940-dfa750f2115d","18f0638d-ad9b-460a-bd8b-61f12d998d0c","48021fc6-c9c8-4568-8c29-953aad4d1e0a","df41dfd5-a3a6-4c35-a58e-9b6ac732236e","1da3ace1-2326-4842-ba52-0e3a8dce989e","68f6be96-60c4-40f5-a14e-2a04dcacc1a6","5833e0eb-b53c-4156-b478-2eac8f04aec6","34530d5b-398d-496e-88d0-07a6e3de107e","4f698849-a196-4c80-be45-52d507ffb2d4","43350253-f84c-4fb3-a988-cc63366cc570","d466671a-79ad-4ca5-878f-599df8bcd17e","5ea9ae04-3601-468a-ba84-cb7e82ae1e48","31614129-0f24-4a4c-9731-53ceecc3017d","990d87fa-2d5a-48cc-bdff-0d3c6b9dd32d","5a2d898e-7f0b-43fd-8e0e-2b517b736499","16fc4a98-74ad-4970-9857-74d0f39a6c64","47380de2-eddf-42b2-b853-434cde2b5fa0","947d47b4-7883-4bb9-9d85-c5e8e2f572ce","8ca10d88-d6ce-458e-b707-a00f3b6183fd","76fb3144-bc19-4baf-ab79-432d526559b7","da07f543-88e8-4349-b9e1-2d135eb818c2","360cdc41-af67-426b-9249-b46077592db4","13973b32-e60a-4396-bf7a-85f0670d658d","b50578f7-df0d-4152-892d-ad77b284e233","0e584a02-5f47-4317-b102-9665aa08fc7d","83db2801-3fb7-4fda-9c88-227effca791f","ef378126-746c-42ef-87ea-83624095a7cc","6e793a99-19b9-4ac5-8f6a-709fd4da0b49","7bfee1d3-395f-414a-b76a-203385a535b8","100919d5-c4a2-4894-a3d7-83a8534dee66","00a794e2-f9ed-41f6-b2a3-444ec0b61131","3dfa5f20-e79c-437f-add7-0a2ade4379aa","359833f5-8592-40b6-8175-edc664e2196a","fddd10df-2a17-496f-8f2c-40845adac181","301ad868-469e-494a-948f-5212604443f0","9afb6667-24a4-456b-8720-48d5b530a003","05b724b7-9613-42c0-a5d1-45f2a0b40efd","5bb8c800-7777-43d0-a2ad-e8fae03ed3b7","b614deb1-8c61-4b74-9e54-f2c4ba8658af","6fd29849-b584-40ea-82c1-c908b83efd3f","921c46aa-ffa6-4d3b-9be2-b0affd7142d7","62ba464b-5e1c-468d-9a1f-9ddcd1053d68","5c0d4798-3eef-449f-9bfd-58d59fe6ff28","c90dc44b-a834-4a18-b728-b0631c14afa9","6a13868b-c532-4562-9131-5c866bddacf9","c33d86ef-305d-408c-87a2-b014fbcf2e16","7fe76de7-a6e6-491a-b482-449cec7c91fd","673fd28e-faab-4725-9bf4-a59b317f8f93","62f44dee-82b5-4a2f-896e-c2d132a4e415","8643025a-c059-4a48-85d0-d76f51d63a74","26fe00f8-9173-4872-9134-bb1d2e00343a","af599e54-878e-494d-8a8f-b8f8d8896f1a","c4c3550e-a965-4993-a50c-628fd38cd3e1","ab699598-7d66-4003-a0aa-86a0f827bbbf","6cedb63e-a5a2-4d1b-bf27-71f3688871ee","f3b504bb-826e-46c7-a1b7-674a5a0ae43a","9f9df1fb-cf10-42f4-b684-3913a492cc6d","be3bb907-a9fa-4b85-a21b-3154efeb0196","460397b3-c4d8-441c-9d4a-9374b15850d3","7b8aa759-d584-418d-b7e7-99e07cb45bc0","97f95e63-ac5d-4ad4-96ba-a5be9131f52b","86fe5e45-3696-4c0e-b88a-cf350e31ee68","bf0d72cc-0680-4042-bd37-2ff5d224c8d3","566c16c0-5a70-4062-80eb-42c00c823556","5bbcca67-469c-4af6-aa1f-f12014aa4747","e88da25c-3aa8-47a6-86d7-c9b2230171d8","4279e979-0fe8-4bba-8a79-e0012d33d2f7","7d3f20f0-ba46-4205-8bfa-508d47dec375","effdf562-0b65-48b3-bc44-bd406ceeb4c0","0af6e6ec-18c4-4cd6-97de-655d15eda26d","fc71d843-9b8c-4c31-a691-e34f2bf61a58","5d264b2d-d8de-4dce-8e0f-57a40c037732","facdd972-8587-42d9-94db-fea86c95f74b","04a198f4-df84-4ecf-8114-648150edc5f6","c707a0ae-7ee9-4d7a-9262-8cc87c7444ef","0944cf9e-9f5a-4cc8-a6bb-982a82145e32","0dea505e-f72c-4939-91fb-c5d318d31cbd","16018ead-6f73-447d-a422-e5895ea2f1e8","4110a755-2084-451d-a03f-2267f377e37a","c44b3809-aa60-4e78-ad0c-fc02ae6b0fb9","9f657a3d-7377-48a8-b6a3-b5a871d58953","02c0fdb9-19a4-4156-9d06-b8aa940e792a","fd78894d-5436-4f66-907a-9ef485a20d7f","11199e7d-90dd-47b0-9da2-1fc58ed7e9b7","51deb6a1-950b-4cd2-8c66-4a0b5a37291b","5eed6188-c6d6-4966-9543-28b3c88ee4e1","e51231c2-1e1d-4b36-9499-4761c759c21d","599ba755-215c-4d72-a152-5e902c03e753","9d21bfc7-b04f-4615-93d5-eb79e9e217e2","1fa05968-fc4e-4728-bf0e-c48de37a2ae1","73c521c0-1787-493e-845e-89b957b58b8b","c570afbe-46af-4d76-b23b-6e16d8d57df4","85d99e6d-f6d6-408f-a9f1-b7a97237d5c4","227e9423-1792-43b0-82e6-ac94397ed789","bc018f2c-f33c-4f25-bffb-34f3da74d2db","cfd6dc82-faa9-4f51-8534-964917ca7666","5ea8beca-77b8-44cb-8871-93620f04a6e7","7cbc7e85-a998-4d7c-bc89-78fbd0df6e8c","f35ee5d5-f4eb-42c4-a2bb-0f3c706afee7","5f94ce71-7492-4d10-ae80-3482646ca6cd","5299e6b7-b23b-46c8-8277-dc1147807117","c0f60687-8f09-4186-801b-9dd11d82d2e1","1400552c-6fe7-4bbd-a3ca-59ffea564316","ef686670-a2cc-4aec-89bf-8a67c4033507","ced133bc-30d4-48de-b239-78e9fe91c8c0","ba9770c6-6fb6-480b-9fcd-ee2ca1d7b0d6","3778be8b-3cde-493e-8ebc-a6c3f9be6129","5ce1ccad-10d3-4d04-a455-4ab42ee64a61","70d2b6ec-b846-43dc-b4f7-1a84ff24a176","0302f714-23e2-4c23-bd45-d1c97c1c1000","8c4b4f4e-6bf7-4da8-a51a-d341baf3ce44","eba5c6e7-188e-488f-a40d-0f14e1edf190","664a82c2-8810-4432-b9c4-bc5be3f7a0a6","1ef94f5a-a930-4996-9ddb-1dca7c74d040","12df5617-a0af-48ca-bf2c-4bcca863fd84","c80801f3-5848-4f8f-9c7a-dc0052a3655d","fb3429ab-83d0-4bed-95e9-1a8e9455252c","e05dbbce-79c2-45a2-a7ef-f1058856feb3","4bb527f3-5718-477f-93ae-96a00a4944fe","cafc4bb9-6584-480c-b992-c6643801be41","ba4c5917-5ba3-495b-857c-af2642a5b115","e4b5cac5-c0f5-4618-aa98-3c01e18c5fde","e6fd4e44-694e-4e30-b72a-7da4ef662a29","6b82129a-13ef-4554-93a5-17cda6672746","5f14ad42-7fae-4258-b7bf-ab24eb46988d","548801a8-a653-452a-b883-db65b6d06fac","0afea355-fcdc-47a0-a82c-f5436b883790","184ca802-aa58-44e3-96a1-5905c23d9364","50dc548d-0c1f-41c5-bf52-cb6957d9d052","82be74c1-6520-4ab5-b10e-fc17162b8c86","b69ac3e7-4dd7-45e8-ad79-2bf1d780f221","d2da8762-d5bc-4197-94d0-8c298fc6e5ed","c1b0ff3b-5ef1-4cf6-b723-64c216558172","08ea33e0-01df-4486-88f0-e1f35de8ca0b","cabab48d-da29-4857-88f0-789518f35342","a3ea6660-0f26-4ca7-8772-09c454995588","406307ea-f1c6-4592-b338-fdf958e300e6","3b98cb2d-64df-4532-a36a-b835b0494744","076cf91a-5eb9-4ee2-9bbf-647e8d818ddb","3742010c-b092-4f45-9448-d0ba8d14c7b8","148e2723-a8b5-4bac-ba2a-02ee22afe3dc","c8cf041f-6c65-4e3a-b304-e0b7cfe5a7a8","4aafbb38-45c3-4510-a4fb-79ddee4609e1","9295f662-1576-4cd9-ae2c-e5b98e004013","caa10cde-996e-4f8d-adfb-d7e3d8046726","73992542-7eea-446a-a813-be9be977a1e9","800d0ed9-5ab9-43c2-b9bf-65bb3d740822","75cbd5cd-883c-4b21-a7f7-cd7f4862c796","4f15c6a9-03c7-4290-a534-d8125d5cf9c0","e1f7972d-096f-4309-8ff3-e95fc6e290be","b88ac08b-1838-4987-8510-5d098e4e029b","bbeb12ae-8826-49e2-b9c1-efb3c49c336e","7c2068ba-d812-424b-bb7f-59445cac4081","ce7feb1b-c0e1-4a8e-a841-3711b1bee26d","07fd3b0d-1350-46c2-91be-bf586c46e878","e76d4f0e-1cbc-4afb-85f9-eea31e83f8e0","3985e331-9778-4909-aa73-79e23575ccc5","7cf78357-6f6e-49bc-9d7c-2a53a51a7de2","45fae77e-3723-4cd9-a1c4-bb7f1dae5943"]}},"description":"All
        C+AI Subscriptions must have pre-defined C+AI NSG rules.  See https://aka.ms/netiso/nsgs
        for more details","metadata":{"createdBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","createdOn":"2019-07-08T19:20:11.3794009Z","updatedBy":"1f75b9dd-4f1d-4e80-9521-321a8b1f5764","updatedOn":"2019-07-09T19:20:20.6889912Z"}},"identity":{"principalId":"13c55e93-542e-463a-8a36-73d67f89ea1f","tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47","type":"SystemAssigned"},"id":"/providers/Microsoft.Management/managementGroups/48fed3a1-0814-4847-88ce-b766155f2792/providers/Microsoft.Authorization/policyAssignments/NRMS-SBNT-DINE-NSG-v011","type":"Microsoft.Authorization/policyAssignments","name":"NRMS-SBNT-DINE-NSG-v011","location":"eastus"}]}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '213590'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:09 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:08.9173801Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '766'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14998'
    status:
      code: 200
      message: OK
- request:
    body: 'b''b\''b\\\''b\\\\\\\''{"properties": {"policyDefinitionId": "/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0"}}\\\\\\\''\\\''\'''''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '162'
      Content-Type:
      - application/json; charset=utf-8
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: PUT
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:11.1476778Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '766'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-writes:
      - '1197'
    status:
      code: 201
      message: Created
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: GET
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:11.1476778Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '766'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"sku":{"name":"A0","tier":"Free"},"properties":{"policyDefinitionId":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","scope":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:11.1476778Z","updatedBy":null,"updatedOn":null}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test_mgmt_resource_policy_test_policy_definitionea4a13f0/providers/Microsoft.Authorization/policyAssignments/pypolicyassignmentea4a13f0","type":"Microsoft.Authorization/policyAssignments","name":"pypolicyassignmentea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '766'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:10 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14997'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      User-Agent:
      - python/3.6.8 (Linux-4.9.125-linuxkit-x86_64-with-Ubuntu-18.04-bionic) msrest/0.6.8
        msrest_azure/0.4.34 azure-mgmt-resource/3.1.0 Azure-SDK-For-Python
      accept-language:
      - en-US
    method: DELETE
    uri: https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0?api-version=2019-01-01
  response:
    body:
      string: '{"properties":{"policyType":"Custom","mode":"Indexed","description":"Don''t
        create a VM anywhere","metadata":{"createdBy":"20d81029-94cd-4923-a766-994415ff73bd","createdOn":"2019-07-20T13:11:06.4039986Z","updatedBy":null,"updatedOn":null},"policyRule":{"if":{"allOf":[{"source":"action","equals":"Microsoft.Compute/virtualMachines/write"},{"field":"location","in":["eastus","eastus2","centralus"]}]},"then":{"effect":"deny"}}},"id":"/subscriptions/00000000-0000-0000-0000-000000000000/providers/Microsoft.Authorization/policyDefinitions/pypolicyea4a13f0","type":"Microsoft.Authorization/policyDefinitions","name":"pypolicyea4a13f0"}'
    headers:
      cache-control:
      - no-cache
      content-length:
      - '631'
      content-type:
      - application/json; charset=utf-8
      date:
      - Sat, 20 Jul 2019 13:11:11 GMT
      expires:
      - '-1'
      pragma:
      - no-cache
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      transfer-encoding:
      - chunked
      vary:
      - Accept-Encoding,Accept-Encoding
      x-content-type-options:
      - nosniff
      x-ms-ratelimit-remaining-subscription-deletes:
      - '14996'
    status:
      code: 200
      message: OK
version: 1
