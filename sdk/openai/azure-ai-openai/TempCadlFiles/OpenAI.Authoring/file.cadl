import "@azure-tools/cadl-azure-core";
import "@cadl-lang/rest";
import "./models/file.models.cadl";
import "./serviceCustomizations.cadl";

namespace Azure.OpenAI;

using Cadl.Rest;
using Cadl.Http;
using Azure.Core;

interface Files
{
  #suppress "@azure-tools/cadl-azure-core/use-standard-operations" "This is an existing service, we have a non-conforming operation."
  @summary("""
Gets a list of all files owned by the Azure OpenAI resource.
These include user uploaded content like files with purpose "fine-tune" for training or
validation of fine-tunes models as well as files that are generated by the
service such as "fine-tune-results" which contains various metrics for the
corresponding fine-tune job.
""")
  @doc("""
Gets a list of all files owned by the Azure OpenAI resource.
These include user uploaded content like files with purpose \"fine-tune\" for training or
validation of fine-tunes models
as well as files that are generated by the
service such as \"fine-tune-results\" which contains various metrics for the
corresponding fine-tune job.
""")
  @route("/files")
  @get
  // TODO: enum value types not supported in csharp emitter, change string literal to TypeDiscriminatorKnownValues enum when fixed
  ListFiles is ServiceCustomizations.OpenAIListOperation<File, "file">;

  @summary("""
Creates a new file entity by uploading data from a local machine. Uploaded
files can, for example, be used for training or evaluating fine-tuned models.
""")
  @doc("""
Creates a new file entity by uploading data from a local machine. Uploaded
files can, for example, be used for training or evaluating fine-tuned models.
""")
  UploadFile is ResourceCreateWithServiceProvidedName<
    File,
    {
      response: File
    }
  >;

  @summary("""
Gets details for a single file specified by the given file_id including status,
size, purpose, etc.
""")
  @doc("""
Gets details for a single file specified by the given file_id including status,
size, purpose, etc.
""")
  GetFile is ResourceRead<File>;

  @summary("""
Deletes the file with the given file_id.
Deletion is also allowed if a file
was used, e.g., as training file in a fine-tune job.
""")
  @doc("""
Deletes the file with the given file_id.
Deletion is also allowed if a file
was used, e.g., as training file in a fine-tune job.
""")
  DeleteFile is ResourceDelete<File>;

  @summary("""
Gets the content of the file specified by the given file_id.
Files can be user
uploaded content or generated by the service like result metrics of a fine-tune
job.
""")
  @doc("""
Gets the content of the file specified by the given file_id.
Files can be user
uploaded content or generated by the service like result metrics of a fine-tune
job.
""")
  @get
  @action("content")
  @actionSeparator("/")
  GetFileContent is ResourceAction<File, {}, FileContent>;

  #suppress "@azure-tools/cadl-azure-core/use-standard-operations" "This is an existing service, we have a non-conforming operation."
  @summary("""
Creates a new file entity by importing data from a provided url. Uploaded files
can, for example, be used for training or evaluating fine-tuned models.
""")
  @doc("""
Creates a new file entity by importing data from a provided url. Uploaded files
can, for example, be used for training or evaluating fine-tuned models.
""")
  @route("/files/import")
  @post
  ImportFile is Foundations.Operation<
    {
      @doc("expected schema for the body of the completion post request")
      @body
      body: FileImport;
    },
    File & CreatedResponse
  >;
}
