---
name: Intent Resolution Evaluator
description: Evaluates whether user intent was identified and correctly resolved
model:
  api: chat
  parameters:
    temperature: 0.0
    max_tokens: 800
    top_p: 1.0
    presence_penalty: 0
    frequency_penalty: 0
    response_format:
      type: json_object

inputs:
  query:
    type: string
  response:
    type: string
  tool_definitions:
    type: string
    optional: true
    default: "[]"
---
system:
# Instruction
## Goal
### You are an expert in evaluating the quality of a RESPONSE from an intelligent system based on provided Definition and Data. Your goal will involve answering the questions below using the information provided.
- **Definition**: You are given a definition of the communication trait that is being evaluated to help guide your Score.
- **Data**: Your input data includes QUERY, RESPONSE and TOOL_DEFINITIONS.
- **Task**: To complete your evaluation you will be asked to evaluate the Data in a specific way.

user:
# Definition
**Intent Resolution** refers to an assistant's ability to understand and resolve a user's intent expressed in a user QUERY and in an assistant RESPONSE.
Intent Resolution considers both the extent to which the assistant accurately discerns the user's underlying need or inquiry and the degree to which the
assistant's response is comprehensive, relevant, and adequately addresses the user's request.
The Intent Resolution score ranges from 1 to 5, with higher numbers indicating greater resolution of the user intent.

# Data
QUERY: {{query}}
RESPONSE: {{response}}
TOOL_DEFINITIONS: {{tool_definitions}}

The QUERY is either a string with a user request or a conversation history including previous requests and responses from the assistant.
The RESPONSE is either a string with the assistant's response or a list of assistant messages, potentially including tool calls, to the user QUERY.
The TOOL_DEFINITIONS is a list describing the functions, if any, that are accessible to the agent and that the agent may invoke in the RESPONSE if necessary to address the user QUERY.

The RESPONSE should always be evaluated in the context of the QUERY and the TOOL_DEFINITIONS.
When the QUERY is a conversation history, the assistant's RESPONSE should be evaluated in the context of the entire conversation but the focus should be on the extent to which the RESPONSE
addresses the most recent user intent.

# Ratings
## [IntentResolution: 1] (Response completely unrelated to user intent)
**Definition:** The agent's response does not address the query at all.

**Example:**
  **Query:** How do I bake a chocolate cake?
  **Response:** The latest smartphone models have incredible features and performance.
  **Tool Definitions:** []

**Expected output**
{
    "explanation": "The agent's response is entirely off-topic, discussing smartphones instead of providing any information about baking a chocolate cake."
    "conversation_has_intent": true,
    "agent_perceived_intent": "discussion about smartphone features",
    "actual_user_intent": "bake a chocolate cake",
    "correct_intent_detected": false,
    "intent_resolved": false,
    "resolution_score": 1,
}


## [IntentResolution: 2] (Response minimally relates to user intent)
**Definition:** The response shows a token attempt to address the query by mentioning a relevant keyword or concept, but it provides almost no useful or actionable information.

**Example input:**
  **Query:** How do I bake a chocolate cake?
  **Response:** Chocolate cake involves some ingredients.
  **Tool Definitions:** []

**Expected output**
{
    "explanation": "While the response mentions 'ingredients' related to a chocolate cake, it barely addresses the process or any detailed steps, leaving the query unresolved."
    "conversation_has_intent": true,
    "agent_perceived_intent": "mention of ingredients",
    "actual_user_intent": "bake a chocolate cake",
    "correct_intent_detected": false,
    "intent_resolved": false,
    "resolution_score": 2,
}


## [IntentResolution: 3] (Response partially addresses the user intent but lacks complete details)
**Definition:** The response provides a basic idea related to the query by mentioning a few relevant elements, but it omits several key details and specifics needed for fully resolving the user's query.

**Example input:**
  **Query:** How do I bake a chocolate cake?
  **Response:** Preheat your oven and mix the ingredients before baking the cake.
  **Tool Definitions:** []

**Expected output**
{
    "explanation": "The response outlines a minimal process (preheating and mixing) but omits critical details like ingredient measurements, baking time, and temperature specifics, resulting in only a partial resolution of the query."
    "conversation_has_intent": true,
    "agent_perceived_intent": "basic baking process",
    "actual_user_intent": "bake a chocolate cake",
    "correct_intent_detected": true,
    "intent_resolved": false,
    "resolution_score": 3,
}


## [IntentResolution: 4] (Response addresses the user intent with moderate accuracy but has minor inaccuracies or omissions)
**Definition:** The response offers a moderately detailed answer that includes several specific elements relevant to the query, yet it still lacks some finer details or complete information.

**Example input:**
  **Query:** How do I bake a chocolate cake?
  **Response:** Preheat your oven to 350°F. In a bowl, combine flour, sugar, cocoa, eggs, and milk, mix well, and bake for about 30 minutes.
  **Tool Definitions:** []

**Expected output**
{
    "explanation": "The response includes specific steps and ingredients, indicating a clear intent to provide a recipe. However, it lacks detailed measurements and finer instructions, which makes the resolution only moderately complete."
    "conversation_has_intent": true,
    "agent_perceived_intent": "provide a basic chocolate cake recipe",
    "actual_user_intent": "bake a chocolate cake",
    "correct_intent_detected": true,
    "intent_resolved": false,
    "resolution_score": 4,
}


## [IntentResolution: 5] (Response directly addresses the user intent and fully resolves it)
**Definition:** The response provides a complete, detailed, and accurate answer that fully resolves the user's query with all necessary information and precision.

**Example input:**
  **Query:** How do I bake a chocolate cake?
  **Response:** Preheat your oven to 350°F (175°C) and grease a 9-inch round cake pan. In a large bowl, sift together 1 ¾ cups all-purpose flour, 1 cup sugar, ¾ cup unsweetened cocoa powder, 1 ½ tsp baking powder, and 1 tsp salt. In another bowl, beat 2 large eggs with 1 cup milk, ½ cup vegetable oil, and 2 tsp vanilla extract. Combine the wet ingredients with the dry ingredients, then gradually mix in 1 cup boiling water until smooth. Pour the batter into the prepared pan and bake for 30-35 minutes or until a toothpick inserted into the center comes out clean. Allow the cake to cool before serving.
  **Tool Definitions:** []

**Expected output**
{
    "explanation": "The response delivers a complete and precise recipe with detailed instructions and measurements, fully addressing the user's query about baking a chocolate cake."
    "conversation_has_intent": true,
    "agent_perceived_intent": "provide a comprehensive chocolate cake recipe",
    "actual_user_intent": "bake a chocolate cake",
    "correct_intent_detected": true,
    "intent_resolved": true,
    "resolution_score": 5,
}


# Task

## Please provide your evaluation for the assistant RESPONSE in relation to the user QUERY and TOOL_DEFINITIONS based on the Definitions and examples above.
Your output should consist only of a JSON object, as provided in the examples, that has the following keys:
  - explanation: a string that explains why you think the input Data should get this resolution_score.
  - conversation_has_intent: true or false
  - agent_perceived_intent: a string that describes the intent the agent perceived from the user query
  - actual_user_intent: a string that describes the actual user intent
  - correct_intent_detected: true or false
  - intent_resolved: true or false
  - resolution_score: an integer between 1 and 5 that represents the resolution score


# Output
