{
  "Entries": [
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94?api-version=2023-04-01-preview",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "379",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "isAnonymous": true,
          "isArchived": false,
          "condaFile": "channels:\n- defaults\ndependencies:\n- python=3.8.12\n- pip=21.2.2\n- pip:\n  - --extra-index-url=https://azuremlsdktestpypi.azureedge.net/sdk-cli-v2\n  - mldesigner==0.0.71974906\n  - mlflow\n  - azureml-mlflow\nname: example-environment\n",
          "image": "mcr.microsoft.com/azureml/openmpi3.1.2-ubuntu18.04"
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Build-ID": "ch7",
        "Cache-Control": "no-cache",
        "Content-Length": "1436",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:37 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94?api-version=2023-04-01-preview",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-939a5a65ffc57e189f1a259de2260698-863489d1d4b6c719-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "2c5da76d-f2db-4678-b635-6ce5dbf44e1a",
        "x-ms-ratelimit-remaining-subscription-writes": "1199",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030237Z:2c5da76d-f2db-4678-b635-6ce5dbf44e1a",
        "x-request-time": "10.580"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94",
        "name": "7926e182b294d8644f987381c0081e94",
        "type": "Microsoft.MachineLearningServices/workspaces/environments/versions",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {},
          "isArchived": false,
          "isAnonymous": true,
          "autoDeleteSetting": null,
          "environmentType": "UserCreated",
          "image": "mcr.microsoft.com/azureml/openmpi3.1.2-ubuntu18.04",
          "condaFile": "{\n  \u0022channels\u0022: [\n    \u0022defaults\u0022\n  ],\n  \u0022dependencies\u0022: [\n    \u0022python=3.8.12\u0022,\n    \u0022pip=21.2.2\u0022,\n    {\n      \u0022pip\u0022: [\n        \u0022--extra-index-url=https://azuremlsdktestpypi.azureedge.net/sdk-cli-v2\u0022,\n        \u0022mldesigner==0.0.71974906\u0022,\n        \u0022mlflow\u0022,\n        \u0022azureml-mlflow\u0022\n      ]\n    }\n  ],\n  \u0022name\u0022: \u0022example-environment\u0022\n}",
          "osType": "Linux",
          "autoRebuild": "Disabled",
          "provisioningState": "Succeeded",
          "stage": "Logged",
          "intellectualProperty": null
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:26.6953544\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User",
          "lastModifiedAt": "2023-05-24T03:02:26.6953544\u002B00:00",
          "lastModifiedBy": "Chenyang Zhang",
          "lastModifiedByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94?api-version=2023-04-01-preview",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "379",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "isAnonymous": true,
          "isArchived": false,
          "condaFile": "channels:\n- defaults\ndependencies:\n- python=3.8.12\n- pip=21.2.2\n- pip:\n  - --extra-index-url=https://azuremlsdktestpypi.azureedge.net/sdk-cli-v2\n  - mldesigner==0.0.71974906\n  - mlflow\n  - azureml-mlflow\nname: example-environment\n",
          "image": "mcr.microsoft.com/azureml/openmpi3.1.2-ubuntu18.04"
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Build-ID": "ch7",
        "Cache-Control": "no-cache",
        "Content-Length": "1436",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:37 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94?api-version=2023-04-01-preview",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-24825fc820b43471247ac680268fc7fa-df64db9fecf1e09d-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "19759389-acdd-4263-bb42-05055359bc31",
        "x-ms-ratelimit-remaining-subscription-writes": "1198",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030238Z:19759389-acdd-4263-bb42-05055359bc31",
        "x-request-time": "0.220"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94",
        "name": "7926e182b294d8644f987381c0081e94",
        "type": "Microsoft.MachineLearningServices/workspaces/environments/versions",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {},
          "isArchived": false,
          "isAnonymous": true,
          "autoDeleteSetting": null,
          "environmentType": "UserCreated",
          "image": "mcr.microsoft.com/azureml/openmpi3.1.2-ubuntu18.04",
          "condaFile": "{\n  \u0022channels\u0022: [\n    \u0022defaults\u0022\n  ],\n  \u0022dependencies\u0022: [\n    \u0022python=3.8.12\u0022,\n    \u0022pip=21.2.2\u0022,\n    {\n      \u0022pip\u0022: [\n        \u0022--extra-index-url=https://azuremlsdktestpypi.azureedge.net/sdk-cli-v2\u0022,\n        \u0022mldesigner==0.0.71974906\u0022,\n        \u0022mlflow\u0022,\n        \u0022azureml-mlflow\u0022\n      ]\n    }\n  ],\n  \u0022name\u0022: \u0022example-environment\u0022\n}",
          "osType": "Linux",
          "autoRebuild": "Disabled",
          "provisioningState": "Succeeded",
          "stage": "Logged",
          "intellectualProperty": null
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:26.6953544\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User",
          "lastModifiedAt": "2023-05-24T03:02:26.6953544\u002B00:00",
          "lastModifiedBy": "Chenyang Zhang",
          "lastModifiedByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94?api-version=2023-04-01-preview",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "379",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "isAnonymous": true,
          "isArchived": false,
          "condaFile": "channels:\n- defaults\ndependencies:\n- python=3.8.12\n- pip=21.2.2\n- pip:\n  - --extra-index-url=https://azuremlsdktestpypi.azureedge.net/sdk-cli-v2\n  - mldesigner==0.0.71974906\n  - mlflow\n  - azureml-mlflow\nname: example-environment\n",
          "image": "mcr.microsoft.com/azureml/openmpi3.1.2-ubuntu18.04"
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Build-ID": "ch7",
        "Cache-Control": "no-cache",
        "Content-Length": "1436",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:38 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94?api-version=2023-04-01-preview",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-43ffb7934ffd06cd3730cfe0ed4cb20d-5e4dc558bb8402e1-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "64df6b62-76f4-4884-823c-2279a6725f0f",
        "x-ms-ratelimit-remaining-subscription-writes": "1197",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030238Z:64df6b62-76f4-4884-823c-2279a6725f0f",
        "x-request-time": "0.178"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94",
        "name": "7926e182b294d8644f987381c0081e94",
        "type": "Microsoft.MachineLearningServices/workspaces/environments/versions",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {},
          "isArchived": false,
          "isAnonymous": true,
          "autoDeleteSetting": null,
          "environmentType": "UserCreated",
          "image": "mcr.microsoft.com/azureml/openmpi3.1.2-ubuntu18.04",
          "condaFile": "{\n  \u0022channels\u0022: [\n    \u0022defaults\u0022\n  ],\n  \u0022dependencies\u0022: [\n    \u0022python=3.8.12\u0022,\n    \u0022pip=21.2.2\u0022,\n    {\n      \u0022pip\u0022: [\n        \u0022--extra-index-url=https://azuremlsdktestpypi.azureedge.net/sdk-cli-v2\u0022,\n        \u0022mldesigner==0.0.71974906\u0022,\n        \u0022mlflow\u0022,\n        \u0022azureml-mlflow\u0022\n      ]\n    }\n  ],\n  \u0022name\u0022: \u0022example-environment\u0022\n}",
          "osType": "Linux",
          "autoRebuild": "Disabled",
          "provisioningState": "Succeeded",
          "stage": "Logged",
          "intellectualProperty": null
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:26.6953544\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User",
          "lastModifiedAt": "2023-05-24T03:02:26.6953544\u002B00:00",
          "lastModifiedBy": "Chenyang Zhang",
          "lastModifiedByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions?api-version=2023-04-01\u0026hash=a687133928d9e45e91a03f4ac1679f5033615fabd05465e18d146cb321744379\u0026hashVersion=202208",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Encoding": "gzip",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:40 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-f04ca04c8dbcbd6679911df3dc7a26a6-a2759f1c02ef22ab-00\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Transfer-Encoding": "chunked",
        "Vary": "Accept-Encoding",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "a55432d3-77cb-465a-977a-6122e1afbcc0",
        "x-ms-ratelimit-remaining-subscription-reads": "11997",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030240Z:a55432d3-77cb-465a-977a-6122e1afbcc0",
        "x-request-time": "0.044"
      },
      "ResponseBody": {
        "value": []
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions/1/startPendingUpload?api-version=2023-04-01",
      "RequestMethod": "POST",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "47",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "pendingUploadType": "TemporaryBlobReference"
      },
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Encoding": "gzip",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:41 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-04b06e2b3be49037e702ec1931b593fb-986364692e2f4495-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Transfer-Encoding": "chunked",
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "94221a3b-3874-4178-9ec2-9b40b6e16d57",
        "x-ms-ratelimit-remaining-subscription-writes": "1196",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030241Z:94221a3b-3874-4178-9ec2-9b40b6e16d57",
        "x-request-time": "0.448"
      },
      "ResponseBody": {
        "blobReferenceForConsumption": {
          "blobUri": "https://amltest5899420437.blob.core.windows.net:443/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c",
          "storageAccountArmId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.Storage/storageAccounts/amltest5899420437",
          "credential": {
            "credentialType": "SAS",
            "sasUri": "https://amltest5899420437.blob.core.windows.net/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c?skoid=372c30a9-c04f-422f-b38c-872e6b7d5540\u0026sktid=72f988bf-86f1-41af-91ab-2d7cd011db47\u0026skt=2023-05-24T02%3A49%3A26Z\u0026ske=2023-05-25T10%3A59%3A26Z\u0026sks=b\u0026skv=2019-07-07\u0026sv=2021-10-04\u0026st=2023-05-24T02%3A52%3A41Z\u0026se=2023-05-24T11%3A02%3A41Z\u0026sr=c\u0026sp=rcwl\u0026sig=000000000000000000000000000000000000"
          }
        },
        "pendingUploadId": "ce1cf727-50fa-4169-abb0-5739b3112e6a",
        "pendingUploadType": "None"
      }
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c/src/baisc_component.py?skoid=372c30a9-c04f-422f-b38c-872e6b7d5540\u0026sktid=72f988bf-86f1-41af-91ab-2d7cd011db47\u0026skt=2023-05-24T02%3A49%3A26Z\u0026ske=2023-05-25T10%3A59%3A26Z\u0026sks=b\u0026skv=2019-07-07\u0026sv=2021-10-04\u0026st=2023-05-24T02%3A52%3A41Z\u0026se=2023-05-24T11%3A02%3A41Z\u0026sr=c\u0026sp=rcwl\u0026sig=000000000000000000000000000000000000",
      "RequestMethod": "HEAD",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-date": "Wed, 24 May 2023 03:02:41 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": null,
      "StatusCode": 404,
      "ResponseHeaders": {
        "Date": "Wed, 24 May 2023 03:02:41 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "Transfer-Encoding": "chunked",
        "x-ms-error-code": "BlobNotFound",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c/src/baisc_component.py?skoid=372c30a9-c04f-422f-b38c-872e6b7d5540\u0026sktid=72f988bf-86f1-41af-91ab-2d7cd011db47\u0026skt=2023-05-24T02%3A49%3A26Z\u0026ske=2023-05-25T10%3A59%3A26Z\u0026sks=b\u0026skv=2019-07-07\u0026sv=2021-10-04\u0026st=2023-05-24T02%3A52%3A41Z\u0026se=2023-05-24T11%3A02%3A41Z\u0026sr=c\u0026sp=rcwl\u0026sig=000000000000000000000000000000000000",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "1486",
        "Content-MD5": "Uk/a5NgJ4\u002BFWFWAqJ7fY/w==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:42 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "aW1wb3J0IGFyZ3BhcnNlDQppbXBvcnQgb3MNCg0KZnJvbSBtbGRlc2lnbmVyLl9jb21wb25lbnRfZXhlY3V0b3IgaW1wb3J0IEV4ZWN1dG9yQmFzZQ0KDQpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWNvbXBvbmVudF9pbl9udW1iZXIiLCB0eXBlPWludCkNCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tY29tcG9uZW50X2luX251bWJlcl8xIiwgdHlwZT1pbnQpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWNvbXBvbmVudF9pbl9wYXRoIiwgdHlwZT1zdHIpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW91dHB1dF9pbl9wYXRoIiwgdHlwZT1zdHIpDQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW91dHB1dF9pbl9udW1iZXIiLCB0eXBlPXN0cikNCg0KDQphcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQ0KDQpsaW5lcyA9IFsNCiAgICBmImNvbXBvbmVudF9pbl9udW1iZXI6IHthcmdzLmNvbXBvbmVudF9pbl9udW1iZXJ9IiwNCiAgICBmImNvbXBvbmVudF9pbl9udW1iZXJfMToge2FyZ3MuY29tcG9uZW50X2luX251bWJlcl8xfSIsDQogICAgZiJjb21wb25lbnRfaW5fcGF0aDoge2FyZ3MuY29tcG9uZW50X2luX3BhdGh9IiwNCl0NCg0KaWYgYXJncy5jb21wb25lbnRfaW5fbnVtYmVyIGlzIG5vdCBOb25lOg0KICAgIGNvbXBvbmVudF9pbl9udW1iZXIgPSBhcmdzLmNvbXBvbmVudF9pbl9udW1iZXINCmVsaWYgb3MucGF0aC5leGlzdHMob3MucGF0aC5qb2luKGFyZ3MuY29tcG9uZW50X2luX3BhdGgsICJvdXRwdXQudHh0IikpOg0KICAgIHdpdGggb3Blbihvcy5wYXRoLmpvaW4oYXJncy5jb21wb25lbnRfaW5fcGF0aCwgIm91dHB1dC50eHQiKSwgInIiKSBhcyBmaWxlOg0KICAgICAgICBjb250ZW50ID0gZmlsZS5yZWFkKCkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlciA9IGludChjb250ZW50KQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uOg0KICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlciA9IGFyZ3MuY29tcG9uZW50X2luX251bWJlcg0KZWxzZToNCiAgICBjb21wb25lbnRfaW5fbnVtYmVyID0gMA0KDQpvdXRwdXRfaW5fbnVtID0gY29tcG9uZW50X2luX251bWJlciAtIDENCg0Kd2l0aCBvcGVuKG9zLnBhdGguam9pbihhcmdzLm91dHB1dF9pbl9wYXRoLCAib3V0cHV0LnR4dCIpLCAidyIpIGFzIGZpbGU6DQogICAgZmlsZS53cml0ZShzdHIob3V0cHV0X2luX251bSkpDQoNCmNvbnRyb2xfb3V0cHV0X2NvbnRlbnQgPSAneyJpc19udW1iZXJfbGFyZ2VyX3RoYW5femVybyI6ICIlcyIsICJvdXRwdXRfaW5fbnVtYmVyIjogIiVzIn0nICUgKA0KICAgIHN0cihvdXRwdXRfaW5fbnVtID4gMCksDQogICAgb3V0cHV0X2luX251bSwNCikNCkV4ZWN1dG9yQmFzZS5fd3JpdGVfY29udHJvbF9vdXRwdXRzX3RvX3J1bl9oaXN0b3J5KGNvbnRyb2xfb3V0cHV0X2NvbnRlbnQ9Y29udHJvbF9vdXRwdXRfY29udGVudCkNCg==",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "Uk/a5NgJ4\u002BFWFWAqJ7fY/w==",
        "Date": "Wed, 24 May 2023 03:02:42 GMT",
        "ETag": "\u00220x8DB5C0357A209D2\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:42 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "api9XrScx1M=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c/src/baisc_component.py?comp=metadata\u0026skoid=372c30a9-c04f-422f-b38c-872e6b7d5540\u0026sktid=72f988bf-86f1-41af-91ab-2d7cd011db47\u0026skt=2023-05-24T02%3A49%3A26Z\u0026ske=2023-05-25T10%3A59%3A26Z\u0026sks=b\u0026skv=2019-07-07\u0026sv=2021-10-04\u0026st=2023-05-24T02%3A52%3A41Z\u0026se=2023-05-24T11%3A02%3A41Z\u0026sr=c\u0026sp=rcwl\u0026sig=000000000000000000000000000000000000",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "0",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-date": "Wed, 24 May 2023 03:02:42 GMT",
        "x-ms-meta-name": "000000000000000000000",
        "x-ms-meta-upload_status": "completed",
        "x-ms-meta-version": "1",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Date": "Wed, 24 May 2023 03:02:42 GMT",
        "ETag": "\u00220x8DB5C0357C6F15D\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:43 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions/1?api-version=2023-04-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "246",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "properties": {
            "hash_sha256": "0000000000000",
            "hash_version": "0000000000000"
          },
          "isAnonymous": true,
          "isArchived": false,
          "codeUri": "https://amltest5899420437.blob.core.windows.net:443/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c/src"
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "795",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:43 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions/1?api-version=2023-04-01",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-d4eb2feaa083ca4463d74954bcc0d154-fbf0a43e679ae393-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "5c8ed513-72df-403d-92c4-5f94dffe8123",
        "x-ms-ratelimit-remaining-subscription-writes": "1195",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030243Z:5c8ed513-72df-403d-92c4-5f94dffe8123",
        "x-request-time": "0.313"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions/1",
        "name": "1",
        "type": "Microsoft.MachineLearningServices/workspaces/codes/versions",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {
            "hash_sha256": "0000000000000",
            "hash_version": "0000000000000"
          },
          "isArchived": false,
          "isAnonymous": false,
          "codeUri": "https://amltest5899420437.blob.core.windows.net:443/0bdd51b6-c-a3a0faaa-7927-5a27-842f-4ffaa344d69c/src",
          "provisioningState": "Succeeded"
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:43.6428915\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User",
          "lastModifiedAt": "2023-05-24T03:02:43.6428915\u002B00:00",
          "lastModifiedBy": "Chenyang Zhang",
          "lastModifiedByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/000000000000000000000?api-version=2022-10-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "1404",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "properties": {},
          "tags": {},
          "isAnonymous": true,
          "isArchived": false,
          "componentSpec": {
            "command": "python basic_component.py $[[--component_in_number ${{inputs.component_in_number}}]] $[[--component_in_number_1 ${{inputs.component_in_number_1}}]] --component_in_path ${{inputs.component_in_path}} --output_in_path ${{outputs.output_in_path}}",
            "code": "azureml:/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions/1",
            "environment": "azureml:/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94",
            "name": "basic_component",
            "version": "0.0.1",
            "$schema": "https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json",
            "display_name": "Basic component",
            "is_deterministic": true,
            "inputs": {
              "component_in_number": {
                "type": "integer",
                "optional": true
              },
              "component_in_number_1": {
                "type": "integer",
                "optional": true
              },
              "component_in_path": {
                "type": "uri_folder"
              }
            },
            "outputs": {
              "output_in_path": {
                "type": "uri_folder"
              },
              "output_in_number": {
                "type": "integer",
                "is_control": true
              },
              "is_number_larger_than_zero": {
                "type": "boolean",
                "is_control": true
              }
            },
            "type": "command",
            "_source": "YAML.COMPONENT"
          }
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "2443",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:46 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/000000000000000000000?api-version=2022-10-01",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-60b9ed653c9944e30906839393b43d26-7a717940894ee1ba-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "bfc77c7b-fe7e-4fa4-a64c-6459d308de4d",
        "x-ms-ratelimit-remaining-subscription-writes": "1194",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030246Z:bfc77c7b-fe7e-4fa4-a64c-6459d308de4d",
        "x-request-time": "0.674"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/c6182fc9-3280-44ef-bd4e-6f45fc19c4f3",
        "name": "c6182fc9-3280-44ef-bd4e-6f45fc19c4f3",
        "type": "Microsoft.MachineLearningServices/workspaces/components/versions",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {},
          "isArchived": false,
          "isAnonymous": true,
          "componentSpec": {
            "$schema": "https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json",
            "name": "basic_component",
            "version": "0.0.1",
            "display_name": "Basic component",
            "is_deterministic": "True",
            "type": "command",
            "inputs": {
              "component_in_path": {
                "type": "uri_folder",
                "optional": "False"
              },
              "component_in_number": {
                "type": "integer",
                "optional": "True"
              },
              "component_in_number_1": {
                "type": "integer",
                "optional": "True"
              }
            },
            "outputs": {
              "output_in_path": {
                "type": "uri_folder"
              },
              "output_in_number": {
                "type": "integer",
                "is_control": "True"
              },
              "is_number_larger_than_zero": {
                "type": "boolean",
                "is_control": "True"
              }
            },
            "code": "azureml:/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/codes/000000000000000000000/versions/1",
            "environment": "azureml:/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/environments/CliV2AnonymousEnvironment/versions/7926e182b294d8644f987381c0081e94",
            "resources": {
              "instance_count": "1"
            },
            "command": "python basic_component.py $[[--component_in_number ${{inputs.component_in_number}}]] $[[--component_in_number_1 ${{inputs.component_in_number_1}}]] --component_in_path ${{inputs.component_in_path}} --output_in_path ${{outputs.output_in_path}}"
          }
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:46.2240136\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User",
          "lastModifiedAt": "2023-05-24T03:02:46.2240136\u002B00:00",
          "lastModifiedBy": "Chenyang Zhang",
          "lastModifiedByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/000000000000000000000?api-version=2022-10-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "1778",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "description": "E2E dummy train-score-eval pipeline with components defined via yaml.",
          "properties": {},
          "tags": {},
          "isAnonymous": true,
          "isArchived": false,
          "componentSpec": {
            "name": "do_while_body_pipeline_component",
            "description": "E2E dummy train-score-eval pipeline with components defined via yaml.",
            "display_name": "do_while_body_pipeline_component",
            "inputs": {
              "component_in_number": {
                "type": "integer",
                "optional": true
              },
              "component_in_number_1": {
                "type": "integer",
                "optional": true
              },
              "component_in_path": {
                "type": "uri_folder"
              }
            },
            "outputs": {
              "output_in_path": {
                "type": "uri_folder"
              },
              "output_in_number": {
                "type": "integer",
                "is_control": true
              },
              "is_number_larger_than_zero": {
                "type": "boolean",
                "is_control": true
              }
            },
            "type": "pipeline",
            "jobs": {
              "train_with_sample_data": {
                "name": "train_with_sample_data",
                "type": "command",
                "inputs": {
                  "component_in_number": {
                    "job_input_type": "literal",
                    "value": "${{parent.inputs.component_in_number}}"
                  },
                  "component_in_number_1": {
                    "job_input_type": "literal",
                    "value": "${{parent.inputs.component_in_number_1}}"
                  },
                  "component_in_path": {
                    "job_input_type": "literal",
                    "value": "${{parent.inputs.component_in_path}}"
                  }
                },
                "outputs": {
                  "output_in_path": {
                    "value": "${{parent.outputs.output_in_path}}",
                    "type": "literal"
                  },
                  "output_in_number": {
                    "value": "${{parent.outputs.output_in_number}}",
                    "type": "literal"
                  },
                  "is_number_larger_than_zero": {
                    "value": "${{parent.outputs.is_number_larger_than_zero}}",
                    "type": "literal"
                  }
                },
                "_source": "YAML.COMPONENT",
                "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/c6182fc9-3280-44ef-bd4e-6f45fc19c4f3"
              }
            },
            "_source": "DSL",
            "sourceJobId": null
          }
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "1692",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:47 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/000000000000000000000?api-version=2022-10-01",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-88f338541c56a57e9cfed57e6d116f0f-cfa95727cd349262-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "aebc1594-c508-4819-97a6-8a5a3ba5021a",
        "x-ms-ratelimit-remaining-subscription-writes": "1193",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030247Z:aebc1594-c508-4819-97a6-8a5a3ba5021a",
        "x-request-time": "0.851"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/e56097e1-ae81-414d-b5d6-b3929d21303f",
        "name": "e56097e1-ae81-414d-b5d6-b3929d21303f",
        "type": "Microsoft.MachineLearningServices/workspaces/components/versions",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {},
          "isArchived": false,
          "isAnonymous": true,
          "componentSpec": {
            "name": "do_while_body_pipeline_component",
            "display_name": "do_while_body_pipeline_component",
            "is_deterministic": "False",
            "type": "pipeline",
            "description": "E2E dummy train-score-eval pipeline with components defined via yaml.",
            "inputs": {
              "component_in_path": {
                "type": "uri_folder",
                "optional": "False"
              },
              "component_in_number": {
                "type": "integer",
                "optional": "True"
              },
              "component_in_number_1": {
                "type": "integer",
                "optional": "True"
              }
            },
            "outputs": {
              "output_in_path": {
                "type": "uri_folder"
              },
              "output_in_number": {
                "type": "integer",
                "is_control": "True"
              },
              "is_number_larger_than_zero": {
                "type": "boolean",
                "is_control": "True"
              }
            }
          }
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:47.7645003\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User",
          "lastModifiedAt": "2023-05-24T03:02:47.7645003\u002B00:00",
          "lastModifiedBy": "Chenyang Zhang",
          "lastModifiedByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/datastores/workspaceblobstore?api-version=2022-10-01",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Encoding": "gzip",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:48 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-7fb8b1507b91f57e24b392fab1f8533f-df3dcd2fdeb6af12-00\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Transfer-Encoding": "chunked",
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "8e53781b-abe0-4764-90b4-30da2669698d",
        "x-ms-ratelimit-remaining-subscription-reads": "11996",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030248Z:8e53781b-abe0-4764-90b4-30da2669698d",
        "x-request-time": "0.081"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/datastores/workspaceblobstore",
        "name": "workspaceblobstore",
        "type": "Microsoft.MachineLearningServices/workspaces/datastores",
        "properties": {
          "description": null,
          "tags": null,
          "properties": null,
          "isDefault": true,
          "credentials": {
            "credentialsType": "AccountKey"
          },
          "datastoreType": "AzureBlob",
          "accountName": "amltest5899420437",
          "containerName": "azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81",
          "endpoint": "core.windows.net",
          "protocol": "https",
          "serviceDataAccessAuthIdentity": "WorkspaceSystemAssignedIdentity"
        },
        "systemData": {
          "createdAt": "2023-05-19T09:41:55.3790868\u002B00:00",
          "createdBy": "779301c0-18b2-4cdc-801b-a0a3368fee0a",
          "createdByType": "Application",
          "lastModifiedAt": "2023-05-19T09:41:56.0641774\u002B00:00",
          "lastModifiedBy": "779301c0-18b2-4cdc-801b-a0a3368fee0a",
          "lastModifiedByType": "Application"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/datastores/workspaceblobstore/listSecrets?api-version=2022-10-01",
      "RequestMethod": "POST",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "0",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Encoding": "gzip",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:49 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-6c5d0c4cf81e62505960c65aeca240f2-3a5028bf03aed71e-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Transfer-Encoding": "chunked",
        "Vary": "Accept-Encoding",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "9a6edc69-ee55-4545-9111-c513bfd10d74",
        "x-ms-ratelimit-remaining-subscription-writes": "1199",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030249Z:9a6edc69-ee55-4545-9111-c513bfd10d74",
        "x-request-time": "0.084"
      },
      "ResponseBody": {
        "secretsType": "AccountKey",
        "key": "dGhpcyBpcyBmYWtlIGtleQ=="
      }
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/__init__.py",
      "RequestMethod": "HEAD",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": null,
      "StatusCode": 404,
      "ResponseHeaders": {
        "Date": "Wed, 24 May 2023 03:02:48 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "Transfer-Encoding": "chunked",
        "x-ms-error-code": "BlobNotFound",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_dsl_pipeline_on_registry.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "4536",
        "Content-MD5": "d1TaRP31HP1J\u002BHb81i1/OQ==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "ZnJvbSBwYXRobGliIGltcG9ydCBQYXRoDQoNCmltcG9ydCBweXRlc3QNCmZyb20gYXp1cmUuY29yZS5leGNlcHRpb25zIGltcG9ydCBSZXNvdXJjZU5vdEZvdW5kRXJyb3INCg0KZnJvbSBhenVyZS5haS5tbCBpbXBvcnQgSW5wdXQsIE1MQ2xpZW50LCBsb2FkX2NvbXBvbmVudCwgbG9hZF9tb2RlbA0KZnJvbSBhenVyZS5haS5tbC5jb25zdGFudHMgaW1wb3J0IEFzc2V0VHlwZXMNCmZyb20gYXp1cmUuYWkubWwuZHNsIGltcG9ydCBwaXBlbGluZQ0KZnJvbSBkZXZ0b29sc190ZXN0dXRpbHMgaW1wb3J0IEF6dXJlUmVjb3JkZWRUZXN0Q2FzZSwgaXNfbGl2ZQ0KZnJvbSB0ZXN0X3V0aWxpdGllcy51dGlscyBpbXBvcnQgX1BZVEVTVF9USU1FT1VUX01FVEhPRCwgYXNzZXJ0X2pvYl9jYW5jZWwNCmZyb20gLi5fdXRpbCBpbXBvcnQgX0RTTF9USU1FT1VUX1NFQ09ORA0KDQoNCmRlZiBhc3NlcnRfcGlwZWxpbmVfam9iX2NhbmNlbChjbGllbnQ6IE1MQ2xpZW50LCBzY29yZV9mdW5jLCBwaXBlbGluZV9tb2RlbF9pbnB1dCwgcGlwZWxpbmVfdGVzdF9kYXRhKToNCiAgICBAcGlwZWxpbmUNCiAgICBkZWYgc2NvcmVfcGlwZWxpbmUobW9kZWxfaW5wdXQsIHRlc3RfZGF0YSk6DQogICAgICAgIHNjb3JlID0gc2NvcmVfZnVuYyhtb2RlbF9pbnB1dD1tb2RlbF9pbnB1dCwgdGVzdF9kYXRhPXRlc3RfZGF0YSkgICMgbm9xYTogRjg0MQ0KICAgICAgICBzY29yZV9kdXBsaWNhdGUgPSBzY29yZV9mdW5jKG1vZGVsX2lucHV0PW1vZGVsX2lucHV0LCB0ZXN0X2RhdGE9dGVzdF9kYXRhKSAgIyBub3FhOiBGODQxDQoNCiAgICBwaXBlbGluZV9qb2IgPSBzY29yZV9waXBlbGluZShtb2RlbF9pbnB1dD1waXBlbGluZV9tb2RlbF9pbnB1dCwgdGVzdF9kYXRhPXBpcGVsaW5lX3Rlc3RfZGF0YSkNCiAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQoNCkBweXRlc3QubWFyay5za2lwaWYoY29uZGl0aW9uPW5vdCBpc19saXZlKCksIHJlYXNvbj0icmVnaXN0cnkgdGVzdCwgbWF5IGZhaWwgaW4gcGxheWJhY2sgbW9kZSIpDQpAcHl0ZXN0Lm1hcmsudXNlZml4dHVyZXMoImVuYWJsZV9waXBlbGluZV9wcml2YXRlX3ByZXZpZXdfZmVhdHVyZXMiLCAicmVjb3JkZWRfdGVzdCIpDQpAcHl0ZXN0Lm1hcmsudGltZW91dCh0aW1lb3V0PV9EU0xfVElNRU9VVF9TRUNPTkQsIG1ldGhvZD1fUFlURVNUX1RJTUVPVVRfTUVUSE9EKQ0KQHB5dGVzdC5tYXJrLmUyZXRlc3QNCkBweXRlc3QubWFyay5waXBlbGluZV90ZXN0DQpjbGFzcyBUZXN0RFNMUGlwZWxpbmVPblJlZ2lzdHJ5KEF6dXJlUmVjb3JkZWRUZXN0Q2FzZSk6DQogICAgdGVzdF9kYXRhID0gSW5wdXQoDQogICAgICAgIHR5cGU9QXNzZXRUeXBlcy5VUklfRklMRSwNCiAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvcGlwZWxpbmVfam9icy9qb2Jfd2l0aF9yZWdpc3RyeV9tb2RlbF9hc19pbnB1dC9kYXRhL3NhbXBsZTEuY3N2IiwNCiAgICApDQoNCiAgICBkZWYgdGVzdF9waXBlbGluZV9qb2JfY3JlYXRlX3dpdGhfcmVnaXN0ZXJlZF9jb21wb25lbnRfb25fcmVnaXN0cnkoc2VsZiwgcGlwZWxpbmVzX3JlZ2lzdHJ5X2NsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBsb2NhbF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudCgiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9iYXNpY19jb21wb25lbnRfY29kZV9sb2NhbF9wYXRoLnltbCIpDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGNyZWF0ZWRfY29tcG9uZW50ID0gcGlwZWxpbmVzX3JlZ2lzdHJ5X2NsaWVudC5jb21wb25lbnRzLmdldCgNCiAgICAgICAgICAgICAgICBsb2NhbF9jb21wb25lbnQubmFtZSwgdmVyc2lvbj1sb2NhbF9jb21wb25lbnQudmVyc2lvbg0KICAgICAgICAgICAgKQ0KICAgICAgICBleGNlcHQgUmVzb3VyY2VOb3RGb3VuZEVycm9yOg0KICAgICAgICAgICAgY3JlYXRlZF9jb21wb25lbnQgPSBwaXBlbGluZXNfcmVnaXN0cnlfY2xpZW50LmNvbXBvbmVudHMuY3JlYXRlX29yX3VwZGF0ZShsb2NhbF9jb21wb25lbnQpDQoNCiAgICAgICAgQHBpcGVsaW5lDQogICAgICAgIGRlZiBzYW1wbGVfcGlwZWxpbmUoKToNCiAgICAgICAgICAgIGNyZWF0ZWRfY29tcG9uZW50KCkNCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBzYW1wbGVfcGlwZWxpbmUoKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVzX3JlZ2lzdHJ5X2NsaWVudC5qb2JzLnZhbGlkYXRlKHBpcGVsaW5lX2pvYikucGFzc2VkDQoNCiAgICAjIHRoaXMgdGVzdCB3aWxsIGJyZWFrIGluIHBsYXliYWNrIG1vZGUsIHNvIGluY2x1ZGUgaXQgaW4gbGl2ZSB0ZXN0IG9ubHkNCiAgICBkZWYgdGVzdF9waXBlbGluZV93aXRoX2xvY2FsX2NvbXBvbmVudF9hbmRfcmVnaXN0cnlfbW9kZWxfYXNfaW5wdXQoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgICMgbG9hZF9jb21wb25lbnQNCiAgICAgICAgc2NvcmVfZnVuYyA9IGxvYWRfY29tcG9uZW50KCIuL3Rlc3RzL3Rlc3RfY29uZmlncy9waXBlbGluZV9qb2JzL2pvYl93aXRoX3JlZ2lzdHJ5X21vZGVsX2FzX2lucHV0L3Njb3JlLnltbCIpDQoNCiAgICAgICAgcGlwZWxpbmVfc2NvcmVfbW9kZWwgPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9ImN1c3RvbV9tb2RlbCIsIHBhdGg9ImF6dXJlbWw6Ly9yZWdpc3RyaWVzL3Nkay10ZXN0L21vZGVscy9pcmlzX21vZGVsL3ZlcnNpb25zLzEiDQogICAgICAgICkNCg0KICAgICAgICBhc3NlcnRfcGlwZWxpbmVfam9iX2NhbmNlbChjbGllbnQsIHNjb3JlX2Z1bmMsIHBpcGVsaW5lX3Njb3JlX21vZGVsLCBzZWxmLnRlc3RfZGF0YSkNCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3dpdGhfbG9jYWxfY29tcG9uZW50X2FuZF9yZWdpc3RyeV9tb2RlbF9hc19pbnB1dF93aXRoX21vZGVsX2lucHV0KA0KICAgICAgICBzZWxmLCBjbGllbnQ6IE1MQ2xpZW50LCBwaXBlbGluZXNfcmVnaXN0cnlfY2xpZW50OiBNTENsaWVudA0KICAgICk6DQogICAgICAgICMgbG9hZF9jb21wb25lbnQNCiAgICAgICAgc2NvcmVfZnVuYyA9IGxvYWRfY29tcG9uZW50KCIuL3Rlc3RzL3Rlc3RfY29uZmlncy9waXBlbGluZV9qb2JzL2pvYl93aXRoX3JlZ2lzdHJ5X21vZGVsX2FzX2lucHV0L3Njb3JlLnltbCIpDQoNCiAgICAgICAgbW9kZWxfcGF0aCA9IFBhdGgoIi4vdGVzdHMvdGVzdF9jb25maWdzL21vZGVsL21vZGVsX2lyaXMueW1sIikNCiAgICAgICAgbW9kZWxfZW50aXR5ID0gbG9hZF9tb2RlbChtb2RlbF9wYXRoKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBwaXBlbGluZV9zY29yZV9tb2RlbCA9IHBpcGVsaW5lc19yZWdpc3RyeV9jbGllbnQubW9kZWxzLmdldCgNCiAgICAgICAgICAgICAgICBuYW1lPW1vZGVsX2VudGl0eS5uYW1lLCB2ZXJzaW9uPW1vZGVsX2VudGl0eS52ZXJzaW9uDQogICAgICAgICAgICApDQogICAgICAgIGV4Y2VwdCBSZXNvdXJjZU5vdEZvdW5kRXJyb3I6DQogICAgICAgICAgICBtb2RlbF9lbnRpdHkgPSBwaXBlbGluZXNfcmVnaXN0cnlfY2xpZW50Lm1vZGVscy5jcmVhdGVfb3JfdXBkYXRlKG1vZGVsX2VudGl0eSkNCiAgICAgICAgICAgIHBpcGVsaW5lX3Njb3JlX21vZGVsID0gcGlwZWxpbmVzX3JlZ2lzdHJ5X2NsaWVudC5tb2RlbHMuZ2V0KA0KICAgICAgICAgICAgICAgIG5hbWU9bW9kZWxfZW50aXR5Lm5hbWUsIHZlcnNpb249bW9kZWxfZW50aXR5LnZlcnNpb24NCiAgICAgICAgICAgICkNCg0KICAgICAgICBhc3NlcnRfcGlwZWxpbmVfam9iX2NhbmNlbChjbGllbnQsIHNjb3JlX2Z1bmMsIHBpcGVsaW5lX3Njb3JlX21vZGVsLCBzZWxmLnRlc3RfZGF0YSkNCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3dpdGhfcmVnaXN0cnlfY29tcG9uZW50X2FuZF9tb2RlbF9hc19pbnB1dCgNCiAgICAgICAgc2VsZiwgY2xpZW50OiBNTENsaWVudCwgcGlwZWxpbmVzX3JlZ2lzdHJ5X2NsaWVudDogTUxDbGllbnQNCiAgICApOg0KICAgICAgICAjIGxvYWRfY29tcG9uZW50DQogICAgICAgIHNjb3JlX2NvbXBvbmVudF9uYW1lLCBjb21wb25lbnRfdmVyc2lvbiA9ICJzY29yZV9jb21wb25lbnQiLCAiMiINCiAgICAgICAgc2NvcmVfZnVuYyA9IHBpcGVsaW5lc19yZWdpc3RyeV9jbGllbnQuY29tcG9uZW50cy5nZXQobmFtZT1zY29yZV9jb21wb25lbnRfbmFtZSwgdmVyc2lvbj1jb21wb25lbnRfdmVyc2lvbikNCg0KICAgICAgICBwaXBlbGluZV9zY29yZV9tb2RlbCA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT0ibWxmbG93X21vZGVsIiwgcGF0aD0iYXp1cmVtbDovL3JlZ2lzdHJpZXMvc2RrLXRlc3QvbW9kZWxzL2lyaXNfbW9kZWwvdmVyc2lvbnMvMSINCiAgICAgICAgKQ0KDQogICAgICAgIGFzc2VydF9waXBlbGluZV9qb2JfY2FuY2VsKGNsaWVudCwgc2NvcmVfZnVuYywgcGlwZWxpbmVfc2NvcmVfbW9kZWwsIHNlbGYudGVzdF9kYXRhKQ0K",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "d1TaRP31HP1J\u002BHb81i1/OQ==",
        "Date": "Wed, 24 May 2023 03:02:48 GMT",
        "ETag": "\u00220x8DB5C035BBF30AF\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:49 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "0cWl0GL\u002BlYU=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_dsl_pipeline_samples.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "20096",
        "Content-MD5": "TDs7GLKhKxqQCkOdJ5l/fw==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "IiIiDQpUaGlzIGZpbGUgY292ZXJzIGFsbCBzYW1wbGUgcGlwZWxpbmUgaW4gaHR0cHM6Ly9naXRodWIuY29tL0F6dXJlL2F6dXJlbWwtcHJldmlld3MvdHJlZS9tYWluL3ByZXZpZXdzL3BpcGVsaW5lcy9zYW1wbGVzDQppbiBkc2wucGlwZWxpbmUuDQpUaGUgc2FtcGxlcyBhcmUgY29waWVkIHRvIHRlc3RfY29uZmlncy9kc2xfcGlwZWxpbmVfc2FtcGxlcw0KIiIiDQppbXBvcnQganNvbg0KaW1wb3J0IHN5cw0KZnJvbSBwYXRobGliIGltcG9ydCBQYXRoDQoNCmltcG9ydCBweWRhc2gNCmltcG9ydCBweXRlc3QNCmZyb20gZGV2dG9vbHNfdGVzdHV0aWxzIGltcG9ydCBBenVyZVJlY29yZGVkVGVzdENhc2UsIGlzX2xpdmUNCmZyb20gdGVzdF91dGlsaXRpZXMudXRpbHMgaW1wb3J0IF9QWVRFU1RfVElNRU9VVF9NRVRIT0QsIGFzc2VydF9qb2JfY2FuY2VsDQoNCmZyb20gYXp1cmUuYWkubWwgaW1wb3J0IE1MQ2xpZW50LCBsb2FkX2pvYg0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcyBpbXBvcnQgQ29tcG9uZW50IGFzIENvbXBvbmVudEVudGl0eQ0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcyBpbXBvcnQgUGlwZWxpbmVKb2INCmZyb20gYXp1cmUuYWkubWwub3BlcmF0aW9ucy5fcnVuX2hpc3RvcnlfY29uc3RhbnRzIGltcG9ydCBKb2JTdGF0dXMNCg0KZnJvbSAuLl91dGlsIGltcG9ydCBfRFNMX1RJTUVPVVRfU0VDT05EDQoNCnRlc3RzX3Jvb3RfZGlyID0gUGF0aChfX2ZpbGVfXykucGFyZW50LnBhcmVudC5wYXJlbnQNCnN5cy5wYXRoLmluc2VydCgwLCBzdHIodGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzIikpDQpzYW1wbGVzX2RpciA9IHRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvIg0KDQoNCmRlZiBhc3NlcnRfam9iX2NvbXBsZXRlZChwaXBlbGluZSwgY2xpZW50OiBNTENsaWVudCk6DQogICAgam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkNCiAgICBjbGllbnQuam9icy5zdHJlYW0oam9iLm5hbWUpDQogICAgYXNzZXJ0IGNsaWVudC5qb2JzLmdldChqb2IubmFtZSkuc3RhdHVzID09IEpvYlN0YXR1cy5DT01QTEVURUQNCg0KDQpkZWYgYXNzZXJ0X2RzbF9jdXJhdGVkKHBpcGVsaW5lOiBQaXBlbGluZUpvYiwgam9iX3lhbWwsIG9taXRfZmllbGRzKToNCiAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBwaXBlbGluZS5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICBwaXBlbGluZV9qb2JfZGljdCA9IGxvYWRfam9iKHNvdXJjZT1qb2JfeWFtbCkuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpDQoNCiAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBweWRhc2gub21pdChkc2xfcGlwZWxpbmVfam9iX2RpY3QsIG9taXRfZmllbGRzKQ0KICAgIHBpcGVsaW5lX2pvYl9kaWN0ID0gcHlkYXNoLm9taXQocGlwZWxpbmVfam9iX2RpY3QsIG9taXRfZmllbGRzKQ0KICAgIHByaW50KGpzb24uZHVtcHMoZHNsX3BpcGVsaW5lX2pvYl9kaWN0LCBpbmRlbnQ9MikpDQogICAgcHJpbnQoanNvbi5kdW1wcyhwaXBlbGluZV9qb2JfZGljdCwgaW5kZW50PTIpKQ0KICAgIGFzc2VydCBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPT0gcGlwZWxpbmVfam9iX2RpY3QNCg0KDQpAcHl0ZXN0Lm1hcmsudXNlZml4dHVyZXMoDQogICAgImVuYWJsZV9lbnZpcm9ubWVudF9pZF9hcm1fZXhwYW5zaW9uIiwNCiAgICAiZW5hYmxlX3BpcGVsaW5lX3ByaXZhdGVfcHJldmlld19mZWF0dXJlcyIsDQogICAgIm1vY2tfY29kZV9oYXNoIiwNCiAgICAibW9ja19jb21wb25lbnRfaGFzaCIsDQogICAgIm1vY2tfc2V0X2hlYWRlcnNfd2l0aF91c2VyX2FtbF90b2tlbiIsDQogICAgInJlY29yZGVkX3Rlc3QiLA0KICAgICJtb2NrX2Fzc2V0X25hbWUiLA0KICAgICJtb2NrX2Fub25fY29tcG9uZW50X3ZlcnNpb24iLA0KKQ0KQHB5dGVzdC5tYXJrLnRpbWVvdXQodGltZW91dD1fRFNMX1RJTUVPVVRfU0VDT05ELCBtZXRob2Q9X1BZVEVTVF9USU1FT1VUX01FVEhPRCkNCkBweXRlc3QubWFyay5lMmV0ZXN0DQpAcHl0ZXN0Lm1hcmsucGlwZWxpbmVfdGVzdA0KY2xhc3MgVGVzdERTTFBpcGVsaW5lU2FtcGxlcyhBenVyZVJlY29yZGVkVGVzdENhc2UpOg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZTJlX2xvY2FsX2NvbXBvbmVudHMoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmUyZV9sb2NhbF9jb21wb25lbnRzLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZTJlX2xvY2FsX2NvbXBvbmVudHMsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGUyZV9sb2NhbF9jb21wb25lbnRzKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZTJlX3JlZ2lzdGVyZWRfY29tcG9uZW50cygNCiAgICAgICAgc2VsZiwNCiAgICAgICAgY2xpZW50OiBNTENsaWVudCwNCiAgICAgICAgcGlwZWxpbmVfc2FtcGxlc19lMmVfcmVnaXN0ZXJlZF90cmFpbl9jb21wb25lbnRzOiBDb21wb25lbnRFbnRpdHksDQogICAgICAgIHBpcGVsaW5lX3NhbXBsZXNfZTJlX3JlZ2lzdGVyZWRfc2NvcmVfY29tcG9uZW50czogQ29tcG9uZW50RW50aXR5LA0KICAgICAgICBwaXBlbGluZV9zYW1wbGVzX2UyZV9yZWdpc3RlcmVkX2V2YWxfY29tcG9uZW50czogQ29tcG9uZW50RW50aXR5LA0KICAgICkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmUyZV9yZWdpc3RlcmVkX2NvbXBvbmVudHMucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBlMmVfcmVnaXN0ZXJlZF9jb21wb25lbnRzLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBlMmVfcmVnaXN0ZXJlZF9jb21wb25lbnRzKA0KICAgICAgICAgICAgY2xpZW50PWNsaWVudCwNCiAgICAgICAgICAgIHBpcGVsaW5lX3NhbXBsZXNfZTJlX3JlZ2lzdGVyZWRfdHJhaW5fY29tcG9uZW50cz1waXBlbGluZV9zYW1wbGVzX2UyZV9yZWdpc3RlcmVkX3RyYWluX2NvbXBvbmVudHMsDQogICAgICAgICAgICBwaXBlbGluZV9zYW1wbGVzX2UyZV9yZWdpc3RlcmVkX3Njb3JlX2NvbXBvbmVudHM9cGlwZWxpbmVfc2FtcGxlc19lMmVfcmVnaXN0ZXJlZF9zY29yZV9jb21wb25lbnRzLA0KICAgICAgICAgICAgcGlwZWxpbmVfc2FtcGxlc19lMmVfcmVnaXN0ZXJlZF9ldmFsX2NvbXBvbmVudHM9cGlwZWxpbmVfc2FtcGxlc19lMmVfcmVnaXN0ZXJlZF9ldmFsX2NvbXBvbmVudHMsDQogICAgICAgICkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCiAgICAgICAgIyBtb3ZlIHVuaXQgdGVzdCBoZXJlIGR1ZSB0byBwZXJtaXNzaW9uIHByb2JsZW0NCiAgICAgICAgam9iX3lhbWwgPSBzdHIoc2FtcGxlc19kaXIgLyAiZTJlX3JlZ2lzdGVyZWRfY29tcG9uZW50cy9waXBlbGluZS55bWwiKQ0KICAgICAgICBvbWl0X2ZpZWxkcyA9IFsNCiAgICAgICAgICAgICJwcm9wZXJ0aWVzLmV4cGVyaW1lbnRfbmFtZSIsDQogICAgICAgICAgICAibmFtZSIsDQogICAgICAgICAgICAicHJvcGVydGllcy5qb2JzLnRyYWluX2pvYi5jb21wb25lbnRJZCIsDQogICAgICAgICAgICAicHJvcGVydGllcy5qb2JzLnNjb3JlX2pvYi5jb21wb25lbnRJZCIsDQogICAgICAgICAgICAicHJvcGVydGllcy5qb2JzLmV2YWx1YXRlX2pvYi5jb21wb25lbnRJZCIsDQogICAgICAgICAgICAicHJvcGVydGllcy5qb2JzLnRyYWluX2pvYi5yZXNvdXJjZXMiLCAgIyBqb2IgeWFtbCB3b24ndCBoYXZlIHJlc291cmNlcyBidXQgd2Ugd2lsbCBwYXNzIHRoZW0NCiAgICAgICAgICAgICJwcm9wZXJ0aWVzLmpvYnMuc2NvcmVfam9iLnJlc291cmNlcyIsDQogICAgICAgICAgICAicHJvcGVydGllcy5qb2JzLmV2YWx1YXRlX2pvYi5yZXNvdXJjZXMiLA0KICAgICAgICAgICAgInByb3BlcnRpZXMuaW5wdXRzLnBpcGVsaW5lX2pvYl90cmFpbmluZ19pbnB1dC51cmkiLA0KICAgICAgICAgICAgInByb3BlcnRpZXMuaW5wdXRzLnBpcGVsaW5lX2pvYl90ZXN0X2lucHV0LnVyaSIsDQogICAgICAgICAgICAicHJvcGVydGllcy5wcm9wZXJ0aWVzIiwNCiAgICAgICAgICAgICJwcm9wZXJ0aWVzLmNvbXB1dGVfaWQiLA0KICAgICAgICAgICAgInByb3BlcnRpZXMuc2V0dGluZ3MiLA0KICAgICAgICBdDQogICAgICAgIGFzc2VydF9kc2xfY3VyYXRlZChwaXBlbGluZSwgam9iX3lhbWwsIG9taXRfZmllbGRzKQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9iYXNpY19jb21wb25lbnQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmJhc2ljX2NvbXBvbmVudC5waXBlbGluZSBpbXBvcnQgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIGJhc2ljX2NvbXBvbmVudA0KDQogICAgICAgIHBpcGVsaW5lID0gYmFzaWNfY29tcG9uZW50KCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfY29tcG9uZW50X3dpdGhfaW5wdXRfb3V0cHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5jb21wb25lbnRfd2l0aF9pbnB1dF9vdXRwdXQucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBjb21wb25lbnRfd2l0aF9pbnB1dF9vdXRwdXQsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGNvbXBvbmVudF93aXRoX2lucHV0X291dHB1dCgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2Jhc2ljX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5iYXNpY19waXBlbGluZS5waXBlbGluZSBpbXBvcnQgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIGJhc2ljX3BpcGVsaW5lDQoNCiAgICAgICAgcGlwZWxpbmUgPSBiYXNpY19waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3dpdGhfZGF0YShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUucGlwbGluZV93aXRoX2RhdGEucGlwZWxpbmUgaW1wb3J0IGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBwaXBsaW5lX3dpdGhfZGF0YQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwbGluZV93aXRoX2RhdGEoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9sb2NhbF9kYXRhX2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5sb2NhbF9kYXRhX2lucHV0LnBpcGVsaW5lIGltcG9ydCBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgbG9jYWxfZGF0YV9pbnB1dA0KDQogICAgICAgIHBpcGVsaW5lID0gbG9jYWxfZGF0YV9pbnB1dCgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2RhdGFzdG9yZV9kYXRhcGF0aF91cmlfZm9sZGVyKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhc3RvcmVfZGF0YXBhdGhfdXJpX2ZvbGRlci5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIGRhdGFzdG9yZV9kYXRhcGF0aF91cmlfZm9sZGVyLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhc3RvcmVfZGF0YXBhdGhfdXJpX2ZvbGRlcigpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2RhdGFzdG9yZV9kYXRhcGF0aF91cmlfZmlsZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZGF0YXN0b3JlX2RhdGFwYXRoX3VyaV9maWxlLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZGF0YXN0b3JlX2RhdGFwYXRoX3VyaV9maWxlLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhc3RvcmVfZGF0YXBhdGhfdXJpX2ZpbGUoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9kYXRhc2V0X2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhc2V0X2lucHV0LnBpcGVsaW5lIGltcG9ydCBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZGF0YXNldF9pbnB1dA0KDQogICAgICAgIHBpcGVsaW5lID0gZGF0YXNldF9pbnB1dChjbGllbnQpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3dlYl91cmxfaW5wdXQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLndlYl91cmxfaW5wdXQucGlwZWxpbmUgaW1wb3J0IGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyB3ZWJfdXJsX2lucHV0DQoNCiAgICAgICAgcGlwZWxpbmUgPSB3ZWJfdXJsX2lucHV0KCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZW52X3B1YmxpY19kb2NrZXJfaW1hZ2Uoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmVudl9wdWJsaWNfZG9ja2VyX2ltYWdlLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZW52X3B1YmxpY19kb2NrZXJfaW1hZ2UsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGVudl9wdWJsaWNfZG9ja2VyX2ltYWdlKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZW52X3JlZ2lzdGVyZWQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmVudl9yZWdpc3RlcmVkLnBpcGVsaW5lIGltcG9ydCBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZW52X3JlZ2lzdGVyZWQNCg0KICAgICAgICBwaXBlbGluZSA9IGVudl9yZWdpc3RlcmVkKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZW52X2NvbmRhX2ZpbGUoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmVudl9jb25kYV9maWxlLnBpcGVsaW5lIGltcG9ydCBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZW52X2NvbmRhX2ZpbGUNCg0KICAgICAgICBwaXBlbGluZSA9IGVudl9jb25kYV9maWxlKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfdGZfaGVsbG9fd29ybGQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLnRmX2hlbGxvX3dvcmxkLnBpcGVsaW5lIGltcG9ydCBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgdGZfaGVsbG9fd29ybGQNCg0KICAgICAgICBwaXBlbGluZSA9IHRmX2hlbGxvX3dvcmxkKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfbXBpX2hlbGxvX3dvcmxkKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5tcGlfaGVsbG9fd29ybGQucGlwZWxpbmUgaW1wb3J0IGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBtcGlfaGVsbG9fd29ybGQNCg0KICAgICAgICBwaXBlbGluZSA9IG1waV9oZWxsb193b3JsZCgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3B5dG9yY2hfaGVsbG9fd29ybGQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLnB5dG9yY2hfaGVsbG9fd29ybGQucGlwZWxpbmUgaW1wb3J0IGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBweXRvcmNoX2hlbGxvX3dvcmxkDQoNCiAgICAgICAgcGlwZWxpbmUgPSBweXRvcmNoX2hlbGxvX3dvcmxkKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfbnljX3RheGlfZGF0YV9yZWdyZXNzaW9uKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5ueWNfdGF4aV9kYXRhX3JlZ3Jlc3Npb24ucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBueWNfdGF4aV9kYXRhX3JlZ3Jlc3Npb24sDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IG55Y190YXhpX2RhdGFfcmVncmVzc2lvbigpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3RmX21uaXN0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS50Zl9tbmlzdC5waXBlbGluZSBpbXBvcnQgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIHRmX21uaXN0DQoNCiAgICAgICAgcGlwZWxpbmUgPSB0Zl9tbmlzdCgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2UyZV9pbmxpbmVfY29tcG9uZW50cyhzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZTJlX2lubGluZV9jb21wb25lbnRzLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgZTJlX2lubGluZV9jb21wb25lbnRzLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBlMmVfaW5saW5lX2NvbXBvbmVudHMoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLnVzZWZpeHR1cmVzKCJtb2NrX2Fzc2V0X25hbWUiKQ0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfY29tbWFuZF9qb2JfaW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmNvbW1hbmRfam9iX2luX3BpcGVsaW5lLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgY29tbWFuZF9qb2JfaW5fcGlwZWxpbmUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGNvbW1hbmRfam9iX2luX3BpcGVsaW5lKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfbXVsdGlfcGFyYWxsZWxfY29tcG9uZW50c193aXRoX2ZpbGVfaW5wdXRfcGlwZWxpbmVfb3V0cHV0KA0KICAgICAgICBzZWxmLA0KICAgICAgICBjbGllbnQ6IE1MQ2xpZW50LA0KICAgICkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLnBhcmFsbGVsX2NvbXBvbmVudF93aXRoX2ZpbGVfaW5wdXQucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZSBhcyBwaXBlbGluZV93aXRoX3BhcmFsbGVsX2NvbXBvbmVudHMsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhfcGFyYWxsZWxfY29tcG9uZW50cygpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3BhcmFsbGVsX2NvbXBvbmVudHNfd2l0aF90YWJ1bGFyX2lucHV0X3BpcGVsaW5lX291dHB1dChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUucGFyYWxsZWxfY29tcG9uZW50X3dpdGhfdGFidWxhcl9pbnB1dC5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIHBpcGVsaW5lX3dpdGhfcGFyYWxsZWxfY29tcG9uZW50cywNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9wYXJhbGxlbF9jb21wb25lbnRzKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfcGFyYWxsZWxfY29tcG9uZW50cyhzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUucGFyYWxsZWxfY29tcG9uZW50LnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgcGlwZWxpbmVfd2l0aF9wYXJhbGxlbF9jb21wb25lbnRzLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX3BhcmFsbGVsX2NvbXBvbmVudHMoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9hdXRvbWxfam9iX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5hdXRvbWxfam9iX2luX3BpcGVsaW5lLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgYXV0b21sX2pvYl9pbl9waXBlbGluZSwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gYXV0b21sX2pvYl9pbl9waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3dpdGhfcGlwZWxpbmVfY29tcG9uZW50KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5waXBlbGluZV93aXRoX3BpcGVsaW5lX2NvbXBvbmVudC5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIHBpcGVsaW5lX3dpdGhfcGlwZWxpbmVfY29tcG9uZW50LA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX3BpcGVsaW5lX2NvbXBvbmVudCgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3dpdGhfZGF0YV9hc19pbnB1dHNfZm9yX3BpcGVsaW5lX2NvbXBvbmVudChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUucGlwZWxpbmVfd2l0aF9waXBlbGluZV9jb21wb25lbnQucGlwZWxpbmVfd2l0aF9kYXRhX2FzX2lucHV0IGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUgYXMgcGlwZWxpbmVfd2l0aF9waXBlbGluZV9jb21wb25lbnQsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhfcGlwZWxpbmVfY29tcG9uZW50KGNsaWVudCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3Rfc3Bhcmtfam9iX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5zcGFya19qb2JfaW5fcGlwZWxpbmUucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9mcm9tX3lhbWwgYXMgc3Bhcmtfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBzcGFya19qb2JfaW5fcGlwZWxpbmUoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9zcGFya19qb2Jfd2l0aF9idWlsZGVyX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5zcGFya19qb2JfaW5fcGlwZWxpbmUucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9mcm9tX2J1aWxkZXIgYXMgc3Bhcmtfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBzcGFya19qb2JfaW5fcGlwZWxpbmUoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9zcGFya19qb2Jfd2l0aF9tdWx0aXBsZV9ub2RlX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5zcGFya19qb2JfaW5fcGlwZWxpbmUua21lYW5zX3NhbXBsZS5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lX2Zyb21feWFtbCBhcyBzcGFya19qb2JfaW5fcGlwZWxpbmUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHNwYXJrX2pvYl9pbl9waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3NwYXJrX2pvYl93aXRoX2J1aWxkZXJfaW5fcGlwZWxpbmVfd2l0aG91dF9lbnRyeSgNCiAgICAgICAgc2VsZiwNCiAgICAgICAgY2xpZW50OiBNTENsaWVudCwNCiAgICApIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5zcGFya19qb2JfaW5fcGlwZWxpbmUuaW52YWxpZF9waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lX2Zyb21fYnVpbGRlcl93aXRob3V0X2VudHJ5IGFzIHNwYXJrX2pvYl9pbl9waXBlbGluZSwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gc3Bhcmtfam9iX2luX3BpcGVsaW5lKCkNCiAgICAgICAgd2l0aCBweXRlc3QucmFpc2VzKEV4Y2VwdGlvbikgYXMgZXg6DQogICAgICAgICAgICBjcmVhdGVkX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUpDQoNCiAgICAgICAgYXNzZXJ0ICgNCiAgICAgICAgICAgICd7XG4gICJyZXN1bHQiOiAiRmFpbGVkIixcbiAgImVycm9ycyI6IFtcbiAgICB7XG4gICAgICAibWVzc2FnZSI6ICJNaXNzaW5nIGRhdGEgZm9yIHJlcXVpcmVkIGZpZWxkLiIsJw0KICAgICAgICAgICAgJ1xuICAgICAgInBhdGgiOiAiam9icy5hZGRfZ3JlZXRpbmdfY29sdW1uLmNvbXBvbmVudC5lbnRyeSIsXG4gICAgICAidmFsdWUiOiBudWxsXG4gICAgfVxuICBdXG59Jw0KICAgICAgICAgICAgPT0gc3RyKGV4LnZhbHVlKQ0KICAgICAgICApDQoNCiAgICAgICAgdmFsaWRhdGlvbl9yZXN1bHQgPSBjbGllbnQuam9icy52YWxpZGF0ZShwaXBlbGluZSkNCiAgICAgICAgYXNzZXJ0IHZhbGlkYXRpb25fcmVzdWx0LnBhc3NlZCBpcyBGYWxzZQ0KICAgICAgICBhc3NlcnQgdmFsaWRhdGlvbl9yZXN1bHQuZXJyb3JfbWVzc2FnZXMgPT0gew0KICAgICAgICAgICAgImpvYnMuYWRkX2dyZWV0aW5nX2NvbHVtbi5jb21wb25lbnQuZW50cnkiOiAiTWlzc2luZyBkYXRhIGZvciByZXF1aXJlZCBmaWVsZC4iLA0KICAgICAgICB9DQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X3NwYXJrX2pvYl93aXRoX2J1aWxkZXJfaW5fcGlwZWxpbmVfd2l0aF9keW5hbWljX2FsbG9jYXRpb25fZGlzYWJsZWQoDQogICAgICAgIHNlbGYsDQogICAgICAgIGNsaWVudDogTUxDbGllbnQsDQogICAgKSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuc3Bhcmtfam9iX2luX3BpcGVsaW5lLmludmFsaWRfcGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9mcm9tX2J1aWxkZXJfd2l0aF9keW5hbWljX2FsbG9jYXRpb25fZGlzYWJsZWQgYXMgc3Bhcmtfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBzcGFya19qb2JfaW5fcGlwZWxpbmUoKQ0KICAgICAgICB3aXRoIHB5dGVzdC5yYWlzZXMoRXhjZXB0aW9uKSBhcyBleDoNCiAgICAgICAgICAgIGNyZWF0ZWRfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkNCg0KICAgICAgICBhc3NlcnQgKA0KICAgICAgICAgICAgJ3tcbiAgInJlc3VsdCI6ICJGYWlsZWQiLFxuICAiZXJyb3JzIjogW1xuICAgIHtcbiAgICAgICJtZXNzYWdlIjogIlNob3VsZCBub3Qgc3BlY2lmeSBtaW4gb3IgbWF4ICcNCiAgICAgICAgICAgICdleGVjdXRvcnMgd2hlbiBkeW5hbWljIGFsbG9jYXRpb24gaXMgZGlzYWJsZWQuIixcbicgaW4gc3RyKGV4LnZhbHVlKQ0KICAgICAgICApDQoNCiAgICAgICAgdmFsaWRhdGlvbl9yZXN1bHQgPSBjbGllbnQuam9icy52YWxpZGF0ZShwaXBlbGluZSkNCiAgICAgICAgYXNzZXJ0IHZhbGlkYXRpb25fcmVzdWx0LnBhc3NlZCBpcyBGYWxzZQ0KICAgICAgICBhc3NlcnQgdmFsaWRhdGlvbl9yZXN1bHQuZXJyb3JfbWVzc2FnZXMgPT0gew0KICAgICAgICAgICAgImpvYnMuYWRkX2dyZWV0aW5nX2NvbHVtbi5jb25mIjogIlNob3VsZCBub3Qgc3BlY2lmeSBtaW4gb3IgbWF4IGV4ZWN1dG9ycyAiDQogICAgICAgICAgICAid2hlbiBkeW5hbWljIGFsbG9jYXRpb24gaXMgZGlzYWJsZWQuIiwNCiAgICAgICAgfQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9kYXRhX3RyYW5zZmVyX2NvcHlfMnVyaWZvbGRlcl9qb2JfaW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLmRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lLmNvcHlfZGF0YS5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lX2Zyb21feWFtbCBhcyBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50LCBza2lwX2NhbmNlbD1UcnVlKQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9kYXRhX3RyYW5zZmVyX2NvcHlfMnVyaWZvbGRlcl9qb2Jfd2l0aF9idWlsZGVyX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZS5jb3B5X2RhdGEucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9mcm9tX2J1aWxkZXIgYXMgZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZGF0YV90cmFuc2Zlcl9jb3B5X21peHR5cGVfam9iX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZS5jb3B5X2RhdGEucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9jb3B5X21peHR5cGVfZnJvbV95YW1sIGFzIGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2RhdGFfdHJhbnNmZXJfY29weV91cmlmaWxlX2pvYl9pbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUuY29weV9kYXRhLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmVfY29weV91cmlmaWxlX2Zyb21feWFtbCBhcyBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9kYXRhX3RyYW5zZmVyX2NvcHlfdXJpZm9sZGVyX2pvYl9pbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUuY29weV9kYXRhLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmVfY29weV91cmlmb2xkZXJfZnJvbV95YW1sIGFzIGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2RhdGFfdHJhbnNmZXJfaW1wb3J0X2ZpbGVzeXN0ZW1fam9iX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZS5pbXBvcnRfZmlsZV9zeXN0ZW0ucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9mcm9tX2J1aWxkZXIgYXMgZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZGF0YV90cmFuc2Zlcl9pbXBvcnRfc3FsX2RhdGFiYXNlX2pvYl9pbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUuaW1wb3J0X2RhdGFiYXNlLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmVfZnJvbV9idWlsZGVyX3NxbCBhcyBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUoKQ0KICAgICAgICBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgQHB5dGVzdC5tYXJrLmUyZXRlc3QNCiAgICBkZWYgdGVzdF9kYXRhX3RyYW5zZmVyX2ltcG9ydF9zbm93Zmxha2VfZGF0YWJhc2Vfam9iX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZS5pbXBvcnRfZGF0YWJhc2UucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIGdlbmVyYXRlX2RzbF9waXBlbGluZV9mcm9tX2J1aWxkZXIgYXMgZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lKCkNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgIEBweXRlc3QubWFyay5lMmV0ZXN0DQogICAgZGVmIHRlc3RfZGF0YV90cmFuc2Zlcl9leHBvcnRfc3FsX2RhdGFiYXNlX2pvYl9pbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUuZXhwb3J0X2RhdGFiYXNlLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmVfZnJvbV9idWlsZGVyIGFzIGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KICAgIGRlZiB0ZXN0X2RhdGFfdHJhbnNmZXJfbXVsdGlfam9iX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5kYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZS5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgZ2VuZXJhdGVfZHNsX3BpcGVsaW5lIGFzIGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSgpDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQo=",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "TDs7GLKhKxqQCkOdJ5l/fw==",
        "Date": "Wed, 24 May 2023 03:02:49 GMT",
        "ETag": "\u00220x8DB5C035BE0BD65\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:49 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "kihQiUXyICw=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/__init__.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "0",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": null,
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "1B2M2Y8AsgTpgAmY7PhCfg==",
        "Date": "Wed, 24 May 2023 03:02:50 GMT",
        "ETag": "\u00220x8DB5C035C2FBBDC\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:50 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "AAAAAAAAAAA=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_dsl_fl.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "10689",
        "Content-MD5": "inmxw/YWaah2Xwl6ksU/EQ==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "aW1wb3J0IHB5dGVzdA0KZnJvbSBwYXRobGliIGltcG9ydCBQYXRoDQpmcm9tIGRldnRvb2xzX3Rlc3R1dGlscyBpbXBvcnQgQXp1cmVSZWNvcmRlZFRlc3RDYXNlLCBpc19saXZlDQpmcm9tIGF6dXJlLmNvcmUuZXhjZXB0aW9ucyBpbXBvcnQgUmVzb3VyY2VOb3RGb3VuZEVycm9yDQpmcm9tIC4uX3V0aWwgaW1wb3J0IF9EU0xfVElNRU9VVF9TRUNPTkQNCmZyb20gdGVzdF91dGlsaXRpZXMudXRpbHMgaW1wb3J0IF9QWVRFU1RfVElNRU9VVF9NRVRIT0QNCmZyb20gYXp1cmUuYWkubWwgaW1wb3J0IElucHV0LCBsb2FkX2NvbXBvbmVudA0KZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlDQpmcm9tIGF6dXJlLmFpLm1sLmRzbC5fZmxfc2NhdHRlcl9nYXRoZXJfbm9kZSBpbXBvcnQgZmxfc2NhdHRlcl9nYXRoZXINCmZyb20gYXp1cmUuYWkubWwuZW50aXRpZXMuX2Fzc2V0cy5mZWRlcmF0ZWRfbGVhcm5pbmdfc2lsbyBpbXBvcnQgRmVkZXJhdGVkTGVhcm5pbmdTaWxvDQpmcm9tIGF6dXJlLmFpLm1sLmNvbnN0YW50cyBpbXBvcnQgQXNzZXRUeXBlcw0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcy5fY3JlZGVudGlhbHMgaW1wb3J0ICgNCiAgICBJZGVudGl0eUNvbmZpZ3VyYXRpb24sDQogICAgSWRlbnRpdHlDb25maWd1cmF0aW9uVHlwZSwNCiAgICBNYW5hZ2VkSWRlbnRpdHlDb25maWd1cmF0aW9uLA0KKQ0KZnJvbSBhenVyZS5haS5tbC5kc2wgaW1wb3J0IHBpcGVsaW5lDQppbXBvcnQgb3MNCmZyb20gYXp1cmUuYWkubWwgaW1wb3J0ICgNCiAgICBNTENsaWVudCwNCikNCg0KDQojIFJFU09VUkNFIE5PVEVTIC0gQXMgYW4gZTJlIHRlc3QgZmlsZSwgdGhpcyBmaWxlIG1ha2VzIGFuZCByZWZlcmVuY2VzIHJlYWwgQU1MIHJlc291cmNlcy4NCiMgQWxsIHJlc291cmNlcyByZWZlcmVuY2VzIGJ5IHRoaXMgZmlsZSBhcmUgY29udGFpbmVkIHdpdGhpbiB0aGUgZm9sbG93aW5nOg0KIyBzdWJzY3JpcHRpb246IGRhdGEgc2NpZW5jZSBWTSBUZWFtIChEU1ZNKQ0KIyByZXNvdXJjZSBncm91cDogZmwtZTJlLXRlc3RpbmctcmcNCiMgd29ya3NwYWNlOiBmbC1lMmUtdGVzdGluZy13cw0KIyBJZiB5b3UncmUgcnVubmluZyB0aGlzIHRlc3QgbG9jYWxseSBpbiBsaXZlIG1vZGUsIG1ha2Ugc3VyZSB5b3UndmUgc2V0IHRoZSBhYm92ZSB2YWx1ZXMgaW4NCiMgeW91ciAuZW52IGZpbGUuDQojIHJlc291cmNlcyBvZiBub3RlOg0KIyAtIG11bHRpcGxlIHN0b3JhZ2UgY29udGFpbmVycw0KIyAtIG11bHRpcGxlIGNvbXB1dGVzIHdpdGggdmFyeWluZyBtYW5hZ2VkIGlkZW50aXRpZXMgdG8gYWxsb3cgYWNjZXNzIHRvIGRpZmZlcmVudCBzdG9yYWdlIGNvbnRhaW5lcnMNCkBweXRlc3QubWFyay50aW1lb3V0KHRpbWVvdXQ9X0RTTF9USU1FT1VUX1NFQ09ORCwgbWV0aG9kPV9QWVRFU1RfVElNRU9VVF9NRVRIT0QpDQpAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KQHB5dGVzdC5tYXJrLmNvcmVfc2RrX3Rlc3QNCmNsYXNzIFRlc3REU0xQaXBlbGluZShBenVyZVJlY29yZGVkVGVzdENhc2UpOg0KICAgICMgREVWIE5PVEU6IFRoaXMgdGVzdCBleHBlY3RzIGEgbG90IG9mIHJlc291cmNlcyB0byBhbHJlYWR5IGV4aXN0IGluIEFNTC4gVGhlIGluaXRpYWwgaW1wbGVtZW50YXRpb24NCiAgICAjIG9mIHRoaXMgdGVzdCBpbXBsZW1lbnRlZCBhbGwgb2YgdGhlc2UgdGhpZ25zIHVuZGVyIHRoZSAnZmwtZTJlLXRlc3RpbmctcmcnIHJlc291cmNlIGdyb3VwIGFuZA0KICAgICMgdGhlICdmbC1lMmUtdGVzdGluZy13cycgd29ya3NwYWNlIGluc2lkZSB0aGF0IFJHLg0KICAgICMgVGhlIG5lZWRlZCByZXNvdXJjZXMgYXJlOg0KICAgICMgLSBJbiB0aGUgd29ya3NwYWNlJ3Mgc3RvcmFnZSBhY2NvdW50LCAzIGNvbnRhaW5lcnMgbmFtZWQgJ3NpbG8tY29udGFpbmVyMScsICdzaWxvLWNvbnRhaW5lcjIzJywNCiAgICAjICAgICAgIGFuZCAnYWdnLWNvbnRhaW5lcicuIEVhY2ggY29udGFpbmVyIG5lZWRzIHRvIGhhdmUgYXNzaWduZWQgdGhlIGJsb2Igb3duZXIgcGVybWlzc2lvbg0KICAgICMgICAgICAgdG8gdGhlICd0ZXN0LW1zaS1pZCcgbWFuYWdlZCBpZGVudGl0eQ0KICAgICMgLSA0IGNvbXB1dGUgY2x1c3RlcnMgaW4gdGhlIHdvcmtzcGFjZSBuYW1lZCBzaWxvQ29tcHV0ZTEvMi8zIGFuZCBhZ2dDb21wdXRlLiBFYWNoIG9mIHdoaWNoDQogICAgIyAgICAgICBoYXMgYmVlbiBhc3NpZ25lZCB0aGUgJ3Rlc3QtbXNpLWlkJyBJRA0KICAgICMgLSA0IGRhdGFzdG9yZXMgY29ubmVjdGVkIHRvIHRoZSBhZm9yZW1lbnRpb25lZCBzdG9yYWdlIGNvbnRhaW5lcnMgbmFtZWQgc2lsb19kYXRhc3RvcmUxLzIvMyBhbmQNCiAgICAjICAgICAgIGFnZ19kYXRhc3RvcmUuDQogICAgQHB5dGVzdC5tYXJrLnNraXBpZigNCiAgICAgICAgY29uZGl0aW9uPW5vdCBpc19saXZlKCksDQogICAgICAgIHJlYXNvbj0oDQogICAgICAgICAgICAiVE9ETyAoMjIzNTAzNCkgVGhlIGNyaXRpY2FsIGNhbGwgdG8gYGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGVgIHNlZW1zIHRvIG1ha2UgZGlmZmVyZW50Ig0KICAgICAgICAgICAgKyAiQVBJIGNhbGxzIGluIHBsYXliYWNrIG1vZGUgY29tcGFyZWQgdG8gcmVjb3JkaW5nIG1vZGUiDQogICAgICAgICksDQogICAgKQ0KICAgIGRlZiB0ZXN0X2ZsX3BpcGVsaW5lKA0KICAgICAgICBzZWxmLA0KICAgICAgICBjbGllbnQ6IE1MQ2xpZW50LA0KICAgICAgICBmZWRlcmF0ZWRfbGVhcm5pbmdfY29tcG9uZW50c19mb2xkZXI6IFBhdGgsDQogICAgICAgIGZlZGVyYXRlZF9sZWFybmluZ19sb2NhbF9kYXRhX2ZvbGRlcjogUGF0aCwNCiAgICApIC0\u002BIE5vbmU6DQogICAgICAgIGlkID0gSWRlbnRpdHlDb25maWd1cmF0aW9uKA0KICAgICAgICAgICAgdHlwZT1JZGVudGl0eUNvbmZpZ3VyYXRpb25UeXBlLk1BTkFHRUQsDQogICAgICAgICAgICB1c2VyX2Fzc2lnbmVkX2lkZW50aXRpZXM9W01hbmFnZWRJZGVudGl0eUNvbmZpZ3VyYXRpb24oY2xpZW50X2lkPSIzYWRmZjc0Mi0wMTQyLTQ1YTYtODE0Mi0zZDk0Zjk0NGNhZmIiKV0sDQogICAgICAgICkNCg0KICAgICAgICAjIFRvIHN1cHBvcnQgZHNsIHBpcGVsaW5lIGt3YXJncw0KICAgICAgICBvcy5lbnZpcm9uWyJBWlVSRV9NTF9DTElfUFJJVkFURV9GRUFUVVJFU19FTkFCTEVEIl0gPSAiVHJ1ZSINCiAgICAgICAgY29tcHV0ZV9uYW1lcyA9IFsNCiAgICAgICAgICAgICJzaWxvQ29tcHV0ZTEiLA0KICAgICAgICAgICAgInNpbG9Db21wdXRlMiIsDQogICAgICAgICAgICAic2lsb0NvbXB1dGUzIiwNCiAgICAgICAgICAgICJhZ2dDb21wdXRlIiwNCiAgICAgICAgXQ0KICAgICAgICBjb21wdXRlcyA9IFtdDQogICAgICAgIGZvciBuYW1lIGluIGNvbXB1dGVfbmFtZXM6DQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgZXh0YW50X2NvbXB1dGUgPSBjbGllbnQuY29tcHV0ZS5nZXQobmFtZSkNCiAgICAgICAgICAgICAgICBwcmludChmIkZvdW5kIGV4aXN0aW5nIGNvbXB1dGUgJ3tuYW1lfScsIHVzaW5nIHRoYXQgaW5zdGVhZCBvZiBjcmVhdGluZyBpdC4iKQ0KICAgICAgICAgICAgICAgIGNvbXB1dGVzLmFwcGVuZChleHRhbnRfY29tcHV0ZSkNCiAgICAgICAgICAgIGV4Y2VwdCBSZXNvdXJjZU5vdEZvdW5kRXJyb3IgYXMgZToNCiAgICAgICAgICAgICAgICByYWlzZSAoZSkNCg0KICAgICAgICBkYXRhc3RvcmVfbmFtZXMgPSBbDQogICAgICAgICAgICAic2lsb19kYXRhc3RvcmUxIiwNCiAgICAgICAgICAgICJzaWxvX2RhdGFzdG9yZTIiLA0KICAgICAgICAgICAgInNpbG9fZGF0YXN0b3JlMyIsDQogICAgICAgICAgICAiYWdnX2RhdGFzdG9yZSIsDQogICAgICAgIF0NCg0KICAgICAgICBkYXRhc3RvcmVzID0gW10NCiAgICAgICAgZm9yIGRhdGFzdG9yZV9uYW1lIGluIGRhdGFzdG9yZV9uYW1lczoNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBleHRhbnRfZHMgPSBjbGllbnQuZGF0YXN0b3Jlcy5nZXQoZGF0YXN0b3JlX25hbWUpDQogICAgICAgICAgICAgICAgcHJpbnQoZiJGb3VuZCBleGlzdGluZyBkYXRhc3RvcmUgJ3tkYXRhc3RvcmVfbmFtZX0nLCB1c2luZyB0aGF0IGluc3RlYWQgb2YgY3JlYXRpbmcgaXQuIikNCiAgICAgICAgICAgICAgICBkYXRhc3RvcmVzLmFwcGVuZChleHRhbnRfZHMpDQogICAgICAgICAgICBleGNlcHQgUmVzb3VyY2VOb3RGb3VuZEVycm9yIGFzIGU6DQogICAgICAgICAgICAgICAgcmFpc2UgKGUpDQoNCiAgICAgICAgIyBMb2FkIGNvbXBvbmVudHMgZnJvbSBsb2NhbCBjb25maWdzDQogICAgICAgIHByZXByb2Nlc3NpbmdfY29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBzb3VyY2U9b3MucGF0aC5qb2luKGZlZGVyYXRlZF9sZWFybmluZ19jb21wb25lbnRzX2ZvbGRlciwgInByZXByb2Nlc3NpbmciLCAic3BlYy55YW1sIikNCiAgICAgICAgKQ0KDQogICAgICAgIHRyYWluaW5nX2NvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPW9zLnBhdGguam9pbihmZWRlcmF0ZWRfbGVhcm5pbmdfY29tcG9uZW50c19mb2xkZXIsICJ0cmFpbmluZyIsICJzcGVjLnlhbWwiKQ0KICAgICAgICApDQoNCiAgICAgICAgYWdncmVnYXRlX2NvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPW9zLnBhdGguam9pbihmZWRlcmF0ZWRfbGVhcm5pbmdfY29tcG9uZW50c19mb2xkZXIsICJhZ2dyZWdhdGUiLCAic3BlYy55YW1sIikNCiAgICAgICAgKQ0KDQogICAgICAgICMgVXNlIGEgbmVzdGVkIHBpcGVsaW5lIGZvciB0aGUgc2lsbyBzdGVwDQogICAgICAgIEBwaXBlbGluZQ0KICAgICAgICBkZWYgc2lsb19zdGVwX2Z1bmMoDQogICAgICAgICAgICByYXdfdHJhaW5fZGF0YTogSW5wdXQsDQogICAgICAgICAgICByYXdfdGVzdF9kYXRhOiBJbnB1dCwNCiAgICAgICAgICAgIGNoZWNrcG9pbnQ6IElucHV0KG9wdGlvbmFsPVRydWUpLA0KICAgICAgICAgICAgbHI6IGZsb2F0ID0gMC4wMSwNCiAgICAgICAgICAgIGJhdGNoX3NpemU6IGludCA9IDY0LA0KICAgICAgICAgICAgaXRlcmF0aW9uX251bTogaW50ID0gMCwNCiAgICAgICAgICAgIGVwb2NoczogaW50ID0gMywNCiAgICAgICAgKToNCiAgICAgICAgICAgICMgUHJlcHJvY2VzcyBkYXRhDQogICAgICAgICAgICBzaWxvX3ByZV9wcm9jZXNzaW5nX3N0ZXAgPSBwcmVwcm9jZXNzaW5nX2NvbXBvbmVudCgNCiAgICAgICAgICAgICAgICByYXdfdHJhaW5pbmdfZGF0YT1yYXdfdHJhaW5fZGF0YSwNCiAgICAgICAgICAgICAgICByYXdfdGVzdGluZ19kYXRhPXJhd190ZXN0X2RhdGEsDQogICAgICAgICAgICAgICAgIyByYXdfZXZhbHVhdGlvbl9kYXRhPXJhd19ldmFsX2RhdGEsDQogICAgICAgICAgICAgICAgIyBoZXJlIHdlJ3JlIHVzaW5nIHRoZSBuYW1lIG9mIHRoZSBzaWxvIGNvbXB1dGUgYXMgYSBtZXRyaWNzIHByZWZpeA0KICAgICAgICAgICAgICAgIG1ldHJpY3NfcHJlZml4PSIiLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICAjIFJ1biB0cmFpbmluZw0KICAgICAgICAgICAgc2lsb190cmFpbmluZ19zdGVwID0gdHJhaW5pbmdfY29tcG9uZW50KA0KICAgICAgICAgICAgICAgIHRyYWluX2RhdGE9c2lsb19wcmVfcHJvY2Vzc2luZ19zdGVwLm91dHB1dHMucHJvY2Vzc2VkX3RyYWluX2RhdGEsDQogICAgICAgICAgICAgICAgdGVzdF9kYXRhPXNpbG9fcHJlX3Byb2Nlc3Npbmdfc3RlcC5vdXRwdXRzLnByb2Nlc3NlZF90ZXN0X2RhdGEsDQogICAgICAgICAgICAgICAgY2hlY2twb2ludD1jaGVja3BvaW50LA0KICAgICAgICAgICAgICAgIGxyPWxyLA0KICAgICAgICAgICAgICAgIGVwb2Nocz1lcG9jaHMsDQogICAgICAgICAgICAgICAgYmF0Y2hfc2l6ZT1iYXRjaF9zaXplLA0KICAgICAgICAgICAgICAgIG1ldHJpY3NfcHJlZml4PSIiLA0KICAgICAgICAgICAgICAgIGl0ZXJhdGlvbl9udW09aXRlcmF0aW9uX251bSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgICMgcmV0dXJuIHRyYWluaW5nIHJlc3VsdHMNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgIm1vZGVsIjogc2lsb190cmFpbmluZ19zdGVwLm91dHB1dHMubW9kZWwsDQogICAgICAgICAgICB9DQoNCiAgICAgICAgIyBVc2UgYSBjb21wb25lbnQgZGlyZWN0bHkgZm9yIHRoZSBhZ2cgc3RlcA0KICAgICAgICBhZ2dyZWdhdGlvbl9zdGVwID0gYWdncmVnYXRlX2NvbXBvbmVudA0KDQogICAgICAgIHNpbG9fY29uZmlncyA9IFsNCiAgICAgICAgICAgIEZlZGVyYXRlZExlYXJuaW5nU2lsbygNCiAgICAgICAgICAgICAgICBjb21wdXRlPWNvbXB1dGVzWzBdLm5hbWUsDQogICAgICAgICAgICAgICAgZGF0YXN0b3JlPWRhdGFzdG9yZXNbMF0ubmFtZSwNCiAgICAgICAgICAgICAgICBpbnB1dHM9ew0KICAgICAgICAgICAgICAgICAgICAicmF3X3RyYWluX2RhdGEiOiBJbnB1dCgNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5VUklfRklMRSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU9ImRpcmVjdCIsDQogICAgICAgICAgICAgICAgICAgICAgICBwYXRoPW9zLnBhdGguam9pbihmZWRlcmF0ZWRfbGVhcm5pbmdfbG9jYWxfZGF0YV9mb2xkZXIsICJzaWxvMV9pbnB1dDEudHh0IiksDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhc3RvcmU9ZGF0YXN0b3Jlc1swXS5uYW1lLA0KICAgICAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgICAgICAicmF3X3Rlc3RfZGF0YSI6IElucHV0KA0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLlVSSV9GSUxFLA0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZT0iZGlyZWN0IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg9b3MucGF0aC5qb2luKGZlZGVyYXRlZF9sZWFybmluZ19sb2NhbF9kYXRhX2ZvbGRlciwgInNpbG8xX2lucHV0Mi50eHQiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzdG9yZT1kYXRhc3RvcmVzWzBdLm5hbWUsDQogICAgICAgICAgICAgICAgICAgICksDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICksDQogICAgICAgICAgICBGZWRlcmF0ZWRMZWFybmluZ1NpbG8oDQogICAgICAgICAgICAgICAgY29tcHV0ZT1jb21wdXRlc1sxXS5uYW1lLA0KICAgICAgICAgICAgICAgIGRhdGFzdG9yZT1kYXRhc3RvcmVzWzFdLm5hbWUsDQogICAgICAgICAgICAgICAgaW5wdXRzPXsNCiAgICAgICAgICAgICAgICAgICAgInJhd190cmFpbl9kYXRhIjogSW5wdXQoDQogICAgICAgICAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuVVJJX0ZJTEUsDQogICAgICAgICAgICAgICAgICAgICAgICBtb2RlPSJtb3VudCIsDQogICAgICAgICAgICAgICAgICAgICAgICBwYXRoPW9zLnBhdGguam9pbihmZWRlcmF0ZWRfbGVhcm5pbmdfbG9jYWxfZGF0YV9mb2xkZXIsICJzaWxvMl9pbnB1dDEudHh0IiksDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhc3RvcmU9ZGF0YXN0b3Jlc1sxXS5uYW1lLA0KICAgICAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgICAgICAicmF3X3Rlc3RfZGF0YSI6IElucHV0KA0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLlVSSV9GSUxFLA0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZT0iZGlyZWN0IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg9b3MucGF0aC5qb2luKGZlZGVyYXRlZF9sZWFybmluZ19sb2NhbF9kYXRhX2ZvbGRlciwgInNpbG8yX2lucHV0Mi50eHQiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzdG9yZT1kYXRhc3RvcmVzWzFdLm5hbWUsDQogICAgICAgICAgICAgICAgICAgICksDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICksDQogICAgICAgICAgICBGZWRlcmF0ZWRMZWFybmluZ1NpbG8oDQogICAgICAgICAgICAgICAgY29tcHV0ZT1jb21wdXRlc1syXS5uYW1lLA0KICAgICAgICAgICAgICAgIGRhdGFzdG9yZT1kYXRhc3RvcmVzWzJdLm5hbWUsDQogICAgICAgICAgICAgICAgaW5wdXRzPXsNCiAgICAgICAgICAgICAgICAgICAgInJhd190cmFpbl9kYXRhIjogSW5wdXQoDQogICAgICAgICAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuVVJJX0ZJTEUsDQogICAgICAgICAgICAgICAgICAgICAgICBtb2RlPSJtb3VudCIsDQogICAgICAgICAgICAgICAgICAgICAgICBwYXRoPW9zLnBhdGguam9pbihmZWRlcmF0ZWRfbGVhcm5pbmdfbG9jYWxfZGF0YV9mb2xkZXIsICJzaWxvM19pbnB1dDEudHh0IiksDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhc3RvcmU9ZGF0YXN0b3Jlc1syXS5uYW1lLA0KICAgICAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgICAgICAicmF3X3Rlc3RfZGF0YSI6IElucHV0KA0KICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLlVSSV9GSUxFLA0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZT0ibW91bnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGF0aD1vcy5wYXRoLmpvaW4oZmVkZXJhdGVkX2xlYXJuaW5nX2xvY2FsX2RhdGFfZm9sZGVyLCAic2lsbzNfaW5wdXQyLnR4dCIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXN0b3JlPWRhdGFzdG9yZXNbMl0ubmFtZSwNCiAgICAgICAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgKSwNCiAgICAgICAgXQ0KDQogICAgICAgIHNpbG9fdG9fYWdncmVnYXRpb25fYXJndW1lbnRfbWFwID0geyJtb2RlbCI6ICJzaWxvX2lucHV0cyJ9DQogICAgICAgIGFnZ3JlZ2F0aW9uX3RvX3NpbG9fYXJndW1lbnRfbWFwID0geyJhZ2dyZWdhdGVkX291dHB1dCI6ICJjaGVja3BvaW50In0NCg0KICAgICAgICAjIE90aGVyIGFyZ3MNCiAgICAgICAgaXRlcmF0aW9ucyA9IDMNCiAgICAgICAgc2lsb19rd2FyZ3MgPSB7fQ0KICAgICAgICBhZ2dfa3dhcmdzID0ge30NCiAgICAgICAgYWdncmVnYXRpb25fY29tcHV0ZSA9IGNvbXB1dGVzWzNdLm5hbWUNCiAgICAgICAgYWdncmVnYXRpb25fZGF0YXN0b3JlID0gZGF0YXN0b3Jlc1szXS5uYW1lDQoNCiAgICAgICAgIyBEZWZpbmUgdGhlIGZsIHBpcGVsaW5lDQogICAgICAgIGZsX25vZGUgPSBmbF9zY2F0dGVyX2dhdGhlcigNCiAgICAgICAgICAgIHNpbG9fY29uZmlncz1zaWxvX2NvbmZpZ3MsDQogICAgICAgICAgICBzaWxvX2NvbXBvbmVudD1zaWxvX3N0ZXBfZnVuYywNCiAgICAgICAgICAgIGFnZ3JlZ2F0aW9uX2NvbXBvbmVudD1hZ2dyZWdhdGlvbl9zdGVwLA0KICAgICAgICAgICAgYWdncmVnYXRpb25fY29tcHV0ZT1hZ2dyZWdhdGlvbl9jb21wdXRlLA0KICAgICAgICAgICAgYWdncmVnYXRpb25fZGF0YXN0b3JlPWFnZ3JlZ2F0aW9uX2RhdGFzdG9yZSwNCiAgICAgICAgICAgIHNoYXJlZF9zaWxvX2t3YXJncz1zaWxvX2t3YXJncywNCiAgICAgICAgICAgIGFnZ3JlZ2F0aW9uX2t3YXJncz1hZ2dfa3dhcmdzLA0KICAgICAgICAgICAgc2lsb190b19hZ2dyZWdhdGlvbl9hcmd1bWVudF9tYXA9c2lsb190b19hZ2dyZWdhdGlvbl9hcmd1bWVudF9tYXAsDQogICAgICAgICAgICBhZ2dyZWdhdGlvbl90b19zaWxvX2FyZ3VtZW50X21hcD1hZ2dyZWdhdGlvbl90b19zaWxvX2FyZ3VtZW50X21hcCwNCiAgICAgICAgICAgIG1heF9pdGVyYXRpb25zPWl0ZXJhdGlvbnMsDQogICAgICAgICkNCg0KICAgICAgICAjIGNyZWF0ZSBhbmQgc3VibWl0IHRoZSBwaXBlbGluZSBqb2INCiAgICAgICAgc3VibWl0dGVkX3BpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUoDQogICAgICAgICAgICBmbF9ub2RlLnNjYXR0ZXJfZ2F0aGVyX2dyYXBoLCBleHBlcmltZW50X25hbWU9ImV4YW1wbGVfZmxfcGlwZWxpbmUiDQogICAgICAgICkNCiAgICAgICAgcHJpbnQoIlN1Ym1pdHRlZCBwaXBlbGluZSBqb2I6IHt9Ii5mb3JtYXQoc3VibWl0dGVkX3BpcGVsaW5lX2pvYi5pZCkpDQogICAgICAgIHN1YmdyYXBoID0gc3VibWl0dGVkX3BpcGVsaW5lX2pvYi5jb21wb25lbnQuam9icw0KDQogICAgICAgICMgVW5mb3J0dW5hdGVseSBleGVjdXRlZCBwaXBlbGluZXMgZG9uJ3QgcmV0dXJuIGludGVyaW9yIHZhbHVlcyBvZiBzdWItcGlwZWxpbmVzLA0KICAgICAgICAjIHNvIHdlIGNhbid0IGluc3BlY3QgaW50ZXJuYWwgZGF0YXN0b3JlcyBvciBjb21wdXRlcyBpbiBzaWxvIHN0ZXBzDQogICAgICAgIGFzc2VydCAic2NhdHRlcl9nYXRoZXJfYm9keSIgaW4gc3ViZ3JhcGgNCiAgICAgICAgc2NhdHRlcl9nYXRoZXJfYm9keSA9IHN1YmdyYXBoWyJzY2F0dGVyX2dhdGhlcl9ib2R5Il0NCiAgICAgICAgYXNzZXJ0IHNjYXR0ZXJfZ2F0aGVyX2JvZHkudHlwZSA9PSAicGlwZWxpbmUiDQogICAgICAgIGFzc2VydCBhbGwoc2lsb19pbnB1dCBpbiBzY2F0dGVyX2dhdGhlcl9ib2R5LmlucHV0cyBmb3Igc2lsb19pbnB1dCBpbiBzaWxvX2t3YXJncykNCiAgICAgICAgYXNzZXJ0IGFsbChzaWxvX2lucHV0IGluIHNjYXR0ZXJfZ2F0aGVyX2JvZHkuaW5wdXRzIGZvciBzaWxvX2lucHV0IGluIGFnZ3JlZ2F0aW9uX3RvX3NpbG9fYXJndW1lbnRfbWFwLnZhbHVlcygpKQ0KICAgICAgICBhc3NlcnQgYWxsKGFnZ19vdXRwdXQgaW4gc2NhdHRlcl9nYXRoZXJfYm9keS5vdXRwdXRzIGZvciBhZ2dfb3V0cHV0IGluIGFnZ3JlZ2F0aW9uX3RvX3NpbG9fYXJndW1lbnRfbWFwKQ0K",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "inmxw/YWaah2Xwl6ksU/EQ==",
        "Date": "Wed, 24 May 2023 03:02:50 GMT",
        "ETag": "\u00220x8DB5C035C2FE2E8\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:50 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "d3pe6wBZ/xY=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_dsl_pipeline_with_specific_nodes.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "13161",
        "Content-MD5": "abQ5Cno4tBTZSUpkYp4kKA==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "aW1wb3J0IG11bHRpcHJvY2Vzc2luZw0KaW1wb3J0IHV1aWQNCmZyb20gZnVuY3Rvb2xzIGltcG9ydCBwYXJ0aWFsDQpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgNCmZyb20gdHlwaW5nIGltcG9ydCBDYWxsYWJsZSwgVW5pb24NCg0KaW1wb3J0IHB5dGVzdA0KZnJvbSBkZXZ0b29sc190ZXN0dXRpbHMgaW1wb3J0IEF6dXJlUmVjb3JkZWRUZXN0Q2FzZQ0KZnJvbSBtb2NrIGltcG9ydCBtb2NrDQpmcm9tIHB5dGVzdF9tb2NrIGltcG9ydCBNb2NrRml4dHVyZQ0KDQpmcm9tIGF6dXJlLmFpLm1sLm9wZXJhdGlvbnMuX29wZXJhdGlvbl9vcmNoZXN0cmF0b3IgaW1wb3J0IE9wZXJhdGlvbk9yY2hlc3RyYXRvcg0KZnJvbSB0ZXN0X3V0aWxpdGllcy51dGlscyBpbXBvcnQgKA0KICAgIF9QWVRFU1RfVElNRU9VVF9NRVRIT0QsDQogICAgYXNzZXJ0X2pvYl9jYW5jZWwsDQogICAgc3VibWl0X2FuZF9jYW5jZWxfbmV3X2RzbF9waXBlbGluZSwNCiAgICBvbWl0X3dpdGhfd2lsZGNhcmQsDQopDQoNCmZyb20gYXp1cmUuYWkubWwgaW1wb3J0ICgNCiAgICBJbnB1dCwNCiAgICBNTENsaWVudCwNCiAgICBkc2wsDQogICAgbG9hZF9jb21wb25lbnQsDQopDQpmcm9tIGF6dXJlLmFpLm1sLmNvbnN0YW50cy5fY29tbW9uIGltcG9ydCBBc3NldFR5cGVzDQpmcm9tIGF6dXJlLmFpLm1sLmVudGl0aWVzIGltcG9ydCBDb21tYW5kQ29tcG9uZW50LCBDb21tYW5kLCBDaG9pY2UsIFN3ZWVwLCBDb21wb25lbnQsIEVudmlyb25tZW50LCBQaXBlbGluZUNvbXBvbmVudA0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcyBpbXBvcnQgUGlwZWxpbmVKb2INCg0KZnJvbSAuLl91dGlsIGltcG9ydCBfRFNMX1RJTUVPVVRfU0VDT05EDQoNCnRlc3RzX3Jvb3RfZGlyID0gUGF0aChfX2ZpbGVfXykucGFyZW50LnBhcmVudC5wYXJlbnQNCmNvbXBvbmVudHNfZGlyID0gdGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2NvbXBvbmVudHMvIg0Kam9iX2lucHV0ID0gSW5wdXQoDQogICAgdHlwZT1Bc3NldFR5cGVzLlVSSV9GSUxFLA0KICAgIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiwNCikNCmV4cGVyaW1lbnRfbmFtZSA9ICJkc2xfcGlwZWxpbmVfZTJlIg0KY29tbW9uX29taXRfZmllbGRzID0gWw0KICAgICJwcm9wZXJ0aWVzIiwNCiAgICAiZGlzcGxheV9uYW1lIiwNCiAgICAiZXhwZXJpbWVudF9uYW1lIiwNCiAgICAiam9icy4qLmNvbXBvbmVudElkIiwNCiAgICAiaW5wdXRzLioudXJpIiwNCiAgICAiam9icy4qLl9zb3VyY2UiLA0KICAgICJqb2JzLioucHJvcGVydGllcyIsDQogICAgInNldHRpbmdzLl9zb3VyY2UiLA0KICAgICJzb3VyY2Vfam9iX2lkIiwNCiAgICAic2VydmljZXMiLA0KXQ0KDQoNCmRlZiBfZ2V0X2NvbXBvbmVudF9pbl9maXJzdF9jaGlsZChfd2l0aF9qb2JzOiBVbmlvbltQaXBlbGluZUpvYiwgUGlwZWxpbmVDb21wb25lbnRdLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBDb21wb25lbnQ6DQogICAgaWYgbm90IF93aXRoX2pvYnMuam9iczoNCiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiTm8gam9icyBmb3VuZCBpbiB0aGUgcGlwZWxpbmUiKQ0KICAgIF9yZXN1bHQgPSBuZXh0KGl0ZXIoX3dpdGhfam9icy5qb2JzLnZhbHVlcygpKSkuY29tcG9uZW50LnNwbGl0KCI6IikNCiAgICBpZiBsZW4oX3Jlc3VsdCkgPT0gMjoNCiAgICAgICAgX25hbWUsIF92ZXJzaW9uID0gX3Jlc3VsdA0KICAgIGVsaWYgbGVuKF9yZXN1bHQpID09IDM6DQogICAgICAgIF8sIF9uYW1lLCBfdmVyc2lvbiA9IF9yZXN1bHQNCiAgICBlbHNlOg0KICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJJbnZhbGlkIGNvbXBvbmVudCBhcm0gc3RyaW5nOiB7fSIuZm9ybWF0KF9yZXN1bHQpKQ0KICAgIHJldHVybiBjbGllbnQuY29tcG9uZW50cy5nZXQoX25hbWUsIF92ZXJzaW9uKQ0KDQoNCkBweXRlc3QubWFyay51c2VmaXh0dXJlcygNCiAgICAiZW5hYmxlX2Vudmlyb25tZW50X2lkX2FybV9leHBhbnNpb24iLA0KICAgICJlbmFibGVfcGlwZWxpbmVfcHJpdmF0ZV9wcmV2aWV3X2ZlYXR1cmVzIiwNCiAgICAibW9ja19jb2RlX2hhc2giLA0KICAgICJtb2NrX2NvbXBvbmVudF9oYXNoIiwNCiAgICAibW9ja19zZXRfaGVhZGVyc193aXRoX3VzZXJfYW1sX3Rva2VuIiwNCiAgICAicmVjb3JkZWRfdGVzdCIsDQopDQpAcHl0ZXN0Lm1hcmsudGltZW91dCh0aW1lb3V0PV9EU0xfVElNRU9VVF9TRUNPTkQsIG1ldGhvZD1fUFlURVNUX1RJTUVPVVRfTUVUSE9EKQ0KQHB5dGVzdC5tYXJrLmUyZXRlc3QNCkBweXRlc3QubWFyay5waXBlbGluZV90ZXN0DQpjbGFzcyBUZXN0RFNMUGlwZWxpbmVXaXRoU3BlY2lmaWNOb2RlcyhBenVyZVJlY29yZGVkVGVzdENhc2UpOg0KICAgIEBzdGF0aWNtZXRob2QNCiAgICBkZWYgX2dlbmVyYXRlX211bHRpX2xheWVyX3BpcGVsaW5lX2Z1bmMoKToNCiAgICAgICAgcGF0aCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCINCg0KICAgICAgICBAZHNsLnBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV9sZWFmKGNvbXBvbmVudF9pbl9wYXRoOiBJbnB1dCk6DQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzEgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9cGF0aCkNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMShjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCwgY29tcG9uZW50X2luX251bWJlcj0xKQ0KDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgICAgICBzb3VyY2U9cGF0aCwNCiAgICAgICAgICAgICAgICBwYXJhbXNfb3ZlcnJpZGU9Ww0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJhbm90aGVyX2NvbXBvbmVudF9uYW1lIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ2ZXJzaW9uIjogImFub3RoZXJfY29tcG9uZW50X3ZlcnNpb24iLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMihjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCwgY29tcG9uZW50X2luX251bWJlcj0xKQ0KDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzMgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgICAgICBzb3VyY2U9cGF0aCwgcGFyYW1zX292ZXJyaWRlPVt7ImVudmlyb25tZW50IjogImF6dXJlbWw6QXp1cmVNTC1za2xlYXJuLTEuMC11YnVudHUyMC4wNC1weTM4LWNwdTozMiJ9XQ0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMzKGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbl9wYXRoLCBjb21wb25lbnRfaW5fbnVtYmVyPTEpDQoNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jNCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1wYXRoKQ0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmM0LmNvbW1hbmQgKz0gIiAmIGVjaG8gdXBkYXRlZDEiDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzQoY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgsIGNvbXBvbmVudF9pbl9udW1iZXI9MSkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV9taWQoam9iX2luX3BhdGg6IElucHV0KToNCiAgICAgICAgICAgIHBpcGVsaW5lX2xlYWYoam9iX2luX3BhdGgpDQogICAgICAgICAgICBwaXBlbGluZV9sZWFmKGpvYl9pbl9wYXRoKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIHBpcGVsaW5lX3Jvb3Qoam9iX2luX3BhdGg6IElucHV0KToNCiAgICAgICAgICAgIHBpcGVsaW5lX21pZChqb2JfaW5fcGF0aCkNCiAgICAgICAgICAgIHBpcGVsaW5lX21pZChqb2JfaW5fcGF0aCkNCg0KICAgICAgICByZXR1cm4gcGlwZWxpbmVfcm9vdA0KDQogICAgQHN0YXRpY21ldGhvZA0KICAgIGRlZiBfZ2VuZXJhdGVfcGlwZWxpbmVfZnVuY19mb3JfY29uY3VycmVudF9jb21wb25lbnRfcmVnaXN0cmF0aW9uX3Rlc3Qoc2hhcmVkX2lucHV0KToNCiAgICAgICAgcGF0aCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCINCiAgICAgICAgY29uZGFfZmlsZV9wYXRoID0gIi4vdGVzdHMvdGVzdF9jb25maWdzL2Vudmlyb25tZW50L2Vudmlyb25tZW50X2ZpbGVzL2Vudmlyb25tZW50LnltbCINCg0KICAgICAgICBlbnZpcm9ubWVudCA9IEVudmlyb25tZW50KA0KICAgICAgICAgICAgbmFtZT0idGVzdC1lbnZpcm9ubWVudCIsDQogICAgICAgICAgICBjb25kYV9maWxlPWNvbmRhX2ZpbGVfcGF0aCwNCiAgICAgICAgICAgIGltYWdlPSJtY3IubWljcm9zb2Z0LmNvbS9henVyZW1sL29wZW5tcGk0LjEuMC11YnVudHUyMC4wNCIsDQogICAgICAgICAgICB2ZXJzaW9uPSIyIiwgICMgVE9ETzogYW5vbnltb3VzIGVudmlyb25tZW50IGhhcyBwb3RlbnRpYWwgdmVyc2lvbiBjb25mbGljdD8NCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGlzIGlzIGFuIGFub255bW91cyBlbnZpcm9ubWVudCIsDQogICAgICAgICkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV9sZWFmKCk6DQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzFhID0gbG9hZF9jb21wb25lbnQoc291cmNlPXBhdGgpDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzFhLmVudmlyb25tZW50ID0gZW52aXJvbm1lbnQNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMWEuY29tbWFuZCArPSAiICYgZWNobyB1cGRhdGVkMSINCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMWEoY29tcG9uZW50X2luX3BhdGg9c2hhcmVkX2lucHV0LCBjb21wb25lbnRfaW5fbnVtYmVyPTEpDQoNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMWIgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9cGF0aCkNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMWIuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudA0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMxYi5jb21tYW5kICs9ICIgJiBlY2hvIHVwZGF0ZWQxIg0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMxYihjb21wb25lbnRfaW5fcGF0aD1zaGFyZWRfaW5wdXQsIGNvbXBvbmVudF9pbl9udW1iZXI9MSkNCg0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMyID0gbG9hZF9jb21wb25lbnQoc291cmNlPXBhdGgpDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIuY29tbWFuZCArPSAiICYgZWNobyB1cGRhdGVkMiINCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMi5lbnZpcm9ubWVudCA9IGVudmlyb25tZW50DQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIoY29tcG9uZW50X2luX3BhdGg9c2hhcmVkX2lucHV0LCBjb21wb25lbnRfaW5fbnVtYmVyPTEpDQoNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1wYXRoKQ0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMzLmNvbW1hbmQgKz0gIiAmIGVjaG8gdXBkYXRlZDMiDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudA0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMzKGNvbXBvbmVudF9pbl9wYXRoPXNoYXJlZF9pbnB1dCwgY29tcG9uZW50X2luX251bWJlcj0xKQ0KDQogICAgICAgICMgVE9ETzogdGVzdCB3aXRoIG11bHRpcGxlIHBpcGVsaW5lcyBhZnRlciBzZXJ2ZXItc2lkZSByZXR1cm4gam9icyBmb3IgcGlwZWxpbmUgY29tcG9uZW50DQogICAgICAgICMgQGRzbC5waXBlbGluZQ0KICAgICAgICAjIGRlZiBwaXBlbGluZV9taWQoKToNCiAgICAgICAgIyAgICAgcGlwZWxpbmVfbGVhZigpDQogICAgICAgICMgICAgIHBpcGVsaW5lX2xlYWYoKQ0KICAgICAgICAjDQogICAgICAgICMgQGRzbC5waXBlbGluZQ0KICAgICAgICAjIGRlZiBwaXBlbGluZV9yb290KCk6DQogICAgICAgICMgICAgIHBpcGVsaW5lX21pZCgpDQogICAgICAgICMgICAgIHBpcGVsaW5lX21pZCgpDQoNCiAgICAgICAgcmV0dXJuIHBpcGVsaW5lX2xlYWYNCg0KICAgIGRlZiB0ZXN0X2RzbF9waXBlbGluZV9zd2VlcF9ub2RlKHNlbGYsIGNsaWVudDogTUxDbGllbnQsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdKSAtPiBOb25lOg0KICAgICAgICB5YW1sX2ZpbGUgPSAiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQoNCiAgICAgICAgQGRzbC5waXBlbGluZQ0KICAgICAgICBkZWYgdHJhaW5fd2l0aF9zd2VlcF9pbl9waXBlbGluZShyYXdfZGF0YSwgcHJpbWFyeV9tZXRyaWM6IHN0ciA9ICJBVUMiLCBtYXhfdG90YWxfdHJpYWxzOiBpbnQgPSAxMCk6DQogICAgICAgICAgICBjb21wb25lbnRfdG9fc3dlZXA6IENvbW1hbmRDb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9eWFtbF9maWxlKQ0KICAgICAgICAgICAgIyB0byBjaGVjayB0aGUgbG9naWMgdG8gc2V0IGRlZmF1bHQgZGlzcGxheSBuYW1lIGZvciBjb21wb25lbnRzDQogICAgICAgICAgICBjb21wb25lbnRfdG9fc3dlZXAuZGlzcGxheV9uYW1lID0gTm9uZQ0KDQogICAgICAgICAgICBjbWRfbm9kZTE6IENvbW1hbmQgPSBjb21wb25lbnRfdG9fc3dlZXAoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1DaG9pY2UoWzIsIDMsIDQsIDVdKSwgY29tcG9uZW50X2luX3BhdGg9cmF3X2RhdGENCiAgICAgICAgICAgICkNCg0KICAgICAgICAgICAgc3dlZXBfam9iMTogU3dlZXAgPSBjbWRfbm9kZTEuc3dlZXAoDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9IkFVQyIsICAjIHByaW1hcnlfbWV0cmljLA0KICAgICAgICAgICAgICAgIGdvYWw9Im1heGltaXplIiwNCiAgICAgICAgICAgICAgICBzYW1wbGluZ19hbGdvcml0aG09InJhbmRvbSIsDQogICAgICAgICAgICApDQogICAgICAgICAgICBzd2VlcF9qb2IxLmNvbXB1dGUgPSAiZ3B1LWNsdXN0ZXIiDQogICAgICAgICAgICBzd2VlcF9qb2IxLnNldF9saW1pdHMobWF4X3RvdGFsX3RyaWFscz0xMCkgICMgbWF4X3RvdGFsX3RyaWFscw0KDQogICAgICAgICAgICBjbWRfbm9kZTI6IENvbW1hbmQgPSBjb21wb25lbnRfdG9fc3dlZXAoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1DaG9pY2UoWzIsIDMsIDQsIDVdKSwgY29tcG9uZW50X2luX3BhdGg9cmF3X2RhdGENCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHN3ZWVwX2pvYjI6IFN3ZWVwID0gY21kX25vZGUyLnN3ZWVwKA0KICAgICAgICAgICAgICAgIHByaW1hcnlfbWV0cmljPSJBVUMiLA0KICAgICAgICAgICAgICAgIGdvYWw9Im1pbmltaXplIiwNCiAgICAgICAgICAgICAgICBzYW1wbGluZ19hbGdvcml0aG09InJhbmRvbSIsDQogICAgICAgICAgICAgICAgbWF4X3RvdGFsX3RyaWFscz0xMCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHN3ZWVwX2pvYjIuY29tcHV0ZSA9ICJncHUtY2x1c3RlciINCg0KICAgICAgICAgICAgc3dlZXBfam9iMzogU3dlZXAgPSBjb21wb25lbnRfdG9fc3dlZXAoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1DaG9pY2UoWzIsIDMsIDQsIDVdKSwgY29tcG9uZW50X2luX3BhdGg9cmF3X2RhdGENCiAgICAgICAgICAgICkuc3dlZXAoDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9ImFjY3VyYWN5IiwNCiAgICAgICAgICAgICAgICBnb2FsPSJtYXhpbWl6ZSIsDQogICAgICAgICAgICAgICAgc2FtcGxpbmdfYWxnb3JpdGhtPSJyYW5kb20iLA0KICAgICAgICAgICAgICAgIG1heF90b3RhbF90cmlhbHM9MTAsDQogICAgICAgICAgICApDQoNCiAgICAgICAgICAgIGNvbXBvbmVudF90b19saW5rID0gbG9hZF9jb21wb25lbnQoc291cmNlPXlhbWxfZmlsZSwgcGFyYW1zX292ZXJyaWRlPVt7Im5hbWUiOiAibm9kZV90b19saW5rIn1dKQ0KICAgICAgICAgICAgbGlua19ub2RlID0gY29tcG9uZW50X3RvX2xpbmsoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj0yLCBjb21wb25lbnRfaW5fcGF0aD1zd2VlcF9qb2IxLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoDQogICAgICAgICAgICApDQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgInBpcGVsaW5lX2pvYl9iZXN0X21vZGVsMSI6IHN3ZWVwX2pvYjEub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICAgICAgInBpcGVsaW5lX2pvYl9iZXN0X21vZGVsMiI6IHN3ZWVwX2pvYjIub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICAgICAgInBpcGVsaW5lX2pvYl9iZXN0X21vZGVsMyI6IHN3ZWVwX2pvYjMub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICAgICAgInBpcGVsaW5lX21vZGVsX3Rlc3RfcmVzdWx0IjogbGlua19ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgfQ0KDQogICAgICAgIHBpcGVsaW5lOiBQaXBlbGluZUpvYiA9IHRyYWluX3dpdGhfc3dlZXBfaW5fcGlwZWxpbmUoDQogICAgICAgICAgICByYXdfZGF0YT1qb2JfaW5wdXQsIG1heF90b3RhbF90cmlhbHM9MTAwLCBwcmltYXJ5X21ldHJpYz0iYWNjdXJhY3kiDQogICAgICAgICkNCiAgICAgICAgcGlwZWxpbmUuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICBjcmVhdGVkX3BpcGVsaW5lID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCiAgICAgICAgbmFtZSwgdmVyc2lvbiA9IGNyZWF0ZWRfcGlwZWxpbmUuam9ic1sic3dlZXBfam9iMSJdLnRyaWFsLnNwbGl0KCI6IikNCiAgICAgICAgY3JlYXRlZF9jb21wb25lbnQgPSBjbGllbnQuY29tcG9uZW50cy5nZXQobmFtZSwgdmVyc2lvbikNCiAgICAgICAgIyBrZWVwIG9yaWdpbmFsIGNvbXBvbmVudCBkaXNwbGF5IG5hbWUgdG8gZ3VhcmFudGVlIHJldXNlDQogICAgICAgIGFzc2VydCBjcmVhdGVkX2NvbXBvbmVudC5kaXNwbGF5X25hbWUgaXMgTm9uZQ0KDQogICAgZGVmIHRlc3RfZHNsX3BpcGVsaW5lX2NvbXBvbmVudF9jYWNoZV9pbl9yZXNvbHZlcihzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBpbnB1dF9kYXRhX3BhdGggPSAiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZGF0YS8iDQogICAgICAgIHBpcGVsaW5lX3Jvb3QgPSBzZWxmLl9nZW5lcmF0ZV9tdWx0aV9sYXllcl9waXBlbGluZV9mdW5jKCkNCg0KICAgICAgICBfc3VibWl0X2FuZF9jYW5jZWwgPSBwYXJ0aWFsKA0KICAgICAgICAgICAgc3VibWl0X2FuZF9jYW5jZWxfbmV3X2RzbF9waXBlbGluZSwgY2xpZW50PWNsaWVudCwgam9iX2luX3BhdGg9SW5wdXQocGF0aD1pbnB1dF9kYXRhX3BhdGgpDQogICAgICAgICkNCg0KICAgICAgICBkZWYgX21vY2tfZ2V0X2NvbXBvbmVudF9hcm1faWQoX2NvbXBvbmVudDogQ29tcG9uZW50KSAtPiBzdHI6DQogICAgICAgICAgICAjIHRoZSBsb2dpYyBoYXMgbm8gZGlmZiBjb21wYXJpbmcgdG8gb3JpZ2luYWwgZnVuY3Rpb24gb3RoZXIgdGhhbiBhbHdheXMgdXNpbmcgc2hvd19wcm9ncmVzcz1GYWxzZQ0KICAgICAgICAgICAgIyBqdXN0IHRvIG1vY2sgdGhlIGZ1bmN0aW9uIGFuZCBjaGVjayBjYWxsIGluZm9ybWF0aW9uDQogICAgICAgICAgICBpZiBub3QgX2NvbXBvbmVudC5pZDoNCiAgICAgICAgICAgICAgICBfY29tcG9uZW50Ll9pZCA9IGNsaWVudC5jb21wb25lbnRzLmNyZWF0ZV9vcl91cGRhdGUoDQogICAgICAgICAgICAgICAgICAgIF9jb21wb25lbnQsIGlzX2Fub255bW91cz1UcnVlLCBzaG93X3Byb2dyZXNzPUZhbHNlDQogICAgICAgICAgICAgICAgKS5pZA0KICAgICAgICAgICAgcmV0dXJuIF9jb21wb25lbnQuaWQNCg0KICAgICAgICB3aXRoIG1vY2sucGF0Y2gub2JqZWN0KA0KICAgICAgICAgICAgT3BlcmF0aW9uT3JjaGVzdHJhdG9yLCAiX2dldF9jb21wb25lbnRfYXJtX2lkIiwgc2lkZV9lZmZlY3Q9X21vY2tfZ2V0X2NvbXBvbmVudF9hcm1faWQNCiAgICAgICAgKSBhcyBtb2NrX3Jlc29sdmU6DQogICAgICAgICAgICBfc3VibWl0X2FuZF9jYW5jZWwocGlwZWxpbmVfcm9vdCkNCiAgICAgICAgICAgICMgcGlwZWxpbmVfbGVhZiwgcGlwZWxpbmVfbWlkIGFuZCAzIGNvbW1hbmQgY29tcG9uZW50cyB3aWxsIGJlIHJlc29sdmVkDQogICAgICAgICAgICBhc3NlcnQgbW9ja19yZXNvbHZlLmNhbGxfY291bnQgPT0gNQ0KDQogICAgICAgIHdpdGggbW9jay5wYXRjaC5vYmplY3QoDQogICAgICAgICAgICBPcGVyYXRpb25PcmNoZXN0cmF0b3IsICJfZ2V0X2NvbXBvbmVudF9hcm1faWQiLCBzaWRlX2VmZmVjdD1fbW9ja19nZXRfY29tcG9uZW50X2FybV9pZA0KICAgICAgICApIGFzIG1vY2tfcmVzb2x2ZToNCiAgICAgICAgICAgIF9zdWJtaXRfYW5kX2NhbmNlbChwaXBlbGluZV9yb290KQ0KICAgICAgICAgICAgIyBubyBtb3JlIHJlcXVlc3RzIHRvIHJlc29sdmUgY29tcG9uZW50cyBhcyBsb2NhbCBjYWNoZSBpcyBoaXQNCiAgICAgICAgICAgIGFzc2VydCBtb2NrX3Jlc29sdmUuY2FsbF9jb3VudCA9PSAwDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGlwZWxpbmVfcm9vdChqb2JfaW5fcGF0aD1JbnB1dChwYXRoPWlucHV0X2RhdGFfcGF0aCkpDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQogICAgICAgIGxlYWZfc3ViZ3JhcGggPSBwaXBlbGluZV9qb2Iuam9ic1sicGlwZWxpbmVfbWlkIl0uY29tcG9uZW50LmpvYnNbInBpcGVsaW5lX2xlYWYiXS5jb21wb25lbnQNCiAgICAgICAgbGVhZl9zdWJncmFwaC5qb2JzWyJhbm90aGVyX2NvbXBvbmVudF9uYW1lIl0uY29tcG9uZW50LmNvbW1hbmQgKz0gIiAmIGVjaG8gdXBkYXRlZDIiDQogICAgICAgIHdpdGggbW9jay5wYXRjaC5vYmplY3QoDQogICAgICAgICAgICBPcGVyYXRpb25PcmNoZXN0cmF0b3IsICJfZ2V0X2NvbXBvbmVudF9hcm1faWQiLCBzaWRlX2VmZmVjdD1fbW9ja19nZXRfY29tcG9uZW50X2FybV9pZA0KICAgICAgICApIGFzIG1vY2tfcmVzb2x2ZToNCiAgICAgICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KICAgICAgICAgICAgIyB1cGRhdGVkIGNvbW1hbmQgY29tcG9uZW50IGFuZCBpdHMgcGFyZW50cyAocGlwZWxpbmVfbGVhZiBhbmQgcGlwZWxpbmVfbWlkKSB3aWxsIGJlIHJlc29sdmVkDQogICAgICAgICAgICBhc3NlcnQgbW9ja19yZXNvbHZlLmNhbGxfY291bnQgPT0gMw0KDQogICAgZGVmIHRlc3RfZHNsX3BpcGVsaW5lX2NvbmN1cnJlbnRfY29tcG9uZW50X3JlZ2lzdHJhdGlvbihzZWxmLCBjbGllbnQ6IE1MQ2xpZW50LCBtb2NrZXI6IE1vY2tGaXh0dXJlKSAtPiBOb25lOg0KICAgICAgICAjIGRpc2FibGUgb24tZGlzayBjYWNoZSB0byB0ZXN0IGNvbmN1cnJlbnQgY29tcG9uZW50IHJlZ2lzdHJhdGlvbg0KICAgICAgICBtb2NrZXIucGF0Y2goImF6dXJlLmFpLm1sLl91dGlscy51dGlscy5pc19vbl9kaXNrX2NhY2hlX2VuYWJsZWQiLCByZXR1cm5fdmFsdWU9RmFsc2UpDQoNCiAgICAgICAgaW5wdXRfZGF0YV9wYXRoID0gIi4vdGVzdHMvdGVzdF9jb25maWdzL2RhdGEvIg0KICAgICAgICBwaXBlbGluZV9yb290ID0gc2VsZi5fZ2VuZXJhdGVfcGlwZWxpbmVfZnVuY19mb3JfY29uY3VycmVudF9jb21wb25lbnRfcmVnaXN0cmF0aW9uX3Rlc3QoDQogICAgICAgICAgICBzaGFyZWRfaW5wdXQ9SW5wdXQocGF0aD1pbnB1dF9kYXRhX3BhdGgpDQogICAgICAgICkNCg0KICAgICAgICBfc3VibWl0X2FuZF9jYW5jZWwgPSBwYXJ0aWFsKA0KICAgICAgICAgICAgc3VibWl0X2FuZF9jYW5jZWxfbmV3X2RzbF9waXBlbGluZSwNCiAgICAgICAgICAgIGNsaWVudD1jbGllbnQsDQogICAgICAgICkNCg0KICAgICAgICB0cmVhdG1lbnRfcGlwZWxpbmVfam9iID0gX3N1Ym1pdF9hbmRfY2FuY2VsKHBpcGVsaW5lX3Jvb3QpDQoNCiAgICAgICAgd2l0aCBtb2NrLnBhdGNoKCJhenVyZS5haS5tbC5fdXRpbHMudXRpbHMuaXNfY29uY3VycmVudF9jb21wb25lbnRfcmVnaXN0cmF0aW9uX2VuYWJsZWQiLCByZXR1cm5fdmFsdWU9RmFsc2UpOg0KICAgICAgICAgICAgYmFzZV9waXBlbGluZV9qb2IgPSBfc3VibWl0X2FuZF9jYW5jZWwocGlwZWxpbmVfcm9vdCkNCg0KICAgICAgICAjIFNlcnZlci1zaWRlIGRvZXMgbm90IGd1YXJhbnRlZSB0aGUgc2FtZSBhbm9ueW1vdXMgcGlwZWxpbmUgY29tcG9uZW50IHNoYXJlIHRoZSBzYW1lIHZlcnNpb24NCiAgICAgICAgIyBTbyBvbWl0IG5hbWUgYW5kIHZlcnNpb24gYW5kIGRvIGNvbXBhcmlzb24gbGF5ZXIgYnkgbGF5ZXINCiAgICAgICAgb21pdF9maWVsZHMgPSBbImlkIiwgIm5hbWUiLCAidmVyc2lvbiIsICJjcmVhdGlvbl9jb250ZXh0IiwgInNlcnZpY2VzIiwgImpvYnMuKi5jb21wb25lbnQiXQ0KDQogICAgICAgIGJhc2UsIHRyZWF0ID0gYmFzZV9waXBlbGluZV9qb2IsIHRyZWF0bWVudF9waXBlbGluZV9qb2INCiAgICAgICAgIyBUT0RPOiB0ZXN0IHdpdGggbXVsdGlwbGUgcGlwZWxpbmVzIGFmdGVyIHNlcnZlci1zaWRlIHJldHVybiBqb2JzIGZvciBwaXBlbGluZSBjb21wb25lbnQNCiAgICAgICAgZm9yIF8gaW4gcmFuZ2UoMCwgMCk6DQogICAgICAgICAgICBhc3NlcnQgb21pdF93aXRoX3dpbGRjYXJkKGJhc2UuX3RvX2RpY3QoKSwgKm9taXRfZmllbGRzKSA9PSBvbWl0X3dpdGhfd2lsZGNhcmQoDQogICAgICAgICAgICAgICAgdHJlYXQuX3RvX2RpY3QoKSwgKm9taXRfZmllbGRzDQogICAgICAgICAgICApDQogICAgICAgICAgICBiYXNlID0gX2dldF9jb21wb25lbnRfaW5fZmlyc3RfY2hpbGQoYmFzZSwgY2xpZW50KQ0KICAgICAgICAgICAgdHJlYXQgPSBfZ2V0X2NvbXBvbmVudF9pbl9maXJzdF9jaGlsZCh0cmVhdCwgY2xpZW50KQ0KDQogICAgICAgICMgVGhlIGxhc3QgbGF5ZXIgY29udGFpbnMgdGhlIGNvbW1hbmQgY29tcG9uZW50cw0KICAgICAgICBvbWl0X2ZpZWxkcy5wb3AoKQ0KICAgICAgICBhc3NlcnQgb21pdF93aXRoX3dpbGRjYXJkKGJhc2UuX3RvX2RpY3QoKSwgKm9taXRfZmllbGRzKSA9PSBvbWl0X3dpdGhfd2lsZGNhcmQodHJlYXQuX3RvX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0K",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "abQ5Cno4tBTZSUpkYp4kKA==",
        "Date": "Wed, 24 May 2023 03:02:50 GMT",
        "ETag": "\u00220x8DB5C035C2FE2E8\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:50 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "LAlnIcLWREA=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_dsl_pipeline.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "160871",
        "Content-MD5": "Ug0G12c/xbuqiJL9W/isog==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "aW1wb3J0IGxvZ2dpbmcNCmZyb20gaW8gaW1wb3J0IFN0cmluZ0lPDQpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgNCmZyb20gdHlwaW5nIGltcG9ydCBDYWxsYWJsZQ0KZnJvbSB1bml0dGVzdC5tb2NrIGltcG9ydCBwYXRjaA0KDQppbXBvcnQgcHlkYXNoDQppbXBvcnQgcHl0ZXN0DQpmcm9tIGRldnRvb2xzX3Rlc3R1dGlscyBpbXBvcnQgQXp1cmVSZWNvcmRlZFRlc3RDYXNlLCBpc19saXZlDQpmcm9tIHBpcGVsaW5lX2pvYi5lMmV0ZXN0cy50ZXN0X3BpcGVsaW5lX2pvYiBpbXBvcnQgYXNzZXJ0X2pvYl9pbnB1dF9vdXRwdXRfdHlwZXMNCmZyb20gdGVzdF91dGlsaXRpZXMudXRpbHMgaW1wb3J0ICgNCiAgICBfUFlURVNUX1RJTUVPVVRfTUVUSE9ELA0KICAgIGFzc2VydF9qb2JfY2FuY2VsLA0KICAgIG9taXRfd2l0aF93aWxkY2FyZCwNCiAgICBzbGVlcF9pZl9saXZlLA0KKQ0KDQpmcm9tIGF6dXJlLmFpLm1sIGltcG9ydCAoDQogICAgQW1sVG9rZW5Db25maWd1cmF0aW9uLA0KICAgIElucHV0LA0KICAgIE1hbmFnZWRJZGVudGl0eUNvbmZpZ3VyYXRpb24sDQogICAgTUxDbGllbnQsDQogICAgTXBpRGlzdHJpYnV0aW9uLA0KICAgIE91dHB1dCwNCiAgICBQeVRvcmNoRGlzdHJpYnV0aW9uLA0KICAgIFRlbnNvckZsb3dEaXN0cmlidXRpb24sDQogICAgVXNlcklkZW50aXR5Q29uZmlndXJhdGlvbiwNCiAgICBjb21tYW5kLA0KICAgIGRzbCwNCiAgICBsb2FkX2NvbXBvbmVudCwNCikNCmZyb20gYXp1cmUuYWkubWwuX3V0aWxzLl9hcm1faWRfdXRpbHMgaW1wb3J0ICgNCiAgICBpc19BUk1faWRfZm9yX3Jlc291cmNlLA0KICAgIGlzX3Npbmd1bGFyaXR5X2lkX2Zvcl9yZXNvdXJjZSwNCikNCmZyb20gYXp1cmUuYWkubWwuY29uc3RhbnRzLl9jb21tb24gaW1wb3J0ICgNCiAgICBBTk9OWU1PVVNfQ09NUE9ORU5UX05BTUUsDQogICAgU0lOR1VMQVJJVFlfSURfRk9STUFULA0KICAgIEFzc2V0VHlwZXMsDQogICAgSW5wdXRPdXRwdXRNb2RlcywNCikNCmZyb20gYXp1cmUuYWkubWwuY29uc3RhbnRzLl9qb2IucGlwZWxpbmUgaW1wb3J0IFBpcGVsaW5lQ29uc3RhbnRzDQpmcm9tIGF6dXJlLmFpLm1sLmRzbC5fZ3JvdXBfZGVjb3JhdG9yIGltcG9ydCBncm91cA0KZnJvbSBhenVyZS5haS5tbC5kc2wuX2xvYWRfaW1wb3J0IGltcG9ydCB0b19jb21wb25lbnQNCmZyb20gYXp1cmUuYWkubWwuZW50aXRpZXMgaW1wb3J0IENvbW1hbmRDb21wb25lbnQsIENvbW1hbmRKb2INCmZyb20gYXp1cmUuYWkubWwuZW50aXRpZXMgaW1wb3J0IENvbXBvbmVudA0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcyBpbXBvcnQgQ29tcG9uZW50IGFzIENvbXBvbmVudEVudGl0eQ0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcyBpbXBvcnQgKA0KICAgIERhdGEsDQogICAgSm9iUmVzb3VyY2VDb25maWd1cmF0aW9uLA0KICAgIFBpcGVsaW5lSm9iLA0KICAgIFF1ZXVlU2V0dGluZ3MsDQopDQpmcm9tIGF6dXJlLmFpLm1sLmV4Y2VwdGlvbnMgaW1wb3J0IFVuZXhwZWN0ZWRLZXl3b3JkRXJyb3IsIFZhbGlkYXRpb25FeGNlcHRpb24NCmZyb20gYXp1cmUuYWkubWwucGFyYWxsZWwgaW1wb3J0IFBhcmFsbGVsSm9iLCBSdW5GdW5jdGlvbiwgcGFyYWxsZWxfcnVuX2Z1bmN0aW9uDQoNCmZyb20gLi5fdXRpbCBpbXBvcnQgX0RTTF9USU1FT1VUX1NFQ09ORA0KDQp0ZXN0c19yb290X2RpciA9IFBhdGgoX19maWxlX18pLnBhcmVudC5wYXJlbnQucGFyZW50DQpjb21wb25lbnRzX2RpciA9IHRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9jb21wb25lbnRzLyINCmpvYl9pbnB1dCA9IElucHV0KA0KICAgIHR5cGU9QXNzZXRUeXBlcy5VUklfRklMRSwNCiAgICBwYXRoPSJodHRwczovL2RwcmVwZGF0YS5ibG9iLmNvcmUud2luZG93cy5uZXQvZGVtby9UaXRhbmljLmNzdiIsDQopDQpleHBlcmltZW50X25hbWUgPSAiZHNsX3BpcGVsaW5lX2UyZSINCmNvbW1vbl9vbWl0X2ZpZWxkcyA9IFsNCiAgICAicHJvcGVydGllcyIsDQogICAgImRpc3BsYXlfbmFtZSIsDQogICAgImV4cGVyaW1lbnRfbmFtZSIsDQogICAgImpvYnMuKi5jb21wb25lbnRJZCIsDQogICAgImlucHV0cy4qLnVyaSIsDQogICAgImpvYnMuKi5fc291cmNlIiwNCiAgICAiam9icy4qLnByb3BlcnRpZXMiLA0KICAgICJzZXR0aW5ncy5fc291cmNlIiwNCiAgICAic291cmNlX2pvYl9pZCIsDQogICAgInNlcnZpY2VzIiwNCl0NCg0KDQpkZWYgY2hlY2tfbmFtZV9hbmRfdmVyc2lvbihvdXRwdXQsIG91dHB1dF9uYW1lLCBvdXRwdXRfdmVyc2lvbik6DQogICAgYXNzZXJ0IG91dHB1dC5uYW1lID09IG91dHB1dF9uYW1lDQogICAgYXNzZXJ0IG91dHB1dC52ZXJzaW9uID09IG91dHB1dF92ZXJzaW9uDQoNCg0KZGVmIGJ1aWxkX3BpcGVsaW5lX3dpdGhfcGFyYWxsZWxfcnVuX2Z1bmN0aW9uKGRhdGEsIGxpdGVyYWxfaW5wdXQ9Tm9uZSk6DQogICAgIyBjb21tYW5kIGpvYiB3aXRoIGRpY3QgZGlzdHJpYnV0aW9uDQogICAgZW52aXJvbm1lbnQgPSAiQXp1cmVNTC1za2xlYXJuLTEuMC11YnVudHUyMC4wNC1weTM4LWNwdTozMyINCiAgICBpbnB1dHMgPSB7DQogICAgICAgICJqb2JfZGF0YV9wYXRoIjogSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2RhdGFzZXQvbW5pc3QtZGF0YSIsDQogICAgICAgICAgICBtb2RlPUlucHV0T3V0cHV0TW9kZXMuRVZBTF9NT1VOVCwNCiAgICAgICAgKSwNCiAgICAgICAgImpvYl9kYXRhX3BhdGhfb3B0aW9uYWwiOiBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgbW9kZT1JbnB1dE91dHB1dE1vZGVzLkVWQUxfTU9VTlQsDQogICAgICAgICAgICBvcHRpb25hbD1UcnVlLA0KICAgICAgICApLA0KICAgIH0NCiAgICBpbnB1dF9kYXRhID0gIiR7e2lucHV0cy5qb2JfZGF0YV9wYXRofX0iDQogICAgb3V0cHV0cyA9IHsiam9iX291dHB1dF9wYXRoIjogT3V0cHV0KHR5cGU9QXNzZXRUeXBlcy5VUklfRk9MREVSLCBtb2RlPSJyd19tb3VudCIpfQ0KICAgIGV4cGVjdGVkX3Jlc291cmNlcyA9IHsiaW5zdGFuY2VfY291bnQiOiAyfQ0KDQogICAgdGFzayA9IFJ1bkZ1bmN0aW9uKA0KICAgICAgICBjb2RlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvcGFyYWxsZWxfY29tcG9uZW50X3dpdGhfZmlsZV9pbnB1dC9zcmMvIiwNCiAgICAgICAgZW50cnlfc2NyaXB0PSJzY29yZS5weSIsDQogICAgICAgIHByb2dyYW1fYXJndW1lbnRzPSItLWpvYl9vdXRwdXRfcGF0aCAke3tvdXRwdXRzLmpvYl9vdXRwdXRfcGF0aH19IiwNCiAgICAgICAgZW52aXJvbm1lbnQ9ZW52aXJvbm1lbnQsDQogICAgKQ0KICAgIGxvZ2dpbmdfbGV2ZWwgPSAiREVCVUciDQogICAgbWF4X2NvbmN1cnJlbmN5X3Blcl9pbnN0YW5jZSA9IDENCiAgICBlcnJvcl90aHJlc2hvbGQgPSAxDQogICAgbWluaV9iYXRjaF9lcnJvcl90aHJlc2hvbGQgPSAxDQogICAgbWluaV9iYXRjaF9zaXplID0gIjUiDQoNCiAgICAjIFBhcmFsbGVsIGZyb20gcGFyYWxsZWxfcnVuX2Z1bmN0aW9uKCkNCiAgICBwYXJhbGxlbF9mdW5jdGlvbiA9IHBhcmFsbGVsX3J1bl9mdW5jdGlvbigNCiAgICAgICAgZGlzcGxheV9uYW1lPSJteS1ldmFsdWF0ZS1qb2IiLA0KICAgICAgICBpbnB1dHM9aW5wdXRzLA0KICAgICAgICBvdXRwdXRzPW91dHB1dHMsDQogICAgICAgIG1pbmlfYmF0Y2hfc2l6ZT1taW5pX2JhdGNoX3NpemUsDQogICAgICAgIHRhc2s9dGFzaywNCiAgICAgICAgbG9nZ2luZ19sZXZlbD1sb2dnaW5nX2xldmVsLA0KICAgICAgICBtYXhfY29uY3VycmVuY3lfcGVyX2luc3RhbmNlPW1heF9jb25jdXJyZW5jeV9wZXJfaW5zdGFuY2UsDQogICAgICAgIGVycm9yX3RocmVzaG9sZD1lcnJvcl90aHJlc2hvbGQsDQogICAgICAgIG1pbmlfYmF0Y2hfZXJyb3JfdGhyZXNob2xkPW1pbmlfYmF0Y2hfZXJyb3JfdGhyZXNob2xkLA0KICAgICAgICByZXNvdXJjZXM9ZXhwZWN0ZWRfcmVzb3VyY2VzLA0KICAgICAgICBpbnB1dF9kYXRhPWlucHV0X2RhdGEsDQogICAgKQ0KICAgIGlmIGxpdGVyYWxfaW5wdXQgaXMgTm9uZToNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKGV4cGVyaW1lbnRfbmFtZT0idGVzdF9waXBlbGluZV93aXRoX3BhcmFsbGVsX2Z1bmN0aW9uIiwgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIpDQogICAgICAgIGRlZiBwYXJhbGxlbF9pbl9waXBlbGluZShqb2JfZGF0YV9wYXRoKToNCiAgICAgICAgICAgIG5vZGUxID0gcGFyYWxsZWxfZnVuY3Rpb24oam9iX2RhdGFfcGF0aD1qb2JfZGF0YV9wYXRoKQ0KICAgICAgICAgICAgIyBUT0RPIDIxMDQyNDc6IG5vZGUxLnRhc2sgd2lsbCBiZSBrZXB0IGFzIGEgbG9jYWwgcGF0aCB3aGVuIHN1Ym1pdHRpbmcgdGhlIHBpcGVsaW5lIGpvYi4NCiAgICAgICAgICAgIG5vZGUxLnRhc2sgPSBOb25lDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICJwaXBlbGluZV9vdXRwdXQiOiBub2RlMS5vdXRwdXRzLmpvYl9vdXRwdXRfcGF0aCwNCiAgICAgICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gcGFyYWxsZWxfaW5fcGlwZWxpbmUoZGF0YSkNCiAgICBlbHNlOg0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoZXhwZXJpbWVudF9uYW1lPSJ0ZXN0X3BpcGVsaW5lX3dpdGhfcGFyYWxsZWxfZnVuY3Rpb24iLCBkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgZGVmIHBhcmFsbGVsX2luX3BpcGVsaW5lKGpvYl9kYXRhX3BhdGgsIGxpdGVyYWxfaW5wdXQpOg0KICAgICAgICAgICAgbm9kZTEgPSBwYXJhbGxlbF9mdW5jdGlvbihqb2JfZGF0YV9wYXRoPWpvYl9kYXRhX3BhdGgpDQogICAgICAgICAgICAjIFRPRE8gMjEwNDI0Nzogbm9kZTEudGFzayB3aWxsIGJlIGtlcHQgYXMgYSBsb2NhbCBwYXRoIHdoZW4gc3VibWl0dGluZyB0aGUgcGlwZWxpbmUgam9iLg0KICAgICAgICAgICAgbm9kZTEudGFzayA9IE5vbmUNCiAgICAgICAgICAgIG5vZGUxLnJlc291cmNlcy5pbnN0YW5jZV9jb3VudCA9IGxpdGVyYWxfaW5wdXQNCiAgICAgICAgICAgIG5vZGUxLm1heF9jb25jdXJyZW5jeV9wZXJfaW5zdGFuY2UgPSBsaXRlcmFsX2lucHV0DQogICAgICAgICAgICBub2RlMS5lcnJvcl90aHJlc2hvbGQgPSBsaXRlcmFsX2lucHV0DQogICAgICAgICAgICBub2RlMS5taW5pX2JhdGNoX2Vycm9yX3RocmVzaG9sZCA9IGxpdGVyYWxfaW5wdXQNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgInBpcGVsaW5lX291dHB1dCI6IG5vZGUxLm91dHB1dHMuam9iX291dHB1dF9wYXRoLA0KICAgICAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBwYXJhbGxlbF9pbl9waXBlbGluZShkYXRhLCBsaXRlcmFsX2lucHV0KQ0KDQoNCkBweXRlc3QubWFyay51c2VmaXh0dXJlcygNCiAgICAiZW5hYmxlX2Vudmlyb25tZW50X2lkX2FybV9leHBhbnNpb24iLA0KICAgICJlbmFibGVfcGlwZWxpbmVfcHJpdmF0ZV9wcmV2aWV3X2ZlYXR1cmVzIiwNCiAgICAiZW5hYmxlX3ByaXZhdGVfcHJldmlld19zY2hlbWFfZmVhdHVyZXMiLA0KICAgICJtb2NrX2NvZGVfaGFzaCIsDQogICAgIm1vY2tfY29tcG9uZW50X2hhc2giLA0KICAgICJtb2NrX3NldF9oZWFkZXJzX3dpdGhfdXNlcl9hbWxfdG9rZW4iLA0KICAgICJyZWNvcmRlZF90ZXN0IiwNCiAgICAibW9ja19hc3NldF9uYW1lIiwNCikNCkBweXRlc3QubWFyay50aW1lb3V0KHRpbWVvdXQ9X0RTTF9USU1FT1VUX1NFQ09ORCwgbWV0aG9kPV9QWVRFU1RfVElNRU9VVF9NRVRIT0QpDQpAcHl0ZXN0Lm1hcmsuZTJldGVzdA0KQHB5dGVzdC5tYXJrLnBpcGVsaW5lX3Rlc3QNCmNsYXNzIFRlc3REU0xQaXBlbGluZShBenVyZVJlY29yZGVkVGVzdENhc2UpOg0KICAgIGRlZiB0ZXN0X2NvbW1hbmRfY29tcG9uZW50X2NyZWF0ZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50LCByYW5kc3RyOiBDYWxsYWJsZVtbc3RyXSwgc3RyXSkgLT4gTm9uZToNCiAgICAgICAgY29tcG9uZW50X3lhbWwgPSBjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGNvbXBvbmVudF9mdW5jMSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1jb21wb25lbnRfeWFtbCwgcGFyYW1zX292ZXJyaWRlPVt7Im5hbWUiOiByYW5kc3RyKCJjb21wb25lbnRfbmFtZSIpfV0pDQogICAgICAgIGNvbXBvbmVudF9mdW5jMiA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1jb21wb25lbnRfeWFtbCwgcGFyYW1zX292ZXJyaWRlPVt7Im5hbWUiOiByYW5kc3RyKCJjb21wb25lbnRfbmFtZSIpfV0pDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIG5hbWU9cmFuZHN0cigicGlwZWxpbmVfbmFtZSIpLA0KICAgICAgICAgICAgZGVzY3JpcHRpb249IlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgdGFncz17Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICAgICBleHBlcmltZW50X25hbWU9ZXhwZXJpbWVudF9uYW1lLA0KICAgICAgICAgICAgY29udGludWVfb25fc3RlcF9mYWlsdXJlPVRydWUsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lKGpvYl9pbl9udW1iZXIsIGpvYl9pbl9vdGhlcl9udW1iZXIsIGpvYl9pbl9wYXRoKToNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMShjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMyKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX290aGVyX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZSgxMCwgMTUsIGpvYl9pbnB1dCkNCiAgICAgICAgam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkNCiAgICAgICAgIyBjaGVjayByZXF1aXJlZCBmaWVsZHMgaW4gam9iIGRpY3QNCiAgICAgICAgam9iX2RpY3QgPSBqb2IuX3RvX2RpY3QoKQ0KICAgICAgICBleHBlY3RlZF9rZXlzID0gWyJzdGF0dXMiLCAicHJvcGVydGllcyIsICJ0YWdzIiwgImNyZWF0aW9uX2NvbnRleHQiXQ0KICAgICAgICBmb3IgayBpbiBleHBlY3RlZF9rZXlzOg0KICAgICAgICAgICAgYXNzZXJ0IGsgaW4gam9iX2RpY3Qua2V5cygpLCBmImZhaWxlZCB0byBnZXQge2t9IGluIHtqb2JfZGljdH0iDQoNCiAgICAgICAgIyBvcmlnaW5hbCBqb2IgZGlkIG5vdCBjaGFuZ2UNCiAgICAgICAgYXNzZXJ0X2pvYl9pbnB1dF9vdXRwdXRfdHlwZXMoam9iKQ0KICAgICAgICBhc3NlcnQgam9iLnNldHRpbmdzLmNvbnRpbnVlX29uX3N0ZXBfZmFpbHVyZSBpcyBUcnVlDQogICAgICAgIGFzc2VydCBqb2IuY29tcHV0ZSA9PSAiY3B1LWNsdXN0ZXIiDQoNCiAgICBkZWYgdGVzdF9waXBlbGluZV9qb2JfY3JlYXRlX3dpdGhfcmVzb2x2ZV9yZXVzZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50LCByYW5kc3RyOiBDYWxsYWJsZVtbc3RyXSwgc3RyXSkgLT4gTm9uZToNCiAgICAgICAgY29tcG9uZW50X3lhbWwgPSBjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGNvbXBvbmVudF9mdW5jMTogQ29tbWFuZENvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1jb21wb25lbnRfeWFtbCkNCiAgICAgICAgY29tcG9uZW50X2Z1bmMyOiBDb21tYW5kQ29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoc291cmNlPWNvbXBvbmVudF95YW1sKQ0KICAgICAgICBjb21wb25lbnRfZnVuYzM6IENvbW1hbmRDb21wb25lbnQgPSBjb21wb25lbnRfZnVuYzENCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgbmFtZT1yYW5kc3RyKCJwaXBlbGluZV9uYW1lIiksDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhlIGhlbGxvIHdvcmxkIHBpcGVsaW5lIGpvYiIsDQogICAgICAgICAgICB0YWdzPXsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgICAgIGV4cGVyaW1lbnRfbmFtZT1leHBlcmltZW50X25hbWUsDQogICAgICAgICAgICBjb250aW51ZV9vbl9zdGVwX2ZhaWx1cmU9VHJ1ZSwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmUoam9iX2luX251bWJlciwgam9iX2luX290aGVyX251bWJlciwgam9iX2luX3BhdGgpOg0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMxKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzMoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fb3RoZXJfbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMShjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9vdGhlcl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fb3RoZXJfbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCg0KICAgICAgICBkc2xfcGlwZWxpbmUgPSBwaXBlbGluZSgxMCwgMTUsIGpvYl9pbnB1dCkNCiAgICAgICAgY29tcG9uZW50X2lkX3NldCA9IHNldChtYXAobGFtYmRhIHg6IGlkKHguY29tcG9uZW50KSwgZHNsX3BpcGVsaW5lLmpvYnMudmFsdWVzKCkpKQ0KICAgICAgICBhc3NlcnQgbGVuKGNvbXBvbmVudF9pZF9zZXQpID09IDINCg0KICAgICAgICBmb3Igam9iX2luc3RhbmNlIGluIGRzbF9waXBlbGluZS5qb2JzLnZhbHVlcygpOg0KICAgICAgICAgICAgYXNzZXJ0IGpvYl9pbnN0YW5jZS5jb21wb25lbnQuaWQgaXMgTm9uZSwgImNvbXBvbmVudCBpZCB3b24ndCBiZSByZXNvbHZlZCBiZWZvcmUgY3JlYXRlX29yX3VwZGF0ZSINCg0KICAgICAgICAjIFRPRE86IG5lZWQgZXh0cmEgbW9jayBiYXNlZCB0ZXN0cyB0byB2ZXJpZnkgaWYgdGhlIGNvbXBvbmVudCBpcyByZXNvbHZlZCBvbmx5IG9uY2UNCiAgICAgICAgXyA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUoZHNsX3BpcGVsaW5lKQ0KICAgICAgICBmb3Igam9iX2luc3RhbmNlIGluIGRzbF9waXBlbGluZS5qb2JzLnZhbHVlcygpOg0KICAgICAgICAgICAgYXNzZXJ0ICgNCiAgICAgICAgICAgICAgICBpc2luc3RhbmNlKGpvYl9pbnN0YW5jZS5jb21wb25lbnQsIHN0cikgb3Igam9iX2luc3RhbmNlLmNvbXBvbmVudC5pZCBpcyBub3QgTm9uZQ0KICAgICAgICAgICAgKSwgImNvbXBvbmVudCBpZCB3aWxsIGJlIGZpbGxlZCBiYWNrIHRvIHRoZSBpbnN0YW5jZSBkdXJpbmcgY3JlYXRlX29yX3VwZGF0ZSINCg0KICAgIGRlZiB0ZXN0X2NvbW1hbmRfY29tcG9uZW50X2NyZWF0ZV93aXRoX291dHB1dChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50LCByYW5kc3RyOiBDYWxsYWJsZVtbc3RyXSwgc3RyXSkgLT4gTm9uZToNCiAgICAgICAgY29tcG9uZW50X3lhbWwgPSBjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGNvbXBvbmVudF9mdW5jMSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1jb21wb25lbnRfeWFtbCwgcGFyYW1zX292ZXJyaWRlPVt7Im5hbWUiOiByYW5kc3RyKCJjb21wb25lbnRfbmFtZSIpfV0pDQogICAgICAgIGNvbXBvbmVudF9mdW5jMiA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1jb21wb25lbnRfeWFtbCwgcGFyYW1zX292ZXJyaWRlPVt7Im5hbWUiOiByYW5kc3RyKCJjb21wb25lbnRfbmFtZSIpfV0pDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIG5hbWU9cmFuZHN0cigicGlwZWxpbmVfbmFtZSIpLA0KICAgICAgICAgICAgZGVzY3JpcHRpb249IlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgdGFncz17Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfb3V0cHV0KGpvYl9pbl9udW1iZXIsIGpvYl9pbl9vdGhlcl9udW1iZXIsIGpvYl9pbl9wYXRoKToNCiAgICAgICAgICAgIG5vZGUxID0gY29tcG9uZW50X2Z1bmMxKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQoNCiAgICAgICAgICAgIG5vZGUyID0gY29tcG9uZW50X2Z1bmMyKA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX290aGVyX251bWJlciwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1ub2RlMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHJldHVybiB7ImpvYl9vdXRfZGF0YSI6IG5vZGUyLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9vdXRwdXQoMTAsIDE1LCBqb2JfaW5wdXQpDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMuam9iX291dF9kYXRhID0gT3V0cHV0KGRhdGFzZXQ9RGF0YShuYW1lPSJkc2xfcGlwZWxpbmVfb3V0cHV0IiwgdmVyc2lvbj0iMSIpKQ0KICAgICAgICBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ZXhwZXJpbWVudF9uYW1lKQ0KDQogICAgZGVmIHRlc3RfY29tbWFuZF9jb21wb25lbnRfY3JlYXRlX2Zyb21fcmVtb3RlKA0KICAgICAgICBzZWxmLA0KICAgICAgICBjbGllbnQ6IE1MQ2xpZW50LA0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQ6IENvbXBvbmVudEVudGl0eSwNCiAgICAgICAgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0sDQogICAgKSAtPiBOb25lOg0KICAgICAgICBjb21wb25lbnRfZnVuYyA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgY2xpZW50PWNsaWVudCwNCiAgICAgICAgICAgIG5hbWU9aGVsbG9fd29ybGRfY29tcG9uZW50Lm5hbWUsDQogICAgICAgICAgICB2ZXJzaW9uPWhlbGxvX3dvcmxkX2NvbXBvbmVudC52ZXJzaW9uLA0KICAgICAgICApDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIG5hbWU9cmFuZHN0cigicGlwZWxpbmVfbmFtZSIpLA0KICAgICAgICAgICAgZGVzY3JpcHRpb249IlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgdGFncz17Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3JlbW90ZV9jb21wb25lbnQoam9iX2luX251bWJlciwgam9iX2luX290aGVyX251bWJlciwgam9iX2luX3BhdGgpOg0KICAgICAgICAgICAgbm9kZTEgPSBjb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KICAgICAgICAgICAgIyB1bi1jb25maWd1cmVkIGRhdGEgYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkDQogICAgICAgICAgICBub2RlMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCA9IE91dHB1dChkYXRhc2V0PURhdGEobmFtZT0ibWxkZXNpZ25lcl9jb21wb25lbnRfb3V0cHV0IikpDQoNCiAgICAgICAgICAgIG5vZGUyID0gY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fb3RoZXJfbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPW5vZGUxLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgcmV0dXJuIHsiam9iX291dF9kYXRhIjogbm9kZTIub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGh9DQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV9yZW1vdGVfY29tcG9uZW50KDEwLCAxNSwgam9iX2lucHV0KQ0KICAgICAgICBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ZXhwZXJpbWVudF9uYW1lKQ0KDQogICAgZGVmIHRlc3RfY29tcG9uZW50X2xvYWRfZnJvbV9yZW1vdGUoc2VsZiwgY2xpZW50OiBNTENsaWVudCwgaGVsbG9fd29ybGRfY29tcG9uZW50OiBDb21wb25lbnRFbnRpdHkpIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBjbGllbnQ9Y2xpZW50LA0KICAgICAgICAgICAgbmFtZT1oZWxsb193b3JsZF9jb21wb25lbnQubmFtZSwNCiAgICAgICAgICAgIHZlcnNpb249aGVsbG9fd29ybGRfY29tcG9uZW50LnZlcnNpb24sDQogICAgICAgICkNCg0KICAgICAgICBjb21wb25lbnRfbm9kZSA9IGNvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9udW1iZXI9MTAsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCg0KICAgICAgICBjb21wb25lbnRfam9iX2RpY3QgPSBjb21wb25lbnRfbm9kZS5fdG9fcmVzdF9vYmplY3QoKQ0KICAgICAgICBhc3NlcnQgaXNfQVJNX2lkX2Zvcl9yZXNvdXJjZShjb21wb25lbnRfam9iX2RpY3RbImNvbXBvbmVudElkIl0pDQogICAgICAgIG9taXRfZmllbGRzID0gWyJjb21wb25lbnRJZCIsICJfc291cmNlIiwgInByb3BlcnRpZXMiXQ0KICAgICAgICBjb21wb25lbnRfam9iX2RpY3QgPSBweWRhc2gub21pdChjb21wb25lbnRfam9iX2RpY3QsICpvbWl0X2ZpZWxkcykNCiAgICAgICAgYXNzZXJ0IGNvbXBvbmVudF9qb2JfZGljdCA9PSB7DQogICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEwIn0sDQogICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAidXJpX2ZpbGUiLA0KICAgICAgICAgICAgICAgICAgICAidXJpIjogImh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJyZXNvdXJjZXMiOiB7Imluc3RhbmNlX2NvdW50IjogMX0sDQogICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfZGlzdHJpYnV0aW9uX2NvbXBvbmVudHMoc2VsZiwgY2xpZW50OiBNTENsaWVudCwgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0pIC0\u002BIE5vbmU6DQogICAgICAgIG1waV9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXN0cihjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudF9tcGkueW1sIikpDQogICAgICAgIHB5dG9yY2hfZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1zdHIoY29tcG9uZW50c19kaXIgLyAiaGVsbG93b3JsZF9jb21wb25lbnRfcHl0b3JjaC55bWwiKSkNCiAgICAgICAgdGVuc29yZmxvd19mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXN0cihjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudF90ZW5zb3JmbG93LnltbCIpKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPXJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgaGVsbG8gd29ybGQgcGlwZWxpbmUgam9iIiwNCiAgICAgICAgICAgIHRhZ3M9eyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgY29tcHV0ZT0iZ3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfZGlzdHJpYnV0aW9uX2NvbXBvbmVudHMoam9iX2luX251bWJlciwgam9iX2luX3BhdGgpOg0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X21waSA9IG1waV9mdW5jKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfbXBpLmRpc3RyaWJ1dGlvbiA9IE1waURpc3RyaWJ1dGlvbigpDQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfbXBpLmRpc3RyaWJ1dGlvbi5wcm9jZXNzX2NvdW50X3Blcl9pbnN0YW5jZSA9IDINCg0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3B5dG9yY2ggPSBweXRvcmNoX2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3B5dG9yY2guZGlzdHJpYnV0aW9uID0gUHlUb3JjaERpc3RyaWJ1dGlvbigpDQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfcHl0b3JjaC5kaXN0cmlidXRpb24ucHJvY2Vzc19jb3VudF9wZXJfaW5zdGFuY2UgPSAyDQoNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF90ZW5zb3JmbG93ID0gdGVuc29yZmxvd19mdW5jKA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF90ZW5zb3JmbG93LmRpc3RyaWJ1dGlvbiA9IFRlbnNvckZsb3dEaXN0cmlidXRpb24oKQ0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3RlbnNvcmZsb3cuZGlzdHJpYnV0aW9uLndvcmtlcl9jb3VudCA9IDINCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX2Rpc3RyaWJ1dGlvbl9jb21wb25lbnRzKDEwLCBqb2JfaW5wdXQpDQogICAgICAgIGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUsIGV4cGVyaW1lbnRfbmFtZT1leHBlcmltZW50X25hbWUpDQoNCiAgICBkZWYgdGVzdF9jb21wb25lbnRfd2l0aF9iaW5kaW5nKHNlbGYsIGNsaWVudDogTUxDbGllbnQsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdKToNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwgPSBzdHIoY29tcG9uZW50c19kaXIgLyAiaGVsbG93b3JsZF9jb21wb25lbnQueW1sIikNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9aGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwpDQoNCiAgICAgICAgbWVyZ2Vfb3V0cHV0c19jb21wb25lbnRfeWFtbCA9IHN0cihjb21wb25lbnRzX2RpciAvICJtZXJnZV9vdXRwdXRzX2NvbXBvbmVudC55bWwiKQ0KICAgICAgICBtZXJnZV9vdXRwdXRzX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPW1lcmdlX291dHB1dHNfY29tcG9uZW50X3lhbWwpDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIG5hbWU9cmFuZHN0cigicGlwZWxpbmVfbmFtZSIpLA0KICAgICAgICAgICAgZGVzY3JpcHRpb249IlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgdGFncz17Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfYmluZGluZyhqb2JfaW5fbnVtYmVyLCBqb2JfaW5fb3RoZXJfbnVtYmVyLCBqb2JfaW5fcGF0aCk6DQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfMSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jKA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF8yID0gaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICAjIGNvbmZpZ3VyZSBjb21wb25lbnQgb3ZlcnJpZGVzLCBjdXJhdGVkIFNESyBub3Qgc3VwcG9ydGVkIHlldA0KICAgICAgICAgICAgIyBoZWxsb193b3JsZF9jb21wb25lbnRfMi5yZXNvdXJjZXMuaW5zdGFuY2VfY291bnQgPSAyDQoNCiAgICAgICAgICAgICMgY29uZmlndXJlIGNvbXBvbmVudCBvdXRwdXRzDQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aC5tb2RlID0gIlVwbG9hZCINCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF8yLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLm1vZGUgPSAiVXBsb2FkIg0KDQogICAgICAgICAgICBtZXJnZV9jb21wb25lbnRfb3V0cHV0cyA9IG1lcmdlX291dHB1dHNfY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fb3RoZXJfbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoXzE9aGVsbG9fd29ybGRfY29tcG9uZW50XzEub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3BhdGhfMj1oZWxsb193b3JsZF9jb21wb25lbnRfMi5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgImpvYl9vdXRfZGF0YV8xIjogbWVyZ2VfY29tcG9uZW50X291dHB1dHMub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGhfMSwNCiAgICAgICAgICAgICAgICAiam9iX291dF9kYXRhXzIiOiBtZXJnZV9jb21wb25lbnRfb3V0cHV0cy5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aF8yLA0KICAgICAgICAgICAgfQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9iaW5kaW5nKDEwLCAxNiwgam9iX2lucHV0KQ0KICAgICAgICBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKA0KICAgICAgICAgICAgcGlwZWxpbmUsDQogICAgICAgICAgICBleHBlcmltZW50X25hbWU9ImRzbF9waXBlbGluZV9lMmUiLA0KICAgICAgICApDQoNCiAgICBkZWYgdGVzdF9kYXRhX2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIHBhcmVudF9kaXIgPSBzdHIodGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2RzbF9waXBlbGluZS9ueWNfdGF4aV9kYXRhX3JlZ3Jlc3Npb24iKQ0KDQogICAgICAgIGRlZiBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUoKToNCiAgICAgICAgICAgICMgMS4gTG9hZCBjb21wb25lbnQgZnVuY3MNCiAgICAgICAgICAgIHByZXBfZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1wYXJlbnRfZGlyICsgIi9wcmVwLnltbCIpDQogICAgICAgICAgICB0cmFuc2Zvcm1fZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1wYXJlbnRfZGlyICsgIi90cmFuc2Zvcm0ueW1sIikNCiAgICAgICAgICAgIHRyYWluX2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9cGFyZW50X2RpciArICIvdHJhaW4ueW1sIikNCiAgICAgICAgICAgIHByZWRpY3RfZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1wYXJlbnRfZGlyICsgIi9wcmVkaWN0LnltbCIpDQogICAgICAgICAgICBzY29yZV9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXBhcmVudF9kaXIgKyAiL3Njb3JlLnltbCIpDQoNCiAgICAgICAgICAgICMgMi4gQ29uc3RydWN0IHBpcGVsaW5lDQogICAgICAgICAgICBAZHNsLnBpcGVsaW5lKGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwgZGVmYXVsdF9kYXRhc3RvcmU9IndvcmtzcGFjZWJsb2JzdG9yZSIpDQogICAgICAgICAgICBkZWYgc2FtcGxlX3BpcGVsaW5lKHBpcGVsaW5lX2pvYl9pbnB1dCk6DQogICAgICAgICAgICAgICAgcHJlcF9qb2IgPSBwcmVwX2Z1bmMocmF3X2RhdGE9cGlwZWxpbmVfam9iX2lucHV0KQ0KICAgICAgICAgICAgICAgIHRyYW5zZm9ybV9qb2IgPSB0cmFuc2Zvcm1fZnVuYyhjbGVhbl9kYXRhPXByZXBfam9iLm91dHB1dHMucHJlcF9kYXRhKQ0KICAgICAgICAgICAgICAgIHRyYWluX2pvYiA9IHRyYWluX2Z1bmModHJhaW5pbmdfZGF0YT10cmFuc2Zvcm1fam9iLm91dHB1dHMudHJhbnNmb3JtZWRfZGF0YSkNCiAgICAgICAgICAgICAgICBwcmVkaWN0X2pvYiA9IHByZWRpY3RfZnVuYygNCiAgICAgICAgICAgICAgICAgICAgbW9kZWxfaW5wdXQ9dHJhaW5fam9iLm91dHB1dHMubW9kZWxfb3V0cHV0LA0KICAgICAgICAgICAgICAgICAgICB0ZXN0X2RhdGE9dHJhaW5fam9iLm91dHB1dHMudGVzdF9kYXRhLA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICBzY29yZV9qb2IgPSBzY29yZV9mdW5jKA0KICAgICAgICAgICAgICAgICAgICBwcmVkaWN0aW9ucz1wcmVkaWN0X2pvYi5vdXRwdXRzLnByZWRpY3Rpb25zLA0KICAgICAgICAgICAgICAgICAgICBtb2RlbD10cmFpbl9qb2Iub3V0cHV0cy5tb2RlbF9vdXRwdXQsDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICJwaXBlbGluZV9qb2JfcHJlcHBlZF9kYXRhIjogcHJlcF9qb2Iub3V0cHV0cy5wcmVwX2RhdGEsDQogICAgICAgICAgICAgICAgICAgICJwaXBlbGluZV9qb2JfdHJhbnNmb3JtZWRfZGF0YSI6IHRyYW5zZm9ybV9qb2Iub3V0cHV0cy50cmFuc2Zvcm1lZF9kYXRhLA0KICAgICAgICAgICAgICAgICAgICAicGlwZWxpbmVfam9iX3RyYWluZWRfbW9kZWwiOiB0cmFpbl9qb2Iub3V0cHV0cy5tb2RlbF9vdXRwdXQsDQogICAgICAgICAgICAgICAgICAgICJwaXBlbGluZV9qb2JfdGVzdF9kYXRhIjogdHJhaW5fam9iLm91dHB1dHMudGVzdF9kYXRhLA0KICAgICAgICAgICAgICAgICAgICAicGlwZWxpbmVfam9iX3ByZWRpY3Rpb25zIjogcHJlZGljdF9qb2Iub3V0cHV0cy5wcmVkaWN0aW9ucywNCiAgICAgICAgICAgICAgICAgICAgInBpcGVsaW5lX2pvYl9zY29yZV9yZXBvcnQiOiBzY29yZV9qb2Iub3V0cHV0cy5zY29yZV9yZXBvcnQsDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBwaXBlbGluZSA9IHNhbXBsZV9waXBlbGluZShJbnB1dCh0eXBlPUFzc2V0VHlwZXMuVVJJX0ZPTERFUiwgcGF0aD1wYXJlbnRfZGlyICsgIi9kYXRhLyIpKQ0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfcHJlcHBlZF9kYXRhLmRhdGEgPSAiL3ByZXBwZWRfZGF0YSINCiAgICAgICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWxpbmVfam9iX3ByZXBwZWRfZGF0YS5tb2RlID0gInJ3X21vdW50Ig0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfdHJhbnNmb3JtZWRfZGF0YS5kYXRhID0gIi90cmFuc2Zvcm1lZF9kYXRhIg0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfdHJhbnNmb3JtZWRfZGF0YS5tb2RlID0gInJ3X21vdW50Ig0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfdHJhaW5lZF9tb2RlbC5kYXRhID0gIi90cmFpbmVkLW1vZGVsIg0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfdHJhaW5lZF9tb2RlbC5tb2RlID0gInJ3X21vdW50Ig0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfdGVzdF9kYXRhLmRhdGEgPSAiL3Rlc3RfZGF0YSINCiAgICAgICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWxpbmVfam9iX3Rlc3RfZGF0YS5tb2RlID0gInJ3X21vdW50Ig0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2JfcHJlZGljdGlvbnMuZGF0YSA9ICIvcHJlZGljdGlvbnMiDQogICAgICAgICAgICBwaXBlbGluZS5vdXRwdXRzLnBpcGVsaW5lX2pvYl9wcmVkaWN0aW9ucy5tb2RlID0gInJ3X21vdW50Ig0KICAgICAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlbGluZV9qb2Jfc2NvcmVfcmVwb3J0LmRhdGEgPSAiL3JlcG9ydCINCiAgICAgICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWxpbmVfam9iX3Njb3JlX3JlcG9ydC5tb2RlID0gInJ3X21vdW50Ig0KICAgICAgICAgICAgcmV0dXJuIHBpcGVsaW5lDQoNCiAgICAgICAgIyBjcmVhdGUgcGlwZWxpbmUgaW5zdGFuY2UNCiAgICAgICAgcGlwZWxpbmUgPSBnZW5lcmF0ZV9kc2xfcGlwZWxpbmUoKQ0KICAgICAgICAjIHN1Ym1pdCBqb2IgdG8gd29ya3NwYWNlDQogICAgICAgIGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUoDQogICAgICAgICAgICBwaXBlbGluZSwNCiAgICAgICAgICAgIGV4cGVyaW1lbnRfbmFtZT0ibnljX3RheGlfZGF0YV9yZWdyZXNzaW9uIiwNCiAgICAgICAgKQ0KDQogICAgZGVmIHRlc3RfY29tbWFuZF9mdW5jdGlvbihzZWxmLCByYW5kc3RyOiBDYWxsYWJsZVtbc3RyXSwgc3RyXSwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF95YW1sID0gc3RyKGNvbXBvbmVudHNfZGlyIC8gImhlbGxvd29ybGRfY29tcG9uZW50LnltbCIpDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPWhlbGxvX3dvcmxkX2NvbXBvbmVudF95YW1sKQ0KICAgICAgICAjIHVwZGF0ZSBjb21wb25lbnQgZGlzcGxheSBuYW1lIHRvIHdvcmsgYXJvdW5kIHNhbWUgY29tcG9uZW50IHJlZ2lzdGVyIG11bHRpcGxlIHRpbWUgaXNzdWUNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMuZGlzcGxheV9uYW1lID0gInRlc3RfY29tbWFuZF9mdW5jdGlvbl9ub2RlIg0KDQogICAgICAgIGVudmlyb25tZW50ID0gIkF6dXJlTUwtc2tsZWFybi0xLjAtdWJ1bnR1MjAuMDQtcHkzOC1jcHU6MzMiDQogICAgICAgIGRpc3RyaWJ1dGlvbiA9IHsidHlwZSI6ICJQeXRvcmNoIiwgInByb2Nlc3NfY291bnRfcGVyX2luc3RhbmNlIjogMn0NCiAgICAgICAgcmVzb3VyY2VzID0geyJpbnN0YW5jZV9jb3VudCI6IDJ9DQogICAgICAgIGVudmlyb25tZW50X3ZhcmlhYmxlcyA9IHsiZW52aXJvbiI6ICJ2YWwifQ0KICAgICAgICBpbnB1dHMgPSB7DQogICAgICAgICAgICAiY29tcG9uZW50X2luX3BhdGgiOiBJbnB1dCh0eXBlPSJ1cmlfZm9sZGVyIiwgcGF0aD0iaHR0cHM6Ly9teS1ibG9iL3BhdGgvdG8vZGF0YSIsIG1vZGU9InJvX21vdW50IiksDQogICAgICAgICAgICAiY29tcG9uZW50X2luX251bWJlciI6IDAuMDEsDQogICAgICAgIH0NCiAgICAgICAgb3V0cHV0cyA9IHsiY29tcG9uZW50X291dF9wYXRoIjogT3V0cHV0KHR5cGU9Im1sZmxvd19tb2RlbCIsIG1vZGU9InJ3X21vdW50Iil9DQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIG5hbWU9cmFuZHN0cigicGlwZWxpbmVfbmFtZSIpLA0KICAgICAgICAgICAgZGVzY3JpcHRpb249IlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgdGFncz17Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIG1peGVkX3BpcGVsaW5lKGpvYl9pbl9udW1iZXIsIGpvYl9pbl9wYXRoKToNCiAgICAgICAgICAgIGNvbW1hbmRfam9iID0gQ29tbWFuZEpvYigNCiAgICAgICAgICAgICAgICBkaXNwbGF5X25hbWU9ImNvbW1hbmQtam9iIiwNCiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudD1lbnZpcm9ubWVudCwNCiAgICAgICAgICAgICAgICBjb21tYW5kPSdlY2hvICJoZWxsbyB3b3JsZCInLA0KICAgICAgICAgICAgICAgIGRpc3RyaWJ1dGlvbj1kaXN0cmlidXRpb24sDQogICAgICAgICAgICAgICAgcmVzb3VyY2VzPXJlc291cmNlcywNCiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudF92YXJpYWJsZXM9ZW52aXJvbm1lbnRfdmFyaWFibGVzLA0KICAgICAgICAgICAgICAgIGlucHV0cz1pbnB1dHMsDQogICAgICAgICAgICAgICAgb3V0cHV0cz1vdXRwdXRzLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgY29tbWFuZF9qb2JfZnVuYyA9IHRvX2NvbXBvbmVudChqb2I9Y29tbWFuZF9qb2IpDQoNCiAgICAgICAgICAgICMgQ29tbWFuZCBmcm9tIGNvbW1hbmQoKSBmdW5jdGlvbg0KICAgICAgICAgICAgY29tbWFuZF9mdW5jdGlvbiA9IGNvbW1hbmQoDQogICAgICAgICAgICAgICAgZGlzcGxheV9uYW1lPSJjb21tYW5kLWZ1bmN0aW9uLWpvYiIsDQogICAgICAgICAgICAgICAgZW52aXJvbm1lbnQ9ZW52aXJvbm1lbnQsDQogICAgICAgICAgICAgICAgY29tbWFuZD0nZWNobyAiaGVsbG8gd29ybGQiJywNCiAgICAgICAgICAgICAgICBkaXN0cmlidXRpb249ZGlzdHJpYnV0aW9uLA0KICAgICAgICAgICAgICAgIHJlc291cmNlcz1yZXNvdXJjZXMsDQogICAgICAgICAgICAgICAgZW52aXJvbm1lbnRfdmFyaWFibGVzPWVudmlyb25tZW50X3ZhcmlhYmxlcywNCiAgICAgICAgICAgICAgICBpbnB1dHM9aW5wdXRzLA0KICAgICAgICAgICAgICAgIG91dHB1dHM9b3V0cHV0cywNCiAgICAgICAgICAgICkNCg0KICAgICAgICAgICAgbm9kZTEgPSBoZWxsb193b3JsZF9jb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KICAgICAgICAgICAgbm9kZTIgPSBjb21tYW5kX2pvYl9mdW5jKA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPW5vZGUxLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9MiwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIG5vZGUzID0gY29tbWFuZF9mdW5jdGlvbigNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1ub2RlMi5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fbnVtYmVyPTMsDQogICAgICAgICAgICApDQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgInBpcGVsaW5lX2pvYl9vdXQiOiBub2RlMy5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgIH0NCg0KICAgICAgICBwaXBlbGluZSA9IG1peGVkX3BpcGVsaW5lKDE2LCBqb2JfaW5wdXQpDQogICAgICAgICMgc3VibWl0IGpvYiB0byB3b3Jrc3BhY2UNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZSgNCiAgICAgICAgICAgIHBpcGVsaW5lLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPSJtaXhlZF9waXBlbGluZSIsDQogICAgICAgICkNCiAgICAgICAgYWN0dWFsX2pvYiA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkucHJvcGVydGllcy5hc19kaWN0KCksICpjb21tb25fb21pdF9maWVsZHMpDQogICAgICAgIGV4cGVjdGVkX2pvYiA9IHsNCiAgICAgICAgICAgICJ0YWdzIjogeyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgImNvbXB1dGVfaWQiOiAiY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAiam9iX2luX251bWJlciI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIxNiJ9LA0KICAgICAgICAgICAgICAgICJqb2JfaW5fcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiUmVhZE9ubHlNb3VudCIsDQogICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZmlsZSIsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiam9icyI6IHsNCiAgICAgICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9udW1iZXIiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmpvYl9pbl9udW1iZXJ9fSIsDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuam9iX2luX3BhdGh9fSJ9LA0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJub2RlMSIsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibm9kZTIiOiB7DQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgICAgICAgICAiZGlzdHJpYnV0aW9uIjogeyJkaXN0cmlidXRpb25fdHlwZSI6ICJQeVRvcmNoIiwgInByb2Nlc3NfY291bnRfcGVyX2luc3RhbmNlIjogMn0sDQogICAgICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X2luX251bWJlciI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIyIn0sDQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X2luX3BhdGgiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5ub2RlMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIm5vZGUyIiwNCiAgICAgICAgICAgICAgICAgICAgInJlc291cmNlcyI6IHsiaW5zdGFuY2VfY291bnQiOiAyfSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJub2RlMyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImRpc3BsYXlfbmFtZSI6ICJjb21tYW5kLWZ1bmN0aW9uLWpvYiIsDQogICAgICAgICAgICAgICAgICAgICJkaXN0cmlidXRpb24iOiB7ImRpc3RyaWJ1dGlvbl90eXBlIjogIlB5VG9yY2giLCAicHJvY2Vzc19jb3VudF9wZXJfaW5zdGFuY2UiOiAyfSwNCiAgICAgICAgICAgICAgICAgICAgImVudmlyb25tZW50X3ZhcmlhYmxlcyI6IHsiZW52aXJvbiI6ICJ2YWwifSwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjMifSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5qb2JzLm5vZGUyLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTMiLA0KICAgICAgICAgICAgICAgICAgICAib3V0cHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3BhdGgiOiB7InR5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5waXBlbGluZV9qb2Jfb3V0fX0ifQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAicmVzb3VyY2VzIjogeyJpbnN0YW5jZV9jb3VudCI6IDJ9LA0KICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICJwaXBlbGluZV9qb2Jfb3V0Ijogew0KICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJSZWFkV3JpdGVNb3VudCIsDQogICAgICAgICAgICAgICAgICAgICJqb2Jfb3V0cHV0X3R5cGUiOiAibWxmbG93X21vZGVsIiwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInNldHRpbmdzIjoge30sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGV4cGVjdGVkX2pvYiA9PSBhY3R1YWxfam9iDQoNCiAgICBkZWYgdGVzdF9jb21tYW5kX3dpdGhfb3B0aW9uYWxfaW5wdXRzKHNlbGYsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwgPSBzdHIoY29tcG9uZW50c19kaXIgLyAiaGVsbG93b3JsZF9jb21wb25lbnRfd2l0aF9vcHRpb25hbF9pbnB1dHMueW1sIikNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9aGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwpDQogICAgICAgIGNvbW1hbmRfZnVuYyA9IGNvbW1hbmQoDQogICAgICAgICAgICBuYW1lPWYidGVzdF9vcHRpb25hbF9pbnB1dF9jb21wb25lbnRfIiArIHJhbmRzdHIoImNvbXBvbmVudF9uYW1lIiksDQogICAgICAgICAgICBkaXNwbGF5X25hbWU9ImNvbW1hbmRfd2l0aF9vcHRpb25hbF9pbnB1dHMiLA0KICAgICAgICAgICAgZW52aXJvbm1lbnQ9IkF6dXJlTUwtc2tsZWFybi0xLjAtdWJ1bnR1MjAuMDQtcHkzOC1jcHU6MzMiLA0KICAgICAgICAgICAgY29tbWFuZD0oDQogICAgICAgICAgICAgICAgJ2VjaG8gImhlbGxvIHdvcmxkIiAnDQogICAgICAgICAgICAgICAgIiYgZWNobyAkW1ske3tpbnB1dHMuZmxvYXR9fV1dICINCiAgICAgICAgICAgICAgICAiJiBlY2hvICRbWyR7e2lucHV0cy5pbnRlZ2VyfX1dXSAiDQogICAgICAgICAgICAgICAgIiYgZWNobyAkW1ske3tpbnB1dHMuc3RyaW5nfX1dXSAiDQogICAgICAgICAgICAgICAgIiYgZWNobyAkW1ske3tpbnB1dHMuYm9vbGVhbn19XV0gIg0KICAgICAgICAgICAgICAgICImIGVjaG8gJHt7aW5wdXRzLnVyaV9mb2xkZXJ9fSAiDQogICAgICAgICAgICAgICAgIiYgZWNobyAkW1ske3tpbnB1dHMub3B0aW9uYWxfMH19XV0gIg0KICAgICAgICAgICAgICAgICImIGVjaG8gJFtbJHt7aW5wdXRzLm9wdGlvbmFsXzF9fV1dIg0KICAgICAgICAgICAgICAgICImIGVjaG8gJFtbJHt7aW5wdXRzLm9wdGlvbmFsXzJ9fV1dIg0KICAgICAgICAgICAgKSwNCiAgICAgICAgICAgIGRpc3RyaWJ1dGlvbj17InR5cGUiOiAiUHl0b3JjaCIsICJwcm9jZXNzX2NvdW50X3Blcl9pbnN0YW5jZSI6IDJ9LA0KICAgICAgICAgICAgcmVzb3VyY2VzPXsiaW5zdGFuY2VfY291bnQiOiAyfSwNCiAgICAgICAgICAgIGVudmlyb25tZW50X3ZhcmlhYmxlcz17ImVudmlyb24iOiAidmFsIn0sDQogICAgICAgICAgICBpbnB1dHM9ew0KICAgICAgICAgICAgICAgICJmbG9hdCI6IElucHV0KHR5cGU9Im51bWJlciIsIGRlZmF1bHQ9MS4xLCBtaW49MCwgbWF4PTUsIG9wdGlvbmFsPVRydWUpLA0KICAgICAgICAgICAgICAgICJpbnRlZ2VyIjogSW5wdXQodHlwZT0iaW50ZWdlciIsIGRlZmF1bHQ9MiwgbWluPS0xLCBtYXg9NCwgb3B0aW9uYWw9VHJ1ZSksDQogICAgICAgICAgICAgICAgInN0cmluZyI6IElucHV0KHR5cGU9InN0cmluZyIsIGRlZmF1bHQ9ImRlZmF1bHRfc3RyIiwgb3B0aW9uYWw9VHJ1ZSksDQogICAgICAgICAgICAgICAgImJvb2xlYW4iOiBJbnB1dCh0eXBlPSJib29sZWFuIiwgZGVmYXVsdD1GYWxzZSwgb3B0aW9uYWw9VHJ1ZSksDQogICAgICAgICAgICAgICAgInVyaV9mb2xkZXIiOiBJbnB1dCh0eXBlPSJ1cmlfZm9sZGVyIiksDQogICAgICAgICAgICAgICAgIm9wdGlvbmFsXzAiOiBJbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIG9wdGlvbmFsPVRydWUpLA0KICAgICAgICAgICAgICAgICJvcHRpb25hbF8xIjogSW5wdXQodHlwZT0ibnVtYmVyIiwgb3B0aW9uYWw9VHJ1ZSksDQogICAgICAgICAgICAgICAgIm9wdGlvbmFsXzIiOiBJbnB1dCh0eXBlPSJudW1iZXIiLCBvcHRpb25hbD1UcnVlLCBkZWZhdWx0PTEuMiksDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgb3V0cHV0cz17ImNvbXBvbmVudF9vdXRfcGF0aCI6IE91dHB1dCh0eXBlPSJ1cmlfZm9sZGVyIil9LA0KICAgICAgICApDQoNCiAgICAgICAgY29tcG9uZW50ID0gY2xpZW50LmNvbXBvbmVudHMuY3JlYXRlX29yX3VwZGF0ZShjb21tYW5kX2Z1bmMuY29tcG9uZW50KQ0KICAgICAgICBhc3NlcnQgY29tcG9uZW50IGFuZCBjb21wb25lbnQudmVyc2lvbiA9PSAiMSINCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgbmFtZT1mInRlc3Rfb3B0aW9uYWxfaW5wdXRfY29tcG9uZW50X3BpcGVsaW5lXyIgKyByYW5kc3RyKCJwaXBlbGluZV9uYW1lIiksDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhlIGNvbW1hbmQgbm9kZSB3aXRoIG9wdGlvbmFsIGlucHV0cyIsDQogICAgICAgICAgICB0YWdzPXsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgc2FtcGxlX3BpcGVsaW5lKGpvYl9pbl9maWxlKToNCiAgICAgICAgICAgIG5vZGUxID0gaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X2luX3BhdGg9am9iX2luX2ZpbGUpDQogICAgICAgICAgICBub2RlMiA9IGNvbW1hbmRfZnVuYyh1cmlfZm9sZGVyPW5vZGUxLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoKQ0KDQogICAgICAgICAgICByZXR1cm4geyJwaXBlbGluZV9vdXRwdXQiOiBub2RlMi5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH0NCg0KICAgICAgICBwaXBlbGluZSA9IHNhbXBsZV9waXBlbGluZSgNCiAgICAgICAgICAgIElucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKQ0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUpDQoNCiAgICAgICAgYWN0dWFsX2pvYiA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkucHJvcGVydGllcy5hc19kaWN0KCksICpjb21tb25fb21pdF9maWVsZHMpDQogICAgICAgIGV4cGVjdGVkX2pvYiA9IHsNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgY29tbWFuZCBub2RlIHdpdGggb3B0aW9uYWwgaW5wdXRzIiwNCiAgICAgICAgICAgICJ0YWdzIjogeyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgImNvbXB1dGVfaWQiOiAiY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAiam9iX2luX2ZpbGUiOiB7DQogICAgICAgICAgICAgICAgICAgICJtb2RlIjogIlJlYWRPbmx5TW91bnQiLA0KICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAidXJpX2ZpbGUiLA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiam9icyI6IHsNCiAgICAgICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X2luX3BhdGgiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5qb2JfaW5fZmlsZX19In0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTEiLA0KICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJub2RlMiI6IHsNCiAgICAgICAgICAgICAgICAgICAgImRpc3BsYXlfbmFtZSI6ICJjb21tYW5kX3dpdGhfb3B0aW9uYWxfaW5wdXRzIiwNCiAgICAgICAgICAgICAgICAgICAgImRpc3RyaWJ1dGlvbiI6IHsiZGlzdHJpYnV0aW9uX3R5cGUiOiAiUHlUb3JjaCIsICJwcm9jZXNzX2NvdW50X3Blcl9pbnN0YW5jZSI6IDJ9LA0KICAgICAgICAgICAgICAgICAgICAiZW52aXJvbm1lbnRfdmFyaWFibGVzIjogeyJlbnZpcm9uIjogInZhbCJ9LA0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgInVyaV9mb2xkZXIiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5ub2RlMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTIiLA0KICAgICAgICAgICAgICAgICAgICAib3V0cHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3BhdGgiOiB7InR5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5waXBlbGluZV9vdXRwdXR9fSJ9DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJyZXNvdXJjZXMiOiB7Imluc3RhbmNlX2NvdW50IjogMn0sDQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7InBpcGVsaW5lX291dHB1dCI6IHsibW9kZSI6ICJSZWFkV3JpdGVNb3VudCIsICJqb2Jfb3V0cHV0X3R5cGUiOiAidXJpX2ZvbGRlciJ9fSwNCiAgICAgICAgICAgICJzZXR0aW5ncyI6IHt9LA0KICAgICAgICB9DQogICAgICAgIGFzc2VydCBleHBlY3RlZF9qb2IgPT0gYWN0dWFsX2pvYg0KDQogICAgZGVmIHRlc3Rfc3Bhcmtfd2l0aF9vcHRpb25hbF9pbnB1dHMoc2VsZiwgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0sIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBjb21wb25lbnRfeWFtbCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvc3Bhcmtfam9iX2luX3BpcGVsaW5lL2NvbXBvbmVudF93aXRoX29wdGlvbmFsX2lucHV0cy55bWwiDQogICAgICAgIHNwYXJrX3dpdGhfb3B0aW9uYWxfaW5wdXRzX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPWNvbXBvbmVudF95YW1sKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPWYidGVzdF9vcHRpb25hbF9pbnB1dF9jb21wb25lbnRfcGlwZWxpbmVfIiArIHJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgc3Bhcmsgbm9kZSB3aXRoIG9wdGlvbmFsIGlucHV0cyIsDQogICAgICAgICAgICB0YWdzPXsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgc2FtcGxlX3BpcGVsaW5lKGpvYl9pbl9maWxlLCBzYW1wbGVfcmF0ZSk6DQogICAgICAgICAgICBub2RlMSA9IHNwYXJrX3dpdGhfb3B0aW9uYWxfaW5wdXRzX2NvbXBvbmVudF9mdW5jKGlucHV0MT1qb2JfaW5fZmlsZSwgc2FtcGxlX3JhdGU9c2FtcGxlX3JhdGUpDQogICAgICAgICAgICBub2RlMS5yZXNvdXJjZXMgPSB7Imluc3RhbmNlX3R5cGUiOiAic3RhbmRhcmRfZTRzX3YzIiwgInJ1bnRpbWVfdmVyc2lvbiI6ICIzLjIuMCJ9DQogICAgICAgICAgICByZXR1cm4geyJwaXBlbGluZV9vdXRwdXQiOiBub2RlMS5vdXRwdXRzLm91dHB1dDF9DQoNCiAgICAgICAgcGlwZWxpbmUgPSBzYW1wbGVfcGlwZWxpbmUoDQogICAgICAgICAgICBqb2JfaW5fZmlsZT1JbnB1dCgNCiAgICAgICAgICAgICAgICBwYXRoPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvc3Bhcmtfam9iX2luX3BpcGVsaW5lL2RhdGFzZXQvc2hha2VzcGVhcmUudHh0IiwNCiAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuVVJJX0ZJTEUsDQogICAgICAgICAgICAgICAgbW9kZT1JbnB1dE91dHB1dE1vZGVzLkRJUkVDVCwNCiAgICAgICAgICAgICksDQogICAgICAgICAgICBzYW1wbGVfcmF0ZT0wLjAxLA0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWxpbmVfb3V0cHV0Lm1vZGUgPSBJbnB1dE91dHB1dE1vZGVzLkRJUkVDVA0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lKQ0KDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVGhlIHNwYXJrIG5vZGUgd2l0aCBvcHRpb25hbCBpbnB1dHMiLA0KICAgICAgICAgICAgInRhZ3MiOiB7Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICAgICAiaXNfYXJjaGl2ZWQiOiBGYWxzZSwNCiAgICAgICAgICAgICJqb2JfdHlwZSI6ICJQaXBlbGluZSIsDQogICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICJqb2JfaW5fZmlsZSI6IHsiam9iX2lucHV0X3R5cGUiOiAidXJpX2ZpbGUiLCAibW9kZSI6ICJEaXJlY3QifSwNCiAgICAgICAgICAgICAgICAic2FtcGxlX3JhdGUiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMC4wMSJ9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJqb2JzIjogew0KICAgICAgICAgICAgICAgICJub2RlMSI6IHsNCiAgICAgICAgICAgICAgICAgICAgImFyZ3MiOiAiLS1pbnB1dDEgJHt7aW5wdXRzLmlucHV0MX19IC0tb3V0cHV0MiAiDQogICAgICAgICAgICAgICAgICAgICIke3tvdXRwdXRzLm91dHB1dDF9fSAtLW15X3NhbXBsZV9yYXRlICINCiAgICAgICAgICAgICAgICAgICAgIiR7e2lucHV0cy5zYW1wbGVfcmF0ZX19ICRbWy0taW5wdXRfb3B0aW9uYWwgIg0KICAgICAgICAgICAgICAgICAgICAiJHt7aW5wdXRzLmlucHV0X29wdGlvbmFsfX1dXSIsDQogICAgICAgICAgICAgICAgICAgICJjb25mIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgInNwYXJrLmRyaXZlci5jb3JlcyI6IDEsDQogICAgICAgICAgICAgICAgICAgICAgICAic3BhcmsuZHJpdmVyLm1lbW9yeSI6ICIyZyIsDQogICAgICAgICAgICAgICAgICAgICAgICAic3BhcmsuZHluYW1pY0FsbG9jYXRpb24uZW5hYmxlZCI6IFRydWUsDQogICAgICAgICAgICAgICAgICAgICAgICAic3BhcmsuZHluYW1pY0FsbG9jYXRpb24ubWF4RXhlY3V0b3JzIjogNCwNCiAgICAgICAgICAgICAgICAgICAgICAgICJzcGFyay5keW5hbWljQWxsb2NhdGlvbi5taW5FeGVjdXRvcnMiOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgInNwYXJrLmV4ZWN1dG9yLmNvcmVzIjogMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJzcGFyay5leGVjdXRvci5pbnN0YW5jZXMiOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgInNwYXJrLmV4ZWN1dG9yLm1lbW9yeSI6ICIyZyIsDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJlbnRyeSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJmaWxlIjogInNhbXBsZXdvcmRfd2l0aF9vcHRpb25hbF9pbnB1dC5weSIsDQogICAgICAgICAgICAgICAgICAgICAgICAic3Bhcmtfam9iX2VudHJ5X3R5cGUiOiAiU3BhcmtKb2JQeXRob25FbnRyeSIsDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJpZGVudGl0eSI6IHsiaWRlbnRpdHlfdHlwZSI6ICJVc2VySWRlbnRpdHkifSwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJpbnB1dDEiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5qb2JfaW5fZmlsZX19In0sDQogICAgICAgICAgICAgICAgICAgICAgICAic2FtcGxlX3JhdGUiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5zYW1wbGVfcmF0ZX19In0sDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIm5vZGUxIiwNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dHMiOiB7Im91dHB1dDEiOiB7InR5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5waXBlbGluZV9vdXRwdXR9fSJ9fSwNCiAgICAgICAgICAgICAgICAgICAgInJlc291cmNlcyI6IHsiaW5zdGFuY2VfdHlwZSI6ICJzdGFuZGFyZF9lNHNfdjMiLCAicnVudGltZV92ZXJzaW9uIjogIjMuMi4wIn0sDQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInNwYXJrIiwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7InBpcGVsaW5lX291dHB1dCI6IHsibW9kZSI6ICJEaXJlY3QiLCAiam9iX291dHB1dF90eXBlIjogInVyaV9maWxlIn19LA0KICAgICAgICAgICAgInNldHRpbmdzIjoge30sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGV4cGVjdGVkX2pvYiA9PSBhY3R1YWxfam9iDQoNCiAgICBkZWYgdGVzdF9jb21tYW5kX2J5X3Bhc3Moc2VsZiwgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0sIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfeWFtbCA9IHN0cihjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiKQ0KICAgICAgICBjb21wb25lbnRfZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1oZWxsb193b3JsZF9jb21wb25lbnRfeWFtbCkNCiAgICAgICAgIyB1cGRhdGUgY29tcG9uZW50IGRpc3BsYXkgbmFtZSB0byB3b3JrIGFyb3VuZCBzYW1lIGNvbXBvbmVudCByZWdpc3RlciBtdWx0aXBsZSB0aW1lIGlzc3VlDQogICAgICAgIGNvbXBvbmVudF9mdW5jLmRpc3BsYXlfbmFtZSA9ICJ0ZXN0X2NvbW1hbmRfYnlfcGFzcyINCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgbmFtZT1yYW5kc3RyKCJwaXBlbGluZV9uYW1lIiksDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhlIGhlbGxvIHdvcmxkIHBpcGVsaW5lIGpvYiIsDQogICAgICAgICAgICB0YWdzPXsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgICAgIGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSwNCiAgICAgICAgICAgIGNvbnRpbnVlX29uX3N0ZXBfZmFpbHVyZT1UcnVlLA0KICAgICAgICApDQogICAgICAgIGRlZiBwaXBlbGluZShqb2JfaW5fbnVtYmVyLCBqb2JfaW5fb3RoZXJfbnVtYmVyLCBqb2JfaW5fcGF0aCk6DQogICAgICAgICAgICAjIGR5bmFtaWMgZmllbGRzIHdpbGwgcGFzcyB0aHJvdWdoIHRvIGJhY2tlbmQNCiAgICAgICAgICAgIG5vZGUxID0gY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCiAgICAgICAgICAgIG5vZGUxLm5ld19maWVsZCA9ICJ2YWwiDQogICAgICAgICAgICBub2RlMiA9IGNvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX290aGVyX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQogICAgICAgICAgICBub2RlMi5uZXdfZmllbGQgPSB7fQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmUoMTAsIDIwLCBqb2JfaW5wdXQpDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUoDQogICAgICAgICAgICBwaXBlbGluZSwNCiAgICAgICAgICAgIGV4cGVyaW1lbnRfbmFtZT0iZHNsX2V4cCIsDQogICAgICAgICkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmZvcmNlX3JlcnVuID0gRmFsc2UNCiAgICAgICAgYWN0dWFsX2pvYiA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkucHJvcGVydGllcy5hc19kaWN0KCksICpjb21tb25fb21pdF9maWVsZHMpDQogICAgICAgIGV4cGVjdGVkX2pvYiA9IHsNCiAgICAgICAgICAgICJ0YWdzIjogeyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBoZWxsbyB3b3JsZCBwaXBlbGluZSBqb2IiLA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAiam9iX2luX251bWJlciI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIxMCJ9LA0KICAgICAgICAgICAgICAgICJqb2JfaW5fb3RoZXJfbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjIwIn0sDQogICAgICAgICAgICAgICAgImpvYl9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJSZWFkT25seU1vdW50IiwNCiAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogInVyaV9maWxlIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJqb2JzIjogew0KICAgICAgICAgICAgICAgICJub2RlMSI6IHsNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X2luX251bWJlciI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuam9iX2luX251bWJlcn19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X2luX3BhdGgiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5qb2JfaW5fcGF0aH19In0sDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIm5vZGUxIiwNCiAgICAgICAgICAgICAgICAgICAgIm5ld19maWVsZCI6ICJ2YWwiLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5vZGUyIjogew0KICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5qb2JfaW5fb3RoZXJfbnVtYmVyfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fcGF0aCI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmpvYl9pbl9wYXRofX0ifSwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTIiLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJzZXR0aW5ncyI6IHsNCiAgICAgICAgICAgICAgICAiY29udGludWVfb25fc3RlcF9mYWlsdXJlIjogVHJ1ZSwNCiAgICAgICAgICAgICAgICAiZm9yY2VfcmVydW4iOiBGYWxzZSwNCiAgICAgICAgICAgICAgICAiZGVmYXVsdF9jb21wdXRlIjogImNwdS1jbHVzdGVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGV4cGVjdGVkX2pvYiA9PSBhY3R1YWxfam9iDQoNCiAgICBkZWYgdGVzdF9waXBlbGluZV9wYXJhbWV0ZXJfd2l0aF9kZWZhdWx0X3ZhbHVlKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGlucHV0X3R5cGVzX2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImlucHV0X3R5cGVzX2NvbXBvbmVudC55bWwiKSkNCg0KICAgICAgICAjIENvbnN0cnVjdCBwaXBlbGluZQ0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhpcyBpcyB0aGUgYmFzaWMgcGlwZWxpbmUgd2l0aCBzZXZlcmFsIGlucHV0IHR5cGVzIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgaW5wdXRfdHlwZXNfcGlwZWxpbmUoDQogICAgICAgICAgICBjb21wb25lbnRfaW5fc3RyaW5nPSJjb21wb25lbnRfaW5fc3RyaW5nIiwNCiAgICAgICAgICAgIGNvbXBvbmVudF9pbl9yYW5nZWRfaW50ZWdlcj0xMCwNCiAgICAgICAgICAgIGNvbXBvbmVudF9pbl9lbnVtPSJ3b3JsZCIsDQogICAgICAgICAgICBjb21wb25lbnRfaW5fYm9vbGVhbj1UcnVlLA0KICAgICAgICAgICAgY29tcG9uZW50X2luX3JhbmdlZF9udW1iZXI9OCwNCiAgICAgICAgKToNCiAgICAgICAgICAgIGlucHV0X3R5cGVzX2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3N0cmluZz1jb21wb25lbnRfaW5fc3RyaW5nLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9yYW5nZWRfaW50ZWdlcj1jb21wb25lbnRfaW5fcmFuZ2VkX2ludGVnZXIsDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX2VudW09Y29tcG9uZW50X2luX2VudW0sDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX2Jvb2xlYW49Y29tcG9uZW50X2luX2Jvb2xlYW4sDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3JhbmdlZF9udW1iZXI9Y29tcG9uZW50X2luX3JhbmdlZF9udW1iZXIsDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBpbnB1dF90eXBlc19waXBlbGluZSgpICAjIHVzZSBkZWZhdWx0IHBpcGVsaW5lIHBhcmFtZXRlcg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ImlucHV0X3R5cGVzX3BpcGVsaW5lIikNCg0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLmlucHV0cy5jb21wb25lbnRfaW5fc3RyaW5nLl9kYXRhID09ICJjb21wb25lbnRfaW5fc3RyaW5nIg0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLmlucHV0cy5jb21wb25lbnRfaW5fcmFuZ2VkX2ludGVnZXIuX2RhdGEgPT0gIjEwIg0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLmlucHV0cy5jb21wb25lbnRfaW5fZW51bS5fZGF0YSA9PSAid29ybGQiDQogICAgICAgIGFzc2VydCBwaXBlbGluZV9qb2IuaW5wdXRzLmNvbXBvbmVudF9pbl9ib29sZWFuLl9kYXRhID09ICJUcnVlIg0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLmlucHV0cy5jb21wb25lbnRfaW5fcmFuZ2VkX251bWJlci5fZGF0YSA9PSAiOCINCg0KICAgIGRlZiB0ZXN0X2NvbXBvbmVudF93aXRoX2RlZmF1bHRfb3B0aW9uYWxfaW5wdXQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXN0cihjb21wb25lbnRzX2RpciAvICJkZWZhdWx0X29wdGlvbmFsX2NvbXBvbmVudC55bWwiKSkNCg0KICAgICAgICAjIENvbnN0cnVjdCBwaXBlbGluZQ0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhpcyBpcyB0aGUgYmFzaWMgcGlwZWxpbmUgd2l0aCBzZXZlcmFsIGlucHV0IHR5cGVzIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgZGVmYXVsdF9vcHRpb25hbF9waXBlbGluZSgpOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPSJkZWYiLA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PUlucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGRlZmF1bHRfb3B0aW9uYWxfZnVuYygNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iZGVmIiwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1JbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiksDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfaW5wdXQ9Tm9uZSwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQ9Tm9uZSwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbT1Ob25lLA0KICAgICAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdD1Ob25lLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gZGVmYXVsdF9vcHRpb25hbF9waXBlbGluZSgpICAjIHVzZSBkZWZhdWx0IHBpcGVsaW5lIHBhcmFtZXRlcg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ImRlZmF1bHRfb3B0aW9uYWxfcGlwZWxpbmUiKQ0KDQogICAgICAgICMgb25seSB0aGUgdHdvIHJlcXVpcmVkIGlucHV0IGV4aXN0cw0KICAgICAgICBhc3NlcnQgbGVuKHBpcGVsaW5lX2pvYi5qb2JzWyJkZWZhdWx0X29wdGlvbmFsX2NvbXBvbmVudCJdLmlucHV0cykgPT0gMg0KICAgICAgICAjIFRPRE86IG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCBzaG91bGQgYWxzbyBleGlzdHMNCiAgICAgICAgYXNzZXJ0IGxlbihwaXBlbGluZV9qb2Iuam9ic1siZGVmYXVsdF9vcHRpb25hbF9jb21wb25lbnRfMSJdLmlucHV0cykgPT0gMg0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfd2l0aF9ub25lX3BhcmFtZXRlcl9oYXNfZGVmYXVsdF9vcHRpb25hbF9mYWxzZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImRlZmF1bHRfb3B0aW9uYWxfY29tcG9uZW50LnltbCIpKQ0KDQogICAgICAgICMgTm9uZSBpbnB1dCBpcyBiaW5kaW5nIHRvIGEgcmVxdWlyZWQgaW5wdXQNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICApDQogICAgICAgIGRlZiBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICk6DQogICAgICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMoDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9cmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09cmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PXJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhfZGVmYXVsdF9vcHRpb25hbF9wYXJhbWV0ZXJzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9SW5wdXQodHlwZT0idXJpX2ZpbGUiLCBwYXRoPSJodHRwczovL2RwcmVwZGF0YS5ibG9iLmNvcmUud2luZG93cy5uZXQvZGVtby9UaXRhbmljLmNzdiIpLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09ImhlbGxvIiwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD1Ob25lLA0KICAgICAgICApDQogICAgICAgIHZhbGlkYXRlX3Jlc3VsdCA9IHBpcGVsaW5lLl92YWxpZGF0ZSgpDQogICAgICAgIGFzc2VydCB2YWxpZGF0ZV9yZXN1bHQuZXJyb3JfbWVzc2FnZXMgPT0gew0KICAgICAgICAgICAgImlucHV0cy5yZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQiOiAiUmVxdWlyZWQgaW5wdXQgJ3JlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCcgZm9yIHBpcGVsaW5lICdwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycycgbm90IHByb3ZpZGVkLiINCiAgICAgICAgfQ0KDQogICAgICAgICMgTm9uZSBpbnB1dCBpcyBub3QgYmluZGluZyB0byBhIHJlcXVpcmVkIGlucHV0DQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtLA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD1Ob25lLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1JbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiksDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iaGVsbG8iLA0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUsIGV4cGVyaW1lbnRfbmFtZT0iZGVmYXVsdF9vcHRpb25hbF9waXBlbGluZSIpDQoNCiAgICAgICAgIyBvbmx5IHRoZSB0d28gcmVxdWlyZWQgaW5wdXRzIGV4aXN0cw0KICAgICAgICBhc3NlcnQgbGVuKG5leHQocGlwZWxpbmVfam9iLmpvYnMudmFsdWVzKCkuX19pdGVyX18oKSkuaW5wdXRzKSA9PSAyDQogICAgICAgIHZhbGlkYXRlX3Jlc3VsdCA9IHBpcGVsaW5lLl92YWxpZGF0ZSgpDQogICAgICAgIGFzc2VydCB2YWxpZGF0ZV9yZXN1bHQucGFzc2VkIGlzIFRydWUNCg0KICAgICAgICAjIE5vdCBwYXNzIHJlcXVpcmVkIHBhcmFtZXRlciB3aXRoIGRlZmF1bHQgdmFsdWUNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICApDQogICAgICAgIGRlZiBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW0sDQogICAgICAgICk6DQogICAgICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMoDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9cmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09cmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PUlucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPSJoZWxsbyIsDQogICAgICAgICkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPSJkZWZhdWx0X29wdGlvbmFsX3BpcGVsaW5lIikNCiAgICAgICAgIyBvbmx5IHRoZSB0d28gcmVxdWlyZWQgaW5wdXQgZXhpc3RzDQogICAgICAgIGFzc2VydCBsZW4obmV4dChwaXBlbGluZV9qb2Iuam9icy52YWx1ZXMoKS5fX2l0ZXJfXygpKS5pbnB1dHMpID09IDINCiAgICAgICAgdmFsaWRhdGVfcmVzdWx0ID0gcGlwZWxpbmUuX3ZhbGlkYXRlKCkNCiAgICAgICAgYXNzZXJ0IHZhbGlkYXRlX3Jlc3VsdC5wYXNzZWQgaXMgVHJ1ZQ0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfd2l0aF9ub25lX3BhcmFtZXRlcl9ub19kZWZhdWx0X29wdGlvbmFsX3RydWUoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXN0cihjb21wb25lbnRzX2RpciAvICJkZWZhdWx0X29wdGlvbmFsX2NvbXBvbmVudC55bWwiKSkNCg0KICAgICAgICAjIE5vbmUgaW5wdXQgaXMgYmluZGluZyB0byBhIG9wdGlvbmFsIGlucHV0DQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgNCiAgICAgICAgICAgIGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICApDQogICAgICAgIGRlZiBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbSwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgKToNCiAgICAgICAgICAgIGRlZmF1bHRfb3B0aW9uYWxfZnVuYygNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1yZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbT1yZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQ9cmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtPW9wdGlvbmFsX3BhcmFtLA0KICAgICAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdD1vcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PUlucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPSJoZWxsbyIsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQ9InJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCIsDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbT1Ob25lLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0PSJvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQiLA0KICAgICAgICApDQogICAgICAgICMgdG9kbzogdW5jb21tZW50IHRoaXMgd2hlbiBiYWNrZW5kIHJlbW92ZSBjb21wb25lbnQgam9iIG9wdGlvbmFsIGlucHV0IHdoaWNoIGlzIGJpbmRpbmcgdG8gYSBOb25lIHBpcGVsaW5lDQogICAgICAgICMgIGlucHV0DQogICAgICAgICMgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPSJkZWZhdWx0X29wdGlvbmFsX3BpcGVsaW5lIikNCiAgICAgICAgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbSIgbm90IGluIHBpcGVsaW5lLmlucHV0cw0KDQogICAgICAgICMgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbSIgbm90IGluIHBpcGVsaW5lX2pvYi5pbnB1dHMNCiAgICAgICAgIyBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtIiBub3QgaW4gbmV4dChwaXBlbGluZV9qb2Iuam9icy52YWx1ZXMoKS5fX2l0ZXJfXygpKS5pbnB1dHMNCg0KICAgICAgICAjIE5vbmUgaW5wdXQgaXMgbm90IGJpbmRpbmcgdG8gYSBvcHRpb25hbCBpbnB1dA0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfZGVmYXVsdF9vcHRpb25hbF9wYXJhbWV0ZXJzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD1yZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09Tm9uZSwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQ9b3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1JbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiksDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iaGVsbG8iLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PSJyZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQiLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09Tm9uZSwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdD0ib3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0IiwNCiAgICAgICAgKQ0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ImRlZmF1bHRfb3B0aW9uYWxfcGlwZWxpbmUiKQ0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtIiBub3QgaW4gcGlwZWxpbmUuaW5wdXRzDQogICAgICAgIGFzc2VydCAib3B0aW9uYWxfcGFyYW0iIG5vdCBpbiBwaXBlbGluZV9qb2IuaW5wdXRzDQoNCiAgICAgICAgIyBOb3QgcGFzcyByZXF1aXJlZCBwYXJhbWV0ZXIgd2l0aCBkZWZhdWx0IHZhbHVlDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW0sDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICk6DQogICAgICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMoDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9cmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09cmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PXJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQ9b3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1JbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiksDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iaGVsbG8iLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PSJyZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQiLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09Tm9uZSwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdD0ib3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0IiwNCiAgICAgICAgKQ0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ImRlZmF1bHRfb3B0aW9uYWxfcGlwZWxpbmUiKQ0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtIiBub3QgaW4gcGlwZWxpbmUuaW5wdXRzDQogICAgICAgIGFzc2VydCAib3B0aW9uYWxfcGFyYW0iIG5vdCBpbiBwaXBlbGluZV9qb2IuaW5wdXRzDQoNCiAgICBkZWYgdGVzdF9jaGVja19waXBlbGluZV9jb21wb25lbnRfcGFyYW1ldGVyKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImRlZmF1bHRfb3B0aW9uYWxfY29tcG9uZW50LnltbCIpKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfbWlzc2luZ190eXBlKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD1yZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0PW9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICkNCg0KICAgICAgICB3aXRoIHB5dGVzdC5yYWlzZXMoVmFsaWRhdGlvbkV4Y2VwdGlvbikgYXMgZToNCiAgICAgICAgICAgIGNsaWVudC5jb21wb25lbnRzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmVfbWlzc2luZ190eXBlKQ0KDQogICAgICAgIGFzc2VydCAoDQogICAgICAgICAgICAiVW5rbm93biB0eXBlIG9mIHBhcmFtZXRlciBbJ3JlcXVpcmVkX2lucHV0JywgJ3JlcXVpcmVkX3BhcmFtJywgJ3JlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCcsICdvcHRpb25hbF9wYXJhbScsICdvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQnXSBpbiBwaXBlbGluZSBmdW5jICdwaXBlbGluZV9taXNzaW5nX3R5cGUnIg0KICAgICAgICAgICAgaW4gZS52YWx1ZS5tZXNzYWdlDQogICAgICAgICkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKG5vbl9waXBlbGluZV9pbnB1dHM9WyJwYXJhbSJdKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9ub25fcGlwZWxpbmVfaW5wdXRzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ6IElucHV0LA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW06IHN0ciwNCiAgICAgICAgICAgIHBhcmFtOiBzdHIsDQogICAgICAgICk6DQogICAgICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMoDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9cmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09cmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICApDQoNCiAgICAgICAgd2l0aCBweXRlc3QucmFpc2VzKFZhbGlkYXRpb25FeGNlcHRpb24pIGFzIGU6DQogICAgICAgICAgICBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lX3dpdGhfbm9uX3BpcGVsaW5lX2lucHV0cykNCiAgICAgICAgYXNzZXJ0ICgNCiAgICAgICAgICAgICJDYW5ub3QgcmVnaXN0ZXIgcGlwZWxpbmUgY29tcG9uZW50ICdwaXBlbGluZV93aXRoX25vbl9waXBlbGluZV9pbnB1dHMnIHdpdGggbm9uX3BpcGVsaW5lX2lucHV0cy4iDQogICAgICAgICAgICBpbiBlLnZhbHVlLm1lc3NhZ2UNCiAgICAgICAgKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF92YXJpYWJsZV9pbnB1dHMocmVxdWlyZWRfaW5wdXQ6IElucHV0LCByZXF1aXJlZF9wYXJhbTogc3RyLCAqYXJncywgKiprd2FyZ3MpOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHdpdGggcHl0ZXN0LnJhaXNlcyhWYWxpZGF0aW9uRXhjZXB0aW9uKSBhcyBlOg0KICAgICAgICAgICAgY2xpZW50LmNvbXBvbmVudHMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV93aXRoX3ZhcmlhYmxlX2lucHV0cykNCiAgICAgICAgYXNzZXJ0ICgNCiAgICAgICAgICAgICJDYW5ub3QgcmVnaXN0ZXIgdGhlIGNvbXBvbmVudCBwaXBlbGluZV93aXRoX3ZhcmlhYmxlX2lucHV0cyB3aXRoIHZhcmlhYmxlIGlucHV0cyBbJ2FyZ3MnLCAna3dhcmdzJ10iDQogICAgICAgICAgICBpbiBlLnZhbHVlLm1lc3NhZ2UNCiAgICAgICAgKQ0KDQogICAgZGVmIHRlc3RfY3JlYXRlX3BpcGVsaW5lX2NvbXBvbmVudF9ieV9kc2woc2VsZiwgY2FwbG9nLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXN0cihjb21wb25lbnRzX2RpciAvICJkZWZhdWx0X29wdGlvbmFsX2NvbXBvbmVudC55bWwiKSkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKGNvbnRpbnVlX29uX3N0ZXBfZmFpbHVyZT1UcnVlLCBmb3JjZV9yZXJ1bj1UcnVlLCBkZWZhdWx0X2RhdGFzdG9yZT0idGVzdCIpDQogICAgICAgIGRlZiB2YWxpZF9waXBlbGluZV9mdW5jKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ6IElucHV0LA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW06IHN0ciwNCiAgICAgICAgICAgIG5vZGVfY29tcHV0ZTogc3RyID0gImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKToNCiAgICAgICAgICAgIGRlZmF1bHRfb3B0aW9uYWxfZnVuYygNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1yZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbT1yZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIG5vZGUyID0gZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgbm9kZTIuY29tcHV0ZSA9IG5vZGVfY29tcHV0ZQ0KDQogICAgICAgIGNvbXBvbmVudCA9IHZhbGlkX3BpcGVsaW5lX2Z1bmMuX3BpcGVsaW5lX2J1aWxkZXIuYnVpbGQodXNlcl9wcm92aWRlZF9rd2FyZ3M9e30pDQogICAgICAgIGFzc2VydCBjb21wb25lbnQuX2F1dG9faW5jcmVtZW50X3ZlcnNpb24gaXMgVHJ1ZQ0KICAgICAgICAjIFNldCBvcmlnaW5hbCBtb2R1bGVfbG9nZ2VyIHdpdGggcGtnIG5hbWUgdG8gJ09wZXJhdGlvbicgdG8gZW5hYmxlIGNhcGxvZyBjYXB0dXJlIGxvZ3MNCiAgICAgICAgZnJvbSBhenVyZS5haS5tbC5vcGVyYXRpb25zIGltcG9ydCBfY29tcG9uZW50X29wZXJhdGlvbnMNCg0KICAgICAgICBfY29tcG9uZW50X29wZXJhdGlvbnMubW9kdWxlX2xvZ2dlciA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKCJPcGVyYXRpb24iKQ0KDQogICAgICAgICMgQXNzZXJ0IGJpbmRpbmcgb24gY29tcHV0ZSBub3QgY2hhbmdlZCBhZnRlciByZXNvbHZlIGRlcGVuZGVuY2llcw0KICAgICAgICBjbGllbnQuY29tcG9uZW50cy5fcmVzb2x2ZV9kZXBlbmRlbmNpZXNfZm9yX3BpcGVsaW5lX2NvbXBvbmVudF9qb2JzKA0KICAgICAgICAgICAgY29tcG9uZW50LCByZXNvbHZlcj1jbGllbnQuY29tcG9uZW50cy5fb3JjaGVzdHJhdG9ycy5nZXRfYXNzZXRfYXJtX2lkLCByZXNvbHZlX2lucHV0cz1GYWxzZQ0KICAgICAgICApDQogICAgICAgIGFzc2VydCBjb21wb25lbnQuam9ic1sibm9kZTIiXS5jb21wdXRlID09ICIke3twYXJlbnQuaW5wdXRzLm5vZGVfY29tcHV0ZX19Ig0KDQogICAgICAgIHdpdGggY2FwbG9nLmF0X2xldmVsKGxvZ2dpbmcuV0FSTklORyk6DQogICAgICAgICAgICBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKHZhbGlkX3BpcGVsaW5lX2Z1bmMpDQogICAgICAgIGFzc2VydCAoDQogICAgICAgICAgICAiSm9iIHNldHRpbmdzIHsnZGVmYXVsdF9kYXRhc3RvcmUnOiAndGVzdCcsICdjb250aW51ZV9vbl9zdGVwX2ZhaWx1cmUnOiBUcnVlLCAnZm9yY2VfcmVydW4nOiBUcnVlfSBvbiBwaXBlbGluZSBmdW5jdGlvbiAndmFsaWRfcGlwZWxpbmVfZnVuYycgYXJlIGlnbm9yZWQgd2hlbiBjcmVhdGluZyBQaXBlbGluZUNvbXBvbmVudC4iDQogICAgICAgICAgICBpbiBjYXBsb2cubWVzc2FnZXMNCiAgICAgICAgKQ0KDQogICAgZGVmIHRlc3RfY3JlYXRlX3BpcGVsaW5lX3dpdGhfcGFyYW1ldGVyX2dyb3VwKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGRlZmF1bHRfb3B0aW9uYWxfZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1zdHIoY29tcG9uZW50c19kaXIgLyAiZGVmYXVsdF9vcHRpb25hbF9jb21wb25lbnQueW1sIikpDQoNCiAgICAgICAgQGdyb3VwDQogICAgICAgIGNsYXNzIFN1Ykdyb3VwOg0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW06IHN0cg0KDQogICAgICAgIEBncm91cA0KICAgICAgICBjbGFzcyBHcm91cDoNCiAgICAgICAgICAgIHN1YjogU3ViR3JvdXANCiAgICAgICAgICAgIG5vZGVfY29tcHV0ZTogc3RyID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgc3ViX3BpcGVsaW5lX2Z1bmMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dDogSW5wdXQsDQogICAgICAgICAgICBncm91cDogR3JvdXAsDQogICAgICAgICAgICBzdWJfZ3JvdXA6IFN1Ykdyb3VwLA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPWdyb3VwLnN1Yi5yZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIG5vZGUyID0gZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXN1Yl9ncm91cC5yZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIG5vZGUyLmNvbXB1dGUgPSBncm91cC5ub2RlX2NvbXB1dGUNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgcm9vdF9waXBlbGluZV93aXRoX2dyb3VwKA0KICAgICAgICAgICAgcl9yZXF1aXJlZF9pbnB1dDogSW5wdXQsDQogICAgICAgICAgICByX2dyb3VwOiBHcm91cCwNCiAgICAgICAgKToNCiAgICAgICAgICAgIHN1Yl9waXBlbGluZV9mdW5jKHJlcXVpcmVkX2lucHV0PXJfcmVxdWlyZWRfaW5wdXQsIGdyb3VwPXJfZ3JvdXAsIHN1Yl9ncm91cD1yX2dyb3VwLnN1YikNCg0KICAgICAgICBqb2IgPSByb290X3BpcGVsaW5lX3dpdGhfZ3JvdXAoDQogICAgICAgICAgICByX3JlcXVpcmVkX2lucHV0PUlucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKSwNCiAgICAgICAgICAgIHJfZ3JvdXA9R3JvdXAoc3ViPVN1Ykdyb3VwKHJlcXVpcmVkX3BhcmFtPSJoZWxsbyIpKSwNCiAgICAgICAgKQ0KICAgICAgICByZXN0X2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKGpvYiwgY2xpZW50KQ0KICAgICAgICBhc3NlcnQgbGVuKHJlc3Rfam9iLmlucHV0cykgPT0gMg0KICAgICAgICByZXN0X2pvYl9kaWN0ID0gcmVzdF9qb2IuX3RvX2RpY3QoKQ0KICAgICAgICBhc3NlcnQgcmVzdF9qb2JfZGljdFsiaW5wdXRzIl0gPT0gew0KICAgICAgICAgICAgInJfcmVxdWlyZWRfaW5wdXQiOiB7DQogICAgICAgICAgICAgICAgIm1vZGUiOiAicm9fbW91bnQiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogInVyaV9maWxlIiwNCiAgICAgICAgICAgICAgICAicGF0aCI6ICJhenVyZW1sOmh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicl9ncm91cC5zdWIucmVxdWlyZWRfcGFyYW0iOiAiaGVsbG8iLA0KICAgICAgICAgICAgInJfZ3JvdXAubm9kZV9jb21wdXRlIjogImNwdS1jbHVzdGVyIiwNCiAgICAgICAgfQ0KICAgICAgICBhc3NlcnQgcmVzdF9qb2JfZGljdFsiam9icyJdWyJzdWJfcGlwZWxpbmVfZnVuYyJdWyJpbnB1dHMiXSA9PSB7DQogICAgICAgICAgICAicmVxdWlyZWRfaW5wdXQiOiB7InBhdGgiOiAiJHt7cGFyZW50LmlucHV0cy5yX3JlcXVpcmVkX2lucHV0fX0ifSwNCiAgICAgICAgICAgICJncm91cC5zdWIucmVxdWlyZWRfcGFyYW0iOiB7InBhdGgiOiAiJHt7cGFyZW50LmlucHV0cy5yX2dyb3VwLnN1Yi5yZXF1aXJlZF9wYXJhbX19In0sDQogICAgICAgICAgICAiZ3JvdXAubm9kZV9jb21wdXRlIjogeyJwYXRoIjogIiR7e3BhcmVudC5pbnB1dHMucl9ncm91cC5ub2RlX2NvbXB1dGV9fSJ9LA0KICAgICAgICAgICAgInN1Yl9ncm91cC5yZXF1aXJlZF9wYXJhbSI6IHsicGF0aCI6ICIke3twYXJlbnQuaW5wdXRzLnJfZ3JvdXAuc3ViLnJlcXVpcmVkX3BhcmFtfX0ifSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfd2l0aF9ub25lX3BhcmFtZXRlcl9oYXNfZGVmYXVsdF9vcHRpb25hbF90cnVlKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGRlZmF1bHRfb3B0aW9uYWxfZnVuYyA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1zdHIoY29tcG9uZW50c19kaXIgLyAiZGVmYXVsdF9vcHRpb25hbF9jb21wb25lbnQueW1sIikpDQoNCiAgICAgICAgIyBOb25lIGlucHV0IGlzIGJpbmRpbmcgdG8gYSBvcHRpb25hbCBpbnB1dA0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW0sDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICk6DQogICAgICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMoDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9cmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09cmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PXJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbT1vcHRpb25hbF9wYXJhbSwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQ9b3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1JbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiksDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iaGVsbG8iLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PSJyZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQiLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09Im9wdGlvbmFsX3BhcmFtIiwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdD1Ob25lLA0KICAgICAgICApDQogICAgICAgICMgdG9kbzogdW5jb21tZW50IHRoaXMgd2hlbiBiYWNrZW5kIHJlbW92ZSBjb21wb25lbnQgam9iIG9wdGlvbmFsIGlucHV0IHdoaWNoIGlzIGJpbmRpbmcgdG8gYSBOb25lIHBpcGVsaW5lDQogICAgICAgICMgIGlucHV0DQogICAgICAgICMgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPSJkZWZhdWx0X29wdGlvbmFsX3BpcGVsaW5lIikNCiAgICAgICAgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQiIG5vdCBpbiBwaXBlbGluZS5pbnB1dHMNCg0KICAgICAgICAjIGFzc2VydCAib3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0IiBub3QgaW4gcGlwZWxpbmVfam9iLmlucHV0cw0KICAgICAgICAjIGFzc2VydCAib3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0IiBub3QgaW4gbmV4dChwaXBlbGluZV9qb2Iuam9icy52YWx1ZXMoKS5fX2l0ZXJfXygpKS5pbnB1dHMNCg0KICAgICAgICAjIE5vbmUgaW5wdXQgaXMgbm90IGJpbmRpbmcgdG8gYSBvcHRpb25hbCBpbnB1dA0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfZGVmYXVsdF9vcHRpb25hbF9wYXJhbWV0ZXJzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD1yZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09b3B0aW9uYWxfcGFyYW0sDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0PU5vbmUsDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PUlucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPSJoZWxsbyIsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQ9InJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCIsDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbT0ib3B0aW9uYWxfcGFyYW0iLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0PU5vbmUsDQogICAgICAgICkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPSJkZWZhdWx0X29wdGlvbmFsX3BpcGVsaW5lIikNCiAgICAgICAgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQiIG5vdCBpbiBwaXBlbGluZS5pbnB1dHMNCiAgICAgICAgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQiIG5vdCBpbiBwaXBlbGluZV9qb2IuaW5wdXRzDQoNCiAgICAgICAgIyBOb3QgcGFzcyByZXF1aXJlZCBwYXJhbWV0ZXIgd2l0aCBkZWZhdWx0IHZhbHVlDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW0sDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICk6DQogICAgICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMoDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9cmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09cmVxdWlyZWRfcGFyYW0sDQogICAgICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PXJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbT1vcHRpb25hbF9wYXJhbSwNCiAgICAgICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhfZGVmYXVsdF9vcHRpb25hbF9wYXJhbWV0ZXJzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQ9SW5wdXQodHlwZT0idXJpX2ZpbGUiLCBwYXRoPSJodHRwczovL2RwcmVwZGF0YS5ibG9iLmNvcmUud2luZG93cy5uZXQvZGVtby9UaXRhbmljLmNzdiIpLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW09ImhlbGxvIiwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD0icmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0IiwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtPSJvcHRpb25hbF9wYXJhbSIsDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQ9Tm9uZSwNCiAgICAgICAgKQ0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ImRlZmF1bHRfb3B0aW9uYWxfcGlwZWxpbmUiKQ0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lLmlucHV0cw0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lX2pvYi5pbnB1dHMNCg0KICAgICAgICAjIFBhc3Mgbm90LW5vbmUgdmFsdWUgdG8gY29tcG9uZW50IGZ1bmMgZGlyZWN0bHkgYnV0IHNldCBub25lIGluIHBpcGVsaW5lIHBhcmFtZXRlcg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfZGVmYXVsdF9vcHRpb25hbF9wYXJhbWV0ZXJzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PUlucHV0KHR5cGU9InVyaV9maWxlIiwgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiKSwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbT1yZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQ9InJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCIsDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09Im9wdGlvbmFsX3BhcmFtIiwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQ9Im9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIsDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX2RlZmF1bHRfb3B0aW9uYWxfcGFyYW1ldGVycygNCiAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PU5vbmUsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iaGVsbG8iLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PU5vbmUsDQogICAgICAgICAgICBvcHRpb25hbF9wYXJhbT1Ob25lLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0PU5vbmUsDQogICAgICAgICkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPSJkZWZhdWx0X29wdGlvbmFsX3BpcGVsaW5lIikNCiAgICAgICAgYXNzZXJ0ICJyZXF1aXJlZF9pbnB1dCIgbm90IGluIHBpcGVsaW5lLmlucHV0cw0KICAgICAgICBhc3NlcnQgInJlcXVpcmVkX2lucHV0IiBub3QgaW4gcGlwZWxpbmVfam9iLmlucHV0cw0KICAgICAgICBhc3NlcnQgInJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lLmlucHV0cw0KICAgICAgICBhc3NlcnQgInJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lX2pvYi5pbnB1dHMNCiAgICAgICAgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbSIgbm90IGluIHBpcGVsaW5lLmlucHV0cw0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtIiBub3QgaW4gcGlwZWxpbmVfam9iLmlucHV0cw0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lLmlucHV0cw0KICAgICAgICBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lX2pvYi5pbnB1dHMNCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3dpdGhfbm9uZV9wYXJhbWV0ZXJfYmluZGluZ190b190d29fY29tcG9uZW50X2lucHV0cyhzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBkZWZhdWx0X29wdGlvbmFsX2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImRlZmF1bHRfb3B0aW9uYWxfY29tcG9uZW50LnltbCIpKQ0KDQogICAgICAgICMgTm9uZSBwaXBlbGluZSBwYXJhbWV0ZXIgaXMgYmluZGluZyB0byB0d28gb3B0aW9uYWwgY29tcG9uZW50IGlucHV0LCByZW1vdmVkIE5vbmUgaW5wdXQNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgZGVmYXVsdF9jb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfZGVmYXVsdF9vcHRpb25hbF9wYXJhbWV0ZXJzKA0KICAgICAgICAgICAgcmVxdWlyZWRfaW5wdXQsDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICApOg0KICAgICAgICAgICAgZGVmYXVsdF9vcHRpb25hbF9mdW5jKA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX2lucHV0PXJlcXVpcmVkX2lucHV0LA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtPXJlcXVpcmVkX3BhcmFtLA0KICAgICAgICAgICAgICAgIHJlcXVpcmVkX3BhcmFtX3dpdGhfZGVmYXVsdD1yZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQsDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09b3B0aW9uYWxfcGFyYW0sDQogICAgICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0PW9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGRlZmF1bHRfb3B0aW9uYWxfZnVuYygNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1yZXF1aXJlZF9pbnB1dCwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbT1yZXF1aXJlZF9wYXJhbSwNCiAgICAgICAgICAgICAgICByZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQ9cmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtPW9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCwNCiAgICAgICAgICAgICAgICBvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQ9b3B0aW9uYWxfcGFyYW1fd2l0aF9kZWZhdWx0LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9kZWZhdWx0X29wdGlvbmFsX3BhcmFtZXRlcnMoDQogICAgICAgICAgICByZXF1aXJlZF9pbnB1dD1JbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiksDQogICAgICAgICAgICByZXF1aXJlZF9wYXJhbT0iaGVsbG8iLA0KICAgICAgICAgICAgcmVxdWlyZWRfcGFyYW1fd2l0aF9kZWZhdWx0PSJyZXF1aXJlZF9wYXJhbV93aXRoX2RlZmF1bHQiLA0KICAgICAgICAgICAgb3B0aW9uYWxfcGFyYW09Im9wdGlvbmFsX3BhcmFtIiwNCiAgICAgICAgICAgIG9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdD1Ob25lLA0KICAgICAgICApDQogICAgICAgICMgdG9kbzogdW5jb21tZW50IHRoaXMgd2hlbiBiYWNrZW5kIHJlbW92ZSBjb21wb25lbnQgam9iIG9wdGlvbmFsIGlucHV0IHdoaWNoIGlzIGJpbmRpbmcgdG8gYSBOb25lIHBpcGVsaW5lDQogICAgICAgICMgIGlucHV0DQogICAgICAgICMgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPSJkZWZhdWx0X29wdGlvbmFsX3BpcGVsaW5lIikNCiAgICAgICAgYXNzZXJ0ICJvcHRpb25hbF9wYXJhbV93aXRoX2RlZmF1bHQiIG5vdCBpbiBwaXBlbGluZS5pbnB1dHMNCiAgICAgICAgIyBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIHBpcGVsaW5lX2pvYi5pbnB1dHMNCiAgICAgICAgIyBhc3NlcnQgIm9wdGlvbmFsX3BhcmFtX3dpdGhfZGVmYXVsdCIgbm90IGluIG5leHQocGlwZWxpbmVfam9iLmpvYnMudmFsdWVzKCkuX19pdGVyX18oKSkuaW5wdXRzDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZGlzYWJsZV9tb2NrX2NvZGVfaGFzaA0KICAgIEBweXRlc3QubWFyay5za2lwaWYoY29uZGl0aW9uPW5vdCBpc19saXZlKCksIHJlYXNvbj0icmV1c2UgdGVzdCwgdGFyZ2V0IHRvIHZlcmlmeSBzZXJ2aWNlLXNpZGUgYmVoYXZpb3IiKQ0KICAgIGRlZiB0ZXN0X2NvbXBvbmVudF9yZXVzZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBwYXRoID0gIi4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIg0KICAgICAgICBjb21wb25lbnRfZnVuYzEgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9cGF0aCkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHBpcGVsaW5lKGNvbXBvbmVudF9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoKToNCiAgICAgICAgICAgIG5vZGUxID0gY29tcG9uZW50X2Z1bmMxKGNvbXBvbmVudF9pbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgpDQogICAgICAgICAgICBub2RlMiA9IGNvbXBvbmVudF9mdW5jMShjb21wb25lbnRfaW5fbnVtYmVyPWNvbXBvbmVudF9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbl9wYXRoKQ0KDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9cGF0aCkNCiAgICAgICAgICAgIG5vZGUzID0gY29tcG9uZW50X2Z1bmMyKGNvbXBvbmVudF9pbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgpDQoNCiAgICAgICAgICAgIG5vZGUxLmNvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQogICAgICAgICAgICBub2RlMi5jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICAgICAgbm9kZTMuY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCg0KICAgICAgICBwaXBlbGluZTEgPSBwaXBlbGluZSgxMCwgam9iX2lucHV0KQ0KDQogICAgICAgIHBpcGVsaW5lMSA9IGNsaWVudC5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lMSkNCg0KICAgICAgICBjb21wb25lbnRfaWRzID0gc2V0KCkNCiAgICAgICAgZm9yIF8sIGpvYiBpbiBwaXBlbGluZTEuam9icy5pdGVtcygpOg0KICAgICAgICAgICAgY29tcG9uZW50X2lkID0gam9iLmNvbXBvbmVudA0KICAgICAgICAgICAgY29tcG9uZW50X2lkcy5hZGQoY29tcG9uZW50X2lkKQ0KDQogICAgICAgIGFzc2VydCBsZW4oY29tcG9uZW50X2lkcykgPT0gMSwgZiJHb3QgbXVsdGlwbGUgY29tcG9uZW50IGlkOiB7Y29tcG9uZW50X2lkc30gZm9yIHNhbWUgYW5vbiBjb21wb25lbnQuIg0KDQogICAgQHB5dGVzdC5tYXJrLmRpc2FibGVfbW9ja19jb2RlX2hhc2gNCiAgICBAcHl0ZXN0Lm1hcmsuc2tpcGlmKGNvbmRpdGlvbj1ub3QgaXNfbGl2ZSgpLCByZWFzb249InJldXNlIHRlc3QsIHRhcmdldCB0byB2ZXJpZnkgc2VydmljZS1zaWRlIGJlaGF2aW9yIikNCiAgICBkZWYgdGVzdF9waXBlbGluZV9yZXVzZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50LCByYW5kc3RyOiBDYWxsYWJsZVtbc3RyXSwgc3RyXSwgcmFuZGludDogQ2FsbGFibGUpIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudF95YW1sID0gY29tcG9uZW50c19kaXIgLyAiaGVsbG93b3JsZF9jb21wb25lbnQueW1sIg0KICAgICAgICBjb21wb25lbnRfZnVuYzEgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Y29tcG9uZW50X3lhbWwsIHBhcmFtc19vdmVycmlkZT1beyJuYW1lIjogcmFuZHN0cigiY29tcG9uZW50X25hbWUiKX1dKQ0KICAgICAgICBjb21wb25lbnRfZnVuYzIgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Y29tcG9uZW50X3lhbWwsIHBhcmFtc19vdmVycmlkZT1beyJuYW1lIjogcmFuZHN0cigiY29tcG9uZW50X25hbWUiKX1dKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPXJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgaGVsbG8gd29ybGQgcGlwZWxpbmUgam9iIiwNCiAgICAgICAgICAgIHRhZ3M9eyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSwNCiAgICAgICAgICAgIGNvbnRpbnVlX3J1bl9vbl9zdGVwX2ZhaWx1cmU9VHJ1ZSwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmUoam9iX2luX251bWJlciwgam9iX2luX290aGVyX251bWJlciwgam9iX2luX3BhdGgpOg0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMxKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fb3RoZXJfbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCg0KICAgICAgICBpbnB1dF9udW1iZXIgPSByYW5kaW50KCkNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZShpbnB1dF9udW1iZXIsIGlucHV0X251bWJlciwgam9iX2lucHV0KQ0KICAgICAgICBqb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lKQ0KICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgc2xlZXBfaWZfbGl2ZSgzMCkNCiAgICAgICAgICAgIGNoaWxkcmVuID0gY2xpZW50LmpvYnMubGlzdChwYXJlbnRfam9iX25hbWU9am9iLm5hbWUpDQogICAgICAgICAgICBjaGlsZHJlbiA9IGxpc3QoY2hpbGRyZW4pDQogICAgICAgICAgICBpZiBsZW4oY2hpbGRyZW4pID09IDI6DQogICAgICAgICAgICAgICAgYnJlYWsNCg0KICAgICAgICBhc3NlcnQgbGVuKGNoaWxkcmVuKSA9PSAyDQogICAgICAgIGNoaWxkMCwgY2hpbGQxID0gY2hpbGRyZW4NCiAgICAgICAgIyBjaGlsZHJlbiBzZXF1ZW5jZSBpcyBub3QgZ3VhcmFudGVlZCwgc28gd2UgbmVlZCB0byBjaGVjayBib3RoDQogICAgICAgIGlmIFBpcGVsaW5lQ29uc3RhbnRzLlJFVVNFRF9GTEFHX0ZJRUxEIGluIGNoaWxkMC5wcm9wZXJ0aWVzLmtleXMoKToNCiAgICAgICAgICAgIGFzc2VydCBjaGlsZDAucHJvcGVydGllc1tQaXBlbGluZUNvbnN0YW50cy5SRVVTRURfRkxBR19GSUVMRF0gPT0gUGlwZWxpbmVDb25zdGFudHMuUkVVU0VEX0ZMQUdfVFJVRQ0KICAgICAgICBlbGlmIFBpcGVsaW5lQ29uc3RhbnRzLlJFVVNFRF9GTEFHX0ZJRUxEIGluIGNoaWxkMS5wcm9wZXJ0aWVzLmtleXMoKToNCiAgICAgICAgICAgIGFzc2VydCBjaGlsZDEucHJvcGVydGllc1tQaXBlbGluZUNvbnN0YW50cy5SRVVTRURfRkxBR19GSUVMRF0gPT0gUGlwZWxpbmVDb25zdGFudHMuUkVVU0VEX0ZMQUdfVFJVRQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgYXNzZXJ0IEZhbHNlLCAiTmVpdGhlciBjaGlsZCByZXVzZXMuIg0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfd2l0aF9jb21wb25lbnRfaW5wdXRfbmFtZV9jYXNlKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImhlbGxvd29ybGRfY29tcG9uZW50X3dpdGhfdXBwZXJjYXNlX2lucHV0LnltbCIpDQogICAgICAgICkNCg0KICAgICAgICAjIGlucHV0IG5hbWUgaXMgdGhlIHNhbWUgd2l0aCB5YW1sIGRlZmluaXRpb24NCiAgICAgICAgQGRzbC5waXBlbGluZShkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgZGVmIGhlbGxvX3dvcmxkX3BpcGVsaW5lKGNvbXBvbmVudF9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoKToNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9Jbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgpDQoNCiAgICAgICAgcGlwZWxpbmUgPSBoZWxsb193b3JsZF9waXBlbGluZShjb21wb25lbnRfaW5fbnVtYmVyPTEwLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5wdXQpDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUsIGV4cGVyaW1lbnRfbmFtZT1leHBlcmltZW50X25hbWUpDQogICAgICAgIGFzc2VydCAiY29tcG9uZW50X0luX251bWJlciIgaW4gbmV4dChwaXBlbGluZV9qb2Iuam9icy52YWx1ZXMoKS5fX2l0ZXJfXygpKS5pbnB1dHMNCg0KICAgICAgICAjIGlucHV0IG5hbWUgaXMgbG93ZXIgY2FzZQ0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgaGVsbG9fd29ybGRfcGlwZWxpbmUoY29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGgpOg0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCkNCg0KICAgICAgICBwaXBlbGluZSA9IGhlbGxvX3dvcmxkX3BpcGVsaW5lKGNvbXBvbmVudF9pbl9udW1iZXI9MTAsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSkNCiAgICAgICAgYXNzZXJ0ICJjb21wb25lbnRfSW5fbnVtYmVyIiBpbiBuZXh0KHBpcGVsaW5lX2pvYi5qb2JzLnZhbHVlcygpLl9faXRlcl9fKCkpLmlucHV0cw0KDQogICAgICAgICMgaW5wdXQgbmFtZSBpcyBlcXVhbCB0byB5YW1sIGRlZmluaXRpb24gaW5wdXQgaWYgYm90aCBjaGFuZ2UgdG8gbG93ZXIgY2FzZQ0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgaGVsbG9fd29ybGRfcGlwZWxpbmUoY29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGgpOg0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X0luX051bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCkNCg0KICAgICAgICBwaXBlbGluZSA9IGhlbGxvX3dvcmxkX3BpcGVsaW5lKGNvbXBvbmVudF9pbl9udW1iZXI9MTAsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSkNCiAgICAgICAgYXNzZXJ0ICJjb21wb25lbnRfSW5fbnVtYmVyIiBpbiBuZXh0KHBpcGVsaW5lX2pvYi5qb2JzLnZhbHVlcygpLl9faXRlcl9fKCkpLmlucHV0cw0KDQogICAgICAgICMgdHdvIGlkZW50aWNhbCBpbnB1dCBhcmUgZ2l2ZW4gaWYgaWdub3JlIGNhc2UNCiAgICAgICAgQGRzbC5waXBlbGluZShkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgZGVmIGhlbGxvX3dvcmxkX3BpcGVsaW5lKGNvbXBvbmVudF9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoKToNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9Jbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fcGF0aCkNCg0KICAgICAgICB3aXRoIHB5dGVzdC5yYWlzZXMoVmFsaWRhdGlvbkV4Y2VwdGlvbikgYXMgZXg6DQogICAgICAgICAgICBoZWxsb193b3JsZF9waXBlbGluZShjb21wb25lbnRfaW5fbnVtYmVyPTEwLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5wdXQpDQogICAgICAgIGFzc2VydCAoDQogICAgICAgICAgICAiSW52YWxpZCBjb21wb25lbnQgaW5wdXQgbmFtZXMgJ2NvbXBvbmVudF9pbl9udW1iZXInIGFuZCAnY29tcG9uZW50X0luX251bWJlcicsIHdoaWNoIGFyZSBlcXVhbCINCiAgICAgICAgICAgIGluIGV4LnZhbHVlLm1lc3NhZ2UNCiAgICAgICAgKQ0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfam9iX2hlbHBfZnVuY3Rpb24oc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIHlhbWxfZmlsZSA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCINCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgcGlwZWxpbmUobnVtYmVyLCBwYXRoKToNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPXlhbWxfZmlsZSkNCiAgICAgICAgICAgIG5vZGUxID0gY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X2luX251bWJlcj1udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPXBhdGgpDQogICAgICAgICAgICByZXR1cm4geyJwaXBlbGluZV9vdXRwdXQiOiBub2RlMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH0NCg0KICAgICAgICBwaXBlbGluZTEgPSBwaXBlbGluZSgxMCwgam9iX2lucHV0KQ0KICAgICAgICBwaXBlbGluZTEgPSBjbGllbnQuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZTEpDQogICAgICAgIHdpdGggcGF0Y2goInN5cy5zdGRvdXQiLCBuZXc9U3RyaW5nSU8oKSkgYXMgc3RkX291dDoNCiAgICAgICAgICAgIHByaW50KHBpcGVsaW5lMSkNCiAgICAgICAgICAgIGFzc2VydCAoDQogICAgICAgICAgICAgICAgImRpc3BsYXlfbmFtZTogcGlwZWxpbmVcbnR5cGU6IHBpcGVsaW5lXG5pbnB1dHM6XG4gIG51bWJlcjogJzEwJ1xuICBwYXRoOlxuICAgIG1vZGU6IHJvX21vdW50XG4gICAgdHlwZTogdXJpX2ZpbGVcbiAgICBwYXRoOiINCiAgICAgICAgICAgICAgICBpbiBzdGRfb3V0LmdldHZhbHVlKCkNCiAgICAgICAgICAgICkNCg0KICAgIGRlZiB0ZXN0X25vZGVfcHJvcGVydHlfc2V0dGluZ192YWxpZGF0aW9uKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIHBhdGggPSAiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGNvbXBvbmVudF9mdW5jMSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1wYXRoKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgcGlwZWxpbmUoY29tcG9uZW50X2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGgpOg0KICAgICAgICAgICAgbm9kZTEgPSBjb21wb25lbnRfZnVuYzEoY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCkNCiAgICAgICAgICAgIG5vZGUxLmplZmZfc3BlY2lhbF9vcHRpb24uZm9vID0gImJhciINCiAgICAgICAgICAgIG5vZGUxLmNvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgZHNsX3BpcGVsaW5lOiBQaXBlbGluZUpvYiA9IHBpcGVsaW5lKDEwLCBqb2JfaW5wdXQpDQogICAgICAgIHdpdGggcGF0Y2goImF6dXJlLmFpLm1sLmVudGl0aWVzLl92YWxpZGF0aW9uLm1vZHVsZV9sb2dnZXIuaW5mbyIpIGFzIG1vY2tfbG9nZ2luZzoNCiAgICAgICAgICAgIF8gPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKGRzbF9waXBlbGluZSkNCiAgICAgICAgICAgIG1vY2tfbG9nZ2luZy5hc3NlcnRfY2FsbGVkX3dpdGgoIldhcm5pbmdzOiBbam9icy5ub2RlMS5qZWZmX3NwZWNpYWxfb3B0aW9uOiBVbmtub3duIGZpZWxkLl0iKQ0KDQogICAgZGVmIHRlc3RfYW5vbl9jb21wb25lbnRfaW5fcGlwZWxpbmUoDQogICAgICAgIHNlbGYsIGNsaWVudDogTUxDbGllbnQsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdLCBoZWxsb193b3JsZF9jb21wb25lbnQ6IENvbXBvbmVudA0KICAgICkgLT4gTm9uZToNCiAgICAgICAgaGVsbG9fd29ybGRfZnVuYyA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgY2xpZW50PWNsaWVudCwgbmFtZT1oZWxsb193b3JsZF9jb21wb25lbnQubmFtZSwgdmVyc2lvbj1oZWxsb193b3JsZF9jb21wb25lbnQudmVyc2lvbg0KICAgICAgICApDQogICAgICAgIG9yaWdpbl9pZCA9IGhlbGxvX3dvcmxkX2Z1bmMuaWQNCiAgICAgICAgbXBpX2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImhlbGxvd29ybGRfY29tcG9uZW50X21waS55bWwiKSkNCiAgICAgICAgYXNzZXJ0IG1waV9mdW5jLl92YWxpZGF0ZSgpLnBhc3NlZA0KDQogICAgICAgIGludmFsaWRfY29tcG9uZW50X25hbWUgPSAiX2ludmFsaWQiDQoNCiAgICAgICAgIyBuYW1lIG9mIGFub255bW91cyBjb21wb25lbnQgaW4gcGlwZWxpbmUgam9iIHNob3VsZCBiZSBvdmVyd3JpdHRlbg0KICAgICAgICBtcGlfZnVuYy5uYW1lID0gaW52YWxpZF9jb21wb25lbnRfbmFtZQ0KICAgICAgICBhc3NlcnQgbm90IG1waV9mdW5jLl92YWxpZGF0ZSgpLnBhc3NlZA0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPXJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgaGVsbG8gd29ybGQgcGlwZWxpbmUgam9iIiwNCiAgICAgICAgICAgIHRhZ3M9eyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgY29tcHV0ZT0iZ3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSwNCiAgICAgICAgICAgIGNvbnRpbnVlX29uX3N0ZXBfZmFpbHVyZT1GYWxzZSwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfZGlzdHJpYnV0aW9uX2NvbXBvbmVudHMoam9iX2luX251bWJlciwgam9iX2luX3BhdGgpOg0KICAgICAgICAgICAgaGVsbG93b3JsZF9jb21wb25lbnQgPSBoZWxsb193b3JsZF9mdW5jKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQogICAgICAgICAgICBoZWxsb3dvcmxkX2NvbXBvbmVudC5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCA9IE91dHB1dChkYXRhc2V0PURhdGEobmFtZT0ibWxkZXNpZ25lcl9jb21wb25lbnRfb3V0cHV0IikpDQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfbXBpID0gbXBpX2Z1bmMoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9tcGkuZGlzdHJpYnV0aW9uID0gTXBpRGlzdHJpYnV0aW9uKCkNCiAgICAgICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9tcGkuZGlzdHJpYnV0aW9uLnByb2Nlc3NfY291bnRfcGVyX2luc3RhbmNlID0gMg0KDQogICAgICAgIHBpcGVsaW5lOiBQaXBlbGluZUpvYiA9IHBpcGVsaW5lX2Rpc3RyaWJ1dGlvbl9jb21wb25lbnRzKDEwLCBqb2JfaW5wdXQpDQogICAgICAgIGFzc2VydCBtcGlfZnVuYy5faXNfYW5vbnltb3VzIGlzIEZhbHNlDQogICAgICAgIGFzc2VydCBwaXBlbGluZS5zZXR0aW5ncy5jb250aW51ZV9vbl9zdGVwX2ZhaWx1cmUgaXMgRmFsc2UNCiAgICAgICAgY3JlYXRlZF9qb2I6IFBpcGVsaW5lSm9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZSgNCiAgICAgICAgICAgIHBpcGVsaW5lLCBleHBlcmltZW50X25hbWU9ZXhwZXJpbWVudF9uYW1lLCBjb250aW51ZV9vbl9zdGVwX2ZhaWx1cmU9VHJ1ZQ0KICAgICAgICApDQogICAgICAgICMgVGhlb3JldGljYWxseSwgd2Ugc2hvdWxkIGtlZXAgdGhlIGludmFsaWQgbmFtZSBpbiByZXF1ZXN0IGJvZHksDQogICAgICAgICMgYXMgY29tcG9uZW50IG5hbWUgdmFsaWQgaW4gYXp1cmVtbC1jb21wb25lbnRzIG1heWJlIGludmFsaWQgaW4gYXp1cmUtYWktbWwuDQogICAgICAgICMgU28gd2UgbGVhdmUgdGhpcyB2YWxpZGF0aW9uIHRvIHNlcnZlci1zaWRlIGZvciBub3cuDQogICAgICAgIGFzc2VydCBtcGlfZnVuYy5fdG9fcmVzdF9vYmplY3QoKS5wcm9wZXJ0aWVzLmNvbXBvbmVudF9zcGVjWyJuYW1lIl0gPT0gaW52YWxpZF9jb21wb25lbnRfbmFtZQ0KDQogICAgICAgICMgY29udGludWVfb25fc3RlcF9mYWlsdXJlIGNhbid0IGJlIHNldCBpbiBjcmVhdGVfb3JfdXBkYXRlDQogICAgICAgIGFzc2VydCBjcmVhdGVkX2pvYi5zZXR0aW5ncy5jb250aW51ZV9vbl9zdGVwX2ZhaWx1cmUgaXMgRmFsc2UNCiAgICAgICAgYXNzZXJ0IGNyZWF0ZWRfam9iLmpvYnNbImhlbGxvX3dvcmxkX2NvbXBvbmVudF9tcGkiXS5jb21wb25lbnQuc3RhcnRzd2l0aChBTk9OWU1PVVNfQ09NUE9ORU5UX05BTUUpDQogICAgICAgIGFzc2VydCBjcmVhdGVkX2pvYi5qb2JzWyJoZWxsb3dvcmxkX2NvbXBvbmVudCJdLmNvbXBvbmVudCA9PSAibWljcm9zb2Z0c2FtcGxlc19jb21tYW5kX2NvbXBvbmVudF9iYXNpYzowLjAuMSINCiAgICAgICAgYXNzZXJ0IGhlbGxvX3dvcmxkX2Z1bmMuX2lzX2Fub255bW91cyBpcyBGYWxzZQ0KICAgICAgICBhc3NlcnQgb3JpZ2luX2lkID09IGhlbGxvX3dvcmxkX2Z1bmMuaWQNCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX2ZvcmNlX3JlcnVuKHNlbGYsIGNsaWVudDogTUxDbGllbnQsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdKSAtPiBOb25lOg0KICAgICAgICBjb21wb25lbnRfeWFtbCA9IGNvbXBvbmVudHNfZGlyIC8gImhlbGxvd29ybGRfY29tcG9uZW50LnltbCINCiAgICAgICAgY29tcG9uZW50X2Z1bmMxID0gbG9hZF9jb21wb25lbnQoc291cmNlPWNvbXBvbmVudF95YW1sLCBwYXJhbXNfb3ZlcnJpZGU9W3sibmFtZSI6IHJhbmRzdHIoImNvbXBvbmVudF9uYW1lIil9XSkNCiAgICAgICAgY29tcG9uZW50X2Z1bmMyID0gbG9hZF9jb21wb25lbnQoc291cmNlPWNvbXBvbmVudF95YW1sLCBwYXJhbXNfb3ZlcnJpZGU9W3sibmFtZSI6IHJhbmRzdHIoImNvbXBvbmVudF9uYW1lIil9XSkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgbmFtZT1yYW5kc3RyKCJwaXBlbGluZV9uYW1lIiksDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhlIGhlbGxvIHdvcmxkIHBpcGVsaW5lIGpvYiIsDQogICAgICAgICAgICB0YWdzPXsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgICAgIGV4cGVyaW1lbnRfbmFtZT1leHBlcmltZW50X25hbWUsDQogICAgICAgICAgICBjb250aW51ZV9vbl9zdGVwX2ZhaWx1cmU9VHJ1ZSwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgcGlwZWxpbmUoam9iX2luX251bWJlciwgam9iX2luX290aGVyX251bWJlciwgam9iX2luX3BhdGgpOg0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMxKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzIoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fb3RoZXJfbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lKDEwLCAxNSwgam9iX2lucHV0KQ0KICAgICAgICBqb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lKQ0KICAgICAgICBhc3NlcnQgam9iLnNldHRpbmdzLmZvcmNlX3JlcnVuIGlzIE5vbmUNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKA0KICAgICAgICAgICAgbmFtZT1yYW5kc3RyKCJwaXBlbGluZV9uYW1lIiksDQogICAgICAgICAgICBkZXNjcmlwdGlvbj0iVGhlIGhlbGxvIHdvcmxkIHBpcGVsaW5lIGpvYiIsDQogICAgICAgICAgICB0YWdzPXsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgICAgIGV4cGVyaW1lbnRfbmFtZT1leHBlcmltZW50X25hbWUsDQogICAgICAgICAgICBjb250aW51ZV9vbl9zdGVwX2ZhaWx1cmU9VHJ1ZSwNCiAgICAgICAgICAgIGZvcmNlX3JlcnVuPVRydWUsDQogICAgICAgICkNCiAgICAgICAgZGVmIHBpcGVsaW5lKGpvYl9pbl9udW1iZXIsIGpvYl9pbl9vdGhlcl9udW1iZXIsIGpvYl9pbl9wYXRoKToNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMShjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KICAgICAgICAgICAgY29tcG9uZW50X2Z1bmMyKGNvbXBvbmVudF9pbl9udW1iZXI9am9iX2luX290aGVyX251bWJlciwgY29tcG9uZW50X2luX3BhdGg9am9iX2luX3BhdGgpDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZSgxMCwgMTUsIGpvYl9pbnB1dCkNCiAgICAgICAgam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSwgZm9yY2VfcmVydW49VHJ1ZSkNCiAgICAgICAgYXNzZXJ0IGpvYi5zZXR0aW5ncy5mb3JjZV9yZXJ1biBpcyBUcnVlDQoNCiAgICBAcHl0ZXN0Lm1hcmsuc2tpcCgiVE9ETyAoMjM3MDEyOSk6IFJlY29yZGluZyBmYWlscyBkdWUgdG8gJ0Nhbm5vdCBmaW5kIHBpcGVsaW5lIHJ1bicgZXJyb3IiKQ0KICAgIGRlZiB0ZXN0X3BhcmFsbGVsX2NvbXBvbmVudHNfd2l0aF90YWJ1bGFyX2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudHNfZGlyID0gdGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2RzbF9waXBlbGluZS9wYXJhbGxlbF9jb21wb25lbnRfd2l0aF90YWJ1bGFyX2lucHV0Ig0KDQogICAgICAgIGJhdGNoX2luZmVyZW5jZSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1zdHIoY29tcG9uZW50c19kaXIgLyAidGFidWxhcl9pbnB1dF9lMmUueW1sIikpDQoNCiAgICAgICAgIyBDb25zdHJ1Y3QgcGlwZWxpbmUNCiAgICAgICAgQGRzbC5waXBlbGluZShkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgZGVmIHBhcmFsbGVsX2luX3BpcGVsaW5lKGpvYl9kYXRhX3BhdGgsIHNjb3JlX21vZGVsKToNCiAgICAgICAgICAgIGJhdGNoX2luZmVyZW5jZV9ub2RlID0gYmF0Y2hfaW5mZXJlbmNlKGpvYl9kYXRhX3BhdGg9am9iX2RhdGFfcGF0aCwgc2NvcmVfbW9kZWw9c2NvcmVfbW9kZWwpDQogICAgICAgICAgICBiYXRjaF9pbmZlcmVuY2Vfbm9kZS5taW5pX2JhdGNoX3NpemUgPSA1DQoNCiAgICAgICAgcGlwZWxpbmUgPSBwYXJhbGxlbF9pbl9waXBlbGluZSgNCiAgICAgICAgICAgIGpvYl9kYXRhX3BhdGg9SW5wdXQoDQogICAgICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZGF0YXNldC9uZXVyYWwtaXJpcy1tbHRhYmxlIiwNCiAgICAgICAgICAgICAgICBtb2RlPUlucHV0T3V0cHV0TW9kZXMuRElSRUNULA0KICAgICAgICAgICAgKSwNCiAgICAgICAgICAgIHNjb3JlX21vZGVsPUlucHV0KA0KICAgICAgICAgICAgICAgIHBhdGg9Ii4vdGVzdHMvdGVzdF9jb25maWdzL21vZGVsIiwgdHlwZT1Bc3NldFR5cGVzLlVSSV9GT0xERVIsIG1vZGU9SW5wdXRPdXRwdXRNb2Rlcy5ET1dOTE9BRA0KICAgICAgICAgICAgKSwNCiAgICAgICAgKQ0KICAgICAgICAjIHN1Ym1pdCBwaXBlbGluZSBqb2INCiAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCwgZXhwZXJpbWVudF9uYW1lPSJwYXJhbGxlbF9pbl9waXBlbGluZSIpDQoNCiAgICAgICAgIyBjaGVjayByZXF1aXJlZCBmaWVsZHMgaW4gam9iIGRpY3QNCiAgICAgICAgam9iX2RpY3QgPSBwaXBlbGluZV9qb2IuX3RvX2RpY3QoKQ0KICAgICAgICBleHBlY3RlZF9rZXlzID0gWyJzdGF0dXMiLCAicHJvcGVydGllcyIsICJjcmVhdGlvbl9jb250ZXh0Il0NCiAgICAgICAgZm9yIGsgaW4gZXhwZWN0ZWRfa2V5czoNCiAgICAgICAgICAgIGFzc2VydCBrIGluIGpvYl9kaWN0LmtleXMoKSwgZiJmYWlsZWQgdG8gZ2V0IHtrfSBpbiB7am9iX2RpY3R9Ig0KDQogICAgICAgICMgb3JpZ2luYWwgam9iIGRpZCBub3QgY2hhbmdlDQogICAgICAgIGFzc2VydF9qb2JfaW5wdXRfb3V0cHV0X3R5cGVzKHBpcGVsaW5lX2pvYikNCiAgICAgICAgYXNzZXJ0IHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPT0gImNwdS1jbHVzdGVyIg0KDQogICAgQHB5dGVzdC5tYXJrLnNraXAoIlRPRE8gKDIzNzAxMjkpOiBSZWNvcmRpbmcgZmFpbHMgZHVlIHRvICdDYW5ub3QgZmluZCBwaXBlbGluZSBydW4nIGVycm9yIikNCiAgICBkZWYgdGVzdF9wYXJhbGxlbF9jb21wb25lbnRzX3dpdGhfdGFidWxhcl9pbnB1dF9iaW5kX3RvX2xpdGVyYWxfaW5wdXQoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgY29tcG9uZW50c19kaXIgPSB0ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvZHNsX3BpcGVsaW5lL3BhcmFsbGVsX2NvbXBvbmVudF93aXRoX3RhYnVsYXJfaW5wdXQiDQoNCiAgICAgICAgYmF0Y2hfaW5mZXJlbmNlID0gbG9hZF9jb21wb25lbnQoc291cmNlPXN0cihjb21wb25lbnRzX2RpciAvICJ0YWJ1bGFyX2lucHV0X2UyZS55bWwiKSkNCg0KICAgICAgICAjIENvbnN0cnVjdCBwaXBlbGluZQ0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgcGFyYWxsZWxfaW5fcGlwZWxpbmUoam9iX2RhdGFfcGF0aCwgc2NvcmVfbW9kZWwsIGxpdGVyYWxfaW5wdXQpOg0KICAgICAgICAgICAgYmF0Y2hfaW5mZXJlbmNlX25vZGUgPSBiYXRjaF9pbmZlcmVuY2Uoam9iX2RhdGFfcGF0aD1qb2JfZGF0YV9wYXRoLCBzY29yZV9tb2RlbD1zY29yZV9tb2RlbCkNCiAgICAgICAgICAgIGJhdGNoX2luZmVyZW5jZV9ub2RlLm1pbmlfYmF0Y2hfc2l6ZSA9IDUNCiAgICAgICAgICAgIGJhdGNoX2luZmVyZW5jZV9ub2RlLm1heF9jb25jdXJyZW5jeV9wZXJfaW5zdGFuY2UgPSBsaXRlcmFsX2lucHV0DQogICAgICAgICAgICBiYXRjaF9pbmZlcmVuY2Vfbm9kZS5lcnJvcl90aHJlc2hvbGQgPSBsaXRlcmFsX2lucHV0DQogICAgICAgICAgICBiYXRjaF9pbmZlcmVuY2Vfbm9kZS5taW5pX2JhdGNoX2Vycm9yX3RocmVzaG9sZCA9IGxpdGVyYWxfaW5wdXQNCg0KICAgICAgICBwaXBlbGluZSA9IHBhcmFsbGVsX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgam9iX2RhdGFfcGF0aD1JbnB1dCgNCiAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgICAgICBwYXRoPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kYXRhc2V0L25ldXJhbC1pcmlzLW1sdGFibGUiLA0KICAgICAgICAgICAgICAgIG1vZGU9SW5wdXRPdXRwdXRNb2Rlcy5ESVJFQ1QsDQogICAgICAgICAgICApLA0KICAgICAgICAgICAgc2NvcmVfbW9kZWw9SW5wdXQoDQogICAgICAgICAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvbW9kZWwiLCB0eXBlPUFzc2V0VHlwZXMuVVJJX0ZPTERFUiwgbW9kZT1JbnB1dE91dHB1dE1vZGVzLkRPV05MT0FEDQogICAgICAgICAgICApLA0KICAgICAgICAgICAgbGl0ZXJhbF9pbnB1dD0yLA0KICAgICAgICApDQogICAgICAgICMgc3VibWl0IHBpcGVsaW5lIGpvYg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50LCBleHBlcmltZW50X25hbWU9InBhcmFsbGVsX2luX3BpcGVsaW5lIikNCg0KICAgICAgICAjIGNoZWNrIHJlcXVpcmVkIGZpZWxkcyBpbiBqb2IgZGljdA0KICAgICAgICBqb2JfZGljdCA9IHBpcGVsaW5lX2pvYi5fdG9fZGljdCgpDQogICAgICAgIGV4cGVjdGVkX2tleXMgPSBbInN0YXR1cyIsICJwcm9wZXJ0aWVzIiwgImNyZWF0aW9uX2NvbnRleHQiXQ0KICAgICAgICBmb3IgayBpbiBleHBlY3RlZF9rZXlzOg0KICAgICAgICAgICAgYXNzZXJ0IGsgaW4gam9iX2RpY3Qua2V5cygpLCBmImZhaWxlZCB0byBnZXQge2t9IGluIHtqb2JfZGljdH0iDQoNCiAgICAgICAgIyBvcmlnaW5hbCBqb2IgZGlkIG5vdCBjaGFuZ2UNCiAgICAgICAgYXNzZXJ0X2pvYl9pbnB1dF9vdXRwdXRfdHlwZXMocGlwZWxpbmVfam9iKQ0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9PSAiY3B1LWNsdXN0ZXIiDQoNCiAgICBAcHl0ZXN0Lm1hcmsuc2tpcCgiVE9ETyAoMjM3MDEyOSk6IFJlY29yZGluZyBmYWlscyBkdWUgdG8gJ0Nhbm5vdCBmaW5kIHBpcGVsaW5lIHJ1bicgZXJyb3IiKQ0KICAgIGRlZiB0ZXN0X3BhcmFsbGVsX2NvbXBvbmVudHNfd2l0aF9maWxlX2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudHNfZGlyID0gdGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2RzbF9waXBlbGluZS9wYXJhbGxlbF9jb21wb25lbnRfd2l0aF9maWxlX2lucHV0Ig0KDQogICAgICAgIGJhdGNoX2luZmVyZW5jZSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1zdHIoY29tcG9uZW50c19kaXIgLyAic2NvcmUueW1sIikpDQoNCiAgICAgICAgIyBDb25zdHJ1Y3QgcGlwZWxpbmUNCiAgICAgICAgQGRzbC5waXBlbGluZShkZWZhdWx0X2NvbXB1dGU9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgZGVmIHBhcmFsbGVsX2luX3BpcGVsaW5lKGpvYl9kYXRhX3BhdGgpOg0KICAgICAgICAgICAgYmF0Y2hfaW5mZXJlbmNlX25vZGUgPSBiYXRjaF9pbmZlcmVuY2Uoam9iX2RhdGFfcGF0aD1qb2JfZGF0YV9wYXRoKQ0KICAgICAgICAgICAgYmF0Y2hfaW5mZXJlbmNlX25vZGUubWluaV9iYXRjaF9zaXplID0gNQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGFyYWxsZWxfaW5fcGlwZWxpbmUoDQogICAgICAgICAgICBqb2JfZGF0YV9wYXRoPUlucHV0KA0KICAgICAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgICAgIHBhdGg9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2RhdGFzZXQvbW5pc3QtZGF0YSIsDQogICAgICAgICAgICAgICAgbW9kZT1JbnB1dE91dHB1dE1vZGVzLkVWQUxfTU9VTlQsDQogICAgICAgICAgICApLA0KICAgICAgICApDQogICAgICAgICMgc3VibWl0IHBpcGVsaW5lIGpvYg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50LCBleHBlcmltZW50X25hbWU9InBhcmFsbGVsX2luX3BpcGVsaW5lIikNCiAgICAgICAgIyBjaGVjayByZXF1aXJlZCBmaWVsZHMgaW4gam9iIGRpY3QNCiAgICAgICAgam9iX2RpY3QgPSBwaXBlbGluZV9qb2IuX3RvX2RpY3QoKQ0KICAgICAgICBleHBlY3RlZF9rZXlzID0gWyJzdGF0dXMiLCAicHJvcGVydGllcyIsICJjcmVhdGlvbl9jb250ZXh0Il0NCiAgICAgICAgZm9yIGsgaW4gZXhwZWN0ZWRfa2V5czoNCiAgICAgICAgICAgIGFzc2VydCBrIGluIGpvYl9kaWN0LmtleXMoKSwgZiJmYWlsZWQgdG8gZ2V0IHtrfSBpbiB7am9iX2RpY3R9Ig0KDQogICAgICAgICMgb3JpZ2luYWwgam9iIGRpZCBub3QgY2hhbmdlDQogICAgICAgIGFzc2VydF9qb2JfaW5wdXRfb3V0cHV0X3R5cGVzKHBpcGVsaW5lX2pvYikNCiAgICAgICAgYXNzZXJ0IHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPT0gImNwdS1jbHVzdGVyIg0KDQogICAgQHB5dGVzdC5tYXJrLnNraXAoIlRPRE8gKDIzNzAxMjkpOiBSZWNvcmRpbmcgZmFpbHMgZHVlIHRvICdDYW5ub3QgZmluZCBwaXBlbGluZSBydW4nIGVycm9yIikNCiAgICBkZWYgdGVzdF9wYXJhbGxlbF9ydW5fZnVuY3Rpb24oc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGRhdGEgPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZGF0YXNldC9tbmlzdC1kYXRhIiwNCiAgICAgICAgICAgIG1vZGU9SW5wdXRPdXRwdXRNb2Rlcy5FVkFMX01PVU5ULA0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lID0gYnVpbGRfcGlwZWxpbmVfd2l0aF9wYXJhbGxlbF9ydW5fZnVuY3Rpb24oZGF0YSkNCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkgICMgc3VibWl0IHBpcGVsaW5lIGpvYg0KDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAidGFncyI6IHt9LA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAiam9iX2RhdGFfcGF0aCI6IHsiam9iX2lucHV0X3R5cGUiOiAibWx0YWJsZSIsICJtb2RlIjogIkV2YWxNb3VudCJ9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJqb2JzIjogew0KICAgICAgICAgICAgICAgICJub2RlMSI6IHsNCiAgICAgICAgICAgICAgICAgICAgImlucHV0X2RhdGEiOiAiJHt7aW5wdXRzLmpvYl9kYXRhX3BhdGh9fSIsDQogICAgICAgICAgICAgICAgICAgICJkaXNwbGF5X25hbWUiOiAibXktZXZhbHVhdGUtam9iIiwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfZGF0YV9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5qb2JfZGF0YV9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJub2RlMSIsDQogICAgICAgICAgICAgICAgICAgICJtaW5pX2JhdGNoX3NpemUiOiA1LA0KICAgICAgICAgICAgICAgICAgICAibG9nZ2luZ19sZXZlbCI6ICJERUJVRyIsDQogICAgICAgICAgICAgICAgICAgICJtYXhfY29uY3VycmVuY3lfcGVyX2luc3RhbmNlIjogMSwNCiAgICAgICAgICAgICAgICAgICAgImVycm9yX3RocmVzaG9sZCI6IDEsDQogICAgICAgICAgICAgICAgICAgICJtaW5pX2JhdGNoX2Vycm9yX3RocmVzaG9sZCI6IDEsDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRzIjogeyJqb2Jfb3V0cHV0X3BhdGgiOiB7InR5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5waXBlbGluZV9vdXRwdXR9fSJ9fSwNCiAgICAgICAgICAgICAgICAgICAgInJlc291cmNlcyI6IHsiaW5zdGFuY2VfY291bnQiOiAyfSwNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAicGFyYWxsZWwiLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7DQogICAgICAgICAgICAgICAgInBpcGVsaW5lX291dHB1dCI6IHsNCiAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiUmVhZFdyaXRlTW91bnQiLA0KICAgICAgICAgICAgICAgICAgICAiam9iX291dHB1dF90eXBlIjogInVyaV9mb2xkZXIiLA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAic2V0dGluZ3MiOiB7ImRlZmF1bHRfY29tcHV0ZSI6ICJjcHUtY2x1c3RlciJ9LA0KICAgICAgICB9DQogICAgICAgIGFzc2VydCBleHBlY3RlZF9qb2IgPT0gYWN0dWFsX2pvYg0KDQogICAgICAgICMgY2hlY2sgcmVxdWlyZWQgZmllbGRzIGluIGpvYiBkaWN0DQogICAgICAgIGpvYl9kaWN0ID0gcGlwZWxpbmVfam9iLl90b19kaWN0KCkNCiAgICAgICAgZXhwZWN0ZWRfa2V5cyA9IFsic3RhdHVzIiwgInByb3BlcnRpZXMiLCAiY3JlYXRpb25fY29udGV4dCJdDQogICAgICAgIGZvciBrIGluIGV4cGVjdGVkX2tleXM6DQogICAgICAgICAgICBhc3NlcnQgayBpbiBqb2JfZGljdC5rZXlzKCksIGYiZmFpbGVkIHRvIGdldCB7a30gaW4ge2pvYl9kaWN0fSINCg0KICAgICAgICAjIG9yaWdpbmFsIGpvYiBkaWQgbm90IGNoYW5nZQ0KICAgICAgICBhc3NlcnRfam9iX2lucHV0X291dHB1dF90eXBlcyhwaXBlbGluZV9qb2IpDQogICAgICAgIGFzc2VydCBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID09ICJjcHUtY2x1c3RlciINCg0KICAgIEBweXRlc3QubWFyay5za2lwKCJUT0RPICgyMzcwMTI5KTogUmVjb3JkaW5nIGZhaWxzIGR1ZSB0byAnQ2Fubm90IGZpbmQgcGlwZWxpbmUgcnVuJyBlcnJvciIpDQogICAgZGVmIHRlc3RfcGFyYWxsZWxfcnVuX2Z1bmN0aW9uX3J1bl9zZXR0aW5nc19iaW5kX3RvX2xpdGVyYWxfaW5wdXQoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGRhdGEgPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZGF0YXNldC9tbmlzdC1kYXRhIiwNCiAgICAgICAgICAgIG1vZGU9SW5wdXRPdXRwdXRNb2Rlcy5FVkFMX01PVU5ULA0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lID0gYnVpbGRfcGlwZWxpbmVfd2l0aF9wYXJhbGxlbF9ydW5fZnVuY3Rpb24oZGF0YSwgMikNCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkgICMgc3VibWl0IHBpcGVsaW5lIGpvYg0KDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAidGFncyI6IHt9LA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAiam9iX2RhdGFfcGF0aCI6IHsiam9iX2lucHV0X3R5cGUiOiAibWx0YWJsZSIsICJtb2RlIjogIkV2YWxNb3VudCJ9LA0KICAgICAgICAgICAgICAgICJsaXRlcmFsX2lucHV0IjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjIifSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiam9icyI6IHsNCiAgICAgICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgICAgICJpbnB1dF9kYXRhIjogIiR7e2lucHV0cy5qb2JfZGF0YV9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICAiZGlzcGxheV9uYW1lIjogIm15LWV2YWx1YXRlLWpvYiIsDQogICAgICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiam9iX2RhdGFfcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuam9iX2RhdGFfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTEiLA0KICAgICAgICAgICAgICAgICAgICAibWluaV9iYXRjaF9zaXplIjogNSwNCiAgICAgICAgICAgICAgICAgICAgImxvZ2dpbmdfbGV2ZWwiOiAiREVCVUciLA0KICAgICAgICAgICAgICAgICAgICAibWF4X2NvbmN1cnJlbmN5X3Blcl9pbnN0YW5jZSI6ICIke3twYXJlbnQuaW5wdXRzLmxpdGVyYWxfaW5wdXR9fSIsDQogICAgICAgICAgICAgICAgICAgICJlcnJvcl90aHJlc2hvbGQiOiAiJHt7cGFyZW50LmlucHV0cy5saXRlcmFsX2lucHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICAibWluaV9iYXRjaF9lcnJvcl90aHJlc2hvbGQiOiAiJHt7cGFyZW50LmlucHV0cy5saXRlcmFsX2lucHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICAib3V0cHV0cyI6IHsiam9iX291dHB1dF9wYXRoIjogeyJ0eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMucGlwZWxpbmVfb3V0cHV0fX0ifX0sDQogICAgICAgICAgICAgICAgICAgICJyZXNvdXJjZXMiOiB7Imluc3RhbmNlX2NvdW50IjogIiR7e3BhcmVudC5pbnB1dHMubGl0ZXJhbF9pbnB1dH19In0sDQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInBhcmFsbGVsIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICJwaXBlbGluZV9vdXRwdXQiOiB7DQogICAgICAgICAgICAgICAgICAgICJtb2RlIjogIlJlYWRXcml0ZU1vdW50IiwNCiAgICAgICAgICAgICAgICAgICAgImpvYl9vdXRwdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIiwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInNldHRpbmdzIjogeyJkZWZhdWx0X2NvbXB1dGUiOiAiY3B1LWNsdXN0ZXIifSwNCiAgICAgICAgfQ0KICAgICAgICBhc3NlcnQgZXhwZWN0ZWRfam9iID09IGFjdHVhbF9qb2INCiAgICAgICAgIyBjaGVjayByZXF1aXJlZCBmaWVsZHMgaW4gam9iIGRpY3QNCiAgICAgICAgam9iX2RpY3QgPSBwaXBlbGluZV9qb2IuX3RvX2RpY3QoKQ0KICAgICAgICBleHBlY3RlZF9rZXlzID0gWyJzdGF0dXMiLCAicHJvcGVydGllcyIsICJjcmVhdGlvbl9jb250ZXh0Il0NCiAgICAgICAgZm9yIGsgaW4gZXhwZWN0ZWRfa2V5czoNCiAgICAgICAgICAgIGFzc2VydCBrIGluIGpvYl9kaWN0LmtleXMoKSwgZiJmYWlsZWQgdG8gZ2V0IHtrfSBpbiB7am9iX2RpY3R9Ig0KDQogICAgICAgICMgb3JpZ2luYWwgam9iIGRpZCBub3QgY2hhbmdlDQogICAgICAgIGFzc2VydF9qb2JfaW5wdXRfb3V0cHV0X3R5cGVzKHBpcGVsaW5lX2pvYikNCiAgICAgICAgYXNzZXJ0IHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPT0gImNwdS1jbHVzdGVyIg0KDQogICAgZGVmIHRlc3RfcGFyYWxsZWxfam9iKHNlbGYsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgZW52aXJvbm1lbnQgPSAiQXp1cmVNTC1za2xlYXJuLTEuMC11YnVudHUyMC4wNC1weTM4LWNwdTozMyINCiAgICAgICAgaW5wdXRzID0gew0KICAgICAgICAgICAgImpvYl9kYXRhX3BhdGgiOiBJbnB1dCgNCiAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgICAgICBwYXRoPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kYXRhc2V0L21uaXN0LWRhdGEiLA0KICAgICAgICAgICAgICAgIG1vZGU9SW5wdXRPdXRwdXRNb2Rlcy5FVkFMX01PVU5ULA0KICAgICAgICAgICAgKSwNCiAgICAgICAgfQ0KICAgICAgICBpbnB1dF9kYXRhID0gIiR7e2lucHV0cy5qb2JfZGF0YV9wYXRofX0iDQogICAgICAgIG91dHB1dHMgPSB7ImpvYl9vdXRwdXRfcGF0aCI6IE91dHB1dCh0eXBlPUFzc2V0VHlwZXMuVVJJX0ZPTERFUiwgbW9kZT0icndfbW91bnQiKX0NCiAgICAgICAgcmVzb3VyY2VzID0geyJpbnN0YW5jZV9jb3VudCI6IDJ9DQogICAgICAgIHRhc2sgPSBSdW5GdW5jdGlvbigNCiAgICAgICAgICAgIGNvZGU9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2RzbF9waXBlbGluZS9wYXJhbGxlbF9jb21wb25lbnRfd2l0aF9maWxlX2lucHV0L3NyYy8iLA0KICAgICAgICAgICAgZW50cnlfc2NyaXB0PSJzY29yZS5weSIsDQogICAgICAgICAgICBwcm9ncmFtX2FyZ3VtZW50cz0iLS1qb2Jfb3V0cHV0X3BhdGggJHt7b3V0cHV0cy5qb2Jfb3V0cHV0X3BhdGh9fSIsDQogICAgICAgICAgICBlbnZpcm9ubWVudD1lbnZpcm9ubWVudCwNCiAgICAgICAgKQ0KICAgICAgICBsb2dnaW5nX2xldmVsID0gIkRFQlVHIg0KICAgICAgICBtYXhfY29uY3VycmVuY3lfcGVyX2luc3RhbmNlID0gMQ0KICAgICAgICBlcnJvcl90aHJlc2hvbGQgPSAxDQogICAgICAgIG1pbmlfYmF0Y2hfZXJyb3JfdGhyZXNob2xkID0gMQ0KICAgICAgICBtaW5pX2JhdGNoX3NpemUgPSAiNSINCiAgICAgICAgZW52aXJvbm1lbnRfdmFyaWFibGVzID0geyJlbnZpcm9ubWVudCI6ICJ2YWwifQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPXJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgcGlwZWxpbmUgam9iIHdpdGggcGFyYWxsZWwgZnVuY3Rpb24iLA0KICAgICAgICAgICAgdGFncz17Im93bmVyIjogInNka3RlYW0iLCAidGFnIjogInRhZ3ZhbHVlIn0sDQogICAgICAgICkNCiAgICAgICAgZGVmIHBhcmFsbGVsX2luX3BpcGVsaW5lKGpvYl9kYXRhX3BhdGgpOg0KICAgICAgICAgICAgcGFyYWxsZWxfam9iID0gUGFyYWxsZWxKb2IoDQogICAgICAgICAgICAgICAgZGlzcGxheV9uYW1lPSJteS1ldmFsdWF0ZS1qb2IiLA0KICAgICAgICAgICAgICAgIHJlc291cmNlcz1yZXNvdXJjZXMsDQogICAgICAgICAgICAgICAgbWluaV9iYXRjaF9zaXplPW1pbmlfYmF0Y2hfc2l6ZSwNCiAgICAgICAgICAgICAgICB0YXNrPXRhc2ssDQogICAgICAgICAgICAgICAgaW5wdXRfZGF0YT1pbnB1dF9kYXRhLA0KICAgICAgICAgICAgICAgIGxvZ2dpbmdfbGV2ZWw9bG9nZ2luZ19sZXZlbCwNCiAgICAgICAgICAgICAgICBtYXhfY29uY3VycmVuY3lfcGVyX2luc3RhbmNlPW1heF9jb25jdXJyZW5jeV9wZXJfaW5zdGFuY2UsDQogICAgICAgICAgICAgICAgZXJyb3JfdGhyZXNob2xkPWVycm9yX3RocmVzaG9sZCwNCiAgICAgICAgICAgICAgICBtaW5pX2JhdGNoX2Vycm9yX3RocmVzaG9sZD1taW5pX2JhdGNoX2Vycm9yX3RocmVzaG9sZCwNCiAgICAgICAgICAgICAgICBlbnZpcm9ubWVudF92YXJpYWJsZXM9ZW52aXJvbm1lbnRfdmFyaWFibGVzLA0KICAgICAgICAgICAgICAgIGlucHV0cz1pbnB1dHMsDQogICAgICAgICAgICAgICAgb3V0cHV0cz1vdXRwdXRzLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgcGFyYWxsZWxfam9iX2Z1bmMgPSB0b19jb21wb25lbnQoam9iPXBhcmFsbGVsX2pvYikNCiAgICAgICAgICAgIHBhcmFsbGVsX25vZGUgPSBwYXJhbGxlbF9qb2JfZnVuYyhqb2JfZGF0YV9wYXRoPWpvYl9kYXRhX3BhdGgpDQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgInBpcGVsaW5lX2pvYl9vdXQiOiBwYXJhbGxlbF9ub2RlLm91dHB1dHMuam9iX291dHB1dF9wYXRoLA0KICAgICAgICAgICAgfQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGFyYWxsZWxfaW5fcGlwZWxpbmUoDQogICAgICAgICAgICBJbnB1dCgNCiAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgICAgICBwYXRoPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kYXRhc2V0L21uaXN0LWRhdGEiLA0KICAgICAgICAgICAgICAgIG1vZGU9SW5wdXRPdXRwdXRNb2Rlcy5FVkFMX01PVU5ULA0KICAgICAgICAgICAgKSwNCiAgICAgICAgKQ0KICAgICAgICBwaXBlbGluZS5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQogICAgICAgICMgc3VibWl0IGpvYiB0byB3b3Jrc3BhY2UNCiAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCwgZXhwZXJpbWVudF9uYW1lPSJwYXJhbGxlbF9pbl9waXBlbGluZSIpDQogICAgICAgIG9taXRfZmllbGRzID0gWw0KICAgICAgICAgICAgImpvYnMucGFyYWxsZWxfbm9kZS50YXNrLmNvZGUiLA0KICAgICAgICAgICAgImpvYnMucGFyYWxsZWxfbm9kZS50YXNrLmVudmlyb25tZW50IiwNCiAgICAgICAgXSArIGNvbW1vbl9vbWl0X2ZpZWxkcw0KICAgICAgICBhY3R1YWxfam9iID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5wcm9wZXJ0aWVzLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAidGFncyI6IHsib3duZXIiOiAic2RrdGVhbSIsICJ0YWciOiAidGFndmFsdWUifSwNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgcGlwZWxpbmUgam9iIHdpdGggcGFyYWxsZWwgZnVuY3Rpb24iLA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAiam9iX2RhdGFfcGF0aCI6IHsiam9iX2lucHV0X3R5cGUiOiAibWx0YWJsZSIsICJtb2RlIjogIkV2YWxNb3VudCJ9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJqb2JzIjogew0KICAgICAgICAgICAgICAgICJwYXJhbGxlbF9ub2RlIjogew0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRfZGF0YSI6ICIke3tpbnB1dHMuam9iX2RhdGFfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfZGF0YV9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5qb2JfZGF0YV9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAibWluaV9iYXRjaF9zaXplIjogNSwNCiAgICAgICAgICAgICAgICAgICAgIm1heF9jb25jdXJyZW5jeV9wZXJfaW5zdGFuY2UiOiAxLA0KICAgICAgICAgICAgICAgICAgICAibWluaV9iYXRjaF9lcnJvcl90aHJlc2hvbGQiOiAxLA0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJwYXJhbGxlbF9ub2RlIiwNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiam9iX291dHB1dF9wYXRoIjogeyJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5waXBlbGluZV9qb2Jfb3V0fX0iLCAidHlwZSI6ICJsaXRlcmFsIn0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgInJlc291cmNlcyI6IHsiaW5zdGFuY2VfY291bnQiOiAyfSwNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAicGFyYWxsZWwiLA0KICAgICAgICAgICAgICAgICAgICAidGFzayI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInJ1bl9mdW5jdGlvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAiZW50cnlfc2NyaXB0IjogInNjb3JlLnB5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJwcm9ncmFtX2FyZ3VtZW50cyI6ICItLWpvYl9vdXRwdXRfcGF0aCAke3tvdXRwdXRzLmpvYl9vdXRwdXRfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICJwaXBlbGluZV9qb2Jfb3V0Ijogew0KICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJSZWFkV3JpdGVNb3VudCIsDQogICAgICAgICAgICAgICAgICAgICJqb2Jfb3V0cHV0X3R5cGUiOiAidXJpX2ZvbGRlciIsDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJzZXR0aW5ncyI6IHsiZGVmYXVsdF9jb21wdXRlIjogImNwdS1jbHVzdGVyIn0sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGV4cGVjdGVkX2pvYiA9PSBhY3R1YWxfam9iDQoNCiAgICBkZWYgdGVzdF9tdWx0aV9wYXJhbGxlbF9jb21wb25lbnRzX3dpdGhfZmlsZV9pbnB1dF9waXBlbGluZV9vdXRwdXQoDQogICAgICAgIHNlbGYsIGNsaWVudDogTUxDbGllbnQsIHJhbmRzdHI6IENhbGxhYmxlW1tzdHJdLCBzdHJdDQogICAgKSAtPiBOb25lOg0KICAgICAgICBjb21wb25lbnRzX2RpciA9IHRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvcGFyYWxsZWxfY29tcG9uZW50X3dpdGhfZmlsZV9pbnB1dCINCiAgICAgICAgYmF0Y2hfaW5mZXJlbmNlMSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1zdHIoY29tcG9uZW50c19kaXIgLyAic2NvcmUueW1sIikpDQogICAgICAgIGJhdGNoX2luZmVyZW5jZTIgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gInNjb3JlLnltbCIpKQ0KICAgICAgICBjb252ZXJ0X2RhdGEgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9c3RyKGNvbXBvbmVudHNfZGlyIC8gImNvbnZlcnRfZGF0YS55bWwiKSkNCg0KICAgICAgICAjIENvbnN0cnVjdCBwaXBlbGluZQ0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZT0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgcGFyYWxsZWxfaW5fcGlwZWxpbmUoam9iX2RhdGFfcGF0aCk6DQogICAgICAgICAgICBiYXRjaF9pbmZlcmVuY2Vfbm9kZTEgPSBiYXRjaF9pbmZlcmVuY2UxKGpvYl9kYXRhX3BhdGg9am9iX2RhdGFfcGF0aCkNCiAgICAgICAgICAgIGNvbnZlcnRfZGF0YV9ub2RlID0gY29udmVydF9kYXRhKGlucHV0X2RhdGE9YmF0Y2hfaW5mZXJlbmNlX25vZGUxLm91dHB1dHMuam9iX291dHB1dF9wYXRoKQ0KICAgICAgICAgICAgY29udmVydF9kYXRhX25vZGUub3V0cHV0cy5maWxlX291dHB1dF9kYXRhLnR5cGUgPSBBc3NldFR5cGVzLk1MVEFCTEUNCiAgICAgICAgICAgIGJhdGNoX2luZmVyZW5jZV9ub2RlMiA9IGJhdGNoX2luZmVyZW5jZTIoam9iX2RhdGFfcGF0aD1jb252ZXJ0X2RhdGFfbm9kZS5vdXRwdXRzLmZpbGVfb3V0cHV0X2RhdGEpDQogICAgICAgICAgICBiYXRjaF9pbmZlcmVuY2Vfbm9kZTIuaW5wdXRzLmpvYl9kYXRhX3BhdGgubW9kZSA9IElucHV0T3V0cHV0TW9kZXMuRVZBTF9NT1VOVA0KDQogICAgICAgICAgICByZXR1cm4geyJqb2Jfb3V0X2RhdGEiOiBiYXRjaF9pbmZlcmVuY2Vfbm9kZTIub3V0cHV0cy5qb2Jfb3V0cHV0X3BhdGh9DQoNCiAgICAgICAgcGlwZWxpbmUgPSBwYXJhbGxlbF9pbl9waXBlbGluZSgNCiAgICAgICAgICAgIGpvYl9kYXRhX3BhdGg9SW5wdXQoDQogICAgICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZGF0YXNldC9tbmlzdC1kYXRhLyIsDQogICAgICAgICAgICAgICAgbW9kZT1JbnB1dE91dHB1dE1vZGVzLkVWQUxfTU9VTlQsDQogICAgICAgICAgICApLA0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMuam9iX291dF9kYXRhLm1vZGUgPSAidXBsb2FkIg0KDQogICAgICAgICMgc3VibWl0IHBpcGVsaW5lIGpvYg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50LCBleHBlcmltZW50X25hbWU9InBhcmFsbGVsX2luX3BpcGVsaW5lIikNCg0KICAgICAgICBvbWl0X2ZpZWxkcyA9IFsNCiAgICAgICAgICAgICJqb2JzLioudGFzay5jb2RlIiwNCiAgICAgICAgICAgICJqb2JzLioudGFzay5lbnZpcm9ubWVudCIsDQogICAgICAgIF0gKyBjb21tb25fb21pdF9maWVsZHMNCiAgICAgICAgYWN0dWFsX2pvYiA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkucHJvcGVydGllcy5hc19kaWN0KCksICpvbWl0X2ZpZWxkcykNCiAgICAgICAgZXhwZWN0ZWRfam9iID0gew0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJpc19hcmNoaXZlZCI6IEZhbHNlLA0KICAgICAgICAgICAgImpvYl90eXBlIjogIlBpcGVsaW5lIiwNCiAgICAgICAgICAgICJpbnB1dHMiOiB7ImpvYl9kYXRhX3BhdGgiOiB7Im1vZGUiOiAiRXZhbE1vdW50IiwgImpvYl9pbnB1dF90eXBlIjogIm1sdGFibGUifX0sDQogICAgICAgICAgICAiam9icyI6IHsNCiAgICAgICAgICAgICAgICAiYmF0Y2hfaW5mZXJlbmNlX25vZGUxIjogew0KICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbCIsDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogImJhdGNoX2luZmVyZW5jZV9ub2RlMSIsDQogICAgICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiam9iX2RhdGFfcGF0aCI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmpvYl9kYXRhX3BhdGh9fSJ9DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJtaW5pX2JhdGNoX3NpemUiOiAxLA0KICAgICAgICAgICAgICAgICAgICAidGFzayI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInJ1bl9mdW5jdGlvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAiZW50cnlfc2NyaXB0IjogInNjb3JlLnB5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJwcm9ncmFtX2FyZ3VtZW50cyI6ICItLWpvYl9vdXRwdXRfcGF0aCAke3tvdXRwdXRzLmpvYl9vdXRwdXRfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0X2RhdGEiOiAiJHt7aW5wdXRzLmpvYl9kYXRhX3BhdGh9fSIsDQogICAgICAgICAgICAgICAgICAgICJyZXNvdXJjZXMiOiB7Imluc3RhbmNlX2NvdW50IjogMn0sDQogICAgICAgICAgICAgICAgICAgICJtYXhfY29uY3VycmVuY3lfcGVyX2luc3RhbmNlIjogMSwNCiAgICAgICAgICAgICAgICAgICAgIm1pbmlfYmF0Y2hfZXJyb3JfdGhyZXNob2xkIjogMSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJjb252ZXJ0X2RhdGFfbm9kZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiY29udmVydF9kYXRhX25vZGUiLA0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImlucHV0X2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5iYXRjaF9pbmZlcmVuY2Vfbm9kZTEub3V0cHV0cy5qb2Jfb3V0cHV0X3BhdGh9fSIsDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRzIjogeyJmaWxlX291dHB1dF9kYXRhIjogeyJqb2Jfb3V0cHV0X3R5cGUiOiAibWx0YWJsZSJ9fSwNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAiYmF0Y2hfaW5mZXJlbmNlX25vZGUyIjogew0KICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbCIsDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogImJhdGNoX2luZmVyZW5jZV9ub2RlMiIsDQogICAgICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiam9iX2RhdGFfcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5qb2JzLmNvbnZlcnRfZGF0YV9ub2RlLm91dHB1dHMuZmlsZV9vdXRwdXRfZGF0YX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJFdmFsTW91bnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAib3V0cHV0cyI6IHsiam9iX291dHB1dF9wYXRoIjogeyJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5qb2Jfb3V0X2RhdGF9fSIsICJ0eXBlIjogImxpdGVyYWwifX0sDQogICAgICAgICAgICAgICAgICAgICJtaW5pX2JhdGNoX3NpemUiOiAxLA0KICAgICAgICAgICAgICAgICAgICAidGFzayI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInJ1bl9mdW5jdGlvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAiZW50cnlfc2NyaXB0IjogInNjb3JlLnB5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJwcm9ncmFtX2FyZ3VtZW50cyI6ICItLWpvYl9vdXRwdXRfcGF0aCAke3tvdXRwdXRzLmpvYl9vdXRwdXRfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0X2RhdGEiOiAiJHt7aW5wdXRzLmpvYl9kYXRhX3BhdGh9fSIsDQogICAgICAgICAgICAgICAgICAgICJyZXNvdXJjZXMiOiB7Imluc3RhbmNlX2NvdW50IjogMn0sDQogICAgICAgICAgICAgICAgICAgICJtYXhfY29uY3VycmVuY3lfcGVyX2luc3RhbmNlIjogMSwNCiAgICAgICAgICAgICAgICAgICAgIm1pbmlfYmF0Y2hfZXJyb3JfdGhyZXNob2xkIjogMSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJvdXRwdXRzIjogeyJqb2Jfb3V0X2RhdGEiOiB7Im1vZGUiOiAiVXBsb2FkIiwgImpvYl9vdXRwdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIn19LA0KICAgICAgICAgICAgInNldHRpbmdzIjogeyJkZWZhdWx0X2NvbXB1dGUiOiAiY3B1LWNsdXN0ZXIifSwNCiAgICAgICAgfQ0KICAgICAgICBhc3NlcnQgZXhwZWN0ZWRfam9iID09IGFjdHVhbF9qb2INCg0KICAgIGRlZiB0ZXN0X2dldF9jaGlsZF9qb2Ioc2VsZiwgY2xpZW50OiBNTENsaWVudCwgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0pIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudF95YW1sID0gY29tcG9uZW50c19kaXIgLyAiaGVsbG93b3JsZF9jb21wb25lbnQueW1sIg0KICAgICAgICBjb21wb25lbnRfZnVuYzEgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Y29tcG9uZW50X3lhbWwsIHBhcmFtc19vdmVycmlkZT1beyJuYW1lIjogcmFuZHN0cigiY29tcG9uZW50X25hbWUiKX1dKQ0KICAgICAgICBjb21wb25lbnRfZnVuYzIgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Y29tcG9uZW50X3lhbWwsIHBhcmFtc19vdmVycmlkZT1beyJuYW1lIjogcmFuZHN0cigiY29tcG9uZW50X25hbWUiKX1dKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPXJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgaGVsbG8gd29ybGQgcGlwZWxpbmUgam9iIiwNCiAgICAgICAgICAgIHRhZ3M9eyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSwNCiAgICAgICAgICAgIGNvbnRpbnVlX29uX3N0ZXBfZmFpbHVyZT1UcnVlLA0KICAgICAgICApDQogICAgICAgIGRlZiBwaXBlbGluZShqb2JfaW5fbnVtYmVyLCBqb2JfaW5fb3RoZXJfbnVtYmVyLCBqb2JfaW5fcGF0aCk6DQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzEoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMihjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9vdGhlcl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmUoMTAsIDE1LCBqb2JfaW5wdXQpDQogICAgICAgIGpvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUpDQogICAgICAgIGNsaWVudC5qb2JzLmdldChqb2IubmFtZSkNCiAgICAgICAgY2xpZW50LmpvYnMuZ2V0KGpvYi5uYW1lKS5fcmVwcl9odG1sXygpICAjIHRvIHRlc3QgY2xpZW50LmpvYnMuZ2V0KCkgd29ya3MgaW4gbm90ZWJvb2sNCg0KICAgICAgICBjaGlsZHJlbiA9IGxpc3QoY2xpZW50LmpvYnMubGlzdChwYXJlbnRfam9iX25hbWU9am9iLm5hbWUpKQ0KICAgICAgICBmb3IgY2hpbGQgaW4gY2hpbGRyZW46DQogICAgICAgICAgICBjbGllbnQuam9icy5nZXQoY2hpbGQubmFtZSkNCiAgICAgICAgICAgIGNsaWVudC5qb2JzLmdldChjaGlsZC5uYW1lKS5fcmVwcl9odG1sXygpDQoNCiAgICBkZWYgdGVzdF9kc2xfcGlwZWxpbmVfd2l0aG91dF9zZXR0aW5nX2JpbmRpbmdfbm9kZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUucGlwZWxpbmVfd2l0aF9zZXRfYmluZGluZ19vdXRwdXRfaW5wdXQucGlwZWxpbmUgaW1wb3J0ICgNCiAgICAgICAgICAgIHBpcGVsaW5lX3dpdGhvdXRfc2V0dGluZ19iaW5kaW5nX25vZGUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhvdXRfc2V0dGluZ19iaW5kaW5nX25vZGUoKQ0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lKQ0KDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiRTJFIGR1bW15IHBpcGVsaW5lIHdpdGggY29tcG9uZW50cyBkZWZpbmVkIHZpYSB5YW1sLiIsDQogICAgICAgICAgICAidGFncyI6IHt9LA0KICAgICAgICAgICAgImNvbXB1dGVfaWQiOiAiY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfaW5wdXQiOiB7Im1vZGUiOiAiUmVhZE9ubHlNb3VudCIsICJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIn0sDQogICAgICAgICAgICAgICAgInRyYWluaW5nX21heF9lcG9jaHMiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMjAifSwNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfbGVhcm5pbmdfcmF0ZSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIxLjgifSwNCiAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZV9zY2hlZHVsZSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICJ0aW1lLWJhc2VkIn0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImpvYnMiOiB7DQogICAgICAgICAgICAgICAgInRyYWluX3dpdGhfc2FtcGxlX2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJ0cmFpbl93aXRoX3NhbXBsZV9kYXRhIiwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ0cmFpbmluZ19kYXRhIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfaW5wdXR9fSJ9LA0KICAgICAgICAgICAgICAgICAgICAgICAgIm1heF9lcG9jaHMiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy50cmFpbmluZ19tYXhfZXBvY2hzfX0ifSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJsZWFybmluZ19yYXRlIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy50cmFpbmluZ19sZWFybmluZ19yYXRlfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJsZWFybmluZ19yYXRlX3NjaGVkdWxlIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5sZWFybmluZ19yYXRlX3NjaGVkdWxlfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dHMiOiB7Im1vZGVsX291dHB1dCI6IHsidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMudHJhaW5lZF9tb2RlbH19IiwgInR5cGUiOiAibGl0ZXJhbCJ9fSwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7InRyYWluZWRfbW9kZWwiOiB7Im1vZGUiOiAiUmVhZFdyaXRlTW91bnQiLCAiam9iX291dHB1dF90eXBlIjogInVyaV9mb2xkZXIifX0sDQogICAgICAgICAgICAic2V0dGluZ3MiOiB7fSwNCiAgICAgICAgfQ0KICAgICAgICBhc3NlcnQgZXhwZWN0ZWRfam9iID09IGFjdHVhbF9qb2INCg0KICAgIGRlZiB0ZXN0X2RzbF9waXBlbGluZV93aXRoX29ubHlfc2V0dGluZ19waXBlbGluZV9sZXZlbChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLnBpcGVsaW5lX3dpdGhfc2V0X2JpbmRpbmdfb3V0cHV0X2lucHV0LnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBwaXBlbGluZV93aXRoX29ubHlfc2V0dGluZ19waXBlbGluZV9sZXZlbCwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfd2l0aF9vbmx5X3NldHRpbmdfcGlwZWxpbmVfbGV2ZWwoKQ0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lKQ0KDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiRTJFIGR1bW15IHBpcGVsaW5lIHdpdGggY29tcG9uZW50cyBkZWZpbmVkIHZpYSB5YW1sLiIsDQogICAgICAgICAgICAidGFncyI6IHt9LA0KICAgICAgICAgICAgImNvbXB1dGVfaWQiOiAiY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgImlzX2FyY2hpdmVkIjogRmFsc2UsDQogICAgICAgICAgICAiam9iX3R5cGUiOiAiUGlwZWxpbmUiLA0KICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfaW5wdXQiOiB7Im1vZGUiOiAiUmVhZE9ubHlNb3VudCIsICJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIn0sDQogICAgICAgICAgICAgICAgInRyYWluaW5nX21heF9lcG9jaHMiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMjAifSwNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfbGVhcm5pbmdfcmF0ZSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIxLjgifSwNCiAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZV9zY2hlZHVsZSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICJ0aW1lLWJhc2VkIn0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImpvYnMiOiB7DQogICAgICAgICAgICAgICAgInRyYWluX3dpdGhfc2FtcGxlX2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJ0cmFpbl93aXRoX3NhbXBsZV9kYXRhIiwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJ0cmFpbmluZ19kYXRhIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfaW5wdXR9fSJ9LA0KICAgICAgICAgICAgICAgICAgICAgICAgIm1heF9lcG9jaHMiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy50cmFpbmluZ19tYXhfZXBvY2hzfX0ifSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJsZWFybmluZ19yYXRlIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy50cmFpbmluZ19sZWFybmluZ19yYXRlfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJsZWFybmluZ19yYXRlX3NjaGVkdWxlIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5sZWFybmluZ19yYXRlX3NjaGVkdWxlfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dHMiOiB7Im1vZGVsX291dHB1dCI6IHsidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMudHJhaW5lZF9tb2RlbH19IiwgInR5cGUiOiAibGl0ZXJhbCJ9fSwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7InRyYWluZWRfbW9kZWwiOiB7Im1vZGUiOiAiVXBsb2FkIiwgImpvYl9vdXRwdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIn19LA0KICAgICAgICAgICAgInNldHRpbmdzIjoge30sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGV4cGVjdGVkX2pvYiA9PSBhY3R1YWxfam9iDQoNCiAgICBAcHl0ZXN0Lm1hcmsuc2tpcGlmKGNvbmRpdGlvbj1ub3QgaXNfbGl2ZSgpLCByZWFzb249IlRPRE8oMjE3NzM1Myk6IGludmVzdGlnYXRlIHdoeSB0aGlzIHRlc3QgZmFpbHMuIikNCiAgICBkZWYgdGVzdF9kc2xfcGlwZWxpbmVfd2l0aF9vbmx5X3NldHRpbmdfYmluZGluZ19ub2RlKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICAjIFRvZG86IGNoZWNrb3V0IHJ1biBwcmlvcml0eSB3aGVuIGJhY2tlbmQgaXMgcmVhZHkNCiAgICAgICAgZnJvbSB0ZXN0X2NvbmZpZ3MuZHNsX3BpcGVsaW5lLnBpcGVsaW5lX3dpdGhfc2V0X2JpbmRpbmdfb3V0cHV0X2lucHV0LnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBwaXBlbGluZV93aXRoX29ubHlfc2V0dGluZ19iaW5kaW5nX25vZGUsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhfb25seV9zZXR0aW5nX2JpbmRpbmdfbm9kZSgpDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUpDQoNCiAgICAgICAgYWN0dWFsX2pvYiA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkucHJvcGVydGllcy5hc19kaWN0KCksICpjb21tb25fb21pdF9maWVsZHMpDQogICAgICAgIGV4cGVjdGVkX2pvYiA9IHsNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJFMkUgZHVtbXkgcGlwZWxpbmUgd2l0aCBjb21wb25lbnRzIGRlZmluZWQgdmlhIHlhbWwuIiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAiY29tcHV0ZV9pZCI6ICJjcHUtY2x1c3RlciIsDQogICAgICAgICAgICAiaXNfYXJjaGl2ZWQiOiBGYWxzZSwNCiAgICAgICAgICAgICJqb2JfdHlwZSI6ICJQaXBlbGluZSIsDQogICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICJ0cmFpbmluZ19pbnB1dCI6IHsibW9kZSI6ICJSZWFkT25seU1vdW50IiwgImpvYl9pbnB1dF90eXBlIjogInVyaV9mb2xkZXIifSwNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfbWF4X2Vwb2NocyI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIyMCJ9LA0KICAgICAgICAgICAgICAgICJ0cmFpbmluZ19sZWFybmluZ19yYXRlIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEuOCJ9LA0KICAgICAgICAgICAgICAgICJsZWFybmluZ19yYXRlX3NjaGVkdWxlIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogInRpbWUtYmFzZWQifSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiam9icyI6IHsNCiAgICAgICAgICAgICAgICAidHJhaW5fd2l0aF9zYW1wbGVfZGF0YSI6IHsNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogInRyYWluX3dpdGhfc2FtcGxlX2RhdGEiLA0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgInRyYWluaW5nX2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiUmVhZE9ubHlNb3VudCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLnRyYWluaW5nX2lucHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXhfZXBvY2hzIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfbWF4X2Vwb2Noc319In0sDQogICAgICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfbGVhcm5pbmdfcmF0ZX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZV9zY2hlZHVsZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMubGVhcm5pbmdfcmF0ZV9zY2hlZHVsZX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGVsX291dHB1dCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJVcGxvYWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy50cmFpbmVkX21vZGVsfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAjIG1vZGUgd2lsbCBiZSBjb3BpZWQgdG8gcGlwZWxpbmUgbGV2ZWwNCiAgICAgICAgICAgICJvdXRwdXRzIjogeyJ0cmFpbmVkX21vZGVsIjogeyJtb2RlIjogIlVwbG9hZCIsICJqb2Jfb3V0cHV0X3R5cGUiOiAidXJpX2ZvbGRlciJ9fSwNCiAgICAgICAgICAgICJzZXR0aW5ncyI6IHt9LA0KICAgICAgICB9DQogICAgICAgIGFzc2VydCBleHBlY3RlZF9qb2IgPT0gYWN0dWFsX2pvYg0KDQogICAgQHB5dGVzdC5tYXJrLnNraXBpZihjb25kaXRpb249bm90IGlzX2xpdmUoKSwgcmVhc29uPSJUT0RPKDIxNzczNTMpOiBpbnZlc3RpZ2F0ZSB3aHkgdGhpcyB0ZXN0IGZhaWxzLiIpDQogICAgZGVmIHRlc3RfZHNsX3BpcGVsaW5lX3dpdGhfc2V0dGluZ19iaW5kaW5nX25vZGVfYW5kX3BpcGVsaW5lX2xldmVsKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5waXBlbGluZV93aXRoX3NldF9iaW5kaW5nX291dHB1dF9pbnB1dC5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgcGlwZWxpbmVfd2l0aF9zZXR0aW5nX2JpbmRpbmdfbm9kZV9hbmRfcGlwZWxpbmVfbGV2ZWwsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZSA9IHBpcGVsaW5lX3dpdGhfc2V0dGluZ19iaW5kaW5nX25vZGVfYW5kX3BpcGVsaW5lX2xldmVsKCkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkNCg0KICAgICAgICBhY3R1YWxfam9iID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5wcm9wZXJ0aWVzLmFzX2RpY3QoKSwgKmNvbW1vbl9vbWl0X2ZpZWxkcykNCiAgICAgICAgZXhwZWN0ZWRfam9iID0gew0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkUyRSBkdW1teSBwaXBlbGluZSB3aXRoIGNvbXBvbmVudHMgZGVmaW5lZCB2aWEgeWFtbC4iLA0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJjb21wdXRlX2lkIjogImNwdS1jbHVzdGVyIiwNCiAgICAgICAgICAgICJpc19hcmNoaXZlZCI6IEZhbHNlLA0KICAgICAgICAgICAgImpvYl90eXBlIjogIlBpcGVsaW5lIiwNCiAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgInRyYWluaW5nX2lucHV0IjogeyJtb2RlIjogIkRvd25sb2FkIiwgImpvYl9pbnB1dF90eXBlIjogInVyaV9mb2xkZXIifSwNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfbWF4X2Vwb2NocyI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIyMCJ9LA0KICAgICAgICAgICAgICAgICJ0cmFpbmluZ19sZWFybmluZ19yYXRlIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEuOCJ9LA0KICAgICAgICAgICAgICAgICJsZWFybmluZ19yYXRlX3NjaGVkdWxlIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogInRpbWUtYmFzZWQifSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiam9icyI6IHsNCiAgICAgICAgICAgICAgICAidHJhaW5fd2l0aF9zYW1wbGVfZGF0YSI6IHsNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogInRyYWluX3dpdGhfc2FtcGxlX2RhdGEiLA0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgInRyYWluaW5nX2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiUmVhZE9ubHlNb3VudCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLnRyYWluaW5nX2lucHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXhfZXBvY2hzIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfbWF4X2Vwb2Noc319In0sDQogICAgICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfbGVhcm5pbmdfcmF0ZX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZV9zY2hlZHVsZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMubGVhcm5pbmdfcmF0ZV9zY2hlZHVsZX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGVsX291dHB1dCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJVcGxvYWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy50cmFpbmVkX21vZGVsfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAjIHBpcGVsaW5lIGxldmVsIG91dHB1dCBzZXR0aW5nIHRha2luZyBlZmZlY3QNCiAgICAgICAgICAgICJvdXRwdXRzIjogeyJ0cmFpbmVkX21vZGVsIjogeyJtb2RlIjogIlJlYWRXcml0ZU1vdW50IiwgImpvYl9vdXRwdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIn19LA0KICAgICAgICAgICAgInNldHRpbmdzIjoge30sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGV4cGVjdGVkX2pvYiA9PSBhY3R1YWxfam9iDQoNCiAgICBkZWYgdGVzdF9kc2xfcGlwZWxpbmVfd2l0aF9jb21tYW5kX2J1aWxkZXJfc2V0dGluZ19iaW5kaW5nX25vZGVfYW5kX3BpcGVsaW5lX2xldmVsKHNlbGYsIGNsaWVudDogTUxDbGllbnQpIC0\u002BIE5vbmU6DQogICAgICAgIGZyb20gdGVzdF9jb25maWdzLmRzbF9waXBlbGluZS5waXBlbGluZV93aXRoX3NldF9iaW5kaW5nX291dHB1dF9pbnB1dC5waXBlbGluZSBpbXBvcnQgKA0KICAgICAgICAgICAgcGlwZWxpbmVfd2l0aF9jb21tYW5kX2J1aWxkZXJfc2V0dGluZ19iaW5kaW5nX25vZGVfYW5kX3BpcGVsaW5lX2xldmVsLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBwaXBlbGluZV93aXRoX2NvbW1hbmRfYnVpbGRlcl9zZXR0aW5nX2JpbmRpbmdfbm9kZV9hbmRfcGlwZWxpbmVfbGV2ZWwoKQ0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lKQ0KDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KDQogICAgICAgIGV4cGVjdGVkX2pvYiA9IHsNCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJFMkUgZHVtbXkgcGlwZWxpbmUgd2l0aCBjb21wb25lbnRzIGRlZmluZWQgdmlhIHlhbWwuIiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAiY29tcHV0ZV9pZCI6ICJjcHUtY2x1c3RlciIsDQogICAgICAgICAgICAiaXNfYXJjaGl2ZWQiOiBGYWxzZSwNCiAgICAgICAgICAgICJqb2JfdHlwZSI6ICJQaXBlbGluZSIsDQogICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICJ0cmFpbmluZ19pbnB1dCI6IHsibW9kZSI6ICJEb3dubG9hZCIsICJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIn0sDQogICAgICAgICAgICAgICAgInRyYWluaW5nX21heF9lcG9jaHMiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMjAifSwNCiAgICAgICAgICAgICAgICAidHJhaW5pbmdfbGVhcm5pbmdfcmF0ZSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIxLjgifSwNCiAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZV9zY2hlZHVsZSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICJ0aW1lLWJhc2VkIn0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImpvYnMiOiB7DQogICAgICAgICAgICAgICAgInRyYWluX3dpdGhfc2FtcGxlX2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgICAgICAgICAiZGlzdHJpYnV0aW9uIjogeyJkaXN0cmlidXRpb25fdHlwZSI6ICJQeVRvcmNoIiwgInByb2Nlc3NfY291bnRfcGVyX2luc3RhbmNlIjogMn0sDQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogInRyYWluX3dpdGhfc2FtcGxlX2RhdGEiLA0KICAgICAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgInRyYWluaW5nX2RhdGEiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiUmVhZE9ubHlNb3VudCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLnRyYWluaW5nX2lucHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXhfZXBvY2hzIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfbWF4X2Vwb2Noc319In0sDQogICAgICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMudHJhaW5pbmdfbGVhcm5pbmdfcmF0ZX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZV9zY2hlZHVsZSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMubGVhcm5pbmdfcmF0ZV9zY2hlZHVsZX19IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGVsX291dHB1dCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibW9kZSI6ICJVcGxvYWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy50cmFpbmVkX21vZGVsfX0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAib3V0cHV0cyI6IHsidHJhaW5lZF9tb2RlbCI6IHsibW9kZSI6ICJSZWFkV3JpdGVNb3VudCIsICJqb2Jfb3V0cHV0X3R5cGUiOiAidXJpX2ZvbGRlciJ9fSwNCiAgICAgICAgICAgICJzZXR0aW5ncyI6IHt9LA0KICAgICAgICB9DQogICAgICAgIGFzc2VydCBleHBlY3RlZF9qb2IgPT0gYWN0dWFsX2pvYg0KDQogICAgQHB5dGVzdC5tYXJrLnNraXAoIlRPRE8gKDIzNzUwODYpOiBKb2IgZmFpbGluZyB3aXRoICdVc2VyIGZhaWxlZCB0byBjYWxsIFNhdmVVc2VyVG9rZW4gYmVmb3JlIEdldFVzZXJUb2tlbiciKQ0KICAgIGRlZiB0ZXN0X3NwYXJrX2NvbXBvbmVudHMoc2VsZiwgY2xpZW50OiBNTENsaWVudCwgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0pIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudHNfZGlyID0gdGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2RzbF9waXBlbGluZS9zcGFya19qb2JfaW5fcGlwZWxpbmUiDQogICAgICAgIGFkZF9ncmVldGluZ19jb2x1bW4gPSBsb2FkX2NvbXBvbmVudChzdHIoY29tcG9uZW50c19kaXIgLyAiYWRkX2dyZWV0aW5nX2NvbHVtbl9jb21wb25lbnQueW1sIikpDQogICAgICAgIGNvdW50X2J5X3JvdyA9IGxvYWRfY29tcG9uZW50KHN0cihjb21wb25lbnRzX2RpciAvICJjb3VudF9ieV9yb3dfY29tcG9uZW50LnltbCIpKQ0KDQogICAgICAgICMgQ29uc3RydWN0IHBpcGVsaW5lDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgc3BhcmtfcGlwZWxpbmVfZnJvbV95YW1sKGlyaXNfZGF0YSk6DQogICAgICAgICAgICBhZGRfZ3JlZXRpbmdfY29sdW1uX25vZGUgPSBhZGRfZ3JlZXRpbmdfY29sdW1uKGZpbGVfaW5wdXQ9aXJpc19kYXRhKQ0KICAgICAgICAgICAgYWRkX2dyZWV0aW5nX2NvbHVtbl9ub2RlLnJlc291cmNlcyA9IHsiaW5zdGFuY2VfdHlwZSI6ICJzdGFuZGFyZF9lNHNfdjMiLCAicnVudGltZV92ZXJzaW9uIjogIjMuMi4wIn0NCiAgICAgICAgICAgIGNvdW50X2J5X3Jvd19ub2RlID0gY291bnRfYnlfcm93KGZpbGVfaW5wdXQ9aXJpc19kYXRhKQ0KICAgICAgICAgICAgY291bnRfYnlfcm93X25vZGUucmVzb3VyY2VzID0geyJpbnN0YW5jZV90eXBlIjogInN0YW5kYXJkX2U0c192MyIsICJydW50aW1lX3ZlcnNpb24iOiAiMy4yLjAifQ0KICAgICAgICAgICAgcmV0dXJuIHsib3V0cHV0IjogY291bnRfYnlfcm93X25vZGUub3V0cHV0cy5vdXRwdXR9DQoNCiAgICAgICAgcGlwZWxpbmUgPSBzcGFya19waXBlbGluZV9mcm9tX3lhbWwoDQogICAgICAgICAgICBpcmlzX2RhdGE9SW5wdXQoDQogICAgICAgICAgICAgICAgcGF0aD0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZHNsX3BpcGVsaW5lL3NwYXJrX2pvYl9pbl9waXBlbGluZS9kYXRhc2V0L2lyaXMuY3N2IiwNCiAgICAgICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuVVJJX0ZJTEUsDQogICAgICAgICAgICAgICAgbW9kZT1JbnB1dE91dHB1dE1vZGVzLkRJUkVDVCwNCiAgICAgICAgICAgICksDQogICAgICAgICkNCiAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5vdXRwdXQubW9kZSA9ICJEaXJlY3QiDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMub3V0cHV0LnR5cGUgPSAidXJpX2ZpbGUiDQoNCiAgICAgICAgIyBzdWJtaXQgcGlwZWxpbmUgam9iDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQsIGV4cGVyaW1lbnRfbmFtZT0ic3BhcmtfaW5fcGlwZWxpbmUiKQ0KICAgICAgICAjIGNoZWNrIHJlcXVpcmVkIGZpZWxkcyBpbiBqb2IgZGljdA0KICAgICAgICBqb2JfZGljdCA9IHBpcGVsaW5lX2pvYi5fdG9fZGljdCgpDQogICAgICAgIGV4cGVjdGVkX2tleXMgPSBbInN0YXR1cyIsICJwcm9wZXJ0aWVzIiwgImNyZWF0aW9uX2NvbnRleHQiXQ0KICAgICAgICBmb3IgayBpbiBleHBlY3RlZF9rZXlzOg0KICAgICAgICAgICAgYXNzZXJ0IGsgaW4gam9iX2RpY3Qua2V5cygpLCBmImZhaWxlZCB0byBnZXQge2t9IGluIHtqb2JfZGljdH0iDQoNCiAgICAgICAgIyBvcmlnaW5hbCBqb2IgZGlkIG5vdCBjaGFuZ2UNCiAgICAgICAgYXNzZXJ0X2pvYl9pbnB1dF9vdXRwdXRfdHlwZXMocGlwZWxpbmVfam9iKQ0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfd2l0aF9ncm91cChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgZnJvbSBlbnVtIGltcG9ydCBFbnVtDQoNCiAgICAgICAgY2xhc3MgRW51bU9wcyhFbnVtKToNCiAgICAgICAgICAgIE9wdGlvbjEgPSAiaGVsbG8iDQogICAgICAgICAgICBPcHRpb24yID0gIndvcmxkIg0KDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF95YW1sID0gIi4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaW5wdXRfdHlwZXNfY29tcG9uZW50LnltbCINCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChoZWxsb193b3JsZF9jb21wb25lbnRfeWFtbCkNCiAgICAgICAgZnJvbSBhenVyZS5haS5tbC5kc2wuX2dyb3VwX2RlY29yYXRvciBpbXBvcnQgZ3JvdXANCg0KICAgICAgICBAZ3JvdXANCiAgICAgICAgY2xhc3MgUGFyYW1DbGFzczoNCiAgICAgICAgICAgIGludF9wYXJhbTogSW5wdXQobWluPTEuMCwgbWF4PTUuMCwgdHlwZT0iaW50ZWdlciIpDQogICAgICAgICAgICBlbnVtX3BhcmFtOiBFbnVtT3BzDQogICAgICAgICAgICBzdHJfcGFyYW06IHN0ciA9ICJ0ZXN0Ig0KICAgICAgICAgICAgYm9vbF9wYXJhbTogYm9vbCA9IFRydWUNCiAgICAgICAgICAgIG51bWJlcl9wYXJhbSA9IDQuMA0KDQogICAgICAgIGRlZmF1bHRfcGFyYW0gPSBQYXJhbUNsYXNzKGludF9wYXJhbT0yLCBlbnVtX3BhcmFtPUVudW1PcHMuT3B0aW9uMSwgYm9vbF9wYXJhbT1GYWxzZSkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZV90YXJnZXQ9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfZ3JvdXAoZ3JvdXA6IFBhcmFtQ2xhc3MpOg0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3N0cmluZz1ncm91cC5zdHJfcGFyYW0sDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3JhbmdlZF9udW1iZXI9Z3JvdXAubnVtYmVyX3BhcmFtLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9lbnVtPWdyb3VwLmVudW1fcGFyYW0sDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX2Jvb2xlYW49Z3JvdXAuYm9vbF9wYXJhbSwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcmFuZ2VkX2ludGVnZXI9Z3JvdXAuaW50X3BhcmFtLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBpcGVsaW5lX3dpdGhfZ3JvdXAoZGVmYXVsdF9wYXJhbSkNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQoNCiAgICAgICAgYWN0dWFsX2pvYiA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkucHJvcGVydGllcy5hc19kaWN0KCksICpjb21tb25fb21pdF9maWVsZHMpDQogICAgICAgIGV4cGVjdGVkX2pvYl9pbnB1dHMgPSB7DQogICAgICAgICAgICAiZ3JvdXAuaW50X3BhcmFtIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjIifSwNCiAgICAgICAgICAgICJncm91cC5lbnVtX3BhcmFtIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogImhlbGxvIn0sDQogICAgICAgICAgICAiZ3JvdXAuc3RyX3BhcmFtIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogInRlc3QifSwNCiAgICAgICAgICAgICJncm91cC5ib29sX3BhcmFtIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIkZhbHNlIn0sDQogICAgICAgICAgICAiZ3JvdXAubnVtYmVyX3BhcmFtIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjQuMCJ9LA0KICAgICAgICB9DQogICAgICAgIGV4cGVjdGVkX25vZGVfaW5wdXRzID0gew0KICAgICAgICAgICAgImNvbXBvbmVudF9pbl9zdHJpbmciOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5ncm91cC5zdHJfcGFyYW19fSJ9LA0KICAgICAgICAgICAgImNvbXBvbmVudF9pbl9yYW5nZWRfaW50ZWdlciI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmdyb3VwLmludF9wYXJhbX19In0sDQogICAgICAgICAgICAiY29tcG9uZW50X2luX2VudW0iOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5ncm91cC5lbnVtX3BhcmFtfX0ifSwNCiAgICAgICAgICAgICJjb21wb25lbnRfaW5fYm9vbGVhbiI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmdyb3VwLmJvb2xfcGFyYW19fSJ9LA0KICAgICAgICAgICAgImNvbXBvbmVudF9pbl9yYW5nZWRfbnVtYmVyIjogew0KICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5ncm91cC5udW1iZXJfcGFyYW19fSIsDQogICAgICAgICAgICB9LA0KICAgICAgICB9DQogICAgICAgIGFzc2VydCBhY3R1YWxfam9iWyJpbnB1dHMiXSA9PSBleHBlY3RlZF9qb2JfaW5wdXRzDQogICAgICAgIGFzc2VydCBhY3R1YWxfam9iWyJqb2JzIl1bIm1pY3Jvc29mdF9zYW1wbGVzX2NvbW1hbmRfY29tcG9uZW50X2Jhc2ljX2lucHV0cyJdWyJpbnB1dHMiXSA9PSBleHBlY3RlZF9ub2RlX2lucHV0cw0KDQogICAgZGVmIHRlc3RfcmVnaXN0ZXJlZF9waXBlbGluZV93aXRoX2dyb3VwKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfeWFtbCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2lucHV0X3R5cGVzX2NvbXBvbmVudC55bWwiDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoaGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwpDQogICAgICAgIGZyb20gYXp1cmUuYWkubWwuZHNsLl9ncm91cF9kZWNvcmF0b3IgaW1wb3J0IGdyb3VwDQoNCiAgICAgICAgQGdyb3VwDQogICAgICAgIGNsYXNzIFN1YlBhcmFtQ2xhc3M6DQogICAgICAgICAgICBpbnRfcGFyYW06IElucHV0KG1pbj0xLjAsIG1heD01LjAsIHR5cGU9ImludGVnZXIiKQ0KDQogICAgICAgIEBncm91cA0KICAgICAgICBjbGFzcyBQYXJhbUNsYXNzOg0KICAgICAgICAgICAgc3ViOiBTdWJQYXJhbUNsYXNzDQogICAgICAgICAgICBzdHJfcGFyYW06IHN0ciA9ICJ0ZXN0Ig0KICAgICAgICAgICAgYm9vbF9wYXJhbTogYm9vbCA9IFRydWUNCiAgICAgICAgICAgIG51bWJlcl9wYXJhbSA9IDQuMA0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9ncm91cChncm91cDogUGFyYW1DbGFzcyk6DQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfZnVuYygNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fc3RyaW5nPWdyb3VwLnN0cl9wYXJhbSwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcmFuZ2VkX251bWJlcj1ncm91cC5udW1iZXJfcGFyYW0sDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX2Jvb2xlYW49Z3JvdXAuYm9vbF9wYXJhbSwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcmFuZ2VkX2ludGVnZXI9Z3JvdXAuc3ViLmludF9wYXJhbSwNCiAgICAgICAgICAgICkNCg0KICAgICAgICBjb21wb25lbnQgPSBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lX3dpdGhfZ3JvdXApDQogICAgICAgICMgQXNzZXJ0IGtleSBub3QgZXhpc3RzDQogICAgICAgIG1hdGNoID0gKA0KICAgICAgICAgICAgIiguKil1bmV4cGVjdGVkIGtleXdvcmQgYXJndW1lbnQgJ2dyb3VwLm5vdF9leGlzdCcoLiopdmFsaWQga2V5d29yZHM6ICINCiAgICAgICAgICAgICInZ3JvdXAnLCAnZ3JvdXAuc3ViLmludF9wYXJhbScsICdncm91cC5zdHJfcGFyYW0nLCAnZ3JvdXAuYm9vbF9wYXJhbScsICdncm91cC5udW1iZXJfcGFyYW0nIg0KICAgICAgICApDQogICAgICAgIHdpdGggcHl0ZXN0LnJhaXNlcyhVbmV4cGVjdGVkS2V5d29yZEVycm9yLCBtYXRjaD1tYXRjaCk6DQogICAgICAgICAgICBjb21wb25lbnQoDQogICAgICAgICAgICAgICAgKip7DQogICAgICAgICAgICAgICAgICAgICJncm91cC5udW1iZXJfcGFyYW0iOiA0LjAsDQogICAgICAgICAgICAgICAgICAgICJncm91cC5zdHJfcGFyYW0iOiAidGVzdGluZyIsDQogICAgICAgICAgICAgICAgICAgICJncm91cC5zdWIuaW50X3BhcmFtIjogNCwNCiAgICAgICAgICAgICAgICAgICAgImdyb3VwLm5vdF9leGlzdCI6IDQsDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgKQ0KICAgICAgICAjIEFzc2VydCBjb25mbGljdCBhc3NpZ25tZW50DQogICAgICAgIHdpdGggcHl0ZXN0LnJhaXNlcyhFeGNlcHRpb24sIG1hdGNoPSJDb25mbGljdCBwYXJhbWV0ZXIga2V5ICdncm91cCcgYW5kICdncm91cC5udW1iZXJfcGFyYW0nIik6DQogICAgICAgICAgICBwaXBlbGluZSA9IGNvbXBvbmVudCgNCiAgICAgICAgICAgICAgICAqKnsNCiAgICAgICAgICAgICAgICAgICAgImdyb3VwLm51bWJlcl9wYXJhbSI6IDQuMCwNCiAgICAgICAgICAgICAgICAgICAgImdyb3VwLnN0cl9wYXJhbSI6ICJ0ZXN0aW5nIiwNCiAgICAgICAgICAgICAgICAgICAgImdyb3VwLnN1Yi5pbnRfcGFyYW0iOiA0LA0KICAgICAgICAgICAgICAgICAgICAiZ3JvdXAiOiBQYXJhbUNsYXNzKHN1Yj1TdWJQYXJhbUNsYXNzKGludF9wYXJhbT0xKSksDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgcGlwZWxpbmUuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICAgICAgY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkNCiAgICAgICAgIyBBc3NlcnQgaGFwcHkgcGF0aA0KICAgICAgICBpbnB1dHMgPSB7Imdyb3VwLm51bWJlcl9wYXJhbSI6IDQuMCwgImdyb3VwLnN0cl9wYXJhbSI6ICJ0ZXN0aW5nIiwgImdyb3VwLnN1Yi5pbnRfcGFyYW0iOiA0fQ0KICAgICAgICBwaXBlbGluZSA9IGNvbXBvbmVudCgqKmlucHV0cykNCiAgICAgICAgcGlwZWxpbmUuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICByZXN0X3BpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUpDQogICAgICAgIGFzc2VydCByZXN0X3BpcGVsaW5lX2pvYi5fdG9fZGljdCgpWyJpbnB1dHMiXSA9PSB7a2V5OiBzdHIodmFsKSBmb3Iga2V5LCB2YWwgaW4gaW5wdXRzLml0ZW1zKCl9DQoNCiAgICBkZWYgdGVzdF9kc2xfcGlwZWxpbmVfd2l0aF9kZWZhdWx0X2NvbXBvbmVudCgNCiAgICAgICAgc2VsZiwNCiAgICAgICAgY2xpZW50OiBNTENsaWVudCwNCiAgICAgICAgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0sDQogICAgKSAtPiBOb25lOg0KICAgICAgICB5YW1sX3BhdGg6IHN0ciA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCINCiAgICAgICAgY29tcG9uZW50X25hbWUgPSByYW5kc3RyKCJjb21wb25lbnRfbmFtZSIpDQogICAgICAgIGNvbXBvbmVudDogQ29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoc291cmNlPXlhbWxfcGF0aCwgcGFyYW1zX292ZXJyaWRlPVt7Im5hbWUiOiBjb21wb25lbnRfbmFtZX1dKQ0KICAgICAgICBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKGNvbXBvbmVudCkNCg0KICAgICAgICBkZWZhdWx0X2NvbXBvbmVudF9mdW5jID0gY2xpZW50LmNvbXBvbmVudHMuZ2V0KGNvbXBvbmVudF9uYW1lKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgcGlwZWxpbmVfd2l0aF9kZWZhdWx0X2NvbXBvbmVudCgpOg0KICAgICAgICAgICAgbm9kZTEgPSBkZWZhdWx0X2NvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCiAgICAgICAgICAgIG5vZGUxLmNvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgIyBjb21wb25lbnQgZnJvbSBjbGllbnQuY29tcG9uZW50cy5nZXQNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV93aXRoX2RlZmF1bHRfY29tcG9uZW50KCkpDQogICAgICAgIGNyZWF0ZWRfcGlwZWxpbmVfam9iOiBQaXBlbGluZUpvYiA9IGNsaWVudC5qb2JzLmdldChwaXBlbGluZV9qb2IubmFtZSkNCiAgICAgICAgYXNzZXJ0IGNyZWF0ZWRfcGlwZWxpbmVfam9iLmpvYnNbIm5vZGUxIl0uY29tcG9uZW50ID09IGYie2NvbXBvbmVudF9uYW1lfUBkZWZhdWx0Ig0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfbm9kZV9pZGVudGl0eV93aXRoX2NvbXBvbmVudChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgcGF0aCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCINCiAgICAgICAgY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChwYXRoKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIHBpcGVsaW5lX2Z1bmMoY29tcG9uZW50X2luX3BhdGgpOg0KICAgICAgICAgICAgbm9kZTEgPSBjb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPTEsIGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbl9wYXRoKQ0KICAgICAgICAgICAgbm9kZTEuaWRlbnRpdHkgPSBBbWxUb2tlbkNvbmZpZ3VyYXRpb24oKQ0KDQogICAgICAgICAgICBub2RlMiA9IGNvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9udW1iZXI9MSwgY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgpDQogICAgICAgICAgICBub2RlMi5pZGVudGl0eSA9IFVzZXJJZGVudGl0eUNvbmZpZ3VyYXRpb24oKQ0KDQogICAgICAgICAgICBub2RlMyA9IGNvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9udW1iZXI9MSwgY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgpDQogICAgICAgICAgICBub2RlMy5pZGVudGl0eSA9IE1hbmFnZWRJZGVudGl0eUNvbmZpZ3VyYXRpb24oKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmVfZnVuYyhjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5wdXQpDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUsIGNvbXB1dGU9ImNwdS1jbHVzdGVyIikNCiAgICAgICAgb21pdF9maWVsZHMgPSBbImpvYnMuKi5jb21wb25lbnRJZCIsICJqb2JzLiouX3NvdXJjZSJdDQogICAgICAgIGFjdHVhbF9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KClbInByb3BlcnRpZXMiXSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgYWN0dWFsX2RpY3RbImpvYnMiXSA9PSB7DQogICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgImlkZW50aXR5IjogeyJ0eXBlIjogImFtbF90b2tlbiJ9LA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEifSwNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuY29tcG9uZW50X2luX3BhdGh9fSJ9LA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTEiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJub2RlMiI6IHsNCiAgICAgICAgICAgICAgICAiaWRlbnRpdHkiOiB7InR5cGUiOiAidXNlcl9pZGVudGl0eSJ9LA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEifSwNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuY29tcG9uZW50X2luX3BhdGh9fSJ9LA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTIiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJub2RlMyI6IHsNCiAgICAgICAgICAgICAgICAiaWRlbnRpdHkiOiB7InR5cGUiOiAibWFuYWdlZF9pZGVudGl0eSJ9LA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEifSwNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuY29tcG9uZW50X2luX3BhdGh9fSJ9LA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTMiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfZGVmYXVsdF9waXBlbGluZV9qb2Jfc2VydmljZXMoc2VsZiwgY2xpZW50OiBNTENsaWVudCwgcmFuZHN0cjogQ2FsbGFibGVbW3N0cl0sIHN0cl0pIC0\u002BIE5vbmU6DQogICAgICAgIGNvbXBvbmVudF95YW1sID0gY29tcG9uZW50c19kaXIgLyAiaGVsbG93b3JsZF9jb21wb25lbnQueW1sIg0KICAgICAgICBjb21wb25lbnRfZnVuYzEgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Y29tcG9uZW50X3lhbWwsIHBhcmFtc19vdmVycmlkZT1beyJuYW1lIjogcmFuZHN0cigiY29tcG9uZW50X25hbWUiKX1dKQ0KICAgICAgICBjb21wb25lbnRfZnVuYzIgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Y29tcG9uZW50X3lhbWwsIHBhcmFtc19vdmVycmlkZT1beyJuYW1lIjogcmFuZHN0cigiY29tcG9uZW50X25hbWUiKX1dKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPXJhbmRzdHIoInBpcGVsaW5lX25hbWUiKSwNCiAgICAgICAgICAgIGRlc2NyaXB0aW9uPSJUaGUgaGVsbG8gd29ybGQgcGlwZWxpbmUgam9iIiwNCiAgICAgICAgICAgIHRhZ3M9eyJvd25lciI6ICJzZGt0ZWFtIiwgInRhZyI6ICJ0YWd2YWx1ZSJ9LA0KICAgICAgICAgICAgY29tcHV0ZT0iY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgZXhwZXJpbWVudF9uYW1lPWV4cGVyaW1lbnRfbmFtZSwNCiAgICAgICAgICAgIGNvbnRpbnVlX29uX3N0ZXBfZmFpbHVyZT1UcnVlLA0KICAgICAgICApDQogICAgICAgIGRlZiBwaXBlbGluZShqb2JfaW5fbnVtYmVyLCBqb2JfaW5fb3RoZXJfbnVtYmVyLCBqb2JfaW5fcGF0aCk6DQogICAgICAgICAgICBjb21wb25lbnRfZnVuYzEoY29tcG9uZW50X2luX251bWJlcj1qb2JfaW5fbnVtYmVyLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5fcGF0aCkNCiAgICAgICAgICAgIGNvbXBvbmVudF9mdW5jMihjb21wb25lbnRfaW5fbnVtYmVyPWpvYl9pbl9vdGhlcl9udW1iZXIsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbl9wYXRoKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcGlwZWxpbmUoMTAsIDE1LCBqb2JfaW5wdXQpDQogICAgICAgIGpvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmUpDQogICAgICAgICMgY2hlY2sgcmVxdWlyZWQgZmllbGRzIGluIGpvYiBkaWN0DQogICAgICAgIGRlZmF1bHRfc2VydmljZXMgPSBqb2IuX3RvX2RpY3QoKVsic2VydmljZXMiXQ0KICAgICAgICBhc3NlcnQgIlN0dWRpbyIgaW4gZGVmYXVsdF9zZXJ2aWNlcw0KICAgICAgICBhc3NlcnQgIlRyYWNraW5nIiBpbiBkZWZhdWx0X3NlcnZpY2VzDQogICAgICAgIGFzc2VydCBkZWZhdWx0X3NlcnZpY2VzWyJTdHVkaW8iXVsiZW5kcG9pbnQiXS5zdGFydHN3aXRoKCJodHRwczovL21sLmF6dXJlLmNvbS9ydW5zLyIpDQogICAgICAgIGFzc2VydCBkZWZhdWx0X3NlcnZpY2VzWyJTdHVkaW8iXVsidHlwZSJdID09ICJTdHVkaW8iDQogICAgICAgIGFzc2VydCBkZWZhdWx0X3NlcnZpY2VzWyJUcmFja2luZyJdWyJlbmRwb2ludCJdLnN0YXJ0c3dpdGgoImF6dXJlbWw6Ly8iKQ0KICAgICAgICBhc3NlcnQgZGVmYXVsdF9zZXJ2aWNlc1siVHJhY2tpbmciXVsidHlwZSJdID09ICJUcmFja2luZyINCg0KICAgIGRlZiB0ZXN0X2dyb3VwX291dHB1dHNfZGVzY3JpcHRpb25fb3ZlcndyaXRlKHNlbGYsIGNsaWVudCk6DQogICAgICAgICMgdGVzdCBncm91cCBvdXRwdXRzIGRlc2NyaXB0aW9uIG92ZXJ3cml0ZQ0KICAgICAgICBAZ3JvdXANCiAgICAgICAgY2xhc3MgT3V0cHV0czoNCiAgICAgICAgICAgIG91dHB1dDE6IE91dHB1dCh0eXBlPSJ1cmlfZm9sZGVyIiwgZGVzY3JpcHRpb249Im5ldyBkZXNjcmlwdGlvbiIpDQoNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwgPSAiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPWhlbGxvX3dvcmxkX2NvbXBvbmVudF95YW1sKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoZGVmYXVsdF9jb21wdXRlX3RhcmdldD0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgbXlfcGlwZWxpbmUoKSAtPiBPdXRwdXRzOg0KICAgICAgICAgICAgbm9kZTEgPSBoZWxsb193b3JsZF9jb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPTEsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCiAgICAgICAgICAgIHJldHVybiBPdXRwdXRzKA0KICAgICAgICAgICAgICAgIG91dHB1dDE9bm9kZTEub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gbXlfcGlwZWxpbmUoKQ0KICAgICAgICAjIG92ZXJ3cml0ZSBncm91cCBvdXRwdXRzIG1vZGUgd2lsbCBhcHBlYXIgaW4gcGlwZWxpbmUgam9iJmNvbXBvbmVudCBsZXZlbA0KICAgICAgICBleHBlY3RlZF9vdXRwdXRzID0geyJvdXRwdXQxIjogeyJkZXNjcmlwdGlvbiI6ICJuZXcgZGVzY3JpcHRpb24iLCAidHlwZSI6ICJ1cmlfZm9sZGVyIn19DQogICAgICAgIGV4cGVjdGVkX2pvYl9vdXRwdXRzID0geyJvdXRwdXQxIjogeyJkZXNjcmlwdGlvbiI6ICJuZXcgZGVzY3JpcHRpb24iLCAiam9iX291dHB1dF90eXBlIjogInVyaV9mb2xkZXIifX0NCiAgICAgICAgcmVzdF9qb2JfZGljdCA9IHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCg0KICAgICAgICAjIGFzc2VydCBwaXBlbGluZSBqb2IgbGV2ZWwgbW9kZSBvdmVyd3JpdGUNCiAgICAgICAgYXNzZXJ0IHJlc3Rfam9iX2RpY3RbInByb3BlcnRpZXMiXVsib3V0cHV0cyJdID09IGV4cGVjdGVkX2pvYl9vdXRwdXRzDQogICAgICAgICMgYXNzZXJ0IHBpcGVsaW5lIGNvbXBvbmVudCBsZXZlbCBtb2RlIG92ZXJ3cml0ZQ0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLmNvbXBvbmVudC5fdG9fZGljdCgpWyJvdXRwdXRzIl0gPT0gZXhwZWN0ZWRfb3V0cHV0cw0KDQogICAgICAgIHJlc3Rfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQogICAgICAgIHJlc3Rfam9iX2RpY3QgPSByZXN0X2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgYXNzZXJ0IHJlc3Rfam9iX2RpY3RbInByb3BlcnRpZXMiXVsib3V0cHV0cyJdWyJvdXRwdXQxIl1bImRlc2NyaXB0aW9uIl0gPT0gIm5ldyBkZXNjcmlwdGlvbiINCg0KICAgICAgICBjb21wb25lbnQgPSBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lX2pvYi5jb21wb25lbnQsIF9pc19hbm9ueW1vdXM9VHJ1ZSkNCiAgICAgICAgYXNzZXJ0IGNvbXBvbmVudC5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KClbInByb3BlcnRpZXMiXVsiY29tcG9uZW50X3NwZWMiXVsib3V0cHV0cyJdID09IGV4cGVjdGVkX291dHB1dHMNCg0KICAgIGRlZiB0ZXN0X2dyb3VwX291dHB1dHNfbW9kZV9vdmVyd3JpdGUoc2VsZiwgY2xpZW50KToNCiAgICAgICAgIyB0ZXN0IGdyb3VwIG91dHB1dHMgbW9kZSBvdmVyd3JpdGUNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwgPSAiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPWhlbGxvX3dvcmxkX2NvbXBvbmVudF95YW1sKQ0KDQogICAgICAgIEBncm91cA0KICAgICAgICBjbGFzcyBPdXRwdXRzOg0KICAgICAgICAgICAgb3V0cHV0MTogT3V0cHV0KHR5cGU9InVyaV9mb2xkZXIiLCBtb2RlPSJ1cGxvYWQiKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoZGVmYXVsdF9jb21wdXRlX3RhcmdldD0iY3B1LWNsdXN0ZXIiKQ0KICAgICAgICBkZWYgbXlfcGlwZWxpbmUoKSAtPiBPdXRwdXRzOg0KICAgICAgICAgICAgbm9kZTEgPSBoZWxsb193b3JsZF9jb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPTEsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCiAgICAgICAgICAgIHJldHVybiBPdXRwdXRzKA0KICAgICAgICAgICAgICAgIG91dHB1dDE9bm9kZTEub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gbXlfcGlwZWxpbmUoKQ0KICAgICAgICAjIG92ZXJ3cml0ZSBncm91cCBvdXRwdXRzIG1vZGUgd2lsbCBhcHBlYXIgaW4gcGlwZWxpbmUgam9iJmNvbXBvbmVudCBsZXZlbA0KICAgICAgICBleHBlY3RlZF9qb2Jfb3V0cHV0cyA9IHsib3V0cHV0MSI6IHsibW9kZSI6ICJVcGxvYWQiLCAiam9iX291dHB1dF90eXBlIjogInVyaV9mb2xkZXIifX0NCiAgICAgICAgZXhwZWN0ZWRfb3V0cHV0cyA9IHsib3V0cHV0MSI6IHsibW9kZSI6ICJ1cGxvYWQiLCAidHlwZSI6ICJ1cmlfZm9sZGVyIn19DQogICAgICAgIHJlc3Rfam9iX2RpY3QgPSBwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpDQogICAgICAgICMgYXNzZXJ0IHBpcGVsaW5lIGpvYiBsZXZlbCBtb2RlIG92ZXJ3cml0ZQ0KICAgICAgICBhc3NlcnQgcmVzdF9qb2JfZGljdFsicHJvcGVydGllcyJdWyJvdXRwdXRzIl0gPT0gZXhwZWN0ZWRfam9iX291dHB1dHMNCiAgICAgICAgIyBhc3NlcnQgcGlwZWxpbmUgY29tcG9uZW50IGxldmVsIG1vZGUgb3ZlcndyaXRlDQogICAgICAgIGFzc2VydCBwaXBlbGluZV9qb2IuY29tcG9uZW50Ll90b19kaWN0KClbIm91dHB1dHMiXSA9PSBleHBlY3RlZF9vdXRwdXRzDQoNCiAgICAgICAgcmVzdF9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCiAgICAgICAgcmVzdF9qb2JfZGljdCA9IHJlc3Rfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKQ0KICAgICAgICBhc3NlcnQgcmVzdF9qb2JfZGljdFsicHJvcGVydGllcyJdWyJvdXRwdXRzIl0gPT0gZXhwZWN0ZWRfam9iX291dHB1dHMNCg0KICAgICAgICBjb21wb25lbnQgPSBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lX2pvYi5jb21wb25lbnQsIF9pc19hbm9ueW1vdXM9VHJ1ZSkNCiAgICAgICAgIyBwaXBlbGluZSBjb21wb25lbnQgb3V0cHV0IG1vZGUgaXMgdW5kZWZpbmVkIGJlaGF2aW9yIHNvIHdlIHNraXAgYXNzZXJ0IGl0DQogICAgICAgICMgYXNzZXJ0IGNvbXBvbmVudC5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KClbInByb3BlcnRpZXMiXVsiY29tcG9uZW50X3NwZWMiXVsib3V0cHV0cyJdID09IGV4cGVjdGVkX291dHB1dHMNCg0KICAgIGRlZiB0ZXN0X2xvY2FsX2RhdGFfYXNfbm9kZV9pbnB1dChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X3lhbWwgPSAiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPWhlbGxvX3dvcmxkX2NvbXBvbmVudF95YW1sKQ0KICAgICAgICBsb2NhbF9kYXRhX2lucHV0ID0gSW5wdXQodHlwZT0idXJpX2ZvbGRlciIsIHBhdGg9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2RhdGEiKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIG15X3BpcGVsaW5lKCk6DQogICAgICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPTEsIGNvbXBvbmVudF9pbl9wYXRoPWxvY2FsX2RhdGFfaW5wdXQpDQoNCiAgICAgICAgcGlwZWxpbmVfam9iOiBQaXBlbGluZUpvYiA9IG15X3BpcGVsaW5lKCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCiAgICBAcHl0ZXN0Lm1hcmsuZGlzYWJsZV9tb2NrX2NvZGVfaGFzaA0KICAgIGRlZiB0ZXN0X3JlZ2lzdGVyX291dHB1dF9zZGsoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGZyb20gYXp1cmUuYWkubWwuc3dlZXAgaW1wb3J0ICgNCiAgICAgICAgICAgIEJhbmRpdFBvbGljeSwNCiAgICAgICAgICAgIENob2ljZSwNCiAgICAgICAgICAgIExvZ05vcm1hbCwNCiAgICAgICAgICAgIExvZ1VuaWZvcm0sDQogICAgICAgICAgICBOb3JtYWwsDQogICAgICAgICAgICBRTG9nTm9ybWFsLA0KICAgICAgICAgICAgUUxvZ1VuaWZvcm0sDQogICAgICAgICAgICBRTm9ybWFsLA0KICAgICAgICAgICAgUVVuaWZvcm0sDQogICAgICAgICAgICBSYW5kaW50LA0KICAgICAgICAgICAgVW5pZm9ybSwNCiAgICAgICAgKQ0KDQogICAgICAgIGNvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiKQ0KICAgICAgICBjb21wb25lbnRfaW5wdXQgPSBJbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IikNCiAgICAgICAgc3BhcmtfY29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9zcGFya19jb21wb25lbnQvY29tcG9uZW50LnltbCIpDQogICAgICAgIHBhcmFsbGVsX2NvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL3BhcmFsbGVsX2NvbXBvbmVudF93aXRoX2ZpbGVfaW5wdXQueW1sIg0KICAgICAgICApDQogICAgICAgIHN3ZWVwX2NvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudF9mb3Jfc3dlZXAueW1sIikNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHJlZ2lzdGVyX25vZGVfb3V0cHV0KCk6DQogICAgICAgICAgICBub2RlID0gY29tcG9uZW50KGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbnB1dCkNCiAgICAgICAgICAgIG5vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgubmFtZSA9ICJhX291dHB1dCINCiAgICAgICAgICAgIG5vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgudmVyc2lvbiA9ICIxIg0KDQogICAgICAgICAgICBzcGFya19ub2RlID0gc3BhcmtfY29tcG9uZW50KGZpbGVfaW5wdXQ9Y29tcG9uZW50X2lucHV0KQ0KICAgICAgICAgICAgc3Bhcmtfbm9kZS5jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICAgICAgc3Bhcmtfbm9kZS5vdXRwdXRzLm91dHB1dC5uYW1lID0gInNwYXJrX291dHB1dCINCiAgICAgICAgICAgIHNwYXJrX25vZGUub3V0cHV0cy5vdXRwdXQudmVyc2lvbiA9ICIxIg0KDQogICAgICAgICAgICBwYXJhbGxlbF9ub2RlID0gcGFyYWxsZWxfY29tcG9uZW50KA0KICAgICAgICAgICAgICAgIGpvYl9kYXRhX3BhdGg9SW5wdXQodHlwZT0ibWx0YWJsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IikNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHBhcmFsbGVsX25vZGUub3V0cHV0cy5qb2Jfb3V0cHV0X3BhdGgubmFtZSA9ICJwYXJhbGxlbF9vdXRwdXQiDQogICAgICAgICAgICBwYXJhbGxlbF9ub2RlLm91dHB1dHMuam9iX291dHB1dF9wYXRoLnZlcnNpb24gPSAiMTIzX3BhcmFsbGVsIg0KDQogICAgICAgICAgICBjbWRfbm9kZTEgPSBzd2VlcF9jb21wb25lbnQoDQogICAgICAgICAgICAgICAgYmF0Y2hfc2l6ZT1DaG9pY2UoWzI1LCAzNV0pLA0KICAgICAgICAgICAgICAgIGZpcnN0X2xheWVyX25ldXJvbnM9UmFuZGludCh1cHBlcj01MCksDQogICAgICAgICAgICAgICAgc2Vjb25kX2xheWVyX25ldXJvbnM9UVVuaWZvcm0obWluX3ZhbHVlPTEwLCBtYXhfdmFsdWU9NTAsIHE9NSksDQogICAgICAgICAgICAgICAgdGhpcmRfbGF5ZXJfbmV1cm9ucz1RTG9nTm9ybWFsKG11PTUsIHNpZ21hPTEsIHE9NSksDQogICAgICAgICAgICAgICAgZXBvY2hzPVFMb2dVbmlmb3JtKG1pbl92YWx1ZT0xLCBtYXhfdmFsdWU9NSwgcT01KSwNCiAgICAgICAgICAgICAgICBtb21lbnR1bT1RTm9ybWFsKG11PTEwLCBzaWdtYT01LCBxPTIpLA0KICAgICAgICAgICAgICAgIHdlaWdodF9kZWNheT1Mb2dOb3JtYWwobXU9MCwgc2lnbWE9MSksDQogICAgICAgICAgICAgICAgbGVhcm5pbmdfcmF0ZT1Mb2dVbmlmb3JtKG1pbl92YWx1ZT0tNiwgbWF4X3ZhbHVlPS0xKSwNCiAgICAgICAgICAgICAgICBmMT1Ob3JtYWwobXU9MCwgc2lnbWE9MSksDQogICAgICAgICAgICAgICAgZjI9VW5pZm9ybShtaW5fdmFsdWU9MTAsIG1heF92YWx1ZT0yMCksDQogICAgICAgICAgICAgICAgZGF0YV9mb2xkZXI9SW5wdXQoDQogICAgICAgICAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgICAgICAgICBwYXRoPSJodHRwczovL2RwcmVwZGF0YS5ibG9iLmNvcmUud2luZG93cy5uZXQvZGVtby8iLA0KICAgICAgICAgICAgICAgICAgICBtb2RlPUlucHV0T3V0cHV0TW9kZXMuUk9fTU9VTlQsDQogICAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHN3ZWVwX25vZGUgPSBjbWRfbm9kZTEuc3dlZXAoDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9InZhbGlkYXRpb25fYWNjIiwNCiAgICAgICAgICAgICAgICBnb2FsPSJtYXhpbWl6ZSIsDQogICAgICAgICAgICAgICAgc2FtcGxpbmdfYWxnb3JpdGhtPSJyYW5kb20iLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgc3dlZXBfbm9kZS5jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICAgICAgc3dlZXBfbm9kZS5zZXRfbGltaXRzKG1heF90b3RhbF90cmlhbHM9MiwgbWF4X2NvbmN1cnJlbnRfdHJpYWxzPTMsIHRpbWVvdXQ9NjAwKQ0KICAgICAgICAgICAgc3dlZXBfbm9kZS5lYXJseV90ZXJtaW5hdGlvbiA9IEJhbmRpdFBvbGljeShldmFsdWF0aW9uX2ludGVydmFsPTIsIHNsYWNrX2ZhY3Rvcj0wLjEsIGRlbGF5X2V2YWx1YXRpb249MSkNCiAgICAgICAgICAgIHN3ZWVwX25vZGUub3V0cHV0cy50cmFpbmVkX21vZGVsX2Rpci5uYW1lID0gInN3ZWVwX291dHB1dCINCiAgICAgICAgICAgIHN3ZWVwX25vZGUub3V0cHV0cy50cmFpbmVkX21vZGVsX2Rpci52ZXJzaW9uID0gInN3ZWVwXzIiDQoNCiAgICAgICAgcGlwZWxpbmUgPSByZWdpc3Rlcl9ub2RlX291dHB1dCgpDQogICAgICAgIHBpcGVsaW5lLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJhenVyZW1sOmNwdS1jbHVzdGVyIg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KICAgICAgICBvdXRwdXQgPSBwaXBlbGluZV9qb2Iuam9ic1sibm9kZSJdLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoDQogICAgICAgIGFzc2VydCBvdXRwdXQubmFtZSA9PSAiYV9vdXRwdXQiDQogICAgICAgIGFzc2VydCBvdXRwdXQudmVyc2lvbiA9PSAiMSINCiAgICAgICAgb3V0cHV0ID0gcGlwZWxpbmVfam9iLmpvYnNbInNwYXJrX25vZGUiXS5vdXRwdXRzLm91dHB1dA0KICAgICAgICBhc3NlcnQgb3V0cHV0Lm5hbWUgPT0gInNwYXJrX291dHB1dCINCiAgICAgICAgYXNzZXJ0IG91dHB1dC52ZXJzaW9uID09ICIxIg0KICAgICAgICBvdXRwdXQgPSBwaXBlbGluZV9qb2Iuam9ic1sicGFyYWxsZWxfbm9kZSJdLm91dHB1dHMuam9iX291dHB1dF9wYXRoDQogICAgICAgIGFzc2VydCBvdXRwdXQubmFtZSA9PSAicGFyYWxsZWxfb3V0cHV0Ig0KICAgICAgICBhc3NlcnQgb3V0cHV0LnZlcnNpb24gPT0gIjEyM19wYXJhbGxlbCINCiAgICAgICAgb3V0cHV0ID0gcGlwZWxpbmVfam9iLmpvYnNbInN3ZWVwX25vZGUiXS5vdXRwdXRzLnRyYWluZWRfbW9kZWxfZGlyDQogICAgICAgIGFzc2VydCBvdXRwdXQubmFtZSA9PSAic3dlZXBfb3V0cHV0Ig0KICAgICAgICBhc3NlcnQgb3V0cHV0LnZlcnNpb24gPT0gInN3ZWVwXzIiDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgpDQogICAgICAgIGRlZiByZWdpc3Rlcl9waXBlbGluZV9vdXRwdXQoKToNCiAgICAgICAgICAgIG5vZGUgPSBjb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2lucHV0KQ0KICAgICAgICAgICAgcmV0dXJuIHsicGlwZWluZV9hX291dHB1dCI6IG5vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGh9DQoNCiAgICAgICAgcGlwZWxpbmUgPSByZWdpc3Rlcl9waXBlbGluZV9vdXRwdXQoKQ0KICAgICAgICBwaXBlbGluZS5vdXRwdXRzLnBpcGVpbmVfYV9vdXRwdXQubmFtZSA9ICJhX291dHB1dCINCiAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlaW5lX2Ffb3V0cHV0LnZlcnNpb24gPSAiMSINCiAgICAgICAgcGlwZWxpbmUuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImF6dXJlbWw6Y3B1LWNsdXN0ZXIiDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQogICAgICAgIG91dHB1dCA9IHBpcGVsaW5lX2pvYi5vdXRwdXRzLnBpcGVpbmVfYV9vdXRwdXQNCiAgICAgICAgYXNzZXJ0IG91dHB1dC5uYW1lID09ICJhX291dHB1dCINCiAgICAgICAgYXNzZXJ0IG91dHB1dC52ZXJzaW9uID09ICIxIg0KDQogICAgICAgIEBkc2wucGlwZWxpbmUoKQ0KICAgICAgICBkZWYgcmVnaXN0ZXJfYm90aF9vdXRwdXQoKToNCiAgICAgICAgICAgIG5vZGUgPSBjb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2lucHV0KQ0KICAgICAgICAgICAgbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aC5uYW1lID0gImFfb3V0cHV0Ig0KICAgICAgICAgICAgbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aC52ZXJzaW9uID0gIjEiDQogICAgICAgICAgICByZXR1cm4geyJwaXBlaW5lX2Ffb3V0cHV0Ijogbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH0NCg0KICAgICAgICBwaXBlbGluZSA9IHJlZ2lzdGVyX2JvdGhfb3V0cHV0KCkNCiAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlaW5lX2Ffb3V0cHV0Lm5hbWUgPSAiYl9vdXRwdXQiDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWluZV9hX291dHB1dC52ZXJzaW9uID0gIjIiDQogICAgICAgIHBpcGVsaW5lLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJhenVyZW1sOmNwdS1jbHVzdGVyIg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZSwgY2xpZW50KQ0KDQogICAgICAgIHBpcGVsaW5lX291dHB1dCA9IHBpcGVsaW5lX2pvYi5vdXRwdXRzLnBpcGVpbmVfYV9vdXRwdXQNCiAgICAgICAgYXNzZXJ0IHBpcGVsaW5lX291dHB1dC5uYW1lID09ICJiX291dHB1dCINCiAgICAgICAgYXNzZXJ0IHBpcGVsaW5lX291dHB1dC52ZXJzaW9uID09ICIyIg0KICAgICAgICBub2RlX291dHB1dCA9IHBpcGVsaW5lX2pvYi5qb2JzWyJub2RlIl0ub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgNCiAgICAgICAgYXNzZXJ0IG5vZGVfb3V0cHV0Lm5hbWUgPT0gTm9uZQ0KICAgICAgICBhc3NlcnQgbm9kZV9vdXRwdXQudmVyc2lvbiA9PSBOb25lDQoNCiAgICBkZWYgdGVzdF9kc2xfcGlwZWxpbmVfd2l0aF9kYXRhX3RyYW5zZmVyX2NvcHlfMnVyaWZvbGRlcihzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBmcm9tIHRlc3RfY29uZmlncy5kc2xfcGlwZWxpbmUuZGF0YV90cmFuc2Zlcl9qb2JfaW5fcGlwZWxpbmUuY29weV9kYXRhLnBpcGVsaW5lIGltcG9ydCAoDQogICAgICAgICAgICBnZW5lcmF0ZV9kc2xfcGlwZWxpbmVfZnJvbV95YW1sIGFzIGRhdGFfdHJhbnNmZXJfam9iX2luX3BpcGVsaW5lLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmUgPSBkYXRhX3RyYW5zZmVyX2pvYl9pbl9waXBlbGluZSgpDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZSkNCg0KICAgICAgICBhY3R1YWxfam9iID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5wcm9wZXJ0aWVzLmFzX2RpY3QoKSwgKmNvbW1vbl9vbWl0X2ZpZWxkcykNCg0KICAgICAgICBleHBlY3RlZF9qb2IgPSB7DQogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAic3VibWl0IGEgcGlwZWxpbmUgd2l0aCBkYXRhIHRyYW5zZmVyIGNvcHkgam9iIiwNCiAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgImNvc21vc19mb2xkZXIiOiB7ImpvYl9pbnB1dF90eXBlIjogInVyaV9mb2xkZXIiLCAibW9kZSI6ICJSZWFkT25seU1vdW50In0sDQogICAgICAgICAgICAgICAgImNvc21vc19mb2xkZXJfZHVwIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIiwgIm1vZGUiOiAiUmVhZE9ubHlNb3VudCJ9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJpc19hcmNoaXZlZCI6IEZhbHNlLA0KICAgICAgICAgICAgImpvYl90eXBlIjogIlBpcGVsaW5lIiwNCiAgICAgICAgICAgICJqb2JzIjogew0KICAgICAgICAgICAgICAgICJtZXJnZV9maWxlcyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImRhdGFfY29weV9tb2RlIjogIm1lcmdlX3dpdGhfb3ZlcndyaXRlIiwNCiAgICAgICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJmb2xkZXIxIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuY29zbW9zX2ZvbGRlcn19In0sDQogICAgICAgICAgICAgICAgICAgICAgICAiZm9sZGVyMiI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmNvc21vc19mb2xkZXJfZHVwfX0ifSwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAibWVyZ2VfZmlsZXMiLA0KICAgICAgICAgICAgICAgICAgICAib3V0cHV0cyI6IHsib3V0cHV0X2ZvbGRlciI6IHsidHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5vdXRwdXRzLm1lcmdlZF9ibG9ifX0ifX0sDQogICAgICAgICAgICAgICAgICAgICJ0YXNrIjogImNvcHlfZGF0YSIsDQogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImRhdGFfdHJhbnNmZXIiLA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAib3V0cHV0cyI6IHsibWVyZ2VkX2Jsb2IiOiB7ImpvYl9vdXRwdXRfdHlwZSI6ICJ1cmlfZm9sZGVyIiwgIm1vZGUiOiAiUmVhZFdyaXRlTW91bnQifX0sDQogICAgICAgICAgICAic2V0dGluZ3MiOiB7ImRlZmF1bHRfY29tcHV0ZSI6ICJzZXJ2ZXJsZXNzIn0sDQogICAgICAgICAgICAidGFncyI6IHt9LA0KICAgICAgICB9DQogICAgICAgIGFzc2VydCBleHBlY3RlZF9qb2IgPT0gYWN0dWFsX2pvYg0KDQogICAgZGVmIHRlc3Rfb3V0cHV0X3NldHRpbmdfcGF0aChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KSAtPiBOb25lOg0KICAgICAgICBjb21wb25lbnRfeWFtbCA9IGNvbXBvbmVudHNfZGlyIC8gImhlbGxvd29ybGRfY29tcG9uZW50LnltbCINCiAgICAgICAgY29tcG9uZW50X2Z1bmMxID0gbG9hZF9jb21wb25lbnQoc291cmNlPWNvbXBvbmVudF95YW1sKQ0KDQogICAgICAgICMgY2FzZSAxOiBvbmx5IG5vZGUgbGV2ZWwgaGFzIHNldHRpbmcNCiAgICAgICAgQGRzbC5waXBlbGluZSgpDQogICAgICAgIGRlZiBwaXBlbGluZSgpOg0KICAgICAgICAgICAgbm9kZTEgPSBjb21wb25lbnRfZnVuYzEoY29tcG9uZW50X2luX251bWJlcj0xLCBjb21wb25lbnRfaW5fcGF0aD1qb2JfaW5wdXQpDQogICAgICAgICAgICBub2RlMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aC5wYXRoID0gImF6dXJlbWw6Ly9kYXRhc3RvcmVzL3dvcmtzcGFjZWJsb2JzdG9yZS9wYXRocy9vdXRwdXRzLzEiDQogICAgICAgICAgICByZXR1cm4gbm9kZTEub3V0cHV0cw0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBpcGVsaW5lKCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCiAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQogICAgICAgIGpvYl9kaWN0ID0gcGlwZWxpbmVfam9iLl90b19kaWN0KCkNCiAgICAgICAgZXhwZWN0ZWRfbm9kZV9vdXRwdXRfZGljdCA9IHsNCiAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3BhdGgiOiAiJHt7cGFyZW50Lm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0iLA0KICAgICAgICB9DQogICAgICAgIGV4cGVjdGVkX3BpcGVsaW5lX291dHB1dF9kaWN0ID0gew0KICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAjIGRlZmF1bHQgbW9kZSBhZGRlZCBieSBtdCwgZGVmYXVsdCB0eXBlIGFkZGVkIGJ5IFNESw0KICAgICAgICAgICAgICAgICJtb2RlIjogInJ3X21vdW50IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJ1cmlfZm9sZGVyIiwNCiAgICAgICAgICAgICAgICAjIG5vZGUgbGV2ZWwgY29uZmlnIHdpbGwgYmUgY29waWVkIHRvIHBpcGVsaW5lIGxldmVsDQogICAgICAgICAgICAgICAgInBhdGgiOiAiYXp1cmVtbDovL2RhdGFzdG9yZXMvd29ya3NwYWNlYmxvYnN0b3JlL3BhdGhzL291dHB1dHMvMSIsDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGpvYl9kaWN0WyJqb2JzIl1bIm5vZGUxIl1bIm91dHB1dHMiXSA9PSBleHBlY3RlZF9ub2RlX291dHB1dF9kaWN0DQogICAgICAgIGFzc2VydCBqb2JfZGljdFsib3V0cHV0cyJdID09IGV4cGVjdGVkX3BpcGVsaW5lX291dHB1dF9kaWN0DQoNCiAgICBkZWYgdGVzdF9waXBlbGluZV9jb21wb25lbnRfb3V0cHV0X3NldHRpbmcoc2VsZiwgY2xpZW50OiBNTENsaWVudCkgLT4gTm9uZToNCiAgICAgICAgY29tcG9uZW50X3lhbWwgPSBjb21wb25lbnRzX2RpciAvICJoZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiDQogICAgICAgIGNvbXBvbmVudF9mdW5jMSA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT1jb21wb25lbnRfeWFtbCkNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIGlubmVyX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBub2RlMSA9IGNvbXBvbmVudF9mdW5jMShjb21wb25lbnRfaW5fbnVtYmVyPTEsIGNvbXBvbmVudF9pbl9wYXRoPWpvYl9pbnB1dCkNCiAgICAgICAgICAgIG5vZGUxLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLnBhdGggPSAiYXp1cmVtbDovL2RhdGFzdG9yZXMvd29ya3NwYWNlYmxvYnN0b3JlL3BhdGhzL291dHB1dHMvMSINCiAgICAgICAgICAgICMgbm9kZTEncyBvdXRwdXQgc2V0dGluZyB3aWxsIGJlIGNvcGllZCB0byBwaXBlbGluZSdzIHNldHRpbmcNCiAgICAgICAgICAgIHJldHVybiBub2RlMS5vdXRwdXRzDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgpDQogICAgICAgIGRlZiBvdXRlcl9waXBlbGluZSgpOg0KICAgICAgICAgICAgIyBpbm5lcl9waXBlbGluZSdzIG91dHB1dCBzZXR0aW5nIHdpbGwgYmUgY29waWVkIHRvIG5vZGUxJ3Mgc2V0dGluZw0KICAgICAgICAgICAgbm9kZTEgPSBpbm5lcl9waXBlbGluZSgpDQogICAgICAgICAgICAjIG5vZGUxJ3Mgb3V0cHV0IHNldHRpbmcgd2lsbCBiZSBjb3BpZWQgdG8gcGlwZWxpbmUncyBzZXR0aW5nDQogICAgICAgICAgICByZXR1cm4gbm9kZTEub3V0cHV0cw0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IG91dGVyX3BpcGVsaW5lKCkNCiAgICAgICAgcGlwZWxpbmVfam9iX2RpY3QgPSBwaXBlbGluZV9qb2IuX3RvX2RpY3QoKQ0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iX2RpY3RbIm91dHB1dHMiXSA9PSB7DQogICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogew0KICAgICAgICAgICAgICAgICJwYXRoIjogImF6dXJlbWw6Ly9kYXRhc3RvcmVzL3dvcmtzcGFjZWJsb2JzdG9yZS9wYXRocy9vdXRwdXRzLzEiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogInVyaV9mb2xkZXIiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHBpcGVsaW5lX2NvbXBvbmVudCA9IHBpcGVsaW5lX2pvYi5qb2JzWyJub2RlMSJdLmNvbXBvbmVudA0KICAgICAgICBwaXBlbGluZV9jb21wb25lbnRfZGljdCA9IHBpcGVsaW5lX2NvbXBvbmVudC5fdG9fZGljdCgpDQogICAgICAgIGFzc2VydCBwaXBlbGluZV9jb21wb25lbnRfZGljdFsib3V0cHV0cyJdID09IHsiY29tcG9uZW50X291dF9wYXRoIjogeyJ0eXBlIjogInVyaV9mb2xkZXIifX0NCiAgICAgICAgYXNzZXJ0IHBpcGVsaW5lX2NvbXBvbmVudF9kaWN0WyJqb2JzIl1bIm5vZGUxIl1bIm91dHB1dHMiXSA9PSB7DQogICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogIiR7e3BhcmVudC5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH19Ig0KICAgICAgICB9DQoNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCiAgICAgICAgcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNsaWVudC5qb2JzLmJlZ2luX2NhbmNlbChwaXBlbGluZV9qb2IubmFtZSkNCiAgICAgICAgam9iX2RpY3QgPSBwaXBlbGluZV9qb2IuX3RvX2RpY3QoKQ0KICAgICAgICAjIG91dGVyIHBpcGVsaW5lJ3Mgbm9kZTEgc2hvdWxkIGhhdmUgdGhlIG91dHB1dCBzZXR0aW5nDQogICAgICAgIGFzc2VydCBqb2JfZGljdFsiam9icyJdWyJub2RlMSJdWyJvdXRwdXRzIl0gPT0geyJjb21wb25lbnRfb3V0X3BhdGgiOiAiJHt7cGFyZW50Lm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0ifQ0KICAgICAgICBhc3NlcnQgam9iX2RpY3RbIm91dHB1dHMiXSA9PSB7DQogICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogew0KICAgICAgICAgICAgICAgICJtb2RlIjogInJ3X21vdW50IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJ1cmlfZm9sZGVyIiwNCiAgICAgICAgICAgICAgICAjIG5vZGUgbGV2ZWwgY29uZmlnIHdpbGwgYmUgY29waWVkIHRvIHBpcGVsaW5lIGxldmVsDQogICAgICAgICAgICAgICAgInBhdGgiOiAiYXp1cmVtbDovL2RhdGFzdG9yZXMvd29ya3NwYWNlYmxvYnN0b3JlL3BhdGhzL291dHB1dHMvMSIsDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIEBweXRlc3QubWFyay5kaXNhYmxlX21vY2tfY29kZV9oYXNoDQogICAgZGVmIHRlc3RfcmVnaXN0ZXJfb3V0cHV0X3Nka19zdWNjZWVkKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBjb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIikNCiAgICAgICAgY29tcG9uZW50X2lucHV0ID0gSW5wdXQodHlwZT0idXJpX2ZpbGUiLCBwYXRoPSJodHRwczovL2RwcmVwZGF0YS5ibG9iLmNvcmUud2luZG93cy5uZXQvZGVtby9UaXRhbmljLmNzdiIpDQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgpDQogICAgICAgIGRlZiBzdWJfcGlwZWxpbmUoKToNCiAgICAgICAgICAgIG5vZGUgPSBjb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2lucHV0KQ0KICAgICAgICAgICAgbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aC5uYW1lID0gInN1Yl9waXBlbGluZV9vdXRwdXQiDQogICAgICAgICAgICBub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLnZlcnNpb24gPSAidjEiDQogICAgICAgICAgICByZXR1cm4geyJzdWJfcGlwZWluZV9hX291dHB1dCI6IG5vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGh9DQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgpDQogICAgICAgIGRlZiByZWdpc3Rlcl9ib3RoX291dHB1dCgpOg0KICAgICAgICAgICAgIyByZWdpc3RlciBOb2RlT3V0cHV0IHdoaWNoIGlzIGJpbmRpbmcgdG8gUGlwZWxpbmVPdXRwdXQNCiAgICAgICAgICAgIG5vZGUgPSBjb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2lucHV0KQ0KICAgICAgICAgICAgbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aC5uYW1lID0gIm4xX291dHB1dCINCiAgICAgICAgICAgIG5vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgudmVyc2lvbiA9ICJ2MSINCg0KICAgICAgICAgICAgIyByZWdpc3RlciBOb2RlT3V0cHV0IHdoaWNoIGlzbid0IGJpbmRpbmcgdG8gUGlwZWxpbmVPdXRwdXQNCiAgICAgICAgICAgIG5vZGVfMiA9IGNvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5wdXQpDQogICAgICAgICAgICBub2RlXzIub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgubmFtZSA9ICJuMl9vdXRwdXQiDQogICAgICAgICAgICBub2RlXzIub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgudmVyc2lvbiA9ICJ2MSINCg0KICAgICAgICAgICAgIyByZWdpc3RlciBOb2RlT3V0cHV0IHdpdGhvdXQgdmVyc2lvbiwgaW4gdGhpcyBjYXNlIHRoZSBydW4gcmVzdWx0IGNhbiBiZSByZXVzZWQNCiAgICAgICAgICAgIG5vZGVfMyA9IGNvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5wdXQpDQogICAgICAgICAgICBub2RlXzMub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgubmFtZSA9ICJuM19vdXRwdXQiDQoNCiAgICAgICAgICAgICMgcmVnaXN0ZXIgTm9kZU91dHB1dCBvZiBzdWJncmFwaA0KICAgICAgICAgICAgc3ViX25vZGUgPSBzdWJfcGlwZWxpbmUoKQ0KICAgICAgICAgICAgc3ViX25vZGUub3V0cHV0cy5zdWJfcGlwZWluZV9hX291dHB1dC5uYW1lID0gInN1Yl9waXBlbGluZSINCiAgICAgICAgICAgIHN1Yl9ub2RlLm91dHB1dHMuc3ViX3BpcGVpbmVfYV9vdXRwdXQudmVyc2lvbiA9ICJ2MSINCg0KICAgICAgICAgICAgcmV0dXJuIHsicGlwZWluZV9hX291dHB1dCI6IG5vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGh9DQoNCiAgICAgICAgcGlwZWxpbmUgPSByZWdpc3Rlcl9ib3RoX291dHB1dCgpDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWluZV9hX291dHB1dC5uYW1lID0gInAxX291dHB1dCINCiAgICAgICAgcGlwZWxpbmUub3V0cHV0cy5waXBlaW5lX2Ffb3V0cHV0LnZlcnNpb24gPSAidjEiDQogICAgICAgIHBpcGVsaW5lLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCiAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmUsIGNsaWVudCkNCg0KICAgICAgICBjaGVja19uYW1lX2FuZF92ZXJzaW9uKHBpcGVsaW5lX2pvYi5vdXRwdXRzLnBpcGVpbmVfYV9vdXRwdXQsICJwMV9vdXRwdXQiLCAidjEiKQ0KICAgICAgICBjaGVja19uYW1lX2FuZF92ZXJzaW9uKHBpcGVsaW5lX2pvYi5qb2JzWyJub2RlXzIiXS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwgIm4yX291dHB1dCIsICJ2MSIpDQogICAgICAgIGFzc2VydCBwaXBlbGluZV9qb2Iuam9ic1sibm9kZV8zIl0ub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgubmFtZSA9PSAibjNfb3V0cHV0Ig0KICAgICAgICBjaGVja19uYW1lX2FuZF92ZXJzaW9uKHBpcGVsaW5lX2pvYi5qb2JzWyJzdWJfbm9kZSJdLm91dHB1dHMuc3ViX3BpcGVpbmVfYV9vdXRwdXQsICJzdWJfcGlwZWxpbmUiLCAidjEiKQ0KDQogICAgQHB5dGVzdC5tYXJrLnNraXAocmVhc29uPSJLZXlFcnJvcjogJ25vZGVfMiciKQ0KICAgIEBweXRlc3QubWFyay5kaXNhYmxlX21vY2tfY29kZV9oYXNoDQogICAgZGVmIHRlc3RfcmVnaXN0ZXJfb3V0cHV0X2Zvcl9waXBlbGluZV9jb21wb25lbnQoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGNvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiKQ0KICAgICAgICBjb21wb25lbnRfaW5wdXQgPSBJbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IikNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHN1Yl9waXBlbGluZSgpOg0KICAgICAgICAgICAgbm9kZV8xID0gY29tcG9uZW50KGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbnB1dCkgICMgdGVzdCB1c2UgT3V0cHV0IHRvIGluaXRpYWxpemUgc3ViZ3JhcGguam9icy5vdXRwdXQNCiAgICAgICAgICAgIG5vZGVfMS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCA9IE91dHB1dChuYW1lPSJzdWJfcGlwZWxpbmVfMV9vdXRwdXQiLCB2ZXJzaW9uPSJ2MSIpDQoNCiAgICAgICAgICAgIG5vZGVfMiA9IGNvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5wdXQpICAjIHRlc3Qgd2UgY2FuIHBhc3MgTm9kZU91dHB1dCBpbiBQaXBlbGluZUNvbXBvbmVudA0KICAgICAgICAgICAgbm9kZV8yLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLm5hbWUgPSAic3ViX3BpcGVsaW5lXzJfb3V0cHV0Ig0KICAgICAgICAgICAgbm9kZV8yLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLnZlcnNpb24gPSAidjIiDQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgInN1Yl9ub2RlXzEiOiBub2RlXzEub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICB9DQoNCiAgICAgICAgQGRzbC5waXBlbGluZSgpDQogICAgICAgIGRlZiByZWdpc3Rlcl9ib3RoX291dHB1dCgpOg0KICAgICAgICAgICAgc3ViZ3JhcGggPSBzdWJfcGlwZWxpbmUoKQ0KDQogICAgICAgIHBpcGVsaW5lID0gcmVnaXN0ZXJfYm90aF9vdXRwdXQoKQ0KICAgICAgICBwaXBlbGluZS5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICAgICAgY2hlY2tfbmFtZV9hbmRfdmVyc2lvbihwaXBlbGluZV9qb2Iuam9ic1sic3ViZ3JhcGgiXS5vdXRwdXRzWyJzdWJfbm9kZV8xIl0sICJzdWJfcGlwZWxpbmVfMV9vdXRwdXQiLCAidjEiKQ0KDQogICAgICAgIHN1YmdyYXBoX2lkID0gcGlwZWxpbmVfam9iLmpvYnNbInN1YmdyYXBoIl0uY29tcG9uZW50DQogICAgICAgIHN1YmdyYXBoX2lkID0gc3ViZ3JhcGhfaWQuc3BsaXQoIjoiKQ0KICAgICAgICBzdWJncmFwaCA9IGNsaWVudC5jb21wb25lbnRzLmdldChuYW1lPXN1YmdyYXBoX2lkWzBdLCB2ZXJzaW9uPXN1YmdyYXBoX2lkWzFdKQ0KICAgICAgICAjIFRPRE86IGVuYWJsZSB0aGlzIGNoZWNrIGluIHBsYXliYWNrIG1vZGUgYWZ0ZXIgcGlwZWxpbmVfY29tcG9uZW50LmpvYnMgaXMgb3BlbmVkIGluIGFsbCBzdWJzY3JpcHRpb25zDQogICAgICAgIGlmIGlzX2xpdmUoKToNCiAgICAgICAgICAgIGNoZWNrX25hbWVfYW5kX3ZlcnNpb24oc3ViZ3JhcGguam9ic1sibm9kZV8yIl0ub3V0cHV0c1siY29tcG9uZW50X291dF9wYXRoIl0sICJzdWJfcGlwZWxpbmVfMl9vdXRwdXQiLCAidjIiKQ0KDQogICAgQHB5dGVzdC5tYXJrLmRpc2FibGVfbW9ja19jb2RlX2hhc2gNCiAgICAjIHdpdGhvdXQgdGhpcyBtYXJrLCB0aGUgY29kZSB3b3VsZCBiZSBwYXNzZWQgd2l0aCBkaWZmZXJlbnQgaWQgZXZlbiB3aGVuIHdlIHVwbG9hZCB0aGUgc2FtZSBjb21wb25lbnQsDQogICAgIyBhZGQgdGhpcyBtYXJrIHRvIHJldXNlIG5vZGUgYW5kIGZ1cnRoZXIgcmV1c2UgcGlwZWxpbmUNCiAgICBkZWYgdGVzdF9yZWdpc3Rlcl93aXRoX291dHB1dF9mb3JtYXQoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGNvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiKQ0KICAgICAgICBjb21wb25lbnRfaW5wdXQgPSBJbnB1dCh0eXBlPSJ1cmlfZmlsZSIsIHBhdGg9Imh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IikNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHN1Yl9waXBlbGluZSgpOg0KICAgICAgICAgICAgbm9kZSA9IGNvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5wdXQpDQogICAgICAgICAgICBub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoID0gT3V0cHV0KG5hbWU9InN1Yl9waXBlbGluZV9vX291dHB1dCIsIHZlcnNpb249InYxIikNCiAgICAgICAgICAgIHJldHVybiB7InN1Yl9waXBlaW5lX2Ffb3V0cHV0Ijogbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH0NCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHJlZ2lzdGVyX2JvdGhfb3V0cHV0KCk6DQogICAgICAgICAgICAjIHJlZ2lzdGVyIE5vZGVPdXRwdXQgd2hpY2ggaXMgYmluZGluZyB0byBQaXBlbGluZU91dHB1dA0KICAgICAgICAgICAgbm9kZSA9IGNvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5wdXQpICAjIGJpbmRpbmcgYW5kIHJlLWRlZmluZSBuYW1lIGFuZCB2ZXJzaW9uDQogICAgICAgICAgICBub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoID0gT3V0cHV0KG5hbWU9Im4xX29fb3V0cHV0IiwgdmVyc2lvbj0iMSIpDQoNCiAgICAgICAgICAgIG5vZGVfMiA9IGNvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5wdXQpICAjIGJpbmRpbmcNCiAgICAgICAgICAgIG5vZGVfMi5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCA9IE91dHB1dChuYW1lPSJuMl9vX291dHB1dCIsIHZlcnNpb249IjIiKQ0KDQogICAgICAgICAgICBub2RlXzMgPSBjb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2lucHV0KSAgIyBpc24ndCBiaW5kaW5nDQogICAgICAgICAgICBub2RlXzMub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGggPSBPdXRwdXQobmFtZT0ibjNfb19vdXRwdXQiLCB2ZXJzaW9uPSI0IikNCg0KICAgICAgICAgICAgc3ViX25vZGUgPSBzdWJfcGlwZWxpbmUoKSAgIyB0ZXN0IHNldCBPdXRwdXQgZm9yIFBpcGVsaW5lQ29tcG9uZW50DQogICAgICAgICAgICBzdWJfbm9kZS5vdXRwdXRzLnN1Yl9waXBlaW5lX2Ffb3V0cHV0ID0gT3V0cHV0KG5hbWU9InN1YmdyYXBoX29fb3V0cHV0IiwgdmVyc2lvbj0iMSIpDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICJwaXBlaW5lX2Ffb3V0cHV0Ijogbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgICAgICAicGlwZWluZV9iX291dHB1dCI6IG5vZGVfMi5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgIH0NCg0KICAgICAgICBwaXBlbGluZSA9IHJlZ2lzdGVyX2JvdGhfb3V0cHV0KCkNCiAgICAgICAgcGlwZWxpbmUuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICBwaXBlbGluZS5vdXRwdXRzLnBpcGVpbmVfYV9vdXRwdXQubmFtZSA9ICJucF9vdXRwdXQiDQogICAgICAgIHBpcGVsaW5lLm91dHB1dHMucGlwZWluZV9hX291dHB1dC52ZXJzaW9uID0gIjEiDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQoNCiAgICAgICAgY2hlY2tfbmFtZV9hbmRfdmVyc2lvbihwaXBlbGluZV9qb2Iub3V0cHV0cy5waXBlaW5lX2Ffb3V0cHV0LCAibnBfb3V0cHV0IiwgIjEiKQ0KICAgICAgICBjaGVja19uYW1lX2FuZF92ZXJzaW9uKHBpcGVsaW5lX2pvYi5vdXRwdXRzLnBpcGVpbmVfYl9vdXRwdXQsICJuMl9vX291dHB1dCIsICIyIikNCiAgICAgICAgY2hlY2tfbmFtZV9hbmRfdmVyc2lvbihwaXBlbGluZV9qb2Iuam9ic1sibm9kZV8zIl0ub3V0cHV0c1siY29tcG9uZW50X291dF9wYXRoIl0sICJuM19vX291dHB1dCIsICI0IikNCiAgICAgICAgY2hlY2tfbmFtZV9hbmRfdmVyc2lvbihwaXBlbGluZV9qb2Iuam9ic1sic3ViX25vZGUiXS5vdXRwdXRzWyJzdWJfcGlwZWluZV9hX291dHB1dCJdLCAic3ViZ3JhcGhfb19vdXRwdXQiLCAiMSIpDQoNCiAgICBkZWYgdGVzdF9waXBlbGluZV9pbnB1dF9iaW5kaW5nX2xpbWl0c190aW1lb3V0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBjb21wb25lbnRfeWFtbCA9IHIiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudF9ub19wYXRocy55bWwiDQogICAgICAgIGNvbXBvbmVudF9mdW5jID0gbG9hZF9jb21wb25lbnQoc291cmNlPWNvbXBvbmVudF95YW1sKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIG15X3BpcGVsaW5lKHRpbWVvdXQpIC0\u002BIFBpcGVsaW5lSm9iOg0KICAgICAgICAgICAgIyBjYXNlIDE6IGlmIHRpbWVvdXQgaXMgUGlwZWxpbmVJbnB1dCwgZ2V0IGJpbmRpbmcgZnJvbSByZXNwb25zZQ0KICAgICAgICAgICAgbm9kZV8wID0gY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X2luX251bWJlcj0xKQ0KICAgICAgICAgICAgbm9kZV8wLnNldF9saW1pdHModGltZW91dD10aW1lb3V0KQ0KICAgICAgICAgICAgIyBjYXNlIDI6IGlmIHRpbWVvdXQgaXMgbm90IFBpcGVsaW5lSW5wdXQsIHJlc3BvbnNlIHRpbWVvdXQgd2lsbCBiZSBwYXJzZWQgdG8gaW50DQogICAgICAgICAgICBub2RlXzEgPSBjb21wb25lbnRfZnVuYyhjb21wb25lbnRfaW5fbnVtYmVyPTEpDQogICAgICAgICAgICBub2RlXzEuc2V0X2xpbWl0cyh0aW1lb3V0PTEpDQoNCiAgICAgICAgcGlwZWxpbmUgPSBteV9waXBlbGluZSgyKQ0KICAgICAgICBwaXBlbGluZS5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lLCBjbGllbnQpDQogICAgICAgIGFzc2VydCBwaXBlbGluZV9qb2Iuam9ic1sibm9kZV8wIl0ubGltaXRzLnRpbWVvdXQgPT0gIiR7e3BhcmVudC5pbnB1dHMudGltZW91dH19Ig0KICAgICAgICBhc3NlcnQgcGlwZWxpbmVfam9iLmpvYnNbIm5vZGVfMSJdLmxpbWl0cy50aW1lb3V0ID09IDENCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX2NvbXBvbmVudF9wcmltaXRpdmVfdHlwZV9jb25zdW1wdGlvbihzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgYmFpc2NfY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvcHJpbWl0aXZlX3R5cGVfY29tcG9uZW50cy9iYXNpY19jb21wb25lbnQueW1sIg0KICAgICAgICApDQogICAgICAgIGJvb2xlYW5fZnVuYyA9IGxvYWRfY29tcG9uZW50KCIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvcHJpbWl0aXZlX3R5cGVfY29tcG9uZW50cy9ib29sZWFuLnltbCIpDQogICAgICAgIGludGVnZXJfZnVuYyA9IGxvYWRfY29tcG9uZW50KCIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvcHJpbWl0aXZlX3R5cGVfY29tcG9uZW50cy9pbnRlZ2VyLnltbCIpDQogICAgICAgIG51bWJlcl9mdW5jID0gbG9hZF9jb21wb25lbnQoIi4vdGVzdHMvdGVzdF9jb25maWdzL2RzbF9waXBlbGluZS9wcmltaXRpdmVfdHlwZV9jb21wb25lbnRzL251bWJlci55bWwiKQ0KICAgICAgICBzdHJpbmdfZnVuYyA9IGxvYWRfY29tcG9uZW50KCIuL3Rlc3RzL3Rlc3RfY29uZmlncy9kc2xfcGlwZWxpbmUvcHJpbWl0aXZlX3R5cGVfY29tcG9uZW50cy9zdHJpbmcueW1sIikNCg0KICAgICAgICBAZHNsLnBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV9jb21wb25lbnRfZnVuYyhib29sX3BhcmFtOiBib29sLCBpbnRfcGFyYW06IGludCwgZmxvYXRfcGFyYW06IGZsb2F0LCBzdHJfcGFyYW06IHN0cik6DQogICAgICAgICAgICBiYWlzY19jb21wb25lbnRfZnVuYygNCiAgICAgICAgICAgICAgICBib29sX3BhcmFtPWJvb2xfcGFyYW0sDQogICAgICAgICAgICAgICAgaW50X3BhcmFtPWludF9wYXJhbSwNCiAgICAgICAgICAgICAgICBmbG9hdF9wYXJhbT1mbG9hdF9wYXJhbSwNCiAgICAgICAgICAgICAgICBzdHJfcGFyYW09c3RyX3BhcmFtLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIHBpcGVsaW5lX2Z1bmMoKToNCiAgICAgICAgICAgICMgY29tcG9uZW50cyByZXR1cm4gcHJpbWl0aXZlIHR5cGUgb3V0cHV0cw0KICAgICAgICAgICAgYm9vbF9ub2RlID0gYm9vbGVhbl9mdW5jKCkNCiAgICAgICAgICAgIGludF9ub2RlID0gaW50ZWdlcl9mdW5jKCkNCiAgICAgICAgICAgIGZsb2F0X25vZGUgPSBudW1iZXJfZnVuYygpDQogICAgICAgICAgICBzdHJfbm9kZSA9IHN0cmluZ19mdW5jKCkNCiAgICAgICAgICAgICMgcGlwZWxpbmUgY29tcG9uZW50IGNvbnN1bWUgYWJvdmUgcHJpbWl0aXZlIHR5cGUgb3V0cHV0cw0KICAgICAgICAgICAgcGlwZWxpbmVfbm9kZSA9IHBpcGVsaW5lX2NvbXBvbmVudF9mdW5jKCAgIyBub3FhOiBGODQxDQogICAgICAgICAgICAgICAgYm9vbF9wYXJhbT1ib29sX25vZGUub3V0cHV0cy5vdXRwdXQsDQogICAgICAgICAgICAgICAgaW50X3BhcmFtPWludF9ub2RlLm91dHB1dHMub3V0cHV0LA0KICAgICAgICAgICAgICAgIGZsb2F0X3BhcmFtPWZsb2F0X25vZGUub3V0cHV0cy5vdXRwdXQsDQogICAgICAgICAgICAgICAgc3RyX3BhcmFtPXN0cl9ub2RlLm91dHB1dHMub3V0cHV0LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBpcGVsaW5lX2Z1bmMoKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQogICAgZGVmIHRlc3RfcGlwZWxpbmVfdmFyaWFibGVfbmFtZV91cHBlcmNhc2Uoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGNvbXBvbmVudF95YW1sID0gIi4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIg0KICAgICAgICBjb21wb25lbnRfZnVuYyA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPWNvbXBvbmVudF95YW1sLA0KICAgICAgICApDQoNCiAgICAgICAgQGRzbC5waXBlbGluZShuYW1lPSJwaXBlbGluZV93aXRoX3VwcGVyY2FzZV9ub2RlX25hbWVzIikNCiAgICAgICAgZGVmIHBpcGVsaW5lX3dpdGhfdXNlcl9kZWZpbmVkX25vZGVzXzEoKToNCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDIpOg0KICAgICAgICAgICAgICAgIG5vZGUxID0gY29tcG9uZW50X2Z1bmMoY29tcG9uZW50X2luX3BhdGg9am9iX2lucHV0KQ0KICAgICAgICAgICAgICAgICMgY2hhbmdlIG5vZGUgbmFtZSB0byBsb3dlciB3aGVuIHNldHRpbmcgaXQgdG8gYXZvaWQgdXBwZXIgY2FzZSBpbiBueHRfaW5wdXQncyBiaW5kaW5nDQogICAgICAgICAgICAgICAgbm9kZTEubmFtZSA9IGYiRHVtbXlfe2l9Ig0KICAgICAgICAgICAgICAgIG54dF9pbnB1dCA9IElucHV0KA0KICAgICAgICAgICAgICAgICAgICBwYXRoPW5vZGUxLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgICAgICAgICBtb2RlPUlucHV0T3V0cHV0TW9kZXMuRElSRUNULA0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICBub2RlMiA9IGNvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9wYXRoPW54dF9pbnB1dCkNCiAgICAgICAgICAgICAgICBub2RlMi5uYW1lID0gZiJBbm90aGVyX3tpfSINCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBwaXBlbGluZV93aXRoX3VzZXJfZGVmaW5lZF9ub2Rlc18xKCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCiAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQogICAgICAgIGFjdHVhbF9qb2IgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLnByb3BlcnRpZXMuYXNfZGljdCgpLCAqY29tbW9uX29taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgYWN0dWFsX2pvYlsiam9icyJdID09IHsNCiAgICAgICAgICAgICJhbm90aGVyXzAiOiB7DQogICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiRGlyZWN0IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5kdW1teV8wLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJhbm90aGVyXzAiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJhbm90aGVyXzEiOiB7DQogICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgIm1vZGUiOiAiRGlyZWN0IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5kdW1teV8xLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJhbm90aGVyXzEiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJkdW1teV8wIjogew0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZmlsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICAidXJpIjogImh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiwNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAiZHVtbXlfMCIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImR1bW15XzEiOiB7DQogICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogInVyaV9maWxlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1cmkiOiAiaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJkdW1teV8xIiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3Npbmd1bGFyaXR5X3N0cm9uZ190eXBlX3N1Ym1pc3Npb24oc2VsZiwgY2xpZW50OiBNTENsaWVudCwgbW9ja19zaW5ndWxhcml0eV9hcm1faWQ6IHN0cik6DQogICAgICAgIGNvbXBvbmVudF95YW1sID0gIi4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnRfc2luZ3VsYXJpdHkueW1sIg0KICAgICAgICBjb21wb25lbnRfZnVuYyA9IGxvYWRfY29tcG9uZW50KGNvbXBvbmVudF95YW1sKQ0KDQogICAgICAgIGluc3RhbmNlX3R5cGUgPSAiU2luZ3VsYXJpdHkuTkQ0MHJzX3YyIg0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIHBpcGVsaW5lX2Z1bmMoKToNCiAgICAgICAgICAgICMgYmFzaWMgam9iX3RpZXIgKyBMb3cgcHJpb3JpdHkNCiAgICAgICAgICAgIGJhc2ljX2xvd19ub2RlID0gY29tcG9uZW50X2Z1bmMoKQ0KICAgICAgICAgICAgYmFzaWNfbG93X25vZGUucmVzb3VyY2VzID0gSm9iUmVzb3VyY2VDb25maWd1cmF0aW9uKGluc3RhbmNlX2NvdW50PTIsIGluc3RhbmNlX3R5cGU9aW5zdGFuY2VfdHlwZSkNCiAgICAgICAgICAgIGJhc2ljX2xvd19ub2RlLnF1ZXVlX3NldHRpbmdzID0gUXVldWVTZXR0aW5ncyhqb2JfdGllcj0iYmFzaWMiLCBwcmlvcml0eT0ibG93IikNCiAgICAgICAgICAgICMgc3RhbmRhcmQgam9iX3RpZXIgKyBNZWRpdW0gcHJpb3JpdHkNCiAgICAgICAgICAgIHN0YW5kYXJkX21lZGl1bV9ub2RlID0gY29tcG9uZW50X2Z1bmMoKQ0KICAgICAgICAgICAgc3RhbmRhcmRfbWVkaXVtX25vZGUucmVzb3VyY2VzID0gSm9iUmVzb3VyY2VDb25maWd1cmF0aW9uKGluc3RhbmNlX2NvdW50PTIsIGluc3RhbmNlX3R5cGU9aW5zdGFuY2VfdHlwZSkNCiAgICAgICAgICAgIHN0YW5kYXJkX21lZGl1bV9ub2RlLnF1ZXVlX3NldHRpbmdzID0gUXVldWVTZXR0aW5ncyhqb2JfdGllcj0ic3RhbmRhcmQiLCBwcmlvcml0eT0ibWVkaXVtIikNCiAgICAgICAgICAgICMgcHJlbWl1bSBqb2JfdGllciArIEhpZ2ggcHJpb3JpdHkNCiAgICAgICAgICAgIHByZW1pdW1faGlnaF9ub2RlID0gY29tcG9uZW50X2Z1bmMoKQ0KICAgICAgICAgICAgcHJlbWl1bV9oaWdoX25vZGUucmVzb3VyY2VzID0gSm9iUmVzb3VyY2VDb25maWd1cmF0aW9uKGluc3RhbmNlX2NvdW50PTIsIGluc3RhbmNlX3R5cGU9aW5zdGFuY2VfdHlwZSkNCiAgICAgICAgICAgIHByZW1pdW1faGlnaF9ub2RlLnF1ZXVlX3NldHRpbmdzID0gUXVldWVTZXR0aW5ncyhqb2JfdGllcj0icHJlbWl1bSIsIHByaW9yaXR5PSJoaWdoIikNCiAgICAgICAgICAgICMgcHJvcGVydGllcw0KICAgICAgICAgICAgbm9kZV93aXRoX3Byb3BlcnRpZXMgPSBjb21wb25lbnRfZnVuYygpDQogICAgICAgICAgICBwcm9wZXJ0aWVzID0geyJTaW5ndWxhcml0eSI6IHsiaW1hZ2VWZXJzaW9uIjogIiIsICJpbnRlcmFjdGl2ZSI6IEZhbHNlfX0NCiAgICAgICAgICAgIG5vZGVfd2l0aF9wcm9wZXJ0aWVzLnJlc291cmNlcyA9IEpvYlJlc291cmNlQ29uZmlndXJhdGlvbigNCiAgICAgICAgICAgICAgICBpbnN0YW5jZV9jb3VudD0yLCBpbnN0YW5jZV90eXBlPWluc3RhbmNlX3R5cGUsIHByb3BlcnRpZXM9cHJvcGVydGllcw0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBpcGVsaW5lX2Z1bmMoKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gbW9ja19zaW5ndWxhcml0eV9hcm1faWQNCiAgICAgICAgIyB0aGlzIHBpcGVsaW5lIGpvYiBpcyBleHBlY3RlZCB0byBmYWlsIGFzIFNpbmd1bGFyaXR5IGlzIG1vY2tlZCwgZm9jdXMgb24gUkVTVCBvYmplY3QgYXNzZXJ0aW9uDQogICAgICAgIGNyZWF0ZWRfcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQogICAgICAgIHJlc3Rfb2JqID0gY3JlYXRlZF9waXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkNCiAgICAgICAgYXNzZXJ0IHJlc3Rfb2JqLnByb3BlcnRpZXMuc2V0dGluZ3NbImRlZmF1bHRfY29tcHV0ZSJdID09IG1vY2tfc2luZ3VsYXJpdHlfYXJtX2lkDQogICAgICAgICMgYmFzaWMgam9iX3RpZXIgKyBMb3cgcHJpb3JpdHkNCiAgICAgICAgYmFzaWNfbG93X25vZGVfZGljdCA9IHJlc3Rfb2JqLnByb3BlcnRpZXMuam9ic1siYmFzaWNfbG93X25vZGUiXQ0KICAgICAgICBhc3NlcnQgYmFzaWNfbG93X25vZGVfZGljdFsicXVldWVfc2V0dGluZ3MiXSA9PSB7ImpvYl90aWVyIjogIkJhc2ljIiwgInByaW9yaXR5IjogMX0NCiAgICAgICAgYXNzZXJ0IGJhc2ljX2xvd19ub2RlX2RpY3RbInJlc291cmNlcyJdID09IHsiaW5zdGFuY2VfY291bnQiOiAyLCAiaW5zdGFuY2VfdHlwZSI6IGluc3RhbmNlX3R5cGV9DQogICAgICAgICMgc3RhbmRhcmQgam9iX3RpZXIgKyBNZWRpdW0gcHJpb3JpdHkNCiAgICAgICAgc3RhbmRhcmRfbWVkaXVtX25vZGVfZGljdCA9IHJlc3Rfb2JqLnByb3BlcnRpZXMuam9ic1sic3RhbmRhcmRfbWVkaXVtX25vZGUiXQ0KICAgICAgICBhc3NlcnQgc3RhbmRhcmRfbWVkaXVtX25vZGVfZGljdFsicXVldWVfc2V0dGluZ3MiXSA9PSB7ImpvYl90aWVyIjogIlN0YW5kYXJkIiwgInByaW9yaXR5IjogMn0NCiAgICAgICAgYXNzZXJ0IHN0YW5kYXJkX21lZGl1bV9ub2RlX2RpY3RbInJlc291cmNlcyJdID09IHsiaW5zdGFuY2VfY291bnQiOiAyLCAiaW5zdGFuY2VfdHlwZSI6IGluc3RhbmNlX3R5cGV9DQogICAgICAgICMgcHJlbWl1bSBqb2JfdGllciArIEhpZ2ggcHJpb3JpdHkNCiAgICAgICAgcHJlbWl1bV9oaWdoX25vZGVfZGljdCA9IHJlc3Rfb2JqLnByb3BlcnRpZXMuam9ic1sicHJlbWl1bV9oaWdoX25vZGUiXQ0KICAgICAgICBhc3NlcnQgcHJlbWl1bV9oaWdoX25vZGVfZGljdFsicXVldWVfc2V0dGluZ3MiXSA9PSB7ImpvYl90aWVyIjogIlByZW1pdW0iLCAicHJpb3JpdHkiOiAzfQ0KICAgICAgICBhc3NlcnQgcHJlbWl1bV9oaWdoX25vZGVfZGljdFsicmVzb3VyY2VzIl0gPT0geyJpbnN0YW5jZV9jb3VudCI6IDIsICJpbnN0YW5jZV90eXBlIjogaW5zdGFuY2VfdHlwZX0NCiAgICAgICAgIyBwcm9wZXJ0aWVzDQogICAgICAgIG5vZGVfd2l0aF9wcm9wZXJ0aWVzX2RpY3QgPSByZXN0X29iai5wcm9wZXJ0aWVzLmpvYnNbIm5vZGVfd2l0aF9wcm9wZXJ0aWVzIl0NCiAgICAgICAgYXNzZXJ0IG5vZGVfd2l0aF9wcm9wZXJ0aWVzX2RpY3RbInJlc291cmNlcyJdID09IHsNCiAgICAgICAgICAgICJpbnN0YW5jZV9jb3VudCI6IDIsDQogICAgICAgICAgICAiaW5zdGFuY2VfdHlwZSI6IGluc3RhbmNlX3R5cGUsDQogICAgICAgICAgICAjIHRoZSBtYXBwaW5nIFNpbmd1bGFyaXR5ID0\u002BIEFJU3VwZXJDb21wdXRlciBpcyBleHBlY3RlZA0KICAgICAgICAgICAgInByb3BlcnRpZXMiOiB7IkFJU3VwZXJDb21wdXRlciI6IHsiaW1hZ2VWZXJzaW9uIjogIiIsICJpbnRlcmFjdGl2ZSI6IEZhbHNlfX0sDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3Npbmd1bGFyaXR5X3Byb3BlcnR5X2JhZ19zdWJtaXNzaW9uKHNlbGYsIGNsaWVudDogTUxDbGllbnQsIG1vY2tfc2luZ3VsYXJpdHlfYXJtX2lkOiBzdHIpOg0KICAgICAgICBjb21wb25lbnRfeWFtbCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50X3Npbmd1bGFyaXR5LnltbCINCiAgICAgICAgY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChjb21wb25lbnRfeWFtbCkNCg0KICAgICAgICAjIHByb3BlcnR5IGJhZyBpcyBzdXBwb3J0ZWQsIHdpdGggbG93ZXIgcHJpb3JpdHkgdGhhbiBzdHJvbmcgdHlwZQ0KICAgICAgICB2Y19jb25maWcgPSB7DQogICAgICAgICAgICAiaW5zdGFuY2VfdHlwZSI6ICJTaW5ndWxhcml0eS5ORDQwcnNfdjIiLA0KICAgICAgICAgICAgImluc3RhbmNlX2NvdW50IjogMiwNCiAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAgICAgICAgICJBSVN1cGVyQ29tcHV0ZXIiOiB7DQogICAgICAgICAgICAgICAgICAgICJpbnRlcmFjdGl2ZSI6IEZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAiaW1hZ2VWZXJzaW9uIjogInB5dG9yY2giLA0KICAgICAgICAgICAgICAgICAgICAic2xhVGllciI6ICJQcmVtaXVtIiwNCiAgICAgICAgICAgICAgICAgICAgInRlbnNvcmJvYXJkTG9nRGlyZWN0b3J5IjogIi9zY3JhdGNoL3RlbnNvcmJvYXJkX2xvZ3MiLA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCg0KICAgICAgICBAZHNsLnBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV9mdW5jKCk6DQogICAgICAgICAgICBub2RlID0gY29tcG9uZW50X2Z1bmMoKQ0KICAgICAgICAgICAgbm9kZS5yZXNvdXJjZXMgPSB2Y19jb25maWcNCiAgICAgICAgICAgIG5vZGUuY29tcHV0ZSA9IG1vY2tfc2luZ3VsYXJpdHlfYXJtX2lkDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGlwZWxpbmVfZnVuYygpDQogICAgICAgICMgYXMgU2luZ3VsYXJpdHkgaXMgbW9ja2VkIGFuZCBleHBlY3RlZCB0byBmYWlsIHZhbGlkYXRpb24sIHNraXAgaXQgZm9yIHN1Ym1pc3Npb247DQogICAgICAgICMgdGhlbiBtYW51YWxseSBjYW5jZWwgaXQgYXMgb3RoZXIgdGVzdHMuDQogICAgICAgIGNyZWF0ZWRfcGlwZWxpbmVfam9iID0gY2xpZW50LmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmVfam9iLCBza2lwX3ZhbGlkYXRpb249VHJ1ZSkNCiAgICAgICAgY2xpZW50LmpvYnMuYmVnaW5fY2FuY2VsKGNyZWF0ZWRfcGlwZWxpbmVfam9iLm5hbWUpLnJlc3VsdCgpDQogICAgICAgIHJlc3Rfb2JqID0gY3JlYXRlZF9waXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkNCiAgICAgICAgYXNzZXJ0IHJlc3Rfb2JqLnByb3BlcnRpZXMuam9ic1sibm9kZSJdWyJjb21wdXRlSWQiXSA9PSBtb2NrX3Npbmd1bGFyaXR5X2FybV9pZA0KICAgICAgICBhc3NlcnQgcmVzdF9vYmoucHJvcGVydGllcy5qb2JzWyJub2RlIl1bInJlc291cmNlcyJdID09IHZjX2NvbmZpZw0KDQogICAgQHB5dGVzdC5tYXJrLnNraXBpZihjb25kaXRpb249bm90IGlzX2xpdmUoKSwgcmVhc29uPSJyZWNvcmRpbmcgd2lsbCBleHBvc2UgU2luZ3VsYXJpdHkgaW5mb3JtYXRpb24iKQ0KICAgIGRlZiB0ZXN0X3BpcGVsaW5lX3Npbmd1bGFyaXR5X2xpdmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCwgc2luZ3VsYXJpdHlfdmMpOg0KICAgICAgICAjIGZ1bGwgbmFtZSBhbmQgc2hvcnQgbmFtZSBhcmUgc3ludGF4IHN1Z2FyLCBTREsgd2lsbCByZXNvbHZlIGl0IHRvIFNpbmd1bGFyaXR5IEFSTSBpZCBiZWZvcmUgcmVxdWVzdCwNCiAgICAgICAgIyB0aGlzIG5lZWRzIGNsaWVudCB0byBnZXQgJiBzZWFyY2ggYXZhaWxhYmxlIFZDcyAtIHRoYXQncyB3aHkgd2UgcGxhY2UgdGhpcyB0ZXN0IGluIGVuZC10by1lbmQgdGVzdCAtDQogICAgICAgICMgYW5kIGNvbXB1dGUgdmFsdWVzIGluIHJldHVybmVkIFJFU1Qgb2JqZWN0IHNob3VsZCBhbGwgYmUgQVJNIGlkLg0KICAgICAgICBjb21wb25lbnRfeWFtbCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50X3Npbmd1bGFyaXR5LnltbCINCiAgICAgICAgY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChjb21wb25lbnRfeWFtbCkNCg0KICAgICAgICAjIGdlbmVyYXRlIFNpbmd1bGFyaXR5IEFSTSBpZCwgZnVsbCBuYW1lIGFuZCBzaG9ydCBuYW1lIGZyb20gVkMNCiAgICAgICAgYXJtX2lkID0gU0lOR1VMQVJJVFlfSURfRk9STUFULmZvcm1hdCgNCiAgICAgICAgICAgIHNpbmd1bGFyaXR5X3ZjLnN1YnNjcmlwdGlvbl9pZCwgc2luZ3VsYXJpdHlfdmMucmVzb3VyY2VfZ3JvdXBfbmFtZSwgc2luZ3VsYXJpdHlfdmMubmFtZQ0KICAgICAgICApDQogICAgICAgIGZ1bGxfbmFtZSA9ICJhenVyZW1sOi8vc3Vic2NyaXB0aW9ucy97fS9yZXNvdXJjZUdyb3Vwcy97fS92aXJ0dWFsY2x1c3RlcnMve30iLmZvcm1hdCgNCiAgICAgICAgICAgIHNpbmd1bGFyaXR5X3ZjLnN1YnNjcmlwdGlvbl9pZCwgc2luZ3VsYXJpdHlfdmMucmVzb3VyY2VfZ3JvdXBfbmFtZSwgc2luZ3VsYXJpdHlfdmMubmFtZQ0KICAgICAgICApDQogICAgICAgIHNob3J0X25hbWUgPSBmImF6dXJlbWw6Ly92aXJ0dWFsY2x1c3RlcnMve3Npbmd1bGFyaXR5X3ZjLm5hbWV9Ig0KDQogICAgICAgIEBkc2wucGlwZWxpbmUNCiAgICAgICAgZGVmIHBpcGVsaW5lX2Z1bmMoKToNCiAgICAgICAgICAgIG5vZGVfd2l0aF9pZCA9IGNvbXBvbmVudF9mdW5jKCkNCiAgICAgICAgICAgIG5vZGVfd2l0aF9pZC5jb21wdXRlID0gYXJtX2lkDQogICAgICAgICAgICBub2RlX3dpdGhfZnVsbF9uYW1lID0gY29tcG9uZW50X2Z1bmMoKQ0KICAgICAgICAgICAgbm9kZV93aXRoX2Z1bGxfbmFtZS5jb21wdXRlID0gZnVsbF9uYW1lDQogICAgICAgICAgICBub2RlX3dpdGhfc2hvcnRfbmFtZSA9IGNvbXBvbmVudF9mdW5jKCkNCiAgICAgICAgICAgIG5vZGVfd2l0aF9zaG9ydF9uYW1lLmNvbXB1dGUgPSBzaG9ydF9uYW1lDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGlwZWxpbmVfZnVuYygpDQogICAgICAgIGNyZWF0ZWRfcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQogICAgICAgIHJlc3Rfb2JqID0gY3JlYXRlZF9waXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkNCg0KICAgICAgICBmb3Igbm9kZV9uYW1lIGluIFsibm9kZV93aXRoX2lkIiwgIm5vZGVfd2l0aF9mdWxsX25hbWUiLCAibm9kZV93aXRoX3Nob3J0X25hbWUiXToNCiAgICAgICAgICAgIG5vZGVfY29tcHV0ZSA9IHJlc3Rfb2JqLnByb3BlcnRpZXMuam9ic1tub2RlX25hbWVdWyJjb21wdXRlSWQiXQ0KICAgICAgICAgICAgYXNzZXJ0IGlzX3Npbmd1bGFyaXR5X2lkX2Zvcl9yZXNvdXJjZShub2RlX2NvbXB1dGUpDQogICAgICAgICAgICBhc3NlcnQgbm9kZV9jb21wdXRlLmVuZHN3aXRoKHNpbmd1bGFyaXR5X3ZjLm5hbWUpDQoNCiAgICBkZWYgdGVzdF9hc3NpZ25fdmFsdWVfdG9fdW5rbm93bl9maWxlZChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgcGF0aCA9ICIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCINCiAgICAgICAgY29tcG9uZW50X2Z1bmMgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9cGF0aCkNCiAgICAgICAgIyBEdWUgdG8gaXQgd2lsbCBibG9jayBjaSB3aXRoIHRoZSB0YWdzIG9mIHlhbWwgd2hlbiBnZW5lcmF0aW5nIHJlY29yZHMsIHJlbW92ZSB0aGUgdGFncyBoZXJlLg0KICAgICAgICBjb21wb25lbnRfZnVuYy50YWdzID0ge30NCg0KICAgICAgICBAZHNsLnBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHBpcGVsaW5lX2Z1bmMoaW5wdXQpOg0KICAgICAgICAgICAgbm9kZSA9IGNvbXBvbmVudF9mdW5jKGNvbXBvbmVudF9pbl9wYXRoPWlucHV0KQ0KICAgICAgICAgICAgbm9kZS51bmtub3duX2ZpZWxkID0gaW5wdXQNCg0KICAgICAgICBwaXBlbGluZV9qb2I6IFBpcGVsaW5lSm9iID0gcGlwZWxpbmVfZnVuYyhpbnB1dD1JbnB1dChwYXRoPXBhdGgpKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KICAgICAgICBqb2JfcmVzID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShqb2I9cGlwZWxpbmVfam9iLCBleHBlcmltZW50X25hbWU9InRlc3RfdW5rbm93bl9maWVsZCIpDQogICAgICAgIGFzc2VydCBqb2JfcmVzLmpvYnNbIm5vZGUiXS51bmtub3duX2ZpZWxkID09ICIke3twYXJlbnQuaW5wdXRzLmlucHV0fX0iDQo=",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "Ug0G12c/xbuqiJL9W/isog==",
        "Date": "Wed, 24 May 2023 03:02:49 GMT",
        "ETag": "\u00220x8DB5C035C4340EF\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:50 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "XLYEHupfzts=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_automl_dsl_pipeline.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "34980",
        "Content-MD5": "XXJmP9FfdpyDfqn5dcdM7w==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "ZnJvbSBwYXRobGliIGltcG9ydCBQYXRoDQoNCmltcG9ydCBweWRhc2gNCmltcG9ydCBweXRlc3QNCmZyb20gZGV2dG9vbHNfdGVzdHV0aWxzIGltcG9ydCBBenVyZVJlY29yZGVkVGVzdENhc2UNCmZyb20gdGVzdF91dGlsaXRpZXMudXRpbHMgaW1wb3J0IGNhbmNlbF9qb2INCg0KZnJvbSBhenVyZS5haS5tbCBpbXBvcnQgSW5wdXQsIE1MQ2xpZW50LCBhdXRvbWwsIGRzbCwgT3V0cHV0DQpmcm9tIGF6dXJlLmFpLm1sLmF1dG9tbCBpbXBvcnQgKA0KICAgIGNsYXNzaWZpY2F0aW9uLA0KICAgIGZvcmVjYXN0aW5nLA0KICAgIHJlZ3Jlc3Npb24sDQogICAgdGV4dF9jbGFzc2lmaWNhdGlvbiwNCiAgICB0ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWwsDQogICAgdGV4dF9uZXIsDQopDQpmcm9tIGF6dXJlLmFpLm1sLmNvbnN0YW50cy5fY29tbW9uIGltcG9ydCBBc3NldFR5cGVzDQpmcm9tIGF6dXJlLmFpLm1sLmVudGl0aWVzIGltcG9ydCBQaXBlbGluZUpvYg0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcy5fam9iLmF1dG9tbCBpbXBvcnQgU2VhcmNoU3BhY2UNCmZyb20gYXp1cmUuYWkubWwuZW50aXRpZXMuX2pvYi5hdXRvbWwubmxwIGltcG9ydCBObHBGZWF0dXJpemF0aW9uU2V0dGluZ3MNCmZyb20gYXp1cmUuYWkubWwuZW50aXRpZXMuX2pvYi5hdXRvbWwudGFidWxhciBpbXBvcnQgVGFidWxhckZlYXR1cml6YXRpb25TZXR0aW5ncw0KZnJvbSBhenVyZS5haS5tbC5lbnRpdGllcy5fam9iLmF1dG9tbC50YWJ1bGFyLmZvcmVjYXN0aW5nX3NldHRpbmdzIGltcG9ydCBGb3JlY2FzdGluZ1NldHRpbmdzDQpmcm9tIGF6dXJlLmFpLm1sLnN3ZWVwIGltcG9ydCBCYW5kaXRQb2xpY3ksIENob2ljZSwgVW5pZm9ybQ0KDQp0ZXN0c19yb290X2RpciA9IFBhdGgoX19maWxlX18pLnBhcmVudC5wYXJlbnQucGFyZW50DQoNCiMgZGVjbGFyZSB2YXJpYWJsZXMgZm9yIGNvbXB1dGUsIHNvIHRoYXQgd2UgY2FuIGVhc2lseSBjaGFuZ2UgdGhlbSBsYXRlcg0KQ1BVX0NMVVNURVIgPSAiY3B1LWNsdXN0ZXIiDQpHUFVfQ0xVU1RFUiA9ICJncHUtY2x1c3RlciINCg0KDQpAcHl0ZXN0Lm1hcmsudXNlZml4dHVyZXMoDQogICAgImVuYWJsZV9lbnZpcm9ubWVudF9pZF9hcm1fZXhwYW5zaW9uIiwNCiAgICAiZW5hYmxlX3BpcGVsaW5lX3ByaXZhdGVfcHJldmlld19mZWF0dXJlcyIsDQogICAgIm1vY2tfY29kZV9oYXNoIiwNCiAgICAibW9ja19jb21wb25lbnRfaGFzaCIsDQogICAgIm1vY2tfc2V0X2hlYWRlcnNfd2l0aF91c2VyX2FtbF90b2tlbiIsDQogICAgInJlY29yZGVkX3Rlc3QiLA0KKQ0KQHB5dGVzdC5tYXJrLmF1dG9tbGUyZXRlc3QNCkBweXRlc3QubWFyay5waXBlbGluZV90ZXN0DQpjbGFzcyBUZXN0QXV0b21sRFNMUGlwZWxpbmUoQXp1cmVSZWNvcmRlZFRlc3RDYXNlKToNCiAgICBkZWYgdGVzdF9hdXRvbWxfY2xhc3NpZmljYXRpb25faW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fYXV0b21sX2NsYXNzaWZpY2F0aW9uX2luX3BpcGVsaW5lIikNCiAgICAgICAgZGVmIHRyYWluX2F1dG9tbF9jbGFzc2lmaWNhdGlvbl9pbl9waXBlbGluZSgNCiAgICAgICAgICAgIGNsYXNzX3RyYWluX2RhdGEsDQogICAgICAgICAgICBjbGFzc192YWxpZF9kYXRhLA0KICAgICAgICApOg0KICAgICAgICAgICAgY2xhc3NpZmljYXRpb25fbm9kZSA9IGNsYXNzaWZpY2F0aW9uKA0KICAgICAgICAgICAgICAgIHRyYWluaW5nX2RhdGE9Y2xhc3NfdHJhaW5fZGF0YSwNCiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9Y2xhc3NfdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0ZXN0X2RhdGE9Y2xhc3NfdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9InkiLA0KICAgICAgICAgICAgICAgIHByaW1hcnlfbWV0cmljPSJhY2N1cmFjeSIsDQogICAgICAgICAgICAgICAgZmVhdHVyaXphdGlvbj1UYWJ1bGFyRmVhdHVyaXphdGlvblNldHRpbmdzKG1vZGU9IkF1dG8iKSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGNsYXNzaWZpY2F0aW9uX25vZGUuc2V0X2xpbWl0cyhtYXhfdHJpYWxzPTEpDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlLnNldF90cmFpbmluZyhlbmFibGVfc3RhY2tfZW5zZW1ibGU9RmFsc2UsIGVuYWJsZV92b3RlX2Vuc2VtYmxlPUZhbHNlKQ0KDQogICAgICAgIGNsYXNzX3RyYWluID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9iYW5rX21hcmtldGluZy90cmFpbiIsDQogICAgICAgICkNCiAgICAgICAgY2xhc3NfdmFsaWQgPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD10ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvYXV0b21sX2pvYi90ZXN0X2RhdGFzZXRzL2JhbmtfbWFya2V0aW5nL3ZhbGlkIiwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYjogUGlwZWxpbmVKb2IgPSB0cmFpbl9hdXRvbWxfY2xhc3NpZmljYXRpb25faW5fcGlwZWxpbmUoY2xhc3NfdHJhaW4sIGNsYXNzX3ZhbGlkKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gQ1BVX0NMVVNURVINCg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICBjbGFzc2lmaWNhdGlvbl9kaWN0ID0gcHlkYXNoLm9taXQoYWN0dWFsX2RpY3RbInByb3BlcnRpZXMiXVsiam9icyJdWyJjbGFzc2lmaWNhdGlvbl9ub2RlIl0sIGZpZWxkc190b19vbWl0KQ0KICAgICAgICBhc3NlcnQgY2xhc3NpZmljYXRpb25fZGljdCA9PSB7DQogICAgICAgICAgICAidGVzdF9kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMuY2xhc3NfdmFsaWRfZGF0YX19IiwNCiAgICAgICAgICAgICJ2YWxpZGF0aW9uX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy5jbGFzc192YWxpZF9kYXRhfX0iLA0KICAgICAgICAgICAgInRyYWluaW5nX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy5jbGFzc190cmFpbl9kYXRhfX0iLA0KICAgICAgICAgICAgInRhcmdldF9jb2x1bW5fbmFtZSI6ICJ5IiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJsb2dfdmVyYm9zaXR5IjogImluZm8iLA0KICAgICAgICAgICAgImxpbWl0cyI6IHsibWF4X3RyaWFscyI6IDF9LA0KICAgICAgICAgICAgImZlYXR1cml6YXRpb24iOiB7Im1vZGUiOiAiYXV0byJ9LA0KICAgICAgICAgICAgInRyYWluaW5nIjogeyJlbmFibGVfc3RhY2tfZW5zZW1ibGUiOiBGYWxzZSwgImVuYWJsZV92b3RlX2Vuc2VtYmxlIjogRmFsc2V9LA0KICAgICAgICAgICAgInRhc2siOiAiY2xhc3NpZmljYXRpb24iLA0KICAgICAgICAgICAgInByaW1hcnlfbWV0cmljIjogImFjY3VyYWN5IiwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfcmVnaXN0ZXJfb3V0cHV0X2Zvcl9hdXRvbWxfY2xhc3NpZmljYXRpb24oc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fYXV0b21sX2NsYXNzaWZpY2F0aW9uX2luX3BpcGVsaW5lIikNCiAgICAgICAgZGVmIHRyYWluX2F1dG9tbF9jbGFzc2lmaWNhdGlvbl9pbl9waXBlbGluZSgNCiAgICAgICAgICAgIGNsYXNzX3RyYWluX2RhdGEsDQogICAgICAgICAgICBjbGFzc192YWxpZF9kYXRhLA0KICAgICAgICApOg0KICAgICAgICAgICAgY2xhc3NpZmljYXRpb25fbm9kZSA9IGNsYXNzaWZpY2F0aW9uKA0KICAgICAgICAgICAgICAgIHRyYWluaW5nX2RhdGE9Y2xhc3NfdHJhaW5fZGF0YSwNCiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9Y2xhc3NfdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0ZXN0X2RhdGE9Y2xhc3NfdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9InkiLA0KICAgICAgICAgICAgICAgIHByaW1hcnlfbWV0cmljPSJhY2N1cmFjeSIsDQogICAgICAgICAgICAgICAgZmVhdHVyaXphdGlvbj1UYWJ1bGFyRmVhdHVyaXphdGlvblNldHRpbmdzKG1vZGU9IkF1dG8iKSwNCiAgICAgICAgICAgICAgICBvdXRwdXRzPXsiYmVzdF9tb2RlbCI6IE91dHB1dCh0eXBlPSJtbGZsb3dfbW9kZWwiKX0sDQogICAgICAgICAgICApDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlLnNldF9saW1pdHMobWF4X3RyaWFscz0xKQ0KICAgICAgICAgICAgY2xhc3NpZmljYXRpb25fbm9kZS5zZXRfdHJhaW5pbmcoZW5hYmxlX3N0YWNrX2Vuc2VtYmxlPUZhbHNlLCBlbmFibGVfdm90ZV9lbnNlbWJsZT1GYWxzZSkNCiAgICAgICAgICAgIGNsYXNzaWZpY2F0aW9uX25vZGUub3V0cHV0c1siYmVzdF9tb2RlbCJdLm5hbWUgPSAiY2xhc3NpZmljYXRpb25fb3V0cHV0X25hbWUiDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlLm91dHB1dHNbImJlc3RfbW9kZWwiXS52ZXJzaW9uID0gIjEiDQoNCiAgICAgICAgICAgIGNsYXNzaWZpY2F0aW9uX25vZGVfMiA9IGNsYXNzaWZpY2F0aW9uKCAgIyBiaW5kaW5nIHRvIHBpcGVsaW5lIG91dHB1dA0KICAgICAgICAgICAgICAgIHRyYWluaW5nX2RhdGE9Y2xhc3NfdHJhaW5fZGF0YSwNCiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9Y2xhc3NfdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0ZXN0X2RhdGE9Y2xhc3NfdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9InkiLA0KICAgICAgICAgICAgICAgIHByaW1hcnlfbWV0cmljPSJhY2N1cmFjeSIsDQogICAgICAgICAgICAgICAgZmVhdHVyaXphdGlvbj1UYWJ1bGFyRmVhdHVyaXphdGlvblNldHRpbmdzKG1vZGU9IkF1dG8iKSwNCiAgICAgICAgICAgICAgICBvdXRwdXRzPXsiYmVzdF9tb2RlbCI6IE91dHB1dCh0eXBlPSJtbGZsb3dfbW9kZWwiKX0sDQogICAgICAgICAgICApDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlXzIuc2V0X2xpbWl0cyhtYXhfdHJpYWxzPTEpDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlXzIuc2V0X3RyYWluaW5nKGVuYWJsZV9zdGFja19lbnNlbWJsZT1GYWxzZSwgZW5hYmxlX3ZvdGVfZW5zZW1ibGU9RmFsc2UpDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlXzIub3V0cHV0c1siYmVzdF9tb2RlbCJdLm5hbWUgPSAiY2xhc3NpZmljYXRpb25fb3V0cHV0X25hbWUiDQogICAgICAgICAgICBjbGFzc2lmaWNhdGlvbl9ub2RlXzIub3V0cHV0c1siYmVzdF9tb2RlbCJdLnZlcnNpb24gPSAiMiINCg0KICAgICAgICAgICAgcmV0dXJuIHsiY2xhc3NpZmljYXRpb25fMl9vdXRwdXQiOiBjbGFzc2lmaWNhdGlvbl9ub2RlXzIub3V0cHV0cy5iZXN0X21vZGVsfQ0KDQogICAgICAgIGNsYXNzX3RyYWluID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9iYW5rX21hcmtldGluZy90cmFpbiIsDQogICAgICAgICkNCiAgICAgICAgY2xhc3NfdmFsaWQgPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD10ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvYXV0b21sX2pvYi90ZXN0X2RhdGFzZXRzL2JhbmtfbWFya2V0aW5nL3ZhbGlkIiwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYjogUGlwZWxpbmVKb2IgPSB0cmFpbl9hdXRvbWxfY2xhc3NpZmljYXRpb25faW5fcGlwZWxpbmUoY2xhc3NfdHJhaW4sIGNsYXNzX3ZhbGlkKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gQ1BVX0NMVVNURVINCg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICBjbGFzc2lmaWNhdGlvbl9kaWN0ID0gcHlkYXNoLm9taXQoYWN0dWFsX2RpY3RbInByb3BlcnRpZXMiXVsiam9icyJdWyJjbGFzc2lmaWNhdGlvbl9ub2RlIl0sIGZpZWxkc190b19vbWl0KQ0KICAgICAgICBhc3NlcnQgY2xhc3NpZmljYXRpb25fZGljdCA9PSB7DQogICAgICAgICAgICAidGVzdF9kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMuY2xhc3NfdmFsaWRfZGF0YX19IiwNCiAgICAgICAgICAgICJ2YWxpZGF0aW9uX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy5jbGFzc192YWxpZF9kYXRhfX0iLA0KICAgICAgICAgICAgInRyYWluaW5nX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy5jbGFzc190cmFpbl9kYXRhfX0iLA0KICAgICAgICAgICAgInRhcmdldF9jb2x1bW5fbmFtZSI6ICJ5IiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7DQogICAgICAgICAgICAgICAgImJlc3RfbW9kZWwiOiB7ImpvYl9vdXRwdXRfdHlwZSI6ICJtbGZsb3dfbW9kZWwiLCAibmFtZSI6ICJjbGFzc2lmaWNhdGlvbl9vdXRwdXRfbmFtZSIsICJ2ZXJzaW9uIjogIjEifQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJsb2dfdmVyYm9zaXR5IjogImluZm8iLA0KICAgICAgICAgICAgImxpbWl0cyI6IHsibWF4X3RyaWFscyI6IDF9LA0KICAgICAgICAgICAgImZlYXR1cml6YXRpb24iOiB7Im1vZGUiOiAiYXV0byJ9LA0KICAgICAgICAgICAgInRyYWluaW5nIjogeyJlbmFibGVfc3RhY2tfZW5zZW1ibGUiOiBGYWxzZSwgImVuYWJsZV92b3RlX2Vuc2VtYmxlIjogRmFsc2V9LA0KICAgICAgICAgICAgInRhc2siOiAiY2xhc3NpZmljYXRpb24iLA0KICAgICAgICAgICAgInByaW1hcnlfbWV0cmljIjogImFjY3VyYWN5IiwNCiAgICAgICAgfQ0KDQogICAgICAgIGNsYXNzaWZpY2F0aW9uX2RpY3QgPSBweWRhc2gub21pdCgNCiAgICAgICAgICAgIGFjdHVhbF9kaWN0WyJwcm9wZXJ0aWVzIl1bIm91dHB1dHMiXVsiY2xhc3NpZmljYXRpb25fMl9vdXRwdXQiXSwgZmllbGRzX3RvX29taXQNCiAgICAgICAgKQ0KICAgICAgICBhc3NlcnQgY2xhc3NpZmljYXRpb25fZGljdCA9PSB7DQogICAgICAgICAgICAiYXNzZXRfbmFtZSI6ICJjbGFzc2lmaWNhdGlvbl9vdXRwdXRfbmFtZSIsDQogICAgICAgICAgICAiYXNzZXRfdmVyc2lvbiI6ICIyIiwNCiAgICAgICAgICAgICJqb2Jfb3V0cHV0X3R5cGUiOiAibWxmbG93X21vZGVsIiwNCiAgICAgICAgICAgICJtb2RlIjogIlJlYWRXcml0ZU1vdW50IiwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfYXV0b21sX3JlZ3Jlc3Npb25faW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fYXV0b21sX3JlZ3Jlc3Npb25faW5fcGlwZWxpbmUiKQ0KICAgICAgICBkZWYgdHJhaW5fYXV0b21sX3JlZ3Jlc3Npb25faW5fcGlwZWxpbmUocmVncmVzc2lvbl90cmFpbl9kYXRhKToNCiAgICAgICAgICAgIHJlZ3Jlc3Npb25fbm9kZSA9IHJlZ3Jlc3Npb24oDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9InIyX3Njb3JlIiwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9IkVSUCIsDQogICAgICAgICAgICAgICAgdHJhaW5pbmdfZGF0YT1yZWdyZXNzaW9uX3RyYWluX2RhdGEsDQogICAgICAgICAgICApDQogICAgICAgICAgICByZWdyZXNzaW9uX25vZGUuc2V0X2xpbWl0cyhtYXhfdHJpYWxzPTEpDQogICAgICAgICAgICByZWdyZXNzaW9uX25vZGUuc2V0X3RyYWluaW5nKGVuYWJsZV9zdGFja19lbnNlbWJsZT1GYWxzZSwgZW5hYmxlX3ZvdGVfZW5zZW1ibGU9RmFsc2UpDQogICAgICAgICAgICByZWdyZXNzaW9uX25vZGUuc2V0X2ZlYXR1cml6YXRpb24obW9kZT0iYXV0byIpDQoNCiAgICAgICAgcmVncmVzc2lvbl90cmFpbiA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvbWFjaGluZV9kYXRhL3RyYWluIiwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYjogUGlwZWxpbmVKb2IgPSB0cmFpbl9hdXRvbWxfcmVncmVzc2lvbl9pbl9waXBlbGluZShyZWdyZXNzaW9uX3RyYWluKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gQ1BVX0NMVVNURVINCg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICByZWdyZXNzaW9uX2RpY3QgPSBweWRhc2gub21pdChhY3R1YWxfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bInJlZ3Jlc3Npb25fbm9kZSJdLCBmaWVsZHNfdG9fb21pdCkNCiAgICAgICAgYXNzZXJ0IHJlZ3Jlc3Npb25fZGljdCA9PSB7DQogICAgICAgICAgICAidHJhaW5pbmdfZGF0YSI6ICIke3twYXJlbnQuaW5wdXRzLnJlZ3Jlc3Npb25fdHJhaW5fZGF0YX19IiwNCiAgICAgICAgICAgICJ0YXJnZXRfY29sdW1uX25hbWUiOiAiRVJQIiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJsb2dfdmVyYm9zaXR5IjogImluZm8iLA0KICAgICAgICAgICAgImxpbWl0cyI6IHsibWF4X3RyaWFscyI6IDF9LA0KICAgICAgICAgICAgImZlYXR1cml6YXRpb24iOiB7Im1vZGUiOiAiYXV0byJ9LA0KICAgICAgICAgICAgInRyYWluaW5nIjogeyJlbmFibGVfc3RhY2tfZW5zZW1ibGUiOiBGYWxzZSwgImVuYWJsZV92b3RlX2Vuc2VtYmxlIjogRmFsc2V9LA0KICAgICAgICAgICAgInRhc2siOiAicmVncmVzc2lvbiIsDQogICAgICAgICAgICAicHJpbWFyeV9tZXRyaWMiOiAicjJfc2NvcmUiLA0KICAgICAgICB9DQoNCiAgICBkZWYgdGVzdF9hdXRvbWxfZm9yZWNhc3RpbmdfaW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fd2l0aF9hdXRvbWxfaW5fcGlwZWxpbmUiKQ0KICAgICAgICBkZWYgdHJhaW5fYXV0b21sX2ZvcmVjYXN0aW5nX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgZm9yZWNhc3RpbmdfdHJhaW5fZGF0YSwNCiAgICAgICAgKToNCiAgICAgICAgICAgIGZvcmVjYXN0aW5nX3NldHRpbmdzID0gRm9yZWNhc3RpbmdTZXR0aW5ncyh0aW1lX2NvbHVtbl9uYW1lPSJEQVRFIiwgZm9yZWNhc3RfaG9yaXpvbj0xMiwgZnJlcXVlbmN5PSJNUyIpDQoNCiAgICAgICAgICAgIGZvcmVjYXN0aW5nX25vZGUgPSBmb3JlY2FzdGluZygNCiAgICAgICAgICAgICAgICBwcmltYXJ5X21ldHJpYz0ibm9ybWFsaXplZF9yb290X21lYW5fc3F1YXJlZF9lcnJvciIsDQogICAgICAgICAgICAgICAgdGFyZ2V0X2NvbHVtbl9uYW1lPSJCZWVyUHJvZHVjdGlvbiIsDQogICAgICAgICAgICAgICAgdHJhaW5pbmdfZGF0YT1mb3JlY2FzdGluZ190cmFpbl9kYXRhLA0KICAgICAgICAgICAgICAgIG5fY3Jvc3NfdmFsaWRhdGlvbnM9MiwNCiAgICAgICAgICAgICAgICBmb3JlY2FzdGluZ19zZXR0aW5ncz1mb3JlY2FzdGluZ19zZXR0aW5ncywNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGZvcmVjYXN0aW5nX25vZGUuc2V0X2xpbWl0cyhtYXhfdHJpYWxzPTEpDQogICAgICAgICAgICBmb3JlY2FzdGluZ19ub2RlLnNldF90cmFpbmluZyhlbmFibGVfc3RhY2tfZW5zZW1ibGU9RmFsc2UsIGVuYWJsZV92b3RlX2Vuc2VtYmxlPUZhbHNlKQ0KICAgICAgICAgICAgZm9yZWNhc3Rpbmdfbm9kZS5zZXRfZmVhdHVyaXphdGlvbihtb2RlPSJhdXRvIikNCg0KICAgICAgICBmb3JlY2FzdGluZ190cmFpbiA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvYmVlcl9mb3JlY2FzdGluZy90cmFpbiIsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZV9qb2I6IFBpcGVsaW5lSm9iID0gdHJhaW5fYXV0b21sX2ZvcmVjYXN0aW5nX2luX3BpcGVsaW5lKGZvcmVjYXN0aW5nX3RyYWluX2RhdGE9Zm9yZWNhc3RpbmdfdHJhaW4pDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSBDUFVfQ0xVU1RFUg0KDQogICAgICAgIGZyb21fcmVzdF9waXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lX2pvYikNCiAgICAgICAgY2FuY2VsX2pvYihjbGllbnQsIGZyb21fcmVzdF9waXBlbGluZV9qb2IpDQoNCiAgICAgICAgYWN0dWFsX2RpY3QgPSBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKQ0KICAgICAgICBmaWVsZHNfdG9fb21pdCA9IFsibmFtZSIsICJkaXNwbGF5X25hbWUiLCAiZXhwZXJpbWVudF9uYW1lIiwgInByb3BlcnRpZXMiXQ0KDQogICAgICAgIGZvcmVjYXN0aW5nX2RpY3QgPSBweWRhc2gub21pdChhY3R1YWxfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bImZvcmVjYXN0aW5nX25vZGUiXSwgZmllbGRzX3RvX29taXQpDQogICAgICAgIGFzc2VydCBmb3JlY2FzdGluZ19kaWN0ID09IHsNCiAgICAgICAgICAgICJ0cmFpbmluZ19kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMuZm9yZWNhc3RpbmdfdHJhaW5fZGF0YX19IiwNCiAgICAgICAgICAgICJuX2Nyb3NzX3ZhbGlkYXRpb25zIjogMiwNCiAgICAgICAgICAgICJ0YXJnZXRfY29sdW1uX25hbWUiOiAiQmVlclByb2R1Y3Rpb24iLA0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJ0eXBlIjogImF1dG9tbCIsDQogICAgICAgICAgICAib3V0cHV0cyI6IHt9LA0KICAgICAgICAgICAgImxvZ192ZXJib3NpdHkiOiAiaW5mbyIsDQogICAgICAgICAgICAibGltaXRzIjogeyJtYXhfdHJpYWxzIjogMX0sDQogICAgICAgICAgICAiZmVhdHVyaXphdGlvbiI6IHsibW9kZSI6ICJhdXRvIn0sDQogICAgICAgICAgICAidHJhaW5pbmciOiB7ImVuYWJsZV9zdGFja19lbnNlbWJsZSI6IEZhbHNlLCAiZW5hYmxlX3ZvdGVfZW5zZW1ibGUiOiBGYWxzZX0sDQogICAgICAgICAgICAidGFzayI6ICJmb3JlY2FzdGluZyIsDQogICAgICAgICAgICAiZm9yZWNhc3RpbmciOiB7ImZvcmVjYXN0X2hvcml6b24iOiAxMiwgInRpbWVfY29sdW1uX25hbWUiOiAiREFURSIsICJmcmVxdWVuY3kiOiAiTVMifSwNCiAgICAgICAgICAgICJwcmltYXJ5X21ldHJpYyI6ICJub3JtYWxpemVkX3Jvb3RfbWVhbl9zcXVhcmVkX2Vycm9yIiwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfYXV0b21sX3RleHRfY2xhc3NpZmljYXRpb25faW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fYXV0b21sX3RleHRfY2xhc3NfaW5fcGlwZWxpbmUiKQ0KICAgICAgICBkZWYgdHJhaW5fYXV0b21sX3RleHRfY2xhc3NfaW5fcGlwZWxpbmUoDQogICAgICAgICAgICB0ZXh0X2NsYXNzaWZpY2F0aW9uX3RyYWluLA0KICAgICAgICAgICAgdGV4dF9jbGFzc2lmaWNhdGlvbl92YWxpZCwNCiAgICAgICAgKToNCiAgICAgICAgICAgIHRleHRfY2xhc3NpZmljYXRpb25fbm9kZSA9IHRleHRfY2xhc3NpZmljYXRpb24oDQogICAgICAgICAgICAgICAgdHJhaW5pbmdfZGF0YT10ZXh0X2NsYXNzaWZpY2F0aW9uX3RyYWluLA0KICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fZGF0YT10ZXh0X2NsYXNzaWZpY2F0aW9uX3ZhbGlkLA0KICAgICAgICAgICAgICAgIHRhcmdldF9jb2x1bW5fbmFtZT0ieSIsDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9ImFjY3VyYWN5IiwNCiAgICAgICAgICAgICAgICBmZWF0dXJpemF0aW9uPU5scEZlYXR1cml6YXRpb25TZXR0aW5ncyhkYXRhc2V0X2xhbmd1YWdlPSJlbmciKSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHRleHRfY2xhc3NpZmljYXRpb25fbm9kZS5zZXRfbGltaXRzKG1heF9jb25jdXJyZW50X3RyaWFscz0xKQ0KDQogICAgICAgIHRleHRfY2xhc3NpZmljYXRpb25fdHJhaW4gPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD10ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvYXV0b21sX2pvYi90ZXN0X2RhdGFzZXRzL25ld3Nncm91cC90cmFpbiIsDQogICAgICAgICkNCiAgICAgICAgdGV4dF9jbGFzc2lmaWNhdGlvbl92YWxpZCA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvbmV3c2dyb3VwL3ZhbGlkIiwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYjogUGlwZWxpbmVKb2IgPSB0cmFpbl9hdXRvbWxfdGV4dF9jbGFzc19pbl9waXBlbGluZSgNCiAgICAgICAgICAgIHRleHRfY2xhc3NpZmljYXRpb25fdHJhaW4sIHRleHRfY2xhc3NpZmljYXRpb25fdmFsaWQNCiAgICAgICAgKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gR1BVX0NMVVNURVINCiAgICAgICAgZnJvbV9yZXN0X3BpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmVfam9iKQ0KICAgICAgICBjYW5jZWxfam9iKGNsaWVudCwgZnJvbV9yZXN0X3BpcGVsaW5lX2pvYikNCg0KICAgICAgICBhY3R1YWxfZGljdCA9IGZyb21fcmVzdF9waXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpDQogICAgICAgIGZpZWxkc190b19vbWl0ID0gWyJuYW1lIiwgImRpc3BsYXlfbmFtZSIsICJleHBlcmltZW50X25hbWUiLCAicHJvcGVydGllcyJdDQoNCiAgICAgICAgam9iX2RpY3QgPSBweWRhc2gub21pdChhY3R1YWxfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bInRleHRfY2xhc3NpZmljYXRpb25fbm9kZSJdLCBmaWVsZHNfdG9fb21pdCkNCiAgICAgICAgYXNzZXJ0IGpvYl9kaWN0ID09IHsNCiAgICAgICAgICAgICJ0cmFpbmluZ19kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMudGV4dF9jbGFzc2lmaWNhdGlvbl90cmFpbn19IiwNCiAgICAgICAgICAgICJ2YWxpZGF0aW9uX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy50ZXh0X2NsYXNzaWZpY2F0aW9uX3ZhbGlkfX0iLA0KICAgICAgICAgICAgInRhcmdldF9jb2x1bW5fbmFtZSI6ICJ5IiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJsaW1pdHMiOiB7Im1heF90cmlhbHMiOiAxLCAibWF4X25vZGVzIjogMSwgIm1heF9jb25jdXJyZW50X3RyaWFscyI6IDF9LA0KICAgICAgICAgICAgImZlYXR1cml6YXRpb24iOiB7ImRhdGFzZXRfbGFuZ3VhZ2UiOiAiZW5nIn0sDQogICAgICAgICAgICAidGFzayI6ICJ0ZXh0X2NsYXNzaWZpY2F0aW9uIiwNCiAgICAgICAgICAgICJwcmltYXJ5X21ldHJpYyI6ICJhY2N1cmFjeSIsDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X2F1dG9tbF90ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWxfaW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fYXV0b21sX3RleHRfY2xhc3NfbXVsdGlsYWJlbF9pbl9waXBlbGluZSIpDQogICAgICAgIGRlZiB0cmFpbl9hdXRvbWxfdGV4dF9jbGFzc19tdWx0aWxhYmVsX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgdGV4dF9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsX3RyYWluLA0KICAgICAgICAgICAgdGV4dF9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsX3ZhbGlkLA0KICAgICAgICApOg0KICAgICAgICAgICAgdGV4dF9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsX25vZGUgPSB0ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWwoDQogICAgICAgICAgICAgICAgdHJhaW5pbmdfZGF0YT10ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWxfdHJhaW4sDQogICAgICAgICAgICAgICAgdmFsaWRhdGlvbl9kYXRhPXRleHRfY2xhc3NpZmljYXRpb25fbXVsdGlsYWJlbF92YWxpZCwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9InRlcm1zIiwNCiAgICAgICAgICAgICAgICBwcmltYXJ5X21ldHJpYz0iYWNjdXJhY3kiLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgdGV4dF9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsX25vZGUuc2V0X2xpbWl0cyhtYXhfY29uY3VycmVudF90cmlhbHM9MSkNCg0KICAgICAgICB0ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWxfdHJhaW4gPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD10ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvYXV0b21sX2pvYi90ZXN0X2RhdGFzZXRzL3BhcGVyX2NhdGVnb3JpemF0aW9uL3RyYWluIiwNCiAgICAgICAgKQ0KDQogICAgICAgIHRleHRfY2xhc3NpZmljYXRpb25fbXVsdGlsYWJlbF92YWxpZCA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvcGFwZXJfY2F0ZWdvcml6YXRpb24vdmFsaWQiLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmVfam9iOiBQaXBlbGluZUpvYiA9IHRyYWluX2F1dG9tbF90ZXh0X2NsYXNzX211bHRpbGFiZWxfaW5fcGlwZWxpbmUoDQogICAgICAgICAgICB0ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWxfdHJhaW4sIHRleHRfY2xhc3NpZmljYXRpb25fbXVsdGlsYWJlbF92YWxpZA0KICAgICAgICApDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSBHUFVfQ0xVU1RFUg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICBqb2JfZGljdCA9IHB5ZGFzaC5vbWl0KGFjdHVhbF9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXVsidGV4dF9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsX25vZGUiXSwgZmllbGRzX3RvX29taXQpDQogICAgICAgIGFzc2VydCBqb2JfZGljdCA9PSB7DQogICAgICAgICAgICAidHJhaW5pbmdfZGF0YSI6ICIke3twYXJlbnQuaW5wdXRzLnRleHRfY2xhc3NpZmljYXRpb25fbXVsdGlsYWJlbF90cmFpbn19IiwNCiAgICAgICAgICAgICJ2YWxpZGF0aW9uX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy50ZXh0X2NsYXNzaWZpY2F0aW9uX211bHRpbGFiZWxfdmFsaWR9fSIsDQogICAgICAgICAgICAidGFyZ2V0X2NvbHVtbl9uYW1lIjogInRlcm1zIiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJsaW1pdHMiOiB7Im1heF90cmlhbHMiOiAxLCAibWF4X25vZGVzIjogMSwgIm1heF9jb25jdXJyZW50X3RyaWFscyI6IDF9LA0KICAgICAgICAgICAgInRhc2siOiAidGV4dF9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsIiwNCiAgICAgICAgICAgICJwcmltYXJ5X21ldHJpYyI6ICJhY2N1cmFjeSIsDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X2F1dG9tbF90ZXh0X25lcl9pbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgQGRzbC5waXBlbGluZShuYW1lPSJ0cmFpbl9hdXRvbWxfdGV4dF9uZXJfaW5fcGlwZWxpbmUiKQ0KICAgICAgICBkZWYgdHJhaW5fYXV0b21sX3RleHRfbmVyX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgdGV4dF9uZXJfdHJhaW4sDQogICAgICAgICAgICB0ZXh0X25lcl92YWxpZCwNCiAgICAgICAgKToNCiAgICAgICAgICAgIHRleHRfbmVyX25vZGUgPSB0ZXh0X25lcigNCiAgICAgICAgICAgICAgICB0cmFpbmluZ19kYXRhPXRleHRfbmVyX3RyYWluLA0KICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fZGF0YT10ZXh0X25lcl92YWxpZCwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9ImxhYmVsIiwNCiAgICAgICAgICAgICAgICBwcmltYXJ5X21ldHJpYz0iYWNjdXJhY3kiLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgdGV4dF9uZXJfbm9kZS5zZXRfbGltaXRzKG1heF9jb25jdXJyZW50X3RyaWFscz0xKQ0KDQogICAgICAgIHRleHRfbmVyX3RyYWluID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9jb25sbDIwMDMvdHJhaW4iLA0KICAgICAgICApDQogICAgICAgIHRleHRfbmVyX3ZhbGlkID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9jb25sbDIwMDMvdmFsaWQiLA0KICAgICAgICApDQoNCiAgICAgICAgcGlwZWxpbmVfam9iOiBQaXBlbGluZUpvYiA9IHRyYWluX2F1dG9tbF90ZXh0X25lcl9pbl9waXBlbGluZSh0ZXh0X25lcl90cmFpbiwgdGV4dF9uZXJfdmFsaWQpDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSBHUFVfQ0xVU1RFUg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICBqb2JfZGljdCA9IHB5ZGFzaC5vbWl0KGFjdHVhbF9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXVsidGV4dF9uZXJfbm9kZSJdLCBmaWVsZHNfdG9fb21pdCkNCiAgICAgICAgYXNzZXJ0IGpvYl9kaWN0ID09IHsNCiAgICAgICAgICAgICJ0cmFpbmluZ19kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMudGV4dF9uZXJfdHJhaW59fSIsDQogICAgICAgICAgICAidmFsaWRhdGlvbl9kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMudGV4dF9uZXJfdmFsaWR9fSIsDQogICAgICAgICAgICAidGFyZ2V0X2NvbHVtbl9uYW1lIjogImxhYmVsIiwNCiAgICAgICAgICAgICJ0YWdzIjoge30sDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJsaW1pdHMiOiB7Im1heF90cmlhbHMiOiAxLCAibWF4X25vZGVzIjogMSwgIm1heF9jb25jdXJyZW50X3RyaWFscyI6IDF9LA0KICAgICAgICAgICAgInRhc2siOiAidGV4dF9uZXIiLA0KICAgICAgICAgICAgInByaW1hcnlfbWV0cmljIjogImFjY3VyYWN5IiwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfYXV0b21sX3Zpc2lvbl9tdWx0aWNsYXNzX25vZGVfaW5fcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBkc2wucGlwZWxpbmUobmFtZT0idHJhaW5fbXVsdGljbGFzc193aXRoX2F1dG9tbF9pbl9waXBlbGluZSIpDQogICAgICAgIGRlZiB0cmFpbl9tdWx0aWNsYXNzX3dpdGhfYXV0b21sX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgaW1hZ2VfbXVsdGljbGFzc190cmFpbl9kYXRhLA0KICAgICAgICAgICAgaW1hZ2VfbXVsdGljbGFzc192YWxpZF9kYXRhLA0KICAgICAgICApOg0KICAgICAgICAgICAgaW1hZ2VfbXVsdGljbGFzc19ub2RlID0gYXV0b21sLmltYWdlX2NsYXNzaWZpY2F0aW9uKA0KICAgICAgICAgICAgICAgIHRyYWluaW5nX2RhdGE9aW1hZ2VfbXVsdGljbGFzc190cmFpbl9kYXRhLA0KICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fZGF0YT1pbWFnZV9tdWx0aWNsYXNzX3ZhbGlkX2RhdGEsDQogICAgICAgICAgICAgICAgdGFyZ2V0X2NvbHVtbl9uYW1lPSJsYWJlbCIsDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9IkFjY3VyYWN5IiwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGltYWdlX211bHRpY2xhc3Nfbm9kZS5zZXRfbGltaXRzKA0KICAgICAgICAgICAgICAgIHRpbWVvdXRfbWludXRlcz02MCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGltYWdlX211bHRpY2xhc3Nfbm9kZS5leHRlbmRfc2VhcmNoX3NwYWNlKA0KICAgICAgICAgICAgICAgIFsNCiAgICAgICAgICAgICAgICAgICAgU2VhcmNoU3BhY2UoDQogICAgICAgICAgICAgICAgICAgICAgICBtb2RlbF9uYW1lPUNob2ljZShbInZpdHMxNnIyMjQiXSksDQogICAgICAgICAgICAgICAgICAgICAgICBsZWFybmluZ19yYXRlPVVuaWZvcm0oMC4wMDEsIDAuMDEpLA0KICAgICAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgICAgICBTZWFyY2hTcGFjZSgNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsX25hbWU9Q2hvaWNlKFsic2VyZXNuZXh0Il0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVhcm5pbmdfcmF0ZT1Vbmlmb3JtKDAuMDAxLCAwLjAxKSwNCiAgICAgICAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICApDQogICAgICAgICAgICBpbWFnZV9tdWx0aWNsYXNzX25vZGUuc2V0X3N3ZWVwKA0KICAgICAgICAgICAgICAgIHNhbXBsaW5nX2FsZ29yaXRobT0iUmFuZG9tIiwNCiAgICAgICAgICAgICAgICBlYXJseV90ZXJtaW5hdGlvbj1CYW5kaXRQb2xpY3koZXZhbHVhdGlvbl9pbnRlcnZhbD0yLCBzbGFja19mYWN0b3I9MC4yLCBkZWxheV9ldmFsdWF0aW9uPTYpLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgaW1hZ2VfbXVsdGljbGFzc19ub2RlLnNldF9saW1pdHMoDQogICAgICAgICAgICAgICAgbWF4X3RyaWFscz0xLA0KICAgICAgICAgICAgICAgIG1heF9jb25jdXJyZW50X3RyaWFscz0xLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIG11bHRpY2xhc3NfdHJhaW4gPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD10ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvYXV0b21sX2pvYi90ZXN0X2RhdGFzZXRzL2ltYWdlX2NsYXNzaWZpY2F0aW9uL3RyYWluIiwNCiAgICAgICAgKQ0KICAgICAgICBtdWx0aWNsYXNzX3ZhbGlkID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9pbWFnZV9jbGFzc2lmaWNhdGlvbi92YWxpZCIsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZV9qb2I6IFBpcGVsaW5lSm9iID0gdHJhaW5fbXVsdGljbGFzc193aXRoX2F1dG9tbF9pbl9waXBlbGluZShtdWx0aWNsYXNzX3RyYWluLCBtdWx0aWNsYXNzX3ZhbGlkKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gR1BVX0NMVVNURVINCg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICBpbWFnZV9tdWx0aWNsYXNzX2RpY3QgPSBweWRhc2gub21pdChhY3R1YWxfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bImltYWdlX211bHRpY2xhc3Nfbm9kZSJdLCBmaWVsZHNfdG9fb21pdCkNCiAgICAgICAgYXNzZXJ0IGltYWdlX211bHRpY2xhc3NfZGljdCA9PSB7DQogICAgICAgICAgICAibGltaXRzIjogeyJtYXhfY29uY3VycmVudF90cmlhbHMiOiAxLCAibWF4X3RyaWFscyI6IDEsICJ0aW1lb3V0X21pbnV0ZXMiOiA2MH0sDQogICAgICAgICAgICAibG9nX3ZlcmJvc2l0eSI6ICJpbmZvIiwNCiAgICAgICAgICAgICJvdXRwdXRzIjoge30sDQogICAgICAgICAgICAicHJpbWFyeV9tZXRyaWMiOiAiYWNjdXJhY3kiLA0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJ0YXJnZXRfY29sdW1uX25hbWUiOiAibGFiZWwiLA0KICAgICAgICAgICAgInRhc2siOiAiaW1hZ2VfY2xhc3NpZmljYXRpb24iLA0KICAgICAgICAgICAgInRyYWluaW5nX2RhdGEiOiAiJHt7cGFyZW50LmlucHV0cy5pbWFnZV9tdWx0aWNsYXNzX3RyYWluX2RhdGF9fSIsDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgInZhbGlkYXRpb25fZGF0YSI6ICIke3twYXJlbnQuaW5wdXRzLmltYWdlX211bHRpY2xhc3NfdmFsaWRfZGF0YX19IiwNCiAgICAgICAgICAgICJzd2VlcCI6IHsNCiAgICAgICAgICAgICAgICAic2FtcGxpbmdfYWxnb3JpdGhtIjogInJhbmRvbSIsDQogICAgICAgICAgICAgICAgImVhcmx5X3Rlcm1pbmF0aW9uIjogew0KICAgICAgICAgICAgICAgICAgICAiZXZhbHVhdGlvbl9pbnRlcnZhbCI6IDIsDQogICAgICAgICAgICAgICAgICAgICJkZWxheV9ldmFsdWF0aW9uIjogNiwNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiYmFuZGl0IiwNCiAgICAgICAgICAgICAgICAgICAgInNsYWNrX2ZhY3RvciI6IDAuMiwNCiAgICAgICAgICAgICAgICAgICAgInNsYWNrX2Ftb3VudCI6IDAuMCwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJzZWFyY2hfc3BhY2UiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6ICJ1bmlmb3JtKDAuMDAxLDAuMDEpIiwNCiAgICAgICAgICAgICAgICAgICAgIm1vZGVsX25hbWUiOiAiY2hvaWNlKCd2aXRzMTZyMjI0JykiLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6ICJ1bmlmb3JtKDAuMDAxLDAuMDEpIiwNCiAgICAgICAgICAgICAgICAgICAgIm1vZGVsX25hbWUiOiAiY2hvaWNlKCdzZXJlc25leHQnKSIsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIF0sDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X2F1dG9tbF92aXNpb25fbXVsdGlsYWJlbF9ub2RlX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBAZHNsLnBpcGVsaW5lKG5hbWU9InRyYWluX211bHRpbGFiZWxfd2l0aF9hdXRvbWxfaW5fcGlwZWxpbmUiKQ0KICAgICAgICBkZWYgdHJhaW5fbXVsdGlsYWJlbF93aXRoX2F1dG9tbF9pbl9waXBlbGluZSgNCiAgICAgICAgICAgIGltYWdlX211bHRpbGFiZWxfdHJhaW5fZGF0YSwNCiAgICAgICAgICAgIGltYWdlX211bHRpbGFiZWxfdmFsaWRfZGF0YSwNCiAgICAgICAgKToNCiAgICAgICAgICAgIGltYWdlX211bHRpbGFiZWxfbm9kZSA9IGF1dG9tbC5pbWFnZV9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsKA0KICAgICAgICAgICAgICAgIHRyYWluaW5nX2RhdGE9aW1hZ2VfbXVsdGlsYWJlbF90cmFpbl9kYXRhLA0KICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fZGF0YT1pbWFnZV9tdWx0aWxhYmVsX3ZhbGlkX2RhdGEsDQogICAgICAgICAgICAgICAgdGFyZ2V0X2NvbHVtbl9uYW1lPSJsYWJlbCIsDQogICAgICAgICAgICAgICAgcHJpbWFyeV9tZXRyaWM9ImlvdSIsDQogICAgICAgICAgICApDQogICAgICAgICAgICBpbWFnZV9tdWx0aWxhYmVsX25vZGUuc2V0X2xpbWl0cygNCiAgICAgICAgICAgICAgICB0aW1lb3V0X21pbnV0ZXM9NjAsDQogICAgICAgICAgICApDQogICAgICAgICAgICBpbWFnZV9tdWx0aWxhYmVsX25vZGUuZXh0ZW5kX3NlYXJjaF9zcGFjZSgNCiAgICAgICAgICAgICAgICBbDQogICAgICAgICAgICAgICAgICAgIFNlYXJjaFNwYWNlKA0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxfbmFtZT1DaG9pY2UoWyJ2aXRiMTZyMjI0Il0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVhcm5pbmdfcmF0ZT1Vbmlmb3JtKDAuMDAxLCAwLjAxKSwNCiAgICAgICAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgICAgICAgICAgU2VhcmNoU3BhY2UoDQogICAgICAgICAgICAgICAgICAgICAgICBtb2RlbF9uYW1lPUNob2ljZShbInNlcmVzbmV4dCJdKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGxlYXJuaW5nX3JhdGU9VW5pZm9ybSgwLjAwMSwgMC4wMSksDQogICAgICAgICAgICAgICAgICAgICksDQogICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgaW1hZ2VfbXVsdGlsYWJlbF9ub2RlLnNldF9zd2VlcCgNCiAgICAgICAgICAgICAgICBzYW1wbGluZ19hbGdvcml0aG09IlJhbmRvbSIsDQogICAgICAgICAgICAgICAgZWFybHlfdGVybWluYXRpb249QmFuZGl0UG9saWN5KGV2YWx1YXRpb25faW50ZXJ2YWw9Miwgc2xhY2tfZmFjdG9yPTAuMiwgZGVsYXlfZXZhbHVhdGlvbj02KSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGltYWdlX211bHRpbGFiZWxfbm9kZS5zZXRfbGltaXRzKA0KICAgICAgICAgICAgICAgIG1heF90cmlhbHM9MSwNCiAgICAgICAgICAgICAgICBtYXhfY29uY3VycmVudF90cmlhbHM9MSwNCiAgICAgICAgICAgICkNCg0KICAgICAgICBtdWx0aWxhYmVsX3RyYWluID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9pbWFnZV9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsL3RyYWluIiwNCiAgICAgICAgKQ0KICAgICAgICBtdWx0aWxhYmVsX3ZhbGlkID0gSW5wdXQoDQogICAgICAgICAgICB0eXBlPUFzc2V0VHlwZXMuTUxUQUJMRSwNCiAgICAgICAgICAgIHBhdGg9dGVzdHNfcm9vdF9kaXIgLyAidGVzdF9jb25maWdzL2F1dG9tbF9qb2IvdGVzdF9kYXRhc2V0cy9pbWFnZV9jbGFzc2lmaWNhdGlvbl9tdWx0aWxhYmVsL3ZhbGlkIiwNCiAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYjogUGlwZWxpbmVKb2IgPSB0cmFpbl9tdWx0aWxhYmVsX3dpdGhfYXV0b21sX2luX3BpcGVsaW5lKG11bHRpbGFiZWxfdHJhaW4sIG11bHRpbGFiZWxfdmFsaWQpDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSBHUFVfQ0xVU1RFUg0KDQogICAgICAgIGZyb21fcmVzdF9waXBlbGluZV9qb2IgPSBjbGllbnQuam9icy5jcmVhdGVfb3JfdXBkYXRlKHBpcGVsaW5lX2pvYikNCiAgICAgICAgY2FuY2VsX2pvYihjbGllbnQsIGZyb21fcmVzdF9waXBlbGluZV9qb2IpDQoNCiAgICAgICAgYWN0dWFsX2RpY3QgPSBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKQ0KICAgICAgICBmaWVsZHNfdG9fb21pdCA9IFsibmFtZSIsICJkaXNwbGF5X25hbWUiLCAiZXhwZXJpbWVudF9uYW1lIiwgInByb3BlcnRpZXMiXQ0KDQogICAgICAgIGltYWdlX211bHRpbGFiZWxfZGljdCA9IHB5ZGFzaC5vbWl0KGFjdHVhbF9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXVsiaW1hZ2VfbXVsdGlsYWJlbF9ub2RlIl0sIGZpZWxkc190b19vbWl0KQ0KICAgICAgICBhc3NlcnQgaW1hZ2VfbXVsdGlsYWJlbF9kaWN0ID09IHsNCiAgICAgICAgICAgICJsaW1pdHMiOiB7Im1heF9jb25jdXJyZW50X3RyaWFscyI6IDEsICJtYXhfdHJpYWxzIjogMSwgInRpbWVvdXRfbWludXRlcyI6IDYwfSwNCiAgICAgICAgICAgICJsb2dfdmVyYm9zaXR5IjogImluZm8iLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7fSwNCiAgICAgICAgICAgICJwcmltYXJ5X21ldHJpYyI6ICJpb3UiLA0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJ0YXJnZXRfY29sdW1uX25hbWUiOiAibGFiZWwiLA0KICAgICAgICAgICAgInRhc2siOiAiaW1hZ2VfY2xhc3NpZmljYXRpb25fbXVsdGlsYWJlbCIsDQogICAgICAgICAgICAidHJhaW5pbmdfZGF0YSI6ICIke3twYXJlbnQuaW5wdXRzLmltYWdlX211bHRpbGFiZWxfdHJhaW5fZGF0YX19IiwNCiAgICAgICAgICAgICJ0eXBlIjogImF1dG9tbCIsDQogICAgICAgICAgICAidmFsaWRhdGlvbl9kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMuaW1hZ2VfbXVsdGlsYWJlbF92YWxpZF9kYXRhfX0iLA0KICAgICAgICAgICAgInN3ZWVwIjogew0KICAgICAgICAgICAgICAgICJzYW1wbGluZ19hbGdvcml0aG0iOiAicmFuZG9tIiwNCiAgICAgICAgICAgICAgICAiZWFybHlfdGVybWluYXRpb24iOiB7DQogICAgICAgICAgICAgICAgICAgICJldmFsdWF0aW9uX2ludGVydmFsIjogMiwNCiAgICAgICAgICAgICAgICAgICAgImRlbGF5X2V2YWx1YXRpb24iOiA2LA0KICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJiYW5kaXQiLA0KICAgICAgICAgICAgICAgICAgICAic2xhY2tfZmFjdG9yIjogMC4yLA0KICAgICAgICAgICAgICAgICAgICAic2xhY2tfYW1vdW50IjogMC4wLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInNlYXJjaF9zcGFjZSI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJtb2RlbF9uYW1lIjogImNob2ljZSgndml0YjE2cjIyNCcpIiwNCiAgICAgICAgICAgICAgICAgICAgImxlYXJuaW5nX3JhdGUiOiAidW5pZm9ybSgwLjAwMSwwLjAxKSIsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJtb2RlbF9uYW1lIjogImNob2ljZSgnc2VyZXNuZXh0JykiLA0KICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6ICJ1bmlmb3JtKDAuMDAxLDAuMDEpIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgXSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfYXV0b21sX3Zpc2lvbl9vZF9ub2RlX2luX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBAZHNsLnBpcGVsaW5lKG5hbWU9InRyYWluX29kX3dpdGhfYXV0b21sX2luX3BpcGVsaW5lIikNCiAgICAgICAgZGVmIHRyYWluX29kX3dpdGhfYXV0b21sX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbl90cmFpbl9kYXRhLA0KICAgICAgICAgICAgaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbl92YWxpZF9kYXRhLA0KICAgICAgICApOg0KICAgICAgICAgICAgaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbl9ub2RlID0gYXV0b21sLmltYWdlX29iamVjdF9kZXRlY3Rpb24oDQogICAgICAgICAgICAgICAgdHJhaW5pbmdfZGF0YT1pbWFnZV9vYmplY3RfZGV0ZWN0aW9uX3RyYWluX2RhdGEsDQogICAgICAgICAgICAgICAgdmFsaWRhdGlvbl9kYXRhPWltYWdlX29iamVjdF9kZXRlY3Rpb25fdmFsaWRfZGF0YSwNCiAgICAgICAgICAgICAgICB0YXJnZXRfY29sdW1uX25hbWU9ImxhYmVsIiwNCiAgICAgICAgICAgICAgICBwcmltYXJ5X21ldHJpYz0iTWVhbkF2ZXJhZ2VQcmVjaXNpb24iLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICBpbWFnZV9vYmplY3RfZGV0ZWN0aW9uX25vZGUuZXh0ZW5kX3NlYXJjaF9zcGFjZSgNCiAgICAgICAgICAgICAgICBbDQogICAgICAgICAgICAgICAgICAgIFNlYXJjaFNwYWNlKA0KICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxfbmFtZT1DaG9pY2UoWyJ5b2xvdjUiXSksDQogICAgICAgICAgICAgICAgICAgICAgICBsZWFybmluZ19yYXRlPVVuaWZvcm0oMC4wMDAxLCAwLjAxKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsX3NpemU9Q2hvaWNlKFsic21hbGwiLCAibWVkaXVtIl0pLCAgIyBtb2RlbC1zcGVjaWZpYw0KICAgICAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgICAgICBTZWFyY2hTcGFjZSgNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsX25hbWU9Q2hvaWNlKFsiZmFzdGVycmNubl9yZXNuZXQ1MF9mcG4iXSksDQogICAgICAgICAgICAgICAgICAgICAgICBsZWFybmluZ19yYXRlPVVuaWZvcm0oMC4wMDAxLCAwLjAwMSksDQogICAgICAgICAgICAgICAgICAgICAgICBvcHRpbWl6ZXI9Q2hvaWNlKFsic2dkIiwgImFkYW0iLCAiYWRhbXciXSksDQogICAgICAgICAgICAgICAgICAgICAgICBtaW5fc2l6ZT1DaG9pY2UoWzYwMCwgODAwXSksICAjIG1vZGVsLXNwZWNpZmljDQogICAgICAgICAgICAgICAgICAgICksDQogICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbl9ub2RlLnNldF90cmFpbmluZ19wYXJhbWV0ZXJzKG5tc19pb3VfdGhyZXNob2xkPTAuNykNCiAgICAgICAgICAgIGltYWdlX29iamVjdF9kZXRlY3Rpb25fbm9kZS5zZXRfbGltaXRzKA0KICAgICAgICAgICAgICAgIHRpbWVvdXRfbWludXRlcz02MCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGltYWdlX29iamVjdF9kZXRlY3Rpb25fbm9kZS5zZXRfc3dlZXAoDQogICAgICAgICAgICAgICAgc2FtcGxpbmdfYWxnb3JpdGhtPSJSYW5kb20iLA0KICAgICAgICAgICAgICAgIGVhcmx5X3Rlcm1pbmF0aW9uPUJhbmRpdFBvbGljeShldmFsdWF0aW9uX2ludGVydmFsPTIsIHNsYWNrX2ZhY3Rvcj0wLjIsIGRlbGF5X2V2YWx1YXRpb249NiksDQogICAgICAgICAgICApDQogICAgICAgICAgICBpbWFnZV9vYmplY3RfZGV0ZWN0aW9uX25vZGUuc2V0X2xpbWl0cygNCiAgICAgICAgICAgICAgICBtYXhfdHJpYWxzPTEsDQogICAgICAgICAgICAgICAgbWF4X2NvbmN1cnJlbnRfdHJpYWxzPTEsDQogICAgICAgICAgICApDQoNCiAgICAgICAgb2JqZWN0X2RldGVjdGlvbl90cmFpbiA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbi90cmFpbiIsDQogICAgICAgICkNCiAgICAgICAgb2JqZWN0X2RldGVjdGlvbl92YWxpZCA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbi92YWxpZCIsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZV9qb2I6IFBpcGVsaW5lSm9iID0gdHJhaW5fb2Rfd2l0aF9hdXRvbWxfaW5fcGlwZWxpbmUob2JqZWN0X2RldGVjdGlvbl90cmFpbiwgb2JqZWN0X2RldGVjdGlvbl92YWxpZCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9IEdQVV9DTFVTVEVSDQoNCiAgICAgICAgZnJvbV9yZXN0X3BpcGVsaW5lX2pvYiA9IGNsaWVudC5qb2JzLmNyZWF0ZV9vcl91cGRhdGUocGlwZWxpbmVfam9iKQ0KICAgICAgICBjYW5jZWxfam9iKGNsaWVudCwgZnJvbV9yZXN0X3BpcGVsaW5lX2pvYikNCg0KICAgICAgICBhY3R1YWxfZGljdCA9IGZyb21fcmVzdF9waXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpDQogICAgICAgIGZpZWxkc190b19vbWl0ID0gWyJuYW1lIiwgImRpc3BsYXlfbmFtZSIsICJleHBlcmltZW50X25hbWUiLCAicHJvcGVydGllcyJdDQoNCiAgICAgICAgaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbl9kaWN0ID0gcHlkYXNoLm9taXQoDQogICAgICAgICAgICBhY3R1YWxfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bImltYWdlX29iamVjdF9kZXRlY3Rpb25fbm9kZSJdLCBmaWVsZHNfdG9fb21pdA0KICAgICAgICApDQogICAgICAgIGFzc2VydCBpbWFnZV9vYmplY3RfZGV0ZWN0aW9uX2RpY3QgPT0gew0KICAgICAgICAgICAgImxpbWl0cyI6IHsibWF4X2NvbmN1cnJlbnRfdHJpYWxzIjogMSwgIm1heF90cmlhbHMiOiAxLCAidGltZW91dF9taW51dGVzIjogNjB9LA0KICAgICAgICAgICAgImxvZ192ZXJib3NpdHkiOiAiaW5mbyIsDQogICAgICAgICAgICAib3V0cHV0cyI6IHt9LA0KICAgICAgICAgICAgInByaW1hcnlfbWV0cmljIjogIm1lYW5fYXZlcmFnZV9wcmVjaXNpb24iLA0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJ0YXJnZXRfY29sdW1uX25hbWUiOiAibGFiZWwiLA0KICAgICAgICAgICAgInRhc2siOiAiaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbiIsDQogICAgICAgICAgICAidHJhaW5pbmdfZGF0YSI6ICIke3twYXJlbnQuaW5wdXRzLmltYWdlX29iamVjdF9kZXRlY3Rpb25fdHJhaW5fZGF0YX19IiwNCiAgICAgICAgICAgICJ0eXBlIjogImF1dG9tbCIsDQogICAgICAgICAgICAidmFsaWRhdGlvbl9kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMuaW1hZ2Vfb2JqZWN0X2RldGVjdGlvbl92YWxpZF9kYXRhfX0iLA0KICAgICAgICAgICAgInRyYWluaW5nX3BhcmFtZXRlcnMiOiB7Im5tc19pb3VfdGhyZXNob2xkIjogMC43fSwNCiAgICAgICAgICAgICJzd2VlcCI6IHsNCiAgICAgICAgICAgICAgICAic2FtcGxpbmdfYWxnb3JpdGhtIjogInJhbmRvbSIsDQogICAgICAgICAgICAgICAgImVhcmx5X3Rlcm1pbmF0aW9uIjogew0KICAgICAgICAgICAgICAgICAgICAiZXZhbHVhdGlvbl9pbnRlcnZhbCI6IDIsDQogICAgICAgICAgICAgICAgICAgICJkZWxheV9ldmFsdWF0aW9uIjogNiwNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiYmFuZGl0IiwNCiAgICAgICAgICAgICAgICAgICAgInNsYWNrX2ZhY3RvciI6IDAuMiwNCiAgICAgICAgICAgICAgICAgICAgInNsYWNrX2Ftb3VudCI6IDAuMCwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJzZWFyY2hfc3BhY2UiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6ICJ1bmlmb3JtKDAuMDAwMSwwLjAxKSIsDQogICAgICAgICAgICAgICAgICAgICJtb2RlbF9uYW1lIjogImNob2ljZSgneW9sb3Y1JykiLA0KICAgICAgICAgICAgICAgICAgICAibW9kZWxfc2l6ZSI6ICJjaG9pY2UoJ3NtYWxsJywnbWVkaXVtJykiLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6ICJ1bmlmb3JtKDAuMDAwMSwwLjAwMSkiLA0KICAgICAgICAgICAgICAgICAgICAibWluX3NpemUiOiAiY2hvaWNlKDYwMCw4MDApIiwNCiAgICAgICAgICAgICAgICAgICAgIm1vZGVsX25hbWUiOiAiY2hvaWNlKCdmYXN0ZXJyY25uX3Jlc25ldDUwX2ZwbicpIiwNCiAgICAgICAgICAgICAgICAgICAgIm9wdGltaXplciI6ICJjaG9pY2UoJ3NnZCcsJ2FkYW0nLCdhZGFtdycpIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgXSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfYXV0b21sX3Zpc2lvbl9zZWdtZW50YXRpb25fbm9kZV9pbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgQGRzbC5waXBlbGluZShuYW1lPSJ0cmFpbl93aXRoX2F1dG9tbF9pbl9waXBlbGluZSIpDQogICAgICAgIGRlZiB0cmFpbl9zZWdtZW50YXRpb25fd2l0aF9hdXRvbWxfaW5fcGlwZWxpbmUoDQogICAgICAgICAgICBpbWFnZV9pbnN0YW5jZV9zZWdtZW50YXRpb25fdHJhaW5fZGF0YSwNCiAgICAgICAgICAgIGltYWdlX2luc3RhbmNlX3NlZ21lbnRhdGlvbl92YWxpZF9kYXRhLA0KICAgICAgICApOg0KICAgICAgICAgICAgaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uX25vZGUgPSBhdXRvbWwuaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uKA0KICAgICAgICAgICAgICAgIHByaW1hcnlfbWV0cmljPSJNZWFuQXZlcmFnZVByZWNpc2lvbiIsDQogICAgICAgICAgICAgICAgdGFyZ2V0X2NvbHVtbl9uYW1lPSJsYWJlbCIsDQogICAgICAgICAgICAgICAgdHJhaW5pbmdfZGF0YT1pbWFnZV9pbnN0YW5jZV9zZWdtZW50YXRpb25fdHJhaW5fZGF0YSwNCiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9aW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uX3ZhbGlkX2RhdGEsDQogICAgICAgICAgICApDQogICAgICAgICAgICBpbWFnZV9pbnN0YW5jZV9zZWdtZW50YXRpb25fbm9kZS5zZXRfbGltaXRzKA0KICAgICAgICAgICAgICAgIHRpbWVvdXRfbWludXRlcz02MCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGltYWdlX2luc3RhbmNlX3NlZ21lbnRhdGlvbl9ub2RlLnNldF90cmFpbmluZ19wYXJhbWV0ZXJzKG5tc19pb3VfdGhyZXNob2xkPTAuNykNCiAgICAgICAgICAgIGltYWdlX2luc3RhbmNlX3NlZ21lbnRhdGlvbl9ub2RlLmV4dGVuZF9zZWFyY2hfc3BhY2UoDQogICAgICAgICAgICAgICAgWw0KICAgICAgICAgICAgICAgICAgICBTZWFyY2hTcGFjZSgNCiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsX25hbWU9Q2hvaWNlKFsibWFza3Jjbm5fcmVzbmV0NTBfZnBuIl0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgbGVhcm5pbmdfcmF0ZT1Vbmlmb3JtKDAuMDAwMSwgMC4wMDEpLA0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVyPUNob2ljZShbInNnZCIsICJhZGFtIiwgImFkYW13Il0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWluX3NpemU9Q2hvaWNlKFs2MDAsIDgwMF0pLA0KICAgICAgICAgICAgICAgICAgICApLA0KICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgICkNCg0KICAgICAgICAgICAgaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uX25vZGUuc2V0X3N3ZWVwKA0KICAgICAgICAgICAgICAgIHNhbXBsaW5nX2FsZ29yaXRobT0iUmFuZG9tIiwNCiAgICAgICAgICAgICAgICBlYXJseV90ZXJtaW5hdGlvbj1CYW5kaXRQb2xpY3koZXZhbHVhdGlvbl9pbnRlcnZhbD0yLCBzbGFja19mYWN0b3I9MC4yLCBkZWxheV9ldmFsdWF0aW9uPTYpLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uX25vZGUuc2V0X2xpbWl0cygNCiAgICAgICAgICAgICAgICBtYXhfdHJpYWxzPTEwLA0KICAgICAgICAgICAgICAgIG1heF9jb25jdXJyZW50X3RyaWFscz0yLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIGluc3RhbmNlX3NlZ21lbnRhdGlvbl90cmFpbiA9IElucHV0KA0KICAgICAgICAgICAgdHlwZT1Bc3NldFR5cGVzLk1MVEFCTEUsDQogICAgICAgICAgICBwYXRoPXRlc3RzX3Jvb3RfZGlyIC8gInRlc3RfY29uZmlncy9hdXRvbWxfam9iL3Rlc3RfZGF0YXNldHMvaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uL3RyYWluIiwNCiAgICAgICAgKQ0KICAgICAgICBpbnN0YW5jZV9zZWdtZW50YXRpb25fdmFsaWQgPSBJbnB1dCgNCiAgICAgICAgICAgIHR5cGU9QXNzZXRUeXBlcy5NTFRBQkxFLA0KICAgICAgICAgICAgcGF0aD10ZXN0c19yb290X2RpciAvICJ0ZXN0X2NvbmZpZ3MvYXV0b21sX2pvYi90ZXN0X2RhdGFzZXRzL2ltYWdlX2luc3RhbmNlX3NlZ21lbnRhdGlvbi92YWxpZCIsDQogICAgICAgICkNCg0KICAgICAgICBwaXBlbGluZV9qb2I6IFBpcGVsaW5lSm9iID0gdHJhaW5fc2VnbWVudGF0aW9uX3dpdGhfYXV0b21sX2luX3BpcGVsaW5lKA0KICAgICAgICAgICAgaW5zdGFuY2Vfc2VnbWVudGF0aW9uX3RyYWluLCBpbnN0YW5jZV9zZWdtZW50YXRpb25fdmFsaWQNCiAgICAgICAgKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gR1BVX0NMVVNURVINCg0KICAgICAgICBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iID0gY2xpZW50LmpvYnMuY3JlYXRlX29yX3VwZGF0ZShwaXBlbGluZV9qb2IpDQogICAgICAgIGNhbmNlbF9qb2IoY2xpZW50LCBmcm9tX3Jlc3RfcGlwZWxpbmVfam9iKQ0KDQogICAgICAgIGFjdHVhbF9kaWN0ID0gZnJvbV9yZXN0X3BpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgZmllbGRzX3RvX29taXQgPSBbIm5hbWUiLCAiZGlzcGxheV9uYW1lIiwgImV4cGVyaW1lbnRfbmFtZSIsICJwcm9wZXJ0aWVzIl0NCg0KICAgICAgICBpbWFnZV9pbnN0YW5jZV9zZWdtZW50YXRpb25fZGljdCA9IHB5ZGFzaC5vbWl0KA0KICAgICAgICAgICAgYWN0dWFsX2RpY3RbInByb3BlcnRpZXMiXVsiam9icyJdWyJpbWFnZV9pbnN0YW5jZV9zZWdtZW50YXRpb25fbm9kZSJdLCBmaWVsZHNfdG9fb21pdA0KICAgICAgICApDQogICAgICAgIGFzc2VydCBpbWFnZV9pbnN0YW5jZV9zZWdtZW50YXRpb25fZGljdCA9PSB7DQogICAgICAgICAgICAibGltaXRzIjogeyJtYXhfY29uY3VycmVudF90cmlhbHMiOiAyLCAibWF4X3RyaWFscyI6IDEwLCAidGltZW91dF9taW51dGVzIjogNjB9LA0KICAgICAgICAgICAgImxvZ192ZXJib3NpdHkiOiAiaW5mbyIsDQogICAgICAgICAgICAib3V0cHV0cyI6IHt9LA0KICAgICAgICAgICAgInByaW1hcnlfbWV0cmljIjogIm1lYW5fYXZlcmFnZV9wcmVjaXNpb24iLA0KICAgICAgICAgICAgInRhZ3MiOiB7fSwNCiAgICAgICAgICAgICJ0YXJnZXRfY29sdW1uX25hbWUiOiAibGFiZWwiLA0KICAgICAgICAgICAgInRhc2siOiAiaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uIiwNCiAgICAgICAgICAgICJ0cmFpbmluZ19kYXRhIjogIiR7e3BhcmVudC5pbnB1dHMuaW1hZ2VfaW5zdGFuY2Vfc2VnbWVudGF0aW9uX3RyYWluX2RhdGF9fSIsDQogICAgICAgICAgICAidHlwZSI6ICJhdXRvbWwiLA0KICAgICAgICAgICAgInZhbGlkYXRpb25fZGF0YSI6ICIke3twYXJlbnQuaW5wdXRzLmltYWdlX2luc3RhbmNlX3NlZ21lbnRhdGlvbl92YWxpZF9kYXRhfX0iLA0KICAgICAgICAgICAgInRyYWluaW5nX3BhcmFtZXRlcnMiOiB7Im5tc19pb3VfdGhyZXNob2xkIjogMC43fSwNCiAgICAgICAgICAgICJzd2VlcCI6IHsNCiAgICAgICAgICAgICAgICAic2FtcGxpbmdfYWxnb3JpdGhtIjogInJhbmRvbSIsDQogICAgICAgICAgICAgICAgImVhcmx5X3Rlcm1pbmF0aW9uIjogew0KICAgICAgICAgICAgICAgICAgICAiZXZhbHVhdGlvbl9pbnRlcnZhbCI6IDIsDQogICAgICAgICAgICAgICAgICAgICJkZWxheV9ldmFsdWF0aW9uIjogNiwNCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiYmFuZGl0IiwNCiAgICAgICAgICAgICAgICAgICAgInNsYWNrX2ZhY3RvciI6IDAuMiwNCiAgICAgICAgICAgICAgICAgICAgInNsYWNrX2Ftb3VudCI6IDAuMCwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJzZWFyY2hfc3BhY2UiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGVhcm5pbmdfcmF0ZSI6ICJ1bmlmb3JtKDAuMDAwMSwwLjAwMSkiLA0KICAgICAgICAgICAgICAgICAgICAibW9kZWxfbmFtZSI6ICJjaG9pY2UoJ21hc2tyY25uX3Jlc25ldDUwX2ZwbicpIiwNCiAgICAgICAgICAgICAgICAgICAgIm9wdGltaXplciI6ICJjaG9pY2UoJ3NnZCcsJ2FkYW0nLCdhZGFtdycpIiwNCiAgICAgICAgICAgICAgICAgICAgIm1pbl9zaXplIjogImNob2ljZSg2MDAsODAwKSIsDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXSwNCiAgICAgICAgfQ0K",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "XXJmP9FfdpyDfqn5dcdM7w==",
        "Date": "Wed, 24 May 2023 03:02:50 GMT",
        "ETag": "\u00220x8DB5C035C4FC228\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:50 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "oXhxStpElP4=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/test_controlflow_pipeline.py",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "45735",
        "Content-MD5": "Nk4cK4U9ZubJGThU1K7nkw==",
        "Content-Type": "application/octet-stream",
        "If-None-Match": "*",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-blob-type": "BlockBlob",
        "x-ms-date": "Wed, 24 May 2023 03:02:49 GMT",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": "ZnJvbSBwYXRobGliIGltcG9ydCBQYXRoDQoNCmltcG9ydCBweXRlc3QNCmZyb20gZGV2dG9vbHNfdGVzdHV0aWxzIGltcG9ydCBBenVyZVJlY29yZGVkVGVzdENhc2UsIGlzX2xpdmUNCmZyb20gdGVzdF91dGlsaXRpZXMudXRpbHMgaW1wb3J0IF9QWVRFU1RfVElNRU9VVF9NRVRIT0QsIGFzc2VydF9qb2JfY2FuY2VsLCBvbWl0X3dpdGhfd2lsZGNhcmQNCg0KZnJvbSBhenVyZS5haS5tbCBpbXBvcnQgSW5wdXQsIE1MQ2xpZW50LCBPdXRwdXQsIGxvYWRfY29tcG9uZW50DQpmcm9tIGF6dXJlLmFpLm1sLmRzbCBpbXBvcnQgcGlwZWxpbmUNCmZyb20gYXp1cmUuYWkubWwuZHNsLl9jb25kaXRpb24gaW1wb3J0IGNvbmRpdGlvbg0KZnJvbSBhenVyZS5haS5tbC5kc2wuX2RvX3doaWxlIGltcG9ydCBkb193aGlsZQ0KZnJvbSBhenVyZS5haS5tbC5kc2wuX2dyb3VwX2RlY29yYXRvciBpbXBvcnQgZ3JvdXANCmZyb20gYXp1cmUuYWkubWwuZHNsLl9wYXJhbGxlbF9mb3IgaW1wb3J0IHBhcmFsbGVsX2Zvcg0KDQpmcm9tIC4uX3V0aWwgaW1wb3J0IF9EU0xfVElNRU9VVF9TRUNPTkQsIGluY2x1ZGVfcHJpdmF0ZV9wcmV2aWV3X25vZGVzX2luX3BpcGVsaW5lDQoNCnRlc3RfaW5wdXQgPSBJbnB1dCgNCiAgICB0eXBlPSJ1cmlfZmlsZSIsDQogICAgcGF0aD0iaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiLA0KKQ0KDQpvbWl0X2ZpZWxkcyA9IFsNCiAgICAibmFtZSIsDQogICAgInByb3BlcnRpZXMuZGlzcGxheV9uYW1lIiwNCiAgICAicHJvcGVydGllcy5qb2JzLiouY29tcG9uZW50SWQiLA0KICAgICJwcm9wZXJ0aWVzLnNldHRpbmdzIiwNCl0NCg0KDQpAcHl0ZXN0Lm1hcmsudXNlZml4dHVyZXMoDQogICAgImVuYWJsZV9wcml2YXRlX3ByZXZpZXdfc2NoZW1hX2ZlYXR1cmVzIiwNCiAgICAiZW5hYmxlX2Vudmlyb25tZW50X2lkX2FybV9leHBhbnNpb24iLA0KICAgICJlbmFibGVfcGlwZWxpbmVfcHJpdmF0ZV9wcmV2aWV3X2ZlYXR1cmVzIiwNCiAgICAibW9ja19jb2RlX2hhc2giLA0KICAgICJtb2NrX2Fzc2V0X25hbWUiLA0KICAgICJtb2NrX2NvbXBvbmVudF9oYXNoIiwNCiAgICAibW9ja19zZXRfaGVhZGVyc193aXRoX3VzZXJfYW1sX3Rva2VuIiwNCiAgICAicmVjb3JkZWRfdGVzdCIsDQogICAgInVzZV9weXRob25fYW1saWdub3JlX2R1cmluZ191cGxvYWQiLA0KKQ0KQHB5dGVzdC5tYXJrLnRpbWVvdXQodGltZW91dD1fRFNMX1RJTUVPVVRfU0VDT05ELCBtZXRob2Q9X1BZVEVTVF9USU1FT1VUX01FVEhPRCkNCkBweXRlc3QubWFyay5lMmV0ZXN0DQpAcHl0ZXN0Lm1hcmsucGlwZWxpbmVfdGVzdA0KY2xhc3MgVGVzdENvbnRyb2xGbG93UGlwZWxpbmUoQXp1cmVSZWNvcmRlZFRlc3RDYXNlKToNCiAgICBwYXNzDQoNCg0KQHB5dGVzdC5tYXJrLnVzZWZpeHR1cmVzKCJtb2NrX2Fub25fY29tcG9uZW50X3ZlcnNpb24iKQ0KY2xhc3MgVGVzdElmRWxzZShUZXN0Q29udHJvbEZsb3dQaXBlbGluZSk6DQogICAgZGVmIHRlc3RfZHNsX2NvbmRpdGlvbl9waXBlbGluZShzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgIyB1cGRhdGUgam9icyBmaWVsZCB0byBpbmNsdWRlIHByaXZhdGUgcHJldmlldyBub2Rlcw0KDQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50X25vX3BhdGhzLnltbCINCiAgICAgICAgKQ0KICAgICAgICBiYXNpY19jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgIHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9jb21wb25lbnRfd2l0aF9jb25kaXRpb25hbF9vdXRwdXQvc3BlYy55YW1sIg0KICAgICAgICApDQoNCiAgICAgICAgQHBpcGVsaW5lKA0KICAgICAgICAgICAgbmFtZT0idGVzdF9tbGRlc2lnbmVyX2NvbXBvbmVudF93aXRoX2NvbmRpdGlvbmFsX291dHB1dCIsDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIGNvbmRpdGlvbl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcmVzdWx0ID0gYmFzaWNfY29tcG9uZW50KCkNCg0KICAgICAgICAgICAgbm9kZTEgPSBoZWxsb193b3JsZF9jb21wb25lbnRfbm9fcGF0aHMoY29tcG9uZW50X2luX251bWJlcj0xKQ0KICAgICAgICAgICAgbm9kZTIgPSBoZWxsb193b3JsZF9jb21wb25lbnRfbm9fcGF0aHMoY29tcG9uZW50X2luX251bWJlcj0yKQ0KICAgICAgICAgICAgY29uZGl0aW9uKGNvbmRpdGlvbj1yZXN1bHQub3V0cHV0cy5vdXRwdXQsIGZhbHNlX2Jsb2NrPW5vZGUxLCB0cnVlX2Jsb2NrPW5vZGUyKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNvbmRpdGlvbl9waXBlbGluZSgpDQoNCiAgICAgICAgIyBpbmNsdWRlIHByaXZhdGUgcHJldmlldyBub2Rlcw0KICAgICAgICB3aXRoIGluY2x1ZGVfcHJpdmF0ZV9wcmV2aWV3X25vZGVzX2luX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCg0KICAgICAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgZHNsX3BpcGVsaW5lX2pvYl9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXSA9PSB7DQogICAgICAgICAgICAiY29uZGl0aW9ubm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgICAgICJjb25kaXRpb24iOiAiJHt7cGFyZW50LmpvYnMucmVzdWx0Lm91dHB1dHMub3V0cHV0fX0iLA0KICAgICAgICAgICAgICAgICJmYWxzZV9ibG9jayI6ICIke3twYXJlbnQuam9icy5ub2RlMX19IiwNCiAgICAgICAgICAgICAgICAidHJ1ZV9ibG9jayI6ICIke3twYXJlbnQuam9icy5ub2RlMn19IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJpZl9lbHNlIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMSJ9fSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJub2RlMSIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm5vZGUyIjogew0KICAgICAgICAgICAgICAgICJfc291cmNlIjogIlJFTU9URS5XT1JLU1BBQ0UuQ09NUE9ORU5UIiwNCiAgICAgICAgICAgICAgICAiaW5wdXRzIjogeyJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjIifX0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTIiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJyZXN1bHQiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJuYW1lIjogInJlc3VsdCIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICB9DQoNCiAgICBkZWYgdGVzdF9kc2xfY29uZGl0aW9uX3BpcGVsaW5lX3dpdGhfcHJpbWl0aXZlX2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfbm9fcGF0aHMgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgIHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudF9ub19wYXRocy55bWwiDQogICAgICAgICkNCg0KICAgICAgICBAcGlwZWxpbmUoDQogICAgICAgICAgICBuYW1lPSJ0ZXN0X21sZGVzaWduZXJfY29tcG9uZW50X3dpdGhfY29uZGl0aW9uYWxfb3V0cHV0IiwNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgY29uZGl0aW9uX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBub2RlMSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyhjb21wb25lbnRfaW5fbnVtYmVyPTEpDQogICAgICAgICAgICBub2RlMiA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyhjb21wb25lbnRfaW5fbnVtYmVyPTIpDQogICAgICAgICAgICBjb25kaXRpb24oY29uZGl0aW9uPVRydWUsIGZhbHNlX2Jsb2NrPW5vZGUxLCB0cnVlX2Jsb2NrPW5vZGUyKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNvbmRpdGlvbl9waXBlbGluZSgpDQogICAgICAgIHdpdGggaW5jbHVkZV9wcml2YXRlX3ByZXZpZXdfbm9kZXNfaW5fcGlwZWxpbmUoKToNCiAgICAgICAgICAgIHJlc3Rfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCiAgICAgICAgZHNsX3BpcGVsaW5lX2pvYl9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHJlc3Rfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgZHNsX3BpcGVsaW5lX2pvYl9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXSA9PSB7DQogICAgICAgICAgICAiY29uZGl0aW9ubm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgICAgICJjb25kaXRpb24iOiBUcnVlLA0KICAgICAgICAgICAgICAgICJmYWxzZV9ibG9jayI6ICIke3twYXJlbnQuam9icy5ub2RlMX19IiwNCiAgICAgICAgICAgICAgICAidHJ1ZV9ibG9jayI6ICIke3twYXJlbnQuam9icy5ub2RlMn19IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJpZl9lbHNlIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMSJ9fSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJub2RlMSIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgIm5vZGUyIjogew0KICAgICAgICAgICAgICAgICJfc291cmNlIjogIlJFTU9URS5XT1JLU1BBQ0UuQ09NUE9ORU5UIiwNCiAgICAgICAgICAgICAgICAiaW5wdXRzIjogeyJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjIifX0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAibm9kZTIiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfZHNsX2NvbmRpdGlvbl9waXBlbGluZV93aXRoX29uZV9icmFuY2goc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50X25vX3BhdGhzLnltbCINCiAgICAgICAgKQ0KDQogICAgICAgIEBwaXBlbGluZSgNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgY29uZGl0aW9uX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBub2RlMSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyhjb21wb25lbnRfaW5fbnVtYmVyPTEpDQogICAgICAgICAgICBjb25kaXRpb24oY29uZGl0aW9uPVRydWUsIGZhbHNlX2Jsb2NrPW5vZGUxKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IGNvbmRpdGlvbl9waXBlbGluZSgpDQogICAgICAgIHdpdGggaW5jbHVkZV9wcml2YXRlX3ByZXZpZXdfbm9kZXNfaW5fcGlwZWxpbmUoKToNCiAgICAgICAgICAgIHJlc3Rfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCiAgICAgICAgZHNsX3BpcGVsaW5lX2pvYl9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHJlc3Rfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgZHNsX3BpcGVsaW5lX2pvYl9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXSA9PSB7DQogICAgICAgICAgICAiY29uZGl0aW9ubm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgICAgICJjb25kaXRpb24iOiBUcnVlLA0KICAgICAgICAgICAgICAgICJmYWxzZV9ibG9jayI6ICIke3twYXJlbnQuam9icy5ub2RlMX19IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJpZl9lbHNlIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAibm9kZTEiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiMSJ9fSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJub2RlMSIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICB9DQoNCiAgICBkZWYgdGVzdF9yZWdpc3RlcmVkX2NvbXBvbmVudF9pc19jb250cm9sKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBwcmltaXRpdmVfY29tcG9uZW50X3dpdGhfbm9ybWFsX2lucHV0X291dHB1dF92MiA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2RvX3doaWxlX3Rlc3QvcHJpbWl0aXZlX2NvbXBvbmVudF93aXRoX25vcm1hbF9pbnB1dF9vdXRwdXRfdjIueWFtbCINCiAgICAgICAgKQ0KICAgICAgICBwcmltaXRpdmVfY29tcG9uZW50X3dpdGhfbm9ybWFsX2lucHV0X291dHB1dF92Mi5vdXRwdXRzWyJib29sX3BhcmFtX291dHB1dCJdLmVhcmx5X2F2YWlsYWJsZSA9IFRydWUNCiAgICAgICAgcmVnaXN0ZXJlZF9jb21wb25lbnQgPSBjbGllbnQuY29tcG9uZW50cy5jcmVhdGVfb3JfdXBkYXRlKHByaW1pdGl2ZV9jb21wb25lbnRfd2l0aF9ub3JtYWxfaW5wdXRfb3V0cHV0X3YyKQ0KICAgICAgICByZXN0X2RpY3QgPSByZWdpc3RlcmVkX2NvbXBvbmVudC5fdG9fZGljdCgpDQogICAgICAgICMgQXNzZXJ0IGlzX2NvbnRyb2wgd2l0aCBjb3JyZWN0IGJvb2wgdHlwZQ0KICAgICAgICBleHBlY3RlZF9kaWN0ID0gew0KICAgICAgICAgICAgIm91dHB1dF9kYXRhIjogeyJ0eXBlIjogInVyaV9mb2xkZXIifSwNCiAgICAgICAgICAgICJib29sX3BhcmFtX291dHB1dCI6IHsidHlwZSI6ICJib29sZWFuIiwgImlzX2NvbnRyb2wiOiBUcnVlLCAiZWFybHlfYXZhaWxhYmxlIjogVHJ1ZX0sDQogICAgICAgICAgICAiaW50X3BhcmFtX291dHB1dCI6IHsidHlwZSI6ICJpbnRlZ2VyIiwgImlzX2NvbnRyb2wiOiBUcnVlfSwNCiAgICAgICAgICAgICJmbG9hdF9wYXJhbV9vdXRwdXQiOiB7InR5cGUiOiAibnVtYmVyIiwgImlzX2NvbnRyb2wiOiBUcnVlfSwNCiAgICAgICAgICAgICJzdHJfcGFyYW1fb3V0cHV0IjogeyJ0eXBlIjogInN0cmluZyIsICJpc19jb250cm9sIjogVHJ1ZX0sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IHJlc3RfZGljdFsib3V0cHV0cyJdID09IGV4cGVjdGVkX2RpY3QNCg0KICAgICAgICAjIEFzc2VydCBvbiBwaXBlbGluZSBjb21wb25lbnQNCiAgICAgICAgQGdyb3VwDQogICAgICAgIGNsYXNzIENvbnRyb2xPdXRwdXRHcm91cDoNCiAgICAgICAgICAgIG91dHB1dF9kYXRhOiBPdXRwdXQodHlwZT0idXJpX2ZvbGRlciIpDQogICAgICAgICAgICBmbG9hdF9wYXJhbV9vdXRwdXQ6IE91dHB1dCh0eXBlPSJudW1iZXIiLCBpc19jb250cm9sPVRydWUpDQogICAgICAgICAgICBpbnRfcGFyYW1fb3V0cHV0OiBPdXRwdXQodHlwZT0iaW50ZWdlciIsIGlzX2NvbnRyb2w9VHJ1ZSkNCiAgICAgICAgICAgIGJvb2xfcGFyYW1fb3V0cHV0OiBPdXRwdXQodHlwZT0iYm9vbGVhbiIsIGlzX2NvbnRyb2w9VHJ1ZSkNCiAgICAgICAgICAgIHN0cl9wYXJhbV9vdXRwdXQ6IE91dHB1dCh0eXBlPSJzdHJpbmciLCBpc19jb250cm9sPVRydWUpDQoNCiAgICAgICAgQHBpcGVsaW5lKCkNCiAgICAgICAgZGVmIHRlc3RfcGlwZWxpbmVfY29tcG9uZW50X2NvbnRyb2xfb3V0cHV0KCkgLT4gQ29udHJvbE91dHB1dEdyb3VwOg0KICAgICAgICAgICAgbm9kZSA9IHByaW1pdGl2ZV9jb21wb25lbnRfd2l0aF9ub3JtYWxfaW5wdXRfb3V0cHV0X3YyKA0KICAgICAgICAgICAgICAgIGlucHV0X2RhdGE9dGVzdF9pbnB1dCwgcGFyYW1ib29sPVRydWUsIHBhcmFtaW50PTIsIHBhcmFtZmxvYXQ9Mi4yLCBwYXJhbXN0cj0idGVzdCINCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHJldHVybiBub2RlLm91dHB1dHMNCg0KICAgICAgICByZWdpc3RlcmVkX3BpcGVsaW5lX2NvbXBvbmVudCA9IGNsaWVudC5jb21wb25lbnRzLmNyZWF0ZV9vcl91cGRhdGUodGVzdF9waXBlbGluZV9jb21wb25lbnRfY29udHJvbF9vdXRwdXQpDQogICAgICAgIHJlc3RfZGljdCA9IHJlZ2lzdGVyZWRfcGlwZWxpbmVfY29tcG9uZW50Ll90b19kaWN0KCkNCiAgICAgICAgYXNzZXJ0IHJlc3RfZGljdFsib3V0cHV0cyJdID09IGV4cGVjdGVkX2RpY3QNCg0KICAgIGRlZiB0ZXN0X2RvX3doaWxlX2NvbWJpbmVkX2lmX2Vsc2Uoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGRvX3doaWxlX2JvZHlfY29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvZG9fd2hpbGVfdGVzdC9kb193aGlsZV9ib2R5X2NvbXBvbmVudC55YW1sIg0KICAgICAgICApDQogICAgICAgIHByaW1pdGl2ZV9jb21wb25lbnRfd2l0aF9ub3JtYWxfaW5wdXRfb3V0cHV0X3YyID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvZG9fd2hpbGVfdGVzdC9wcmltaXRpdmVfY29tcG9uZW50X3dpdGhfbm9ybWFsX2lucHV0X291dHB1dF92Mi55YW1sIg0KICAgICAgICApDQoNCiAgICAgICAgQHBpcGVsaW5lKGRlZmF1bHRfY29tcHV0ZV90YXJnZXQ9ImNwdS1jbHVzdGVyIiwgY29udGludWVfb25fc3RlcF9mYWlsdXJlPVRydWUpDQogICAgICAgIGRlZiB0ZXN0X3BpcGVsaW5lKGlucHV0X2RhdGEsIGludF9wYXJhbSwgYm9vbF9wYXJhbSwgZmxvYXRfcGFyYW0sIHN0cl9wYXJhbSk6DQogICAgICAgICAgICBkb193aGlsZV9ib2R5X2Z1bmMgPSBkb193aGlsZV9ib2R5X2NvbXBvbmVudCgNCiAgICAgICAgICAgICAgICBpbnB1dF8xPWlucHV0X2RhdGEsDQogICAgICAgICAgICAgICAgaW5wdXRfMj1pbnB1dF9kYXRhLA0KICAgICAgICAgICAgICAgIGludF9wYXJhbT1pbnRfcGFyYW0sDQogICAgICAgICAgICAgICAgYm9vbF9wYXJhbT1ib29sX3BhcmFtLA0KICAgICAgICAgICAgICAgIGZsb2F0X3BhcmFtPWZsb2F0X3BhcmFtLA0KICAgICAgICAgICAgICAgIHN0cl9wYXJhbT1zdHJfcGFyYW0sDQogICAgICAgICAgICApDQoNCiAgICAgICAgICAgIGRvX3doaWxlKA0KICAgICAgICAgICAgICAgIGJvZHk9ZG9fd2hpbGVfYm9keV9mdW5jLA0KICAgICAgICAgICAgICAgIGNvbmRpdGlvbj1kb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5jb25kaXRpb24sDQogICAgICAgICAgICAgICAgbWFwcGluZz17DQogICAgICAgICAgICAgICAgICAgIGRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLm91dHB1dF8xOiBkb193aGlsZV9ib2R5X2Z1bmMuaW5wdXRzLmlucHV0XzEsDQogICAgICAgICAgICAgICAgICAgIGRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLm91dHB1dF8yOiBkb193aGlsZV9ib2R5X2Z1bmMuaW5wdXRzLmlucHV0XzIsDQogICAgICAgICAgICAgICAgICAgIGRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLmludF9wYXJhbV9vdXRwdXQ6IGRvX3doaWxlX2JvZHlfZnVuYy5pbnB1dHMuaW50X3BhcmFtLA0KICAgICAgICAgICAgICAgICAgICBkb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5ib29sX3BhcmFtX291dHB1dDogZG9fd2hpbGVfYm9keV9mdW5jLmlucHV0cy5ib29sX3BhcmFtLA0KICAgICAgICAgICAgICAgICAgICBkb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5mbG9hdF9wYXJhbV9vdXRwdXQ6IGRvX3doaWxlX2JvZHlfZnVuYy5pbnB1dHMuZmxvYXRfcGFyYW0sDQogICAgICAgICAgICAgICAgICAgIGRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLnN0cl9wYXJhbV9vdXRwdXQ6IGRvX3doaWxlX2JvZHlfZnVuYy5pbnB1dHMuc3RyX3BhcmFtLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgbWF4X2l0ZXJhdGlvbl9jb3VudD0zLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICBwcmltaXRpdmVfb3V0cHV0X2NvbXBvbmVudF90cnVlID0gcHJpbWl0aXZlX2NvbXBvbmVudF93aXRoX25vcm1hbF9pbnB1dF9vdXRwdXRfdjIoDQogICAgICAgICAgICAgICAgaW5wdXRfZGF0YT1kb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5vdXRwdXRfMSwNCiAgICAgICAgICAgICAgICBwYXJhbWJvb2w9ZG9fd2hpbGVfYm9keV9mdW5jLm91dHB1dHMuYm9vbF9wYXJhbV9vdXRwdXQsDQogICAgICAgICAgICAgICAgcGFyYW1pbnQ9ZG9fd2hpbGVfYm9keV9mdW5jLm91dHB1dHMuaW50X3BhcmFtX291dHB1dCwNCiAgICAgICAgICAgICAgICBwYXJhbWZsb2F0PWRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLmZsb2F0X3BhcmFtX291dHB1dCwNCiAgICAgICAgICAgICAgICBwYXJhbXN0cj1kb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5zdHJfcGFyYW1fb3V0cHV0LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICBjb25kaXRpb24oY29uZGl0aW9uPWRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLmNvbmRpdGlvbiwgdHJ1ZV9ibG9jaz1wcmltaXRpdmVfb3V0cHV0X2NvbXBvbmVudF90cnVlKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHRlc3RfcGlwZWxpbmUoDQogICAgICAgICAgICBpbnB1dF9kYXRhPXRlc3RfaW5wdXQsIGludF9wYXJhbT00LCBib29sX3BhcmFtPVRydWUsIGZsb2F0X3BhcmFtPTIyLjAsIHN0cl9wYXJhbT0ic3RyaW5nX3BhcmFtX25vX3NwYWNlIg0KICAgICAgICApDQoNCiAgICAgICAgd2l0aCBpbmNsdWRlX3ByaXZhdGVfcHJldmlld19ub2Rlc19pbl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcmVzdF9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCg0KICAgICAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBvbWl0X3dpdGhfd2lsZGNhcmQocmVzdF9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpLCAqb21pdF9maWVsZHMpDQogICAgICAgIGFzc2VydCBkc2xfcGlwZWxpbmVfam9iX2RpY3RbInByb3BlcnRpZXMiXVsiam9icyJdID09IHsNCiAgICAgICAgICAgICJjb25kaXRpb25ub2RlIjogew0KICAgICAgICAgICAgICAgICJfc291cmNlIjogIkRTTCIsDQogICAgICAgICAgICAgICAgImNvbmRpdGlvbiI6ICIke3twYXJlbnQuam9icy5kb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5jb25kaXRpb259fSIsDQogICAgICAgICAgICAgICAgInRydWVfYmxvY2siOiAiJHt7cGFyZW50LmpvYnMucHJpbWl0aXZlX291dHB1dF9jb21wb25lbnRfdHJ1ZX19IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJpZl9lbHNlIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiZG9fd2hpbGVfYm9keV9mdW5jIjogew0KICAgICAgICAgICAgICAgICJfc291cmNlIjogIlJFTU9URS5XT1JLU1BBQ0UuQ09NUE9ORU5UIiwNCiAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAiYm9vbF9wYXJhbSI6IHsiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQuaW5wdXRzLmJvb2xfcGFyYW19fSJ9LA0KICAgICAgICAgICAgICAgICAgICAiZmxvYXRfcGFyYW0iOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5mbG9hdF9wYXJhbX19In0sDQogICAgICAgICAgICAgICAgICAgICJpbnB1dF8xIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuaW5wdXRfZGF0YX19In0sDQogICAgICAgICAgICAgICAgICAgICJpbnB1dF8yIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuaW5wdXRfZGF0YX19In0sDQogICAgICAgICAgICAgICAgICAgICJpbnRfcGFyYW0iOiB7ImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50LmlucHV0cy5pbnRfcGFyYW19fSJ9LA0KICAgICAgICAgICAgICAgICAgICAic3RyX3BhcmFtIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5pbnB1dHMuc3RyX3BhcmFtfX0ifSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJuYW1lIjogImRvX3doaWxlX2JvZHlfZnVuYyIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgImRvd2hpbGUiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiRFNMIiwNCiAgICAgICAgICAgICAgICAiYm9keSI6ICIke3twYXJlbnQuam9icy5kb193aGlsZV9ib2R5X2Z1bmN9fSIsDQogICAgICAgICAgICAgICAgImNvbmRpdGlvbiI6ICJjb25kaXRpb24iLA0KICAgICAgICAgICAgICAgICJsaW1pdHMiOiB7Im1heF9pdGVyYXRpb25fY291bnQiOiAzfSwNCiAgICAgICAgICAgICAgICAibWFwcGluZyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImJvb2xfcGFyYW1fb3V0cHV0IjogWyJib29sX3BhcmFtIl0sDQogICAgICAgICAgICAgICAgICAgICJmbG9hdF9wYXJhbV9vdXRwdXQiOiBbImZsb2F0X3BhcmFtIl0sDQogICAgICAgICAgICAgICAgICAgICJpbnRfcGFyYW1fb3V0cHV0IjogWyJpbnRfcGFyYW0iXSwNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dF8xIjogWyJpbnB1dF8xIl0sDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRfMiI6IFsiaW5wdXRfMiJdLA0KICAgICAgICAgICAgICAgICAgICAic3RyX3BhcmFtX291dHB1dCI6IFsic3RyX3BhcmFtIl0sDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJkb193aGlsZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInByaW1pdGl2ZV9vdXRwdXRfY29tcG9uZW50X3RydWUiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJpbnB1dF9kYXRhIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5qb2JzLmRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLm91dHB1dF8xfX0iLA0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAicGFyYW1ib29sIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5qb2JzLmRvX3doaWxlX2JvZHlfZnVuYy5vdXRwdXRzLmJvb2xfcGFyYW1fb3V0cHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAicGFyYW1mbG9hdCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5kb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5mbG9hdF9wYXJhbV9vdXRwdXR9fSIsDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICJwYXJhbWludCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5kb193aGlsZV9ib2R5X2Z1bmMub3V0cHV0cy5pbnRfcGFyYW1fb3V0cHV0fX0iLA0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAicGFyYW1zdHIiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmpvYnMuZG9fd2hpbGVfYm9keV9mdW5jLm91dHB1dHMuc3RyX3BhcmFtX291dHB1dH19IiwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJuYW1lIjogInByaW1pdGl2ZV9vdXRwdXRfY29tcG9uZW50X3RydWUiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfaWZfZWxzZV9tdWx0aXBsZV9ibG9ja3Moc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50X25vX3BhdGhzLnltbCINCiAgICAgICAgKQ0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIikNCiAgICAgICAgYmFzaWNfY29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvY29tcG9uZW50X3dpdGhfY29uZGl0aW9uYWxfb3V0cHV0L3NwZWMueWFtbCINCiAgICAgICAgKQ0KDQogICAgICAgIEBwaXBlbGluZSgNCiAgICAgICAgICAgIGNvbXB1dGU9ImNwdS1jbHVzdGVyIiwNCiAgICAgICAgKQ0KICAgICAgICBkZWYgY29uZGl0aW9uX3BpcGVsaW5lKCk6DQogICAgICAgICAgICByZXN1bHQgPSBiYXNpY19jb21wb25lbnQoKQ0KDQogICAgICAgICAgICBub2RlMSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudF9ub19wYXRocyhjb21wb25lbnRfaW5fbnVtYmVyPTEpDQoNCiAgICAgICAgICAgIG5vZGUyID0gaGVsbG9fd29ybGRfY29tcG9uZW50X25vX3BhdGhzKGNvbXBvbmVudF9pbl9udW1iZXI9MikNCiAgICAgICAgICAgIG5vZGUzID0gaGVsbG9fd29ybGRfY29tcG9uZW50KGNvbXBvbmVudF9pbl9udW1iZXI9MywgY29tcG9uZW50X2luX3BhdGg9dGVzdF9pbnB1dCkNCiAgICAgICAgICAgIG5vZGU0ID0gaGVsbG9fd29ybGRfY29tcG9uZW50KGNvbXBvbmVudF9pbl9udW1iZXI9NCwgY29tcG9uZW50X2luX3BhdGg9dGVzdF9pbnB1dCkNCiAgICAgICAgICAgIGNvbmRpdGlvbihjb25kaXRpb249cmVzdWx0Lm91dHB1dHMub3V0cHV0LCBmYWxzZV9ibG9jaz1bbm9kZTEsIG5vZGUzXSwgdHJ1ZV9ibG9jaz1bbm9kZTIsIG5vZGU0XSkNCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBjb25kaXRpb25fcGlwZWxpbmUoKQ0KICAgICAgICB3aXRoIGluY2x1ZGVfcHJpdmF0ZV9wcmV2aWV3X25vZGVzX2luX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCg0KICAgICAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgZHNsX3BpcGVsaW5lX2pvYl9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXVsiY29uZGl0aW9ubm9kZSJdID09IHsNCiAgICAgICAgICAgICJfc291cmNlIjogIkRTTCIsDQogICAgICAgICAgICAiY29uZGl0aW9uIjogIiR7e3BhcmVudC5qb2JzLnJlc3VsdC5vdXRwdXRzLm91dHB1dH19IiwNCiAgICAgICAgICAgICJmYWxzZV9ibG9jayI6IFsiJHt7cGFyZW50LmpvYnMubm9kZTF9fSIsICIke3twYXJlbnQuam9icy5ub2RlM319Il0sDQogICAgICAgICAgICAidHJ1ZV9ibG9jayI6IFsiJHt7cGFyZW50LmpvYnMubm9kZTJ9fSIsICIke3twYXJlbnQuam9icy5ub2RlNH19Il0sDQogICAgICAgICAgICAidHlwZSI6ICJpZl9lbHNlIiwNCiAgICAgICAgfQ0KDQogICAgQHB5dGVzdC5tYXJrLnNraXBpZihjb25kaXRpb249bm90IGlzX2xpdmUoKSwgcmVhc29uPSJUT0RPKDIxNzczNTMpOiBjaGVjayB3aHkgcmVjb3JkZWQgdGVzdHMgZmFpbHVyZS4iKQ0KICAgIGRlZiB0ZXN0X2lmX2Vsc2VfbXVsdGlwbGVfYmxvY2tzX3N1YmdyYXBoKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnRfbm9fcGF0aHMgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgIHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudF9ub19wYXRocy55bWwiDQogICAgICAgICkNCiAgICAgICAgYmFzaWNfY29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoDQogICAgICAgICAgICBzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvY29tcG9uZW50X3dpdGhfY29uZGl0aW9uYWxfb3V0cHV0L3NwZWMueWFtbCINCiAgICAgICAgKQ0KDQogICAgICAgIEBwaXBlbGluZSgpDQogICAgICAgIGRlZiBzdWJncmFwaCgpOg0KICAgICAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50X25vX3BhdGhzKGNvbXBvbmVudF9pbl9udW1iZXI9MikNCg0KICAgICAgICBAcGlwZWxpbmUoDQogICAgICAgICAgICBjb21wdXRlPSJjcHUtY2x1c3RlciIsDQogICAgICAgICkNCiAgICAgICAgZGVmIGNvbmRpdGlvbl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcmVzdWx0ID0gYmFzaWNfY29tcG9uZW50KCkNCg0KICAgICAgICAgICAgbm9kZTEgPSBoZWxsb193b3JsZF9jb21wb25lbnRfbm9fcGF0aHMoY29tcG9uZW50X2luX251bWJlcj0xKQ0KDQogICAgICAgICAgICBub2RlMiA9IHN1YmdyYXBoKCkNCg0KICAgICAgICAgICAgY29uZGl0aW9uKGNvbmRpdGlvbj1yZXN1bHQub3V0cHV0cy5vdXRwdXQsIHRydWVfYmxvY2s9W25vZGUxLCBub2RlMl0pDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gY29uZGl0aW9uX3BpcGVsaW5lKCkNCiAgICAgICAgd2l0aCBpbmNsdWRlX3ByaXZhdGVfcHJldmlld19ub2Rlc19pbl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCiAgICAgICAgZHNsX3BpcGVsaW5lX2pvYl9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCksICpvbWl0X2ZpZWxkcykNCiAgICAgICAgYXNzZXJ0IGRzbF9waXBlbGluZV9qb2JfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bImNvbmRpdGlvbm5vZGUiXSA9PSB7DQogICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgImNvbmRpdGlvbiI6ICIke3twYXJlbnQuam9icy5yZXN1bHQub3V0cHV0cy5vdXRwdXR9fSIsDQogICAgICAgICAgICAidHJ1ZV9ibG9jayI6IFsiJHt7cGFyZW50LmpvYnMubm9kZTF9fSIsICIke3twYXJlbnQuam9icy5ub2RlMn19Il0sDQogICAgICAgICAgICAidHlwZSI6ICJpZl9lbHNlIiwNCiAgICAgICAgfQ0KDQoNCkBweXRlc3QubWFyay51c2VmaXh0dXJlcygibW9ja19hbm9uX2NvbXBvbmVudF92ZXJzaW9uIikNCmNsYXNzIFRlc3REb1doaWxlUGlwZWxpbmUoVGVzdENvbnRyb2xGbG93UGlwZWxpbmUpOg0KICAgIEBwcm9wZXJ0eQ0KICAgIGRlZiBfYmFzaWNfY29tcG9uZW50X2Z1bmMoc2VsZik6DQogICAgICAgIHJldHVybiBsb2FkX2NvbXBvbmVudCgiLi90ZXN0cy90ZXN0X2NvbmZpZ3MvZHNsX3BpcGVsaW5lL2RvX3doaWxlL2Jhc2ljX2NvbXBvbmVudC9jb21wb25lbnQueW1sIikNCg0KICAgIEBweXRlc3QubWFyay5za2lwaWYoDQogICAgICAgIGNvbmRpdGlvbj1ub3QgaXNfbGl2ZSgpLA0KICAgICAgICByZWFzb249IlRPRE8gKDIzNzQ2MTApOiBoYXNoIHNhbml0aXplciBpcyBiZWluZyBhcHBsaWVkIHVubmVjZXNzYXJpbHkgYW5kIGZvcmNpbmcgcGxheWJhY2sgZmFpbHVyZXMiLA0KICAgICkNCiAgICBAcHl0ZXN0Lm1hcmsudXNlZml4dHVyZXMoIm1vY2tfYW5vbl9jb21wb25lbnRfdmVyc2lvbiIpDQogICAgZGVmIHRlc3RfZG9fd2hpbGVfcGlwZWxpbmUoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIEBwaXBlbGluZQ0KICAgICAgICBkZWYgZG9fd2hpbGVfYm9keV9waXBlbGluZV9jb21wb25lbnQoDQogICAgICAgICAgICBjb21wb25lbnRfaW5fbnVtYmVyOiBJbnB1dCh0eXBlPSJpbnRlZ2VyIiwgb3B0aW9uYWw9VHJ1ZSksDQogICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aDogSW5wdXQodHlwZT0idXJpX2ZvbGRlciIpLA0KICAgICAgICApOg0KICAgICAgICAgICAgIyBDYWxsIGNvbXBvbmVudCBvYmogYXMgZnVuY3Rpb246IGFwcGx5IGdpdmVuIGlucHV0cyAmIHBhcmFtZXRlcnMgdG8gY3JlYXRlIGEgbm9kZSBpbiBwaXBlbGluZQ0KICAgICAgICAgICAgYmFzaWNfY29tcG9uZW50ID0gc2VsZi5fYmFzaWNfY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbl9wYXRoLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgcmV0dXJuIGJhc2ljX2NvbXBvbmVudC5vdXRwdXRzDQoNCiAgICAgICAgQHBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV93aXRoX2RvX3doaWxlKA0KICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcjogSW5wdXQodHlwZT0iaW50ZWdlciIpLA0KICAgICAgICAgICAgY29tcG9uZW50X2luX3BhdGg6IElucHV0KHR5cGU9InVyaV9mb2xkZXIiKSwNCiAgICAgICAgKToNCiAgICAgICAgICAgICMgRG8gd2hpbGUgbm9kZSB3aXRoIHBpcGVsaW5lIGNvbXBvbmVudA0KICAgICAgICAgICAgZG9fd2hpbGVfYm9keV9waXBlbGluZSA9IGRvX3doaWxlX2JvZHlfcGlwZWxpbmVfY29tcG9uZW50KA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGRvX3doaWxlX3dpdGhfcGlwZWxpbmUgPSBkb193aGlsZSggICMgbm9xYTogRjg0MQ0KICAgICAgICAgICAgICAgIGJvZHk9ZG9fd2hpbGVfYm9keV9waXBlbGluZSwNCiAgICAgICAgICAgICAgICBjb25kaXRpb249ZG9fd2hpbGVfYm9keV9waXBlbGluZS5vdXRwdXRzLmlzX251bWJlcl9sYXJnZXJfdGhhbl96ZXJvLA0KICAgICAgICAgICAgICAgIG1hcHBpbmc9ew0KICAgICAgICAgICAgICAgICAgICBkb193aGlsZV9ib2R5X3BpcGVsaW5lLm91dHB1dHMub3V0cHV0X2luX3BhdGg6IGRvX3doaWxlX2JvZHlfcGlwZWxpbmUuaW5wdXRzLmNvbXBvbmVudF9pbl9wYXRoLA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgbWF4X2l0ZXJhdGlvbl9jb3VudD01LA0KICAgICAgICAgICAgKQ0KDQogICAgICAgICAgICBjb21tYW5kX2NvbXBvbmVudCA9IHNlbGYuX2Jhc2ljX2NvbXBvbmVudF9mdW5jKA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGRvX3doaWxlX3dpdGhfY29tbWFuZF9jb21wb25lbnQgPSBkb193aGlsZSggICMgbm9xYTogRjg0MQ0KICAgICAgICAgICAgICAgIGJvZHk9Y29tbWFuZF9jb21wb25lbnQsDQogICAgICAgICAgICAgICAgY29uZGl0aW9uPWNvbW1hbmRfY29tcG9uZW50Lm91dHB1dHMuaXNfbnVtYmVyX2xhcmdlcl90aGFuX3plcm8sDQogICAgICAgICAgICAgICAgbWFwcGluZz17DQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRfaW5fbnVtYmVyIjogY29tbWFuZF9jb21wb25lbnQuaW5wdXRzLmNvbXBvbmVudF9pbl9udW1iZXIsDQogICAgICAgICAgICAgICAgICAgIGNvbW1hbmRfY29tcG9uZW50Lm91dHB1dHMub3V0cHV0X2luX3BhdGg6IGNvbW1hbmRfY29tcG9uZW50LmlucHV0cy5jb21wb25lbnRfaW5fcGF0aCwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG1heF9pdGVyYXRpb25fY291bnQ9NSwNCiAgICAgICAgICAgICkNCg0KICAgICAgICAgICAgIyBVc2UgdGhlIG91dHB1dHMgb2YgZG9fd2hpbGUgbm9kZQ0KICAgICAgICAgICAgYmFzaWNfY29tcG9uZW50ID0gZG9fd2hpbGVfYm9keV9waXBlbGluZV9jb21wb25lbnQoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1Ob25lLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPWNvbW1hbmRfY29tcG9uZW50Lm91dHB1dHMub3V0cHV0X2luX3BhdGgsDQogICAgICAgICAgICApDQogICAgICAgICAgICByZXR1cm4geyJvdXRwdXRfaW5fcGF0aCI6IGJhc2ljX2NvbXBvbmVudC5vdXRwdXRzLm91dHB1dF9pbl9wYXRofQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBpcGVsaW5lX3dpdGhfZG9fd2hpbGUoDQogICAgICAgICAgICBjb21wb25lbnRfaW5fbnVtYmVyPTIsDQogICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1JbnB1dCh0eXBlPSJ1cmlfZm9sZGVyIiwgcGF0aD1zdHIoUGF0aChfX2ZpbGVfXykucGFyZW50KSksDQogICAgICAgICkNCiAgICAgICAgIyBzZXQgcGlwZWxpbmUgbGV2ZWwgY29tcHV0ZQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQogICAgZGVmIHRlc3RfZG9fd2hpbGVfcGlwZWxpbmVfd2l0aF9wcmltaXRpdmVfaW5wdXRzKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIGRvX3doaWxlX2JvZHlfcGlwZWxpbmVfY29tcG9uZW50KA0KICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcjogSW5wdXQodHlwZT0iaW50ZWdlciIpLA0KICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcl8xOiBJbnB1dCh0eXBlPSJpbnRlZ2VyIiksDQogICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aDogSW5wdXQodHlwZT0idXJpX2ZvbGRlciIpLA0KICAgICAgICApOg0KICAgICAgICAgICAgIiIiRTJFIGR1bW15IHRyYWluLXNjb3JlLWV2YWwgcGlwZWxpbmUgd2l0aCBjb21wb25lbnRzIGRlZmluZWQgdmlhIHlhbWwuIiIiDQogICAgICAgICAgICAjIENhbGwgY29tcG9uZW50IG9iaiBhcyBmdW5jdGlvbjogYXBwbHkgZ2l2ZW4gaW5wdXRzICYgcGFyYW1ldGVycyB0byBjcmVhdGUgYSBub2RlIGluIHBpcGVsaW5lDQogICAgICAgICAgICB0cmFpbl93aXRoX3NhbXBsZV9kYXRhID0gc2VsZi5fYmFzaWNfY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXJfMT1jb21wb25lbnRfaW5fbnVtYmVyXzEsDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3BhdGg9Y29tcG9uZW50X2luX3BhdGgsDQogICAgICAgICAgICApDQogICAgICAgICAgICByZXR1cm4gdHJhaW5fd2l0aF9zYW1wbGVfZGF0YS5vdXRwdXRzDQoNCiAgICAgICAgQHBpcGVsaW5lDQogICAgICAgIGRlZiBwaXBlbGluZV93aXRoX2RvX3doaWxlKA0KICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcjogSW5wdXQodHlwZT0iaW50ZWdlciIpLA0KICAgICAgICAgICAgY29tcG9uZW50X2luX3BhdGg6IElucHV0KHR5cGU9InVyaV9mb2xkZXIiKSwNCiAgICAgICAgKToNCiAgICAgICAgICAgICMgRG8gd2hpbGUgbm9kZSB3aXRoIHBpcGVsaW5lIGNvbXBvbmVudA0KICAgICAgICAgICAgZG9fd2hpbGVfYm9keV9waXBlbGluZSA9IGRvX3doaWxlX2JvZHlfcGlwZWxpbmVfY29tcG9uZW50KA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9Y29tcG9uZW50X2luX251bWJlciwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fbnVtYmVyXzE9Y29tcG9uZW50X2luX251bWJlciwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1jb21wb25lbnRfaW5fcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGRvX3doaWxlX3dpdGhfcGlwZWxpbmUgPSBkb193aGlsZSggICMgbm9xYTogRjg0MQ0KICAgICAgICAgICAgICAgIGJvZHk9ZG9fd2hpbGVfYm9keV9waXBlbGluZSwNCiAgICAgICAgICAgICAgICBjb25kaXRpb249ZG9fd2hpbGVfYm9keV9waXBlbGluZS5vdXRwdXRzLmlzX251bWJlcl9sYXJnZXJfdGhhbl96ZXJvLA0KICAgICAgICAgICAgICAgIG1hcHBpbmc9ew0KICAgICAgICAgICAgICAgICAgICBkb193aGlsZV9ib2R5X3BpcGVsaW5lLm91dHB1dHMub3V0cHV0X2luX251bWJlcjogWw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9fd2hpbGVfYm9keV9waXBlbGluZS5pbnB1dHMuY29tcG9uZW50X2luX251bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvX3doaWxlX2JvZHlfcGlwZWxpbmUuaW5wdXRzLmNvbXBvbmVudF9pbl9udW1iZXJfMSwNCiAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dF9pbl9wYXRoIjogZG9fd2hpbGVfYm9keV9waXBlbGluZS5pbnB1dHMuY29tcG9uZW50X2luX3BhdGgsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBtYXhfaXRlcmF0aW9uX2NvdW50PTUsDQogICAgICAgICAgICApDQoNCiAgICAgICAgICAgIGNvbW1hbmRfY29tcG9uZW50ID0gc2VsZi5fYmFzaWNfY29tcG9uZW50X2Z1bmMoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXJfMT1jb21wb25lbnRfaW5fbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPWNvbXBvbmVudF9pbl9wYXRoLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgZG9fd2hpbGVfd2l0aF9jb21tYW5kX2NvbXBvbmVudCA9IGRvX3doaWxlKCAgIyBub3FhOiBGODQxDQogICAgICAgICAgICAgICAgYm9keT1jb21tYW5kX2NvbXBvbmVudCwNCiAgICAgICAgICAgICAgICBjb25kaXRpb249Y29tbWFuZF9jb21wb25lbnQub3V0cHV0cy5pc19udW1iZXJfbGFyZ2VyX3RoYW5femVybywNCiAgICAgICAgICAgICAgICBtYXBwaW5nPXsNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dF9pbl9udW1iZXIiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kX2NvbXBvbmVudC5pbnB1dHMuY29tcG9uZW50X2luX251bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRfY29tcG9uZW50LmlucHV0cy5jb21wb25lbnRfaW5fbnVtYmVyXzEsDQogICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRfaW5fcGF0aCI6IGNvbW1hbmRfY29tcG9uZW50LmlucHV0cy5jb21wb25lbnRfaW5fcGF0aCwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG1heF9pdGVyYXRpb25fY291bnQ9NSwNCiAgICAgICAgICAgICkNCg0KICAgICAgICAgICAgIyBVc2UgdGhlIG91dHB1dHMgb2YgZG9fd2hpbGUgbm9kZQ0KICAgICAgICAgICAgYmFzaWNfY29tcG9uZW50ID0gZG9fd2hpbGVfYm9keV9waXBlbGluZV9jb21wb25lbnQoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX251bWJlcj1kb193aGlsZV9ib2R5X3BpcGVsaW5lLm91dHB1dHMub3V0cHV0X2luX251bWJlciwNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fbnVtYmVyXzE9Y29tbWFuZF9jb21wb25lbnQub3V0cHV0cy5vdXRwdXRfaW5fbnVtYmVyLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPWRvX3doaWxlX2JvZHlfcGlwZWxpbmUub3V0cHV0cy5vdXRwdXRfaW5fcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIHJldHVybiB7Im91dHB1dF9pbl9wYXRoIjogYmFzaWNfY29tcG9uZW50Lm91dHB1dHMub3V0cHV0X2luX3BhdGh9DQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGlwZWxpbmVfd2l0aF9kb193aGlsZSgNCiAgICAgICAgICAgIGNvbXBvbmVudF9pbl9udW1iZXI9MiwNCiAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPUlucHV0KHR5cGU9InVyaV9mb2xkZXIiLCBwYXRoPXN0cihQYXRoKF9fZmlsZV9fKS5wYXJlbnQpKSwNCiAgICAgICAgKQ0KICAgICAgICAjIHNldCBwaXBlbGluZSBsZXZlbCBjb21wdXRlDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCg0KQHB5dGVzdC5tYXJrLnNraXBpZigNCiAgICBjb25kaXRpb249aXNfbGl2ZSgpLA0KICAgICMgVE9ETzogcmVvcGVuIGxpdmUgdGVzdCB3aGVuIHBhcmFsbGVsX2ZvciBkZXBsb3llZCB0byBjYW5hcnkNCiAgICByZWFzb249InBhcmFsbGVsX2ZvciBpcyBub3QgYXZhaWxhYmxlIGluIGNhbmFyeS4iLA0KKQ0KY2xhc3MgVGVzdFBhcmFsbGVsRm9yUGlwZWxpbmUoVGVzdENvbnRyb2xGbG93UGlwZWxpbmUpOg0KICAgIGRlZiB0ZXN0X3NpbXBsZV9kc2xfcGFyYWxsZWxfZm9yX3BpcGVsaW5lKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIikNCg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIHBhcmFsbGVsX2Zvcl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGFyYWxsZWxfYm9keSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD10ZXN0X2lucHV0KQ0KICAgICAgICAgICAgcGFyYWxsZWxfbm9kZSA9IHBhcmFsbGVsX2ZvcigNCiAgICAgICAgICAgICAgICBib2R5PXBhcmFsbGVsX2JvZHksDQogICAgICAgICAgICAgICAgaXRlbXM9Ww0KICAgICAgICAgICAgICAgICAgICB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAxfSwNCiAgICAgICAgICAgICAgICAgICAgeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMn0sDQogICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGFmdGVyX25vZGUgPSBoZWxsb193b3JsZF9jb21wb25lbnQoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3BhdGg9cGFyYWxsZWxfbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGFmdGVyX25vZGUuY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBwYXJhbGxlbF9mb3JfcGlwZWxpbmUoKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIHdpdGggaW5jbHVkZV9wcml2YXRlX3ByZXZpZXdfbm9kZXNfaW5fcGlwZWxpbmUoKToNCiAgICAgICAgICAgIHBpcGVsaW5lX2pvYiA9IGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQogICAgICAgIGRzbF9waXBlbGluZV9qb2JfZGljdCA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpLCAqb21pdF9maWVsZHMpDQogICAgICAgIGFzc2VydCBkc2xfcGlwZWxpbmVfam9iX2RpY3RbInByb3BlcnRpZXMiXVsiam9icyJdID09IHsNCiAgICAgICAgICAgICJhZnRlcl9ub2RlIjogew0KICAgICAgICAgICAgICAgICJfc291cmNlIjogIlJFTU9URS5XT1JLU1BBQ0UuQ09NUE9ORU5UIiwNCiAgICAgICAgICAgICAgICAiY29tcHV0ZUlkIjogImNwdS1jbHVzdGVyIiwNCiAgICAgICAgICAgICAgICAiaW5wdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X2luX3BhdGgiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiam9iX2lucHV0X3R5cGUiOiAibGl0ZXJhbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiJHt7cGFyZW50LmpvYnMucGFyYWxsZWxfbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH19IiwNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAiYWZ0ZXJfbm9kZSIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBhcmFsbGVsX2JvZHkiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZmlsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICAidXJpIjogImh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiwNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIm5hbWUiOiAicGFyYWxsZWxfYm9keSIsDQogICAgICAgICAgICAgICAgInR5cGUiOiAiY29tbWFuZCIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgInBhcmFsbGVsX25vZGUiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiRFNMIiwNCiAgICAgICAgICAgICAgICAiYm9keSI6ICIke3twYXJlbnQuam9icy5wYXJhbGxlbF9ib2R5fX0iLA0KICAgICAgICAgICAgICAgICJpdGVtcyI6ICdbeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMX0sICcgJ3siY29tcG9uZW50X2luX251bWJlciI6IDJ9XScsDQogICAgICAgICAgICAgICAgInR5cGUiOiAicGFyYWxsZWxfZm9yIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X2RzbF9wYXJhbGxlbF9mb3JfcGlwZWxpbmVfdW5wcm92aWRlZF9pbnB1dChzZWxmLCBjbGllbnQ6IE1MQ2xpZW50KToNCiAgICAgICAgaGVsbG9fd29ybGRfY29tcG9uZW50ID0gbG9hZF9jb21wb25lbnQoc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50X2FsdDEueW1sIikNCg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIHBhcmFsbGVsX2Zvcl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGFyYWxsZWxfYm9keSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD10ZXN0X2lucHV0KQ0KICAgICAgICAgICAgcGFyYWxsZWxfbm9kZSA9IHBhcmFsbGVsX2ZvcigNCiAgICAgICAgICAgICAgICBib2R5PXBhcmFsbGVsX2JvZHksDQogICAgICAgICAgICAgICAgaXRlbXM9Ww0KICAgICAgICAgICAgICAgICAgICB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAxfSwNCiAgICAgICAgICAgICAgICAgICAgeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMn0sDQogICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIGFmdGVyX25vZGUgPSBoZWxsb193b3JsZF9jb21wb25lbnQoDQogICAgICAgICAgICAgICAgY29tcG9uZW50X2luX3BhdGg9cGFyYWxsZWxfbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwgY29tcG9uZW50X2luX251bWJlcj0xDQogICAgICAgICAgICApDQogICAgICAgICAgICBhZnRlcl9ub2RlLmNvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGFyYWxsZWxfZm9yX3BpcGVsaW5lKCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCg0KICAgICAgICB3aXRoIGluY2x1ZGVfcHJpdmF0ZV9wcmV2aWV3X25vZGVzX2luX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCiAgICAgICAgZHNsX3BpcGVsaW5lX2pvYl9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCksICpvbWl0X2ZpZWxkcykNCiAgICAgICAgYXNzZXJ0IGRzbF9waXBlbGluZV9qb2JfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl0gPT0gew0KICAgICAgICAgICAgImFmdGVyX25vZGUiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJjb21wdXRlSWQiOiAiY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fbnVtYmVyIjogeyJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIjEifSwNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5qb2JzLnBhcmFsbGVsX25vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGh9fSIsDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJhZnRlcl9ub2RlIiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicGFyYWxsZWxfYm9keSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJSRU1PVEUuV09SS1NQQUNFLkNPTVBPTkVOVCIsDQogICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogInVyaV9maWxlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1cmkiOiAiaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJwYXJhbGxlbF9ib2R5IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicGFyYWxsZWxfbm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgICAgICJib2R5IjogIiR7e3BhcmVudC5qb2JzLnBhcmFsbGVsX2JvZHl9fSIsDQogICAgICAgICAgICAgICAgIml0ZW1zIjogJ1t7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAxfSwgJyAneyJjb21wb25lbnRfaW5fbnVtYmVyIjogMn1dJywNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbF9mb3IiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfcGFyYWxsZWxfZm9yX3BpcGVsaW5lX3dpdGhfc3ViZ3JhcGgoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiKQ0KDQogICAgICAgIEBwaXBlbGluZQ0KICAgICAgICBkZWYgc3ViX2dyYXBoKGNvbXBvbmVudF9pbl9udW1iZXI6IGludCA9IDEwKToNCiAgICAgICAgICAgIG5vZGUgPSBoZWxsb193b3JsZF9jb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9dGVzdF9pbnB1dCwgY29tcG9uZW50X2luX251bWJlcj1jb21wb25lbnRfaW5fbnVtYmVyKQ0KICAgICAgICAgICAgcmV0dXJuIHsiY29tcG9uZW50X291dF9wYXRoIjogbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH0NCg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIHBhcmFsbGVsX2Zvcl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGFyYWxsZWxfYm9keSA9IHN1Yl9ncmFwaCgpDQogICAgICAgICAgICBwYXJhbGxlbF9ub2RlID0gcGFyYWxsZWxfZm9yKA0KICAgICAgICAgICAgICAgIGJvZHk9cGFyYWxsZWxfYm9keSwNCiAgICAgICAgICAgICAgICBpdGVtcz1bDQogICAgICAgICAgICAgICAgICAgIHsiY29tcG9uZW50X2luX251bWJlciI6IDF9LA0KICAgICAgICAgICAgICAgICAgICB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAyfSwNCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgYWZ0ZXJfbm9kZSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudCgNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1wYXJhbGxlbF9ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgYWZ0ZXJfbm9kZS5jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBhcmFsbGVsX2Zvcl9waXBlbGluZSgpDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgd2l0aCBpbmNsdWRlX3ByaXZhdGVfcHJldmlld19ub2Rlc19pbl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCiAgICAgICAgZHNsX3BpcGVsaW5lX2pvYl9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCksICpvbWl0X2ZpZWxkcykNCiAgICAgICAgYXNzZXJ0IGRzbF9waXBlbGluZV9qb2JfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl0gPT0gew0KICAgICAgICAgICAgImFmdGVyX25vZGUiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiUkVNT1RFLldPUktTUEFDRS5DT01QT05FTlQiLA0KICAgICAgICAgICAgICAgICJjb21wdXRlSWQiOiAiY3B1LWNsdXN0ZXIiLA0KICAgICAgICAgICAgICAgICJpbnB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfaW5fcGF0aCI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJqb2JfaW5wdXRfdHlwZSI6ICJsaXRlcmFsIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICIke3twYXJlbnQuam9icy5wYXJhbGxlbF9ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0iLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJhZnRlcl9ub2RlIiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicGFyYWxsZWxfYm9keSI6IHsiX3NvdXJjZSI6ICJSRU1PVEUuV09SS1NQQUNFLkNPTVBPTkVOVCIsICJuYW1lIjogInBhcmFsbGVsX2JvZHkiLCAidHlwZSI6ICJwaXBlbGluZSJ9LA0KICAgICAgICAgICAgInBhcmFsbGVsX25vZGUiOiB7DQogICAgICAgICAgICAgICAgIl9zb3VyY2UiOiAiRFNMIiwNCiAgICAgICAgICAgICAgICAiYm9keSI6ICIke3twYXJlbnQuam9icy5wYXJhbGxlbF9ib2R5fX0iLA0KICAgICAgICAgICAgICAgICJpdGVtcyI6ICdbeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMX0sICcgJ3siY29tcG9uZW50X2luX251bWJlciI6IDJ9XScsDQogICAgICAgICAgICAgICAgInR5cGUiOiAicGFyYWxsZWxfZm9yIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X3BhcmFsbGVsX2Zvcl9waXBlbGluZV9zdWJncmFwaF91bnByb3ZpZGVkX2lucHV0KHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIikNCg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIHN1Yl9ncmFwaChjb21wb25lbnRfaW5fbnVtYmVyOiBpbnQpOg0KICAgICAgICAgICAgbm9kZSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudChjb21wb25lbnRfaW5fcGF0aD10ZXN0X2lucHV0LCBjb21wb25lbnRfaW5fbnVtYmVyPWNvbXBvbmVudF9pbl9udW1iZXIpDQogICAgICAgICAgICByZXR1cm4geyJjb21wb25lbnRfb3V0X3BhdGgiOiBub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofQ0KDQogICAgICAgIEBwaXBlbGluZQ0KICAgICAgICBkZWYgcGFyYWxsZWxfZm9yX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwYXJhbGxlbF9ib2R5ID0gc3ViX2dyYXBoKCkNCiAgICAgICAgICAgIHBhcmFsbGVsX25vZGUgPSBwYXJhbGxlbF9mb3IoDQogICAgICAgICAgICAgICAgYm9keT1wYXJhbGxlbF9ib2R5LA0KICAgICAgICAgICAgICAgIGl0ZW1zPVsNCiAgICAgICAgICAgICAgICAgICAgeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMX0sDQogICAgICAgICAgICAgICAgICAgIHsiY29tcG9uZW50X2luX251bWJlciI6IDJ9LA0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICApDQogICAgICAgICAgICBhZnRlcl9ub2RlID0gaGVsbG9fd29ybGRfY29tcG9uZW50KA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudF9pbl9wYXRoPXBhcmFsbGVsX25vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGgsDQogICAgICAgICAgICApDQogICAgICAgICAgICBhZnRlcl9ub2RlLmNvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGFyYWxsZWxfZm9yX3BpcGVsaW5lKCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCg0KICAgICAgICB3aXRoIGluY2x1ZGVfcHJpdmF0ZV9wcmV2aWV3X25vZGVzX2luX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCg0KICAgICAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgZHNsX3BpcGVsaW5lX2pvYl9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXSA9PSB7DQogICAgICAgICAgICAiYWZ0ZXJfbm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJSRU1PVEUuV09SS1NQQUNFLkNPTVBPTkVOVCIsDQogICAgICAgICAgICAgICAgImNvbXB1dGVJZCI6ICJjcHUtY2x1c3RlciIsDQogICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogImxpdGVyYWwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIiR7e3BhcmVudC5qb2JzLnBhcmFsbGVsX25vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X3BhdGh9fSIsDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICJuYW1lIjogImFmdGVyX25vZGUiLA0KICAgICAgICAgICAgICAgICJ0eXBlIjogImNvbW1hbmQiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJwYXJhbGxlbF9ib2R5IjogeyJfc291cmNlIjogIlJFTU9URS5XT1JLU1BBQ0UuQ09NUE9ORU5UIiwgIm5hbWUiOiAicGFyYWxsZWxfYm9keSIsICJ0eXBlIjogInBpcGVsaW5lIn0sDQogICAgICAgICAgICAicGFyYWxsZWxfbm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgICAgICJib2R5IjogIiR7e3BhcmVudC5qb2JzLnBhcmFsbGVsX2JvZHl9fSIsDQogICAgICAgICAgICAgICAgIml0ZW1zIjogJ1t7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAxfSwgJyAneyJjb21wb25lbnRfaW5fbnVtYmVyIjogMn1dJywNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbF9mb3IiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgfQ0KDQogICAgZGVmIHRlc3RfcGFyYWxsZWxfZm9yX3BpcGVsaW5lX3dpdGhfcG9ydF9vdXRwdXRzKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgIHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudC55bWwiLA0KICAgICAgICAgICAgcGFyYW1zX292ZXJyaWRlPVsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfcGF0aCI6IHsidHlwZSI6ICJ1cmlfZm9sZGVyIn0sDQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9maWxlIjogeyJ0eXBlIjogInVyaV9maWxlIn0sDQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF90YWJsZSI6IHsidHlwZSI6ICJtbHRhYmxlIn0sDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdLA0KICAgICAgICApDQoNCiAgICAgICAgQHBpcGVsaW5lDQogICAgICAgIGRlZiBwYXJhbGxlbF9mb3JfcGlwZWxpbmUoKToNCiAgICAgICAgICAgIHBhcmFsbGVsX2JvZHkgPSBoZWxsb193b3JsZF9jb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9dGVzdF9pbnB1dCkNCiAgICAgICAgICAgIHBhcmFsbGVsX25vZGUgPSBwYXJhbGxlbF9mb3IoDQogICAgICAgICAgICAgICAgYm9keT1wYXJhbGxlbF9ib2R5LA0KICAgICAgICAgICAgICAgIGl0ZW1zPVsNCiAgICAgICAgICAgICAgICAgICAgeyJjb21wb25lbnRfaW5fbnVtYmVyIjogM30sDQogICAgICAgICAgICAgICAgICAgIHsiY29tcG9uZW50X2luX251bWJlciI6IDR9LA0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICApDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3BhdGgiOiBwYXJhbGxlbF9ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X2ZpbGUiOiBwYXJhbGxlbF9ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9maWxlLA0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3RhYmxlIjogcGFyYWxsZWxfbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfdGFibGUsDQogICAgICAgICAgICB9DQoNCiAgICAgICAgcGlwZWxpbmVfam9iID0gcGFyYWxsZWxfZm9yX3BpcGVsaW5lKCkNCiAgICAgICAgcGlwZWxpbmVfam9iLnNldHRpbmdzLmRlZmF1bHRfY29tcHV0ZSA9ICJjcHUtY2x1c3RlciINCg0KICAgICAgICB3aXRoIGluY2x1ZGVfcHJpdmF0ZV9wcmV2aWV3X25vZGVzX2luX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwaXBlbGluZV9qb2IgPSBhc3NlcnRfam9iX2NhbmNlbChwaXBlbGluZV9qb2IsIGNsaWVudCkNCg0KICAgICAgICBkc2xfcGlwZWxpbmVfam9iX2RpY3QgPSBvbWl0X3dpdGhfd2lsZGNhcmQocGlwZWxpbmVfam9iLl90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKSwgKm9taXRfZmllbGRzKQ0KICAgICAgICBhc3NlcnQgZHNsX3BpcGVsaW5lX2pvYl9kaWN0WyJwcm9wZXJ0aWVzIl1bImpvYnMiXSA9PSB7DQogICAgICAgICAgICAicGFyYWxsZWxfYm9keSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJSRU1PVEUuV09SS1NQQUNFLkNPTVBPTkVOVCIsDQogICAgICAgICAgICAgICAgImlucHV0cyI6IHsNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9pbl9wYXRoIjogew0KICAgICAgICAgICAgICAgICAgICAgICAgImpvYl9pbnB1dF90eXBlIjogInVyaV9maWxlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1cmkiOiAiaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiLA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAibmFtZSI6ICJwYXJhbGxlbF9ib2R5IiwNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjb21tYW5kIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAicGFyYWxsZWxfbm9kZSI6IHsNCiAgICAgICAgICAgICAgICAiX3NvdXJjZSI6ICJEU0wiLA0KICAgICAgICAgICAgICAgICJib2R5IjogIiR7e3BhcmVudC5qb2JzLnBhcmFsbGVsX2JvZHl9fSIsDQogICAgICAgICAgICAgICAgIml0ZW1zIjogJ1t7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAzfSwgJyAneyJjb21wb25lbnRfaW5fbnVtYmVyIjogNH1dJywNCiAgICAgICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbF9mb3IiLA0KICAgICAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9maWxlIjogeyJ0eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMuY29tcG9uZW50X291dF9maWxlfX0ifSwNCiAgICAgICAgICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfcGF0aCI6IHsidHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH19In0sDQogICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3RhYmxlIjogeyJ0eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMuY29tcG9uZW50X291dF90YWJsZX19In0sDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IGRzbF9waXBlbGluZV9qb2JfZGljdFsicHJvcGVydGllcyJdWyJvdXRwdXRzIl0gPT0gew0KICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfZmlsZSI6IHsiam9iX291dHB1dF90eXBlIjogIm1sdGFibGUiLCAibW9kZSI6ICJSZWFkV3JpdGVNb3VudCJ9LA0KICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfcGF0aCI6IHsiam9iX291dHB1dF90eXBlIjogIm1sdGFibGUiLCAibW9kZSI6ICJSZWFkV3JpdGVNb3VudCJ9LA0KICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfdGFibGUiOiB7ImpvYl9vdXRwdXRfdHlwZSI6ICJtbHRhYmxlIiwgIm1vZGUiOiAiUmVhZFdyaXRlTW91bnQifSwNCiAgICAgICAgfQ0KDQogICAgICAgICMgcGFyYWxsZWwgZm9yIHBpcGVsaW5lIGNvbXBvbmVudCBpcyBjb3JyZWN0bHkgZ2VuZXJhdGVkDQogICAgICAgIEBwaXBlbGluZQ0KICAgICAgICBkZWYgcGFyZW50X3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwYXJhbGxlbF9mb3JfcGlwZWxpbmUoKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBhcmVudF9waXBlbGluZSgpDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgcmVzdF9waXBlbGluZV9jb21wb25lbnQgPSBwaXBlbGluZV9qb2Iuam9ic1sicGFyYWxsZWxfZm9yX3BpcGVsaW5lIl0uY29tcG9uZW50Ll90b19yZXN0X29iamVjdCgpLmFzX2RpY3QoKQ0KICAgICAgICBhc3NlcnQgcmVzdF9waXBlbGluZV9jb21wb25lbnRbInByb3BlcnRpZXMiXVsiY29tcG9uZW50X3NwZWMiXVsib3V0cHV0cyJdID09IHsNCiAgICAgICAgICAgICJjb21wb25lbnRfb3V0X2ZpbGUiOiB7InR5cGUiOiAibWx0YWJsZSJ9LA0KICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfcGF0aCI6IHsidHlwZSI6ICJtbHRhYmxlIn0sDQogICAgICAgICAgICAiY29tcG9uZW50X291dF90YWJsZSI6IHsidHlwZSI6ICJtbHRhYmxlIn0sDQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0IHJlc3RfcGlwZWxpbmVfY29tcG9uZW50WyJwcm9wZXJ0aWVzIl1bImNvbXBvbmVudF9zcGVjIl1bImpvYnMiXVsicGFyYWxsZWxfbm9kZSJdID09IHsNCiAgICAgICAgICAgICJib2R5IjogIiR7e3BhcmVudC5qb2JzLnBhcmFsbGVsX2JvZHl9fSIsDQogICAgICAgICAgICAiaXRlbXMiOiAnW3siY29tcG9uZW50X2luX251bWJlciI6IDN9LCB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiA0fV0nLA0KICAgICAgICAgICAgIm91dHB1dHMiOiB7DQogICAgICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfZmlsZSI6IHsidHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5vdXRwdXRzLmNvbXBvbmVudF9vdXRfZmlsZX19In0sDQogICAgICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfcGF0aCI6IHsidHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aH19In0sDQogICAgICAgICAgICAgICAgImNvbXBvbmVudF9vdXRfdGFibGUiOiB7InR5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5jb21wb25lbnRfb3V0X3RhYmxlfX0ifSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbF9mb3IiLA0KICAgICAgICAgICAgIl9zb3VyY2UiOiAiRFNMIiwNCiAgICAgICAgfQ0KDQogICAgICAgIHdpdGggaW5jbHVkZV9wcml2YXRlX3ByZXZpZXdfbm9kZXNfaW5fcGlwZWxpbmUoKToNCiAgICAgICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQogICAgZGVmIHRlc3RfcGFyYWxsZWxfZm9yX3BpcGVsaW5lX3dpdGhfcHJpbWl0aXZlX291dHB1dHMoc2VsZiwgY2xpZW50OiBNTENsaWVudCk6DQogICAgICAgIGhlbGxvX3dvcmxkX2NvbXBvbmVudCA9IGxvYWRfY29tcG9uZW50KA0KICAgICAgICAgICAgc291cmNlPSIuL3Rlc3RzL3Rlc3RfY29uZmlncy9jb21wb25lbnRzL2hlbGxvd29ybGRfY29tcG9uZW50LnltbCIsDQogICAgICAgICAgICBwYXJhbXNfb3ZlcnJpZGU9Ww0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dHMiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogeyJ0eXBlIjogInVyaV9mb2xkZXIifSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X251bWJlciI6IHsidHlwZSI6ICJudW1iZXIifSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X2Jvb2xlYW4iOiB7InR5cGUiOiAiYm9vbGVhbiIsICJpc19jb250cm9sIjogVHJ1ZX0sDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdLA0KICAgICAgICApDQoNCiAgICAgICAgQHBpcGVsaW5lDQogICAgICAgIGRlZiBwYXJhbGxlbF9mb3JfcGlwZWxpbmUoKToNCiAgICAgICAgICAgIHBhcmFsbGVsX2JvZHkgPSBoZWxsb193b3JsZF9jb21wb25lbnQoY29tcG9uZW50X2luX3BhdGg9dGVzdF9pbnB1dCkNCiAgICAgICAgICAgIHBhcmFsbGVsX25vZGUgPSBwYXJhbGxlbF9mb3IoDQogICAgICAgICAgICAgICAgYm9keT1wYXJhbGxlbF9ib2R5LA0KICAgICAgICAgICAgICAgIGl0ZW1zPVsNCiAgICAgICAgICAgICAgICAgICAgeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMX0sDQogICAgICAgICAgICAgICAgICAgIHsiY29tcG9uZW50X2luX251bWJlciI6IDJ9LA0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICApDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X3BhdGgiOiBwYXJhbGxlbF9ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X251bWJlciI6IHBhcmFsbGVsX25vZGUub3V0cHV0cy5jb21wb25lbnRfb3V0X251bWJlciwNCiAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9ib29sZWFuIjogcGFyYWxsZWxfbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfYm9vbGVhbiwNCiAgICAgICAgICAgIH0NCg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIHBhcmVudF9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGFyYWxsZWxfZm9yX3BpcGVsaW5lKCkNCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBwYXJlbnRfcGlwZWxpbmUoKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIHJlc3RfcGlwZWxpbmVfY29tcG9uZW50ID0gcGlwZWxpbmVfam9iLmpvYnNbInBhcmFsbGVsX2Zvcl9waXBlbGluZSJdLmNvbXBvbmVudC5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCkNCiAgICAgICAgYXNzZXJ0IHJlc3RfcGlwZWxpbmVfY29tcG9uZW50WyJwcm9wZXJ0aWVzIl1bImNvbXBvbmVudF9zcGVjIl1bIm91dHB1dHMiXSA9PSB7DQogICAgICAgICAgICAiY29tcG9uZW50X291dF9ib29sZWFuIjogeyJpc19jb250cm9sIjogVHJ1ZSwgInR5cGUiOiAic3RyaW5nIn0sDQogICAgICAgICAgICAiY29tcG9uZW50X291dF9udW1iZXIiOiB7InR5cGUiOiAic3RyaW5nIn0sDQogICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogeyJ0eXBlIjogIm1sdGFibGUifSwNCiAgICAgICAgfQ0KDQogICAgICAgIGFzc2VydCByZXN0X3BpcGVsaW5lX2NvbXBvbmVudFsicHJvcGVydGllcyJdWyJjb21wb25lbnRfc3BlYyJdWyJqb2JzIl1bInBhcmFsbGVsX25vZGUiXSA9PSB7DQogICAgICAgICAgICAiYm9keSI6ICIke3twYXJlbnQuam9icy5wYXJhbGxlbF9ib2R5fX0iLA0KICAgICAgICAgICAgIml0ZW1zIjogJ1t7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAxfSwgeyJjb21wb25lbnRfaW5fbnVtYmVyIjogMn1dJywNCiAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X2Jvb2xlYW4iOiB7InR5cGUiOiAibGl0ZXJhbCIsICJ2YWx1ZSI6ICIke3twYXJlbnQub3V0cHV0cy5jb21wb25lbnRfb3V0X2Jvb2xlYW59fSJ9LA0KICAgICAgICAgICAgICAgICJjb21wb25lbnRfb3V0X251bWJlciI6IHsidHlwZSI6ICJsaXRlcmFsIiwgInZhbHVlIjogIiR7e3BhcmVudC5vdXRwdXRzLmNvbXBvbmVudF9vdXRfbnVtYmVyfX0ifSwNCiAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogeyJ0eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0ifSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbF9mb3IiLA0KICAgICAgICAgICAgIl9zb3VyY2UiOiAiRFNMIiwNCiAgICAgICAgfQ0KDQogICAgICAgICMgcGFyYWxsZWwgZm9yIHBpcGVsaW5lIGNvbXBvbmVudCBpcyBjb3JyZWN0bHkgZ2VuZXJhdGVkDQogICAgICAgIHdpdGggaW5jbHVkZV9wcml2YXRlX3ByZXZpZXdfbm9kZXNfaW5fcGlwZWxpbmUoKToNCiAgICAgICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQogICAgZGVmIHRlc3RfcGFyYWxsZWxfZm9yX3BpcGVsaW5lX3dpdGhfZW1wdHlfaW5wdXRzKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudCgNCiAgICAgICAgICAgIHNvdXJjZT0iLi90ZXN0cy90ZXN0X2NvbmZpZ3MvY29tcG9uZW50cy9oZWxsb3dvcmxkX2NvbXBvbmVudF9ub19pbnB1dHMueW1sIiwNCiAgICAgICAgKQ0KDQogICAgICAgIEBwaXBlbGluZQ0KICAgICAgICBkZWYgcGFyYWxsZWxfZm9yX3BpcGVsaW5lKCk6DQogICAgICAgICAgICBwYXJhbGxlbF9ib2R5ID0gaGVsbG9fd29ybGRfY29tcG9uZW50KCkNCiAgICAgICAgICAgIGZvcmVhY2hfY29uZmlnID0ge30NCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDEwKToNCiAgICAgICAgICAgICAgICBmb3JlYWNoX2NvbmZpZ1tmInNpbG9fe2l9Il0gPSB7fQ0KICAgICAgICAgICAgcGFyYWxsZWxfbm9kZSA9IHBhcmFsbGVsX2Zvcihib2R5PXBhcmFsbGVsX2JvZHksIGl0ZW1zPWZvcmVhY2hfY29uZmlnKQ0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogcGFyYWxsZWxfbm9kZS5vdXRwdXRzLmNvbXBvbmVudF9vdXRfcGF0aCwNCiAgICAgICAgICAgIH0NCg0KICAgICAgICBwaXBlbGluZV9qb2IgPSBwYXJhbGxlbF9mb3JfcGlwZWxpbmUoKQ0KICAgICAgICBwaXBlbGluZV9qb2Iuc2V0dGluZ3MuZGVmYXVsdF9jb21wdXRlID0gImNwdS1jbHVzdGVyIg0KDQogICAgICAgIHdpdGggaW5jbHVkZV9wcml2YXRlX3ByZXZpZXdfbm9kZXNfaW5fcGlwZWxpbmUoKToNCiAgICAgICAgICAgIGFzc2VydF9qb2JfY2FuY2VsKHBpcGVsaW5lX2pvYiwgY2xpZW50KQ0KDQogICAgICAgIGRzbF9waXBlbGluZV9qb2JfZGljdCA9IG9taXRfd2l0aF93aWxkY2FyZChwaXBlbGluZV9qb2IuX3RvX3Jlc3Rfb2JqZWN0KCkuYXNfZGljdCgpLCAqb21pdF9maWVsZHMpDQogICAgICAgIGFzc2VydCBkc2xfcGlwZWxpbmVfam9iX2RpY3RbInByb3BlcnRpZXMiXVsiam9icyJdID09IHsNCiAgICAgICAgICAgICJwYXJhbGxlbF9ib2R5IjogeyJfc291cmNlIjogIllBTUwuQ09NUE9ORU5UIiwgIm5hbWUiOiAicGFyYWxsZWxfYm9keSIsICJ0eXBlIjogImNvbW1hbmQifSwNCiAgICAgICAgICAgICJwYXJhbGxlbF9ub2RlIjogew0KICAgICAgICAgICAgICAgICJfc291cmNlIjogIkRTTCIsDQogICAgICAgICAgICAgICAgImJvZHkiOiAiJHt7cGFyZW50LmpvYnMucGFyYWxsZWxfYm9keX19IiwNCiAgICAgICAgICAgICAgICAiaXRlbXMiOiAneyJzaWxvXzAiOiB7fSwgInNpbG9fMSI6IHt9LCAic2lsb18yIjoge30sICcNCiAgICAgICAgICAgICAgICAnInNpbG9fMyI6IHt9LCAic2lsb180Ijoge30sICJzaWxvXzUiOiB7fSwgJw0KICAgICAgICAgICAgICAgICcic2lsb182Ijoge30sICJzaWxvXzciOiB7fSwgInNpbG9fOCI6IHt9LCAnDQogICAgICAgICAgICAgICAgJyJzaWxvXzkiOiB7fX0nLA0KICAgICAgICAgICAgICAgICJvdXRwdXRzIjogew0KICAgICAgICAgICAgICAgICAgICAiY29tcG9uZW50X291dF9wYXRoIjogeyJ0eXBlIjogImxpdGVyYWwiLCAidmFsdWUiOiAiJHt7cGFyZW50Lm91dHB1dHMuY29tcG9uZW50X291dF9wYXRofX0ifQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgInR5cGUiOiAicGFyYWxsZWxfZm9yIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgIH0NCg0KICAgIGRlZiB0ZXN0X3BhcmFsbGVsX2Zvcl9waXBlbGluZV93aXRoX2Fzc2V0X2l0ZW1zKHNlbGYsIGNsaWVudDogTUxDbGllbnQpOg0KICAgICAgICBoZWxsb193b3JsZF9jb21wb25lbnQgPSBsb2FkX2NvbXBvbmVudChzb3VyY2U9Ii4vdGVzdHMvdGVzdF9jb25maWdzL2NvbXBvbmVudHMvaGVsbG93b3JsZF9jb21wb25lbnQueW1sIikNCg0KICAgICAgICBAcGlwZWxpbmUNCiAgICAgICAgZGVmIHBhcmFsbGVsX2Zvcl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGFyYWxsZWxfYm9keSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudCgpDQogICAgICAgICAgICBwYXJhbGxlbF9ub2RlID0gcGFyYWxsZWxfZm9yKA0KICAgICAgICAgICAgICAgIGJvZHk9cGFyYWxsZWxfYm9keSwNCiAgICAgICAgICAgICAgICBpdGVtcz1bDQogICAgICAgICAgICAgICAgICAgIHsiY29tcG9uZW50X2luX251bWJlciI6IDEsICJjb21wb25lbnRfaW5fcGF0aCI6IHRlc3RfaW5wdXR9LA0KICAgICAgICAgICAgICAgICAgICB7ImNvbXBvbmVudF9pbl9udW1iZXIiOiAyLCAiY29tcG9uZW50X2luX3BhdGgiOiB0ZXN0X2lucHV0fSwNCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICAgYWZ0ZXJfbm9kZSA9IGhlbGxvX3dvcmxkX2NvbXBvbmVudCgNCiAgICAgICAgICAgICAgICBjb21wb25lbnRfaW5fcGF0aD1wYXJhbGxlbF9ub2RlLm91dHB1dHMuY29tcG9uZW50X291dF9wYXRoLA0KICAgICAgICAgICAgKQ0KDQogICAgICAgIHBpcGVsaW5lX2pvYiA9IHBhcmFsbGVsX2Zvcl9waXBlbGluZSgpDQogICAgICAgIHBpcGVsaW5lX2pvYi5zZXR0aW5ncy5kZWZhdWx0X2NvbXB1dGUgPSAiY3B1LWNsdXN0ZXIiDQoNCiAgICAgICAgd2l0aCBpbmNsdWRlX3ByaXZhdGVfcHJldmlld19ub2Rlc19pbl9waXBlbGluZSgpOg0KICAgICAgICAgICAgcGlwZWxpbmVfam9iID0gYXNzZXJ0X2pvYl9jYW5jZWwocGlwZWxpbmVfam9iLCBjbGllbnQpDQoNCiAgICAgICAgZHNsX3BpcGVsaW5lX2pvYl9kaWN0ID0gb21pdF93aXRoX3dpbGRjYXJkKHBpcGVsaW5lX2pvYi5fdG9fcmVzdF9vYmplY3QoKS5hc19kaWN0KCksICpvbWl0X2ZpZWxkcykNCiAgICAgICAgYXNzZXJ0IGRzbF9waXBlbGluZV9qb2JfZGljdFsicHJvcGVydGllcyJdWyJqb2JzIl1bInBhcmFsbGVsX25vZGUiXSA9PSB7DQogICAgICAgICAgICAiYm9keSI6ICIke3twYXJlbnQuam9icy5wYXJhbGxlbF9ib2R5fX0iLA0KICAgICAgICAgICAgIml0ZW1zIjogJ1t7ImNvbXBvbmVudF9pbl9wYXRoIjogeyJ1cmkiOiAnDQogICAgICAgICAgICAnImh0dHBzOi8vZHByZXBkYXRhLmJsb2IuY29yZS53aW5kb3dzLm5ldC9kZW1vL1RpdGFuaWMuY3N2IiwgJw0KICAgICAgICAgICAgJyJqb2JfaW5wdXRfdHlwZSI6ICJ1cmlfZmlsZSJ9LCAnDQogICAgICAgICAgICAnImNvbXBvbmVudF9pbl9udW1iZXIiOiAxfSwgeyJjb21wb25lbnRfaW5fcGF0aCI6ICcNCiAgICAgICAgICAgICd7InVyaSI6ICcNCiAgICAgICAgICAgICciaHR0cHM6Ly9kcHJlcGRhdGEuYmxvYi5jb3JlLndpbmRvd3MubmV0L2RlbW8vVGl0YW5pYy5jc3YiLCAnDQogICAgICAgICAgICAnImpvYl9pbnB1dF90eXBlIjogInVyaV9maWxlIn0sICcNCiAgICAgICAgICAgICciY29tcG9uZW50X2luX251bWJlciI6IDJ9XScsDQogICAgICAgICAgICAidHlwZSI6ICJwYXJhbGxlbF9mb3IiLA0KICAgICAgICAgICAgIl9zb3VyY2UiOiAiRFNMIiwNCiAgICAgICAgfQ0K",
      "StatusCode": 201,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Content-MD5": "Nk4cK4U9ZubJGThU1K7nkw==",
        "Date": "Wed, 24 May 2023 03:02:50 GMT",
        "ETag": "\u00220x8DB5C035C70649B\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:50 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-content-crc64": "7kkQaajaWT8=",
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://amltest5899420437.blob.core.windows.net/azureml-blobstore-0bdd51b6-cd9c-4978-b870-99997b393b81/LocalUpload/00000000000000000000000000000000/e2etests/__init__.py?comp=metadata",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/xml",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "0",
        "User-Agent": "azsdk-python-storage-blob/12.16.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)",
        "x-ms-date": "Wed, 24 May 2023 03:02:50 GMT",
        "x-ms-meta-name": "507272c2-9acb-4471-9bc2-7e9b00b1f851",
        "x-ms-meta-upload_status": "completed",
        "x-ms-meta-version": "49944216-650e-4e99-83cd-44884b25df21",
        "x-ms-version": "2022-11-02"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Content-Length": "0",
        "Date": "Wed, 24 May 2023 03:02:50 GMT",
        "ETag": "\u00220x8DB5C035C9329AA\u0022",
        "Last-Modified": "Wed, 24 May 2023 03:02:51 GMT",
        "Server": [
          "Windows-Azure-Blob/1.0",
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-request-server-encrypted": "true",
        "x-ms-version": "2022-11-02"
      },
      "ResponseBody": null
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/jobs/000000000000000000000?api-version=2023-04-01-preview",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "3487",
        "Content-Type": "application/json",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": {
        "properties": {
          "properties": {},
          "tags": {},
          "displayName": "pipeline_with_do_while",
          "experimentName": "azure-ai-ml",
          "isArchived": false,
          "jobType": "Pipeline",
          "inputs": {
            "component_in_number": {
              "jobInputType": "literal",
              "value": "2"
            },
            "component_in_path": {
              "uri": "azureml://datastores/workspaceblobstore/paths/LocalUpload/00000000000000000000000000000000/e2etests/",
              "jobInputType": "uri_folder"
            }
          },
          "jobs": {
            "do_while_body_pipeline": {
              "name": "do_while_body_pipeline",
              "type": "pipeline",
              "inputs": {
                "component_in_number": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_number_1": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_path": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_path}}"
                }
              },
              "_source": "DSL",
              "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/e56097e1-ae81-414d-b5d6-b3929d21303f"
            },
            "do_while_with_pipeline": {
              "body": "${{parent.jobs.do_while_body_pipeline}}",
              "type": "do_while",
              "condition": "is_number_larger_than_zero",
              "mapping": {
                "${{parent.jobs.do_while_body_pipeline.outputs.output_in_number}}": [
                  "component_in_number",
                  "component_in_number_1"
                ],
                "output_in_path": [
                  "component_in_path"
                ]
              },
              "limits": {
                "max_iteration_count": 5
              },
              "_source": "DSL"
            },
            "command_component": {
              "name": "command_component",
              "type": "command",
              "inputs": {
                "component_in_number": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_number_1": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_path": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_path}}"
                }
              },
              "_source": "YAML.COMPONENT",
              "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/c6182fc9-3280-44ef-bd4e-6f45fc19c4f3"
            },
            "do_while_with_command_component": {
              "body": "${{parent.jobs.command_component}}",
              "type": "do_while",
              "condition": "is_number_larger_than_zero",
              "mapping": {
                "output_in_number": [
                  "component_in_number",
                  "component_in_number_1"
                ],
                "output_in_path": [
                  "component_in_path"
                ]
              },
              "limits": {
                "max_iteration_count": 5
              },
              "_source": "DSL"
            },
            "basic_component": {
              "name": "basic_component",
              "type": "pipeline",
              "inputs": {
                "component_in_number": {
                  "job_input_type": "literal",
                  "value": "${{parent.jobs.do_while_body_pipeline.outputs.output_in_number}}"
                },
                "component_in_number_1": {
                  "job_input_type": "literal",
                  "value": "${{parent.jobs.command_component.outputs.output_in_number}}"
                },
                "component_in_path": {
                  "job_input_type": "literal",
                  "value": "${{parent.jobs.do_while_body_pipeline.outputs.output_in_path}}"
                }
              },
              "outputs": {
                "output_in_path": {
                  "value": "${{parent.outputs.output_in_path}}",
                  "type": "literal"
                }
              },
              "_source": "DSL",
              "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/e56097e1-ae81-414d-b5d6-b3929d21303f"
            }
          },
          "outputs": {
            "output_in_path": {
              "jobOutputType": "uri_folder"
            }
          },
          "settings": {
            "default_compute": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/computes/cpu-cluster",
            "_source": "DSL"
          }
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "6879",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:52 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/jobs/000000000000000000000?api-version=2023-04-01-preview",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-0d0f6e88065224a0065dd0f28219e8ec-40e71feb5c65d7ca-01\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "e3d4e96c-d95b-4b0b-b8e9-0db2017bcbcb",
        "x-ms-ratelimit-remaining-subscription-writes": "1192",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030252Z:e3d4e96c-d95b-4b0b-b8e9-0db2017bcbcb",
        "x-request-time": "1.318"
      },
      "ResponseBody": {
        "id": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/jobs/000000000000000000000",
        "name": "000000000000000000000",
        "type": "Microsoft.MachineLearningServices/workspaces/jobs",
        "properties": {
          "description": null,
          "tags": {},
          "properties": {
            "azureml.DevPlatv2": "true",
            "azureml.DatasetAccessMode": "Asset",
            "azureml.runsource": "azureml.PipelineRun",
            "runSource": "MFE",
            "runType": "HTTP",
            "azureml.parameters": "{\u0022component_in_number\u0022:\u00222\u0022}",
            "azureml.continue_on_step_failure": "True",
            "azureml.continue_on_failed_optional_input": "True",
            "azureml.enforceRerun": "False",
            "azureml.defaultComputeName": "cpu-cluster",
            "azureml.defaultDataStoreName": "workspaceblobstore",
            "azureml.pipelineComponent": "pipelinerun"
          },
          "displayName": "pipeline_with_do_while",
          "status": "Preparing",
          "experimentName": "azure-ai-ml",
          "services": {
            "Tracking": {
              "jobServiceType": "Tracking",
              "port": null,
              "endpoint": "azureml://eastus2.api.azureml.ms/mlflow/v1.0/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000?",
              "status": null,
              "errorMessage": null,
              "properties": null,
              "nodes": null
            },
            "Studio": {
              "jobServiceType": "Studio",
              "port": null,
              "endpoint": "https://ml.azure.com/runs/000000000000000000000?wsid=/subscriptions/00000000-0000-0000-0000-000000000/resourcegroups/00000/workspaces/00000",
              "status": null,
              "errorMessage": null,
              "properties": null,
              "nodes": null
            }
          },
          "computeId": null,
          "isArchived": false,
          "identity": null,
          "componentId": null,
          "notificationSetting": null,
          "secretsConfiguration": null,
          "jobType": "Pipeline",
          "settings": {
            "default_compute": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/computes/cpu-cluster",
            "_source": "DSL"
          },
          "jobs": {
            "do_while_body_pipeline": {
              "name": "do_while_body_pipeline",
              "type": "pipeline",
              "inputs": {
                "component_in_number": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_number_1": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_path": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_path}}"
                }
              },
              "_source": "DSL",
              "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/e56097e1-ae81-414d-b5d6-b3929d21303f"
            },
            "do_while_with_pipeline": {
              "body": "${{parent.jobs.do_while_body_pipeline}}",
              "type": "do_while",
              "condition": "is_number_larger_than_zero",
              "mapping": {
                "${{parent.jobs.do_while_body_pipeline.outputs.output_in_number}}": [
                  "component_in_number",
                  "component_in_number_1"
                ],
                "output_in_path": [
                  "component_in_path"
                ]
              },
              "limits": {
                "max_iteration_count": 5
              },
              "_source": "DSL"
            },
            "command_component": {
              "name": "command_component",
              "type": "command",
              "inputs": {
                "component_in_number": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_number_1": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_number}}"
                },
                "component_in_path": {
                  "job_input_type": "literal",
                  "value": "${{parent.inputs.component_in_path}}"
                }
              },
              "_source": "YAML.COMPONENT",
              "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/c6182fc9-3280-44ef-bd4e-6f45fc19c4f3"
            },
            "do_while_with_command_component": {
              "body": "${{parent.jobs.command_component}}",
              "type": "do_while",
              "condition": "is_number_larger_than_zero",
              "mapping": {
                "output_in_number": [
                  "component_in_number",
                  "component_in_number_1"
                ],
                "output_in_path": [
                  "component_in_path"
                ]
              },
              "limits": {
                "max_iteration_count": 5
              },
              "_source": "DSL"
            },
            "basic_component": {
              "name": "basic_component",
              "type": "pipeline",
              "inputs": {
                "component_in_number": {
                  "job_input_type": "literal",
                  "value": "${{parent.jobs.do_while_body_pipeline.outputs.output_in_number}}"
                },
                "component_in_number_1": {
                  "job_input_type": "literal",
                  "value": "${{parent.jobs.command_component.outputs.output_in_number}}"
                },
                "component_in_path": {
                  "job_input_type": "literal",
                  "value": "${{parent.jobs.do_while_body_pipeline.outputs.output_in_path}}"
                }
              },
              "outputs": {
                "output_in_path": {
                  "value": "${{parent.outputs.output_in_path}}",
                  "type": "literal"
                }
              },
              "_source": "DSL",
              "componentId": "/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/components/azureml_anonymous/versions/e56097e1-ae81-414d-b5d6-b3929d21303f"
            }
          },
          "inputs": {
            "component_in_number": {
              "description": null,
              "jobInputType": "literal",
              "value": "2"
            },
            "component_in_path": {
              "description": null,
              "uri": "azureml://datastores/workspaceblobstore/paths/LocalUpload/00000000000000000000000000000000/e2etests/",
              "mode": "ReadOnlyMount",
              "jobInputType": "uri_folder"
            }
          },
          "outputs": {
            "output_in_path": {
              "description": null,
              "uri": null,
              "assetName": null,
              "assetVersion": null,
              "mode": "ReadWriteMount",
              "autoDeleteSetting": null,
              "jobOutputType": "uri_folder"
            }
          },
          "sourceJobId": null
        },
        "systemData": {
          "createdAt": "2023-05-24T03:02:52.5748946\u002B00:00",
          "createdBy": "Chenyang Zhang",
          "createdByType": "User"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/resourceGroups/00000/providers/Microsoft.MachineLearningServices/workspaces/00000/jobs/000000000000000000000/cancel?api-version=2023-04-01-preview",
      "RequestMethod": "POST",
      "RequestHeaders": {
        "Accept": "application/json",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "Content-Length": "0",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": null,
      "StatusCode": 202,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "4",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:55 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/providers/Microsoft.MachineLearningServices/locations/eastus2/mfeOperationResults/jc:0bdd51b6-cd9c-4978-b870-99997b393b81:000000000000000000000?api-version=2023-04-01-preview",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-async-operation-timeout": "PT1H",
        "x-ms-correlation-request-id": "308570d2-f816-4223-9587-3cc22b4079d2",
        "x-ms-ratelimit-remaining-subscription-writes": "1198",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030255Z:308570d2-f816-4223-9587-3cc22b4079d2",
        "x-request-time": "0.759"
      },
      "ResponseBody": "null"
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/providers/Microsoft.MachineLearningServices/locations/eastus2/mfeOperationResults/jc:0bdd51b6-cd9c-4978-b870-99997b393b81:000000000000000000000?api-version=2023-04-01-preview",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "*/*",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": null,
      "StatusCode": 202,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "2",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Wed, 24 May 2023 03:02:56 GMT",
        "Expires": "-1",
        "Location": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/providers/Microsoft.MachineLearningServices/locations/eastus2/mfeOperationResults/jc:0bdd51b6-cd9c-4978-b870-99997b393b81:000000000000000000000?api-version=2023-04-01-preview",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "89b1d47c-1ab2-4e66-ab17-ed3d7298eaa1",
        "x-ms-ratelimit-remaining-subscription-reads": "11995",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030256Z:89b1d47c-1ab2-4e66-ab17-ed3d7298eaa1",
        "x-request-time": "0.056"
      },
      "ResponseBody": {}
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/00000000-0000-0000-0000-000000000/providers/Microsoft.MachineLearningServices/locations/eastus2/mfeOperationResults/jc:0bdd51b6-cd9c-4978-b870-99997b393b81:000000000000000000000?api-version=2023-04-01-preview",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "*/*",
        "Accept-Encoding": "gzip, deflate",
        "Connection": "keep-alive",
        "User-Agent": "azure-ai-ml/1.8.0 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.8.12 (Windows-10-10.0.22621-SP0)"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "0",
        "Date": "Wed, 24 May 2023 03:03:25 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Request-Context": "appId=cid-v1:2d2e8e63-272e-4b3c-8598-4ee570a0e70d",
        "Server-Timing": "traceparent;desc=\u002200-bcee1abde810d2fc156dd6f3c801ee25-251dfaaa6d4a56b0-00\u0022",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "x-aml-cluster": "vienna-eastus2-02",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "d161e026-862d-4812-9754-108867ce5b0f",
        "x-ms-ratelimit-remaining-subscription-reads": "11994",
        "x-ms-response-type": "standard",
        "x-ms-routing-request-id": "JAPANEAST:20230524T030326Z:d161e026-862d-4812-9754-108867ce5b0f",
        "x-request-time": "0.062"
      },
      "ResponseBody": null
    }
  ],
  "Variables": {}
}
