type: pipeline

name: simplePipelineJobWithFlow
description: The hello world pipeline job with flow option 1

compute: "azureml:cpu-cluster"

inputs:
  job_data:
    type: uri_file
    path: "../test_data/flow_input_data.jsonl"

outputs:
  anonymous_command_output: ${{parent.jobs.anonymous_command_flow.outputs.output_data}}

jobs:
  registered_parallel_flow:
    type: parallel
    component: azureml:flow_name:flow_version
    logging_level: INFO
    instance_count: 2
    inputs:
      data: ${{parent.inputs.job_data}}
      groundtruth: "${data.answer}"
      prediction: "${run.outputs.category}"
      connections.node_name.connection: another_connection
      connections.node_name.deployment_name: deployment_name

  registered_command_flow:
    type: command
    component: azureml:flow_name:flow_version
    inputs:
      data: ${{parent.inputs.job_data}}
      groundtruth: "${data.answer}"
      prediction: "${run.outputs.category}"
      connections.node_name.connection: another_connection
      connections.node_name.deployment_name: deployment_name
