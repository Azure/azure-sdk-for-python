$schema: https://azuremlschemas.azureedge.net/latest/autoMLJob.schema.json
type: automl

experiment_name: automl-image-classification-e2e-cli-test
compute: gpu-cluster

log_verbosity: debug
task: image_classification
primary_metric: accuracy

limits:
  timeout_minutes: 60
  max_trials: 10
  max_concurrent_trials: 2

target_column_name: label

training_data:
  path: src/azure-ai-ml/tests/test_configs/automl_job/test_datasets/image_classification/train
  type: mltable
validation_data:
  path: src/azure-ai-ml/tests/test_configs/automl_job/test_datasets/image_classification/valid
  type: mltable

sweep:
  sampling_algorithm: random
  early_termination:
    type: bandit
    evaluation_interval: 2
    slack_factor: 0.2
    delay_evaluation: 6

training_parameters:
  early_stopping: true
  evaluation_frequency: 1
  optimizer: sgd

search_space:
  - model_name:
      type: choice
      values: [vitb16r224, vits16r224]
    learning_rate:
      type: uniform
      min_value: 0.001
      max_value: 0.01
    number_of_epochs:
      type: choice
      values: [15, 30]

  - model_name:
      type: choice
      values: [seresnext, resnest50]
    learning_rate:
      type: uniform
      min_value: 0.001
      max_value: 0.01
    layers_to_freeze:
      type: choice
      values: [0, 2]
